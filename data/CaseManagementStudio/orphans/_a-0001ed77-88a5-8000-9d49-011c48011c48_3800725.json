{
  "uuid": "_a-0001ed77-88a5-8000-9d49-011c48011c48_3800725",
  "name": "CMGT_Case_ConfigureTask_Task_TaskDetailsSection",
  "type": "Interface",
  "description": "UI components to configure task details",
  "sail_code": "{\n  /*Name*/\n  #\"SYSTEM_SYSRULES_textField\"(\n    label: #\"urn:appian:translation-string:v1:0bae9b3f-5ddd-4c6a-a4cf-abe8702dac9e\",\n    value: ri!selectedTask[recordType!CMGT_Task.title],\n    saveInto: {\n      ri!selectedTask[recordType!CMGT_Task.title],\n      a!save(\n        ri!case[recordType!CMGT_Case.tasks],\n        #\"urn:appian:function:v1:a:update\"(\n          ri!case[recordType!CMGT_Case.tasks],\n          /*Index of the case task that we want to update in the ri!tasks array*/\n          wherecontains(\n            ri!selectedTaskInstanceUUID,\n            ri!case[recordType!CMGT_Case.tasks.taskInstanceUuid]\n          ),\n          /*The updated case task*/\n          #\"urn:appian:function:v1:a:update\"(\n            ri!selectedTask,\n            recordType!CMGT_Task.title,\n            a!defaultValue(\n              value: ri!selectedTask[recordType!CMGT_Task.title],\n              default: #\"urn:appian:translation-string:v1:30830477-e9a2-4628-8fcd-40507aa24b3c\"\n            )\n          )\n        )\n      )\n    },\n    characterLimit: cons!CMGT_INT_MAX_CHAR_LIMIT_MEDIUM,\n    showCharacterCount: false,\n    required: true,\n    requiredMessage: #\"urn:appian:translation-string:v1:4fab94dc-fcb1-427a-af9f-1239079b2897\"(\n      #\"urn:appian:translation-variable:v1:3e31b6d5-df20-4d17-80a7-81f3c83ff370\": #\"urn:appian:translation-string:v1:0bae9b3f-5ddd-4c6a-a4cf-abe8702dac9e\"\n    )\n  ),\n  /*Description*/\n  #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n    label: #\"urn:appian:translation-string:v1:0495bd73-7477-4bca-8918-2632c601a60b\",\n    labelSize: \"EXTRA_SMALL\",\n    labelColor: \"STANDARD\",\n    contents: rule!CMGT_UTIL_RichTextField(\n      value: ri!selectedTask[recordType!CMGT_Task.description],\n      readOnly: false(),\n      maxSize: cons!CMGT_INT_MAX_CHAR_LIMIT_EXTRA_LARGE,\n      label: #\"urn:appian:translation-string:v1:0495bd73-7477-4bca-8918-2632c601a60b\",\n      labelPosition: \"COLLAPSED\",\n      height: \"SHORT\",\n      additionalSaves: {\n        a!save(\n          ri!case[recordType!CMGT_Case.tasks],\n          #\"urn:appian:function:v1:a:update\"(\n            ri!case[recordType!CMGT_Case.tasks],\n            /*Index of the case task that we want to update in the ri!tasks array*/\n            wherecontains(\n              ri!selectedTaskInstanceUUID,\n              ri!case[recordType!CMGT_Case.tasks.taskInstanceUuid]\n            ),\n            /*The updated case task*/\n            #\"urn:appian:function:v1:a:update\"(\n              ri!selectedTask,\n              recordType!CMGT_Task.description,\n              ri!selectedTask[recordType!CMGT_Task.description]\n            )\n          )\n        )\n      }\n    ),\n    isCollapsible: true,\n    marginAbove: \"LESS\"\n  ),\n  /*Milestone*/\n  #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n    items: {\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n          choiceLabels: ri!activeMilestones[recordType!CMGT_Milestone.label],\n          choiceValues: ri!activeMilestones[recordType!CMGT_Milestone.referenceMilestoneUuid],\n          label: #\"urn:appian:translation-string:v1:802692c1-f167-44d0-8058-196440edbb6a\",\n          placeholder: #\"urn:appian:translation-string:v1:d6ec595a-cb00-4ca9-ad39-73fe092ca2eb\",\n          value: ri!selectedTask[recordType!CMGT_Task.milestone.referenceMilestoneUuid],\n          saveInto: a!localVariables(\n            local!milestone,\n            {\n              a!save(\n                local!milestone,\n                rule!CMGT_UTIL_Filter(\n                  records: ri!activeMilestones,\n                  field: recordType!CMGT_Milestone.referenceMilestoneUuid,\n                  value: save!value\n                )\n              ),\n              a!save(\n                ri!selectedTask[recordType!CMGT_Task.milestone],\n                local!milestone\n              ),\n              a!save(\n                ri!case[recordType!CMGT_Case.tasks],\n                #\"urn:appian:function:v1:a:update\"(\n                  ri!case[recordType!CMGT_Case.tasks],\n                  wherecontains(\n                    ri!selectedTaskInstanceUUID,\n                    ri!case[recordType!CMGT_Case.tasks.taskInstanceUuid]\n                  ),\n                  #\"urn:appian:function:v1:a:update\"(\n                    ri!selectedTask,\n                    recordType!CMGT_Task.milestone,\n                    ri!selectedTask[recordType!CMGT_Task.milestone]\n                  )\n                )\n              )\n            }\n          )\n        )\n      ),\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          labelPosition: \"COLLAPSED\",\n          value: {\n            #\"SYSTEM_SYSRULES_richTextIcon\"(\n              icon: \"edit\",\n              caption: #\"urn:appian:translation-string:v1:8f97c2f4-8f44-48fb-b01f-cc99b62ac984\",\n              link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                saveInto: {\n                  a!save(ri!currentStep, \"UPDATE_REF_MILESTONES\"),\n                  a!save(ri!workingCase, ri!case)\n                }\n              ),\n              linkStyle: \"STANDALONE\",\n              size: \"MEDIUM\"\n            )\n          },\n          marginBelow: \"LESS\"\n        ),\n        width: \"MINIMIZE\"\n      )\n    },\n    alignVertical: \"BOTTOM\",\n    stackWhen: \"NEVER\"\n  ),\n  /*Status*/\n  #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n    contents: #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n      data: #\"SYSTEM_SYSRULES_recordData\"(\n        recordType: recordType!CMGT_CFG_Status,\n        filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n          operator: \"AND\",\n          filters: {\n            #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!CMGT_CFG_Status.type,\n              operator: \"=\",\n              value: \"TASK\"\n            ),\n            #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!CMGT_CFG_Status.isActive,\n              operator: \"=\",\n              value: true\n            ),\n            #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!CMGT_CFG_Status.statusId,\n              operator: \"in\",\n              value: {\n                a!defaultValue(\n                  value: ri!initialTask[recordType!CMGT_Task.statusId],\n                  /* For new tasks the initial status will always be queued */\n                  default: cons!CMGT_REFID_STATUS_TASK_QUEUED\n                ),\n                cons!CMGT_REFID_STATUS_TASK_READY,\n                cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n              }\n            )\n          }\n        )\n      ),\n      choiceLabels: recordType!CMGT_CFG_Status.statusLabel,\n      choiceValues: recordType!CMGT_CFG_Status.statusId,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!CMGT_CFG_Status.sortOrder,\n        ascending: true()\n      ),\n      label: #\"urn:appian:translation-string:v1:7e0ce8d9-9374-4a9e-925a-fc30eb5ba4b6\",\n      labelPosition: \"ABOVE\",\n      value: ri!selectedTask[recordType!CMGT_Task.statusId],\n      saveInto: {\n        ri!selectedTask[recordType!CMGT_Task.statusId],\n        a!save(\n          ri!selectedTask[recordType!CMGT_Task.dueOn],\n          if(\n            ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_QUEUED,\n            null,\n            if(\n              and(\n               ri!previousStatusOfSelectedTask <> ri!selectedTask[recordType!CMGT_Task.statusId],\n                /*having a check to not recalculate if the status is being swithced between ready and inprogress*/\n                if(\n                  ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                 ri!previousStatusOfSelectedTask <> cons!CMGT_REFID_STATUS_TASK_READY,\n                  not(\n                    and(\n                      ri!previousStatusOfSelectedTask = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                      ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_READY\n                    )\n                  )\n                ),\n                or(\n                  ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_READY,\n                  ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS\n                )\n              ),\n              if(\n                rule!CMGT_UTIL_IsNotBlank(\n                  ri!selectedTask[recordType!CMGT_Task.sla]\n                ),\n                rule!CMGT_UTIL_CalculateDueDateBasedOnSLA(\n                  SLA: ri!selectedTask[recordType!CMGT_Task.sla],\n                  dateTime: now()\n                ),\n                null\n              ),\n              ri!selectedTask[recordType!CMGT_Task.dueOn]\n            )\n          )\n        ),\n        a!save(\n          ri!case[recordType!CMGT_Case.tasks],\n          #\"urn:appian:function:v1:a:update\"(\n            ri!case[recordType!CMGT_Case.tasks],\n            /*Index of the case task that we want to update*/\n            wherecontains(\n              ri!selectedTaskInstanceUUID,\n              ri!case[recordType!CMGT_Case.tasks.taskInstanceUuid]\n            ),\n            /*The updated case task*/\n            rule!CMGT_UTIL_SetRecordFields(\n              record: rule!CMGT_Task_SetMetaData(\n                tasks: #\"urn:appian:function:v1:a:update\"(\n                  ri!selectedTask,\n                  recordType!CMGT_Task.status,\n                  rule!CMGT_UTIL_Filter(\n                    records: ri!taskStatus,\n                    field: recordType!CMGT_CFG_Status.statusId,\n                    value: save!value\n                  )\n                ),\n                initiator: loggedInUser()\n              ),\n              alwaysOverwrite: a!map(\n                field: recordType!CMGT_Task.dueOn,\n                /*To restrict edit of Completed and not needed tasks dueOn */\n                value: ri!initialTask[recordType!CMGT_Task.dueOn],\n                applyWhen: or(\n                  ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n                  ri!selectedTask[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n                )\n              )\n            )\n          )\n        )\n      },\n      required: true()\n    ),\n    marginBelow: \"EVEN_LESS\"\n  )\n}",
  "calls": [
    {
      "name": "CMGT_UTIL_RichTextField",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_CalculateDueDateBasedOnSLA",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_SetRecordFields",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Task_SetMetaData",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_INT_MAX_CHAR_LIMIT_MEDIUM",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_INT_MAX_CHAR_LIMIT_EXTRA_LARGE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_STATUS_TASK_QUEUED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_STATUS_TASK_READY",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_STATUS_TASK_IN_PROGRESS",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_STATUS_TASK_NOT_NEEDED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_STATUS_TASK_COMPLETED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_Task",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_Case",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_Milestone",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_CFG_Status",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Role",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    }
  ],
  "called_by": []
}
{
  "_metadata": {
    "bundle_id": "CMGT_Task_Complete_AutomatedTask_Wrapper"
  },
  "objects": {
    "_a-0000e990-c462-8000-9ba7-011c48011c48_29411": {
      "name": "CMGT_QR_GetTask",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Task,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  groupByFields: ri!groupByFields,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskId,\n      operator: \"in\",\n      value: ri!taskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.statusId,\n      operator: \"in\",\n      value: ri!statusId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isActive,\n      operator: \"=\",\n      value: true,\n      applyWhen: ri!includeInactive <> true\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isCurrent,\n      operator: \"=\",\n      value: a!defaultValue(ri!isCurrentTask, true),\n      applyWhen: a!defaultValue(ri!isCurrentTaskApplyWhen, true),\n      \n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskIntentionCode,\n      operator: \"in\",\n      value: a!defaultValue(\n        ri!taskIntentionCodes,\n        {\n          cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW\n        }\n      )\n    ),\n    \n  },\n  fields: {\n    ri!fields,\n    if(\n      ri!includeRoles,\n      {\n        recordType!CMGT_Task.roles\n      },\n      {}\n    ),\n    if(\n      ri!includeMilestone,\n      {\n        recordType!CMGT_Task.milestone\n      },\n      {}\n    ),\n    if(\n      ri!includeCase,\n      {\n        recordType!CMGT_Task.case\n      },\n      {}\n    ),\n    if(\n      ri!includeBranches,\n      {\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/73a323c9-ce12-4212-97aa-f89df7d14c09/9644c5ba-af85-48a3-9cda-fcfb028d6113/3280de96-3518-4a9e-b8ae-854a84562f07\"\n      },\n      {}\n    ),\n    recordType!CMGT_Task.taskBehaviorType,\n    recordType!CMGT_Task.status,\n    recordType!CMGT_Task.taskResponseOptions,\n    recordType!CMGT_Task.selectedTaskResponseOption,\n    recordType!CMGT_Task.conditionSet,\n    recordType!CMGT_Task.conditionSet,\n    #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/5189c3ac-98e2-4a82-8598-2e9561baec9d/64b891e4-359b-48b4-9f47-2a3af4695c34/52813580-ecf3-49c7-be71-568ab452d54a\",\n    recordType!CMGT_Task.createCaseTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.automationTaskAction\n  },\n  logicalExpressions: {\n    ri!additionalLogicalExpression,\n    rule!CMGT_Task_AutomationRuleGlobalLogicalExpression(\n      taskIntentionCodes: ri!taskIntentionCodes\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  relatedRecordData: ri!relatedRecordData,\n  sort: ri!sort,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ecf6-527e-8000-9bbc-011c48011c48_56681": {
      "name": "CMGT_CFG_ENUM_ACTIONS",
      "type": "Expression Rule",
      "sail_code": "/*Contains the list of all actions for use in the Automation \nand their attributes. */\n{\nrule!CMGT_CFG_ENUM_ACT_ASSIGN_CASE(),\nrule!CMGT_CFG_ENUM_ACT_REASSIGN_CASE(),\nrule!CMGT_CFG_ENUM_ACT_ASSIGN_TASK(),\nrule!CMGT_CFG_ENUM_ACT_REASSIGN_TASK(),\nrule!CMGT_CFG_ENUM_ACT_WORKFLOW_ROUTING(),\nrule!CMGT_CFG_ENUM_ACT_SEND_EMAIL()\n  /* to add a new action, copy the above expression rule and replace the \n  values with the process model constant and attributes \n  of the newly configured action */\n  \n}"
    },
    "_a-0000ed7d-5e46-8000-9d4b-011c48011c48_3821612": {
      "name": "CMGT_CFG_ENUM_ACT_REASSIGN_TASK",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  actionCode: cons!CMGT_CFG_TXT_ACT_REASSIGN_TASK,\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:22b56237-493d-43a4-99d4-4849ebaa4861\",\n  /*interface used to configure assignment logic*/\n  configurationRule:rule!CMGT_WFL_AutomationRule_Configure_AssignmentLogic,\n  runtimeConfigurationRule: rule!CMGT_AutomationRule_Configure_AssignmentLogic,\n  configurationDisplayRule: rule!CMGT_WFL_CaseType_Rules_FormatAssignAction,\n  runtimeDisplayRule: rule!CMGT_Case_Rules_FormatAssignAction,\n  /*process to be run to assigne a case*/\n  PmConstant: cons!CMGT_PM_ROLE_MANAGE,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_TaskAssignment_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_TASK,\n  createdBy: \"system\"\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180568": {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "sail_code": "not(rule!CMGT_UTIL_IsBlank(ri!input))"
    },
    "_a-0000ed49-63d5-8000-9d3e-011c48011c48_3626108": {
      "name": "CMGT_CFG_ENUM_ACT_REASSIGN_CASE",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  actionCode: cons!CMGT_CFG_TXT_ACT_REASSIGN_CASE,\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:255ef9a9-837a-4a2c-aef4-2c578cfb4807\",\n  /*interface used to configure assignment logic*/\n  configurationRule:rule!CMGT_WFL_AutomationRule_Configure_AssignmentLogic,\n  runtimeConfigurationRule: rule!CMGT_AutomationRule_Configure_AssignmentLogic,\n  configurationDisplayRule: rule!CMGT_WFL_CaseType_Rules_FormatAssignAction,\n  runtimeDisplayRule: rule!CMGT_Case_Rules_FormatAssignAction,\n  /*process to be run to assigne a case*/\n  PmConstant: cons!CMGT_PM_ROLE_MANAGE,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_CaseAssignment_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_CASE,\n  createdBy: \"system\"\n)"
    },
    "_a-0000ed9c-71ef-8000-9d58-011c48011c48_3988353": {
      "name": "CMGT_CFG_ENUM_ACT_WORKFLOW_ROUTING",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:d21a949c-ac2f-4bf6-96ae-cdbbb7c64355\",\n  actionCode: cons!CMGT_CFG_TXT_ACT_WORKFLOW_ROUTING,\n  image: cons!CMGT_DOC_IMAGE_AUTOMATION_TYPE_WORKFLOW_ROUTING,\n  description: #\"urn:appian:translation-string:v1:b6767c60-abdc-4042-8808-4caa75358eec\",\n  isCustom: false(),\n  PmConstant: cons!CMGT_PM_TASK_COMPLETE_AUTOMATED_TASK_WORKFLOW_ROUTING,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_WorkflowRouting_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_AUTOMATION,\n  createdBy: \"system\"\n)"
    },
    "_a-0000ed9c-71ef-8000-9d58-011c48011c48_3988340": {
      "name": "CMGT_CFG_ENUM_ACT_SEND_EMAIL",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  actionCode: cons!CMGT_CFG_TXT_ACT_SEND_EMAIL,\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:30808437-7386-42dc-8605-9d75e19508d3\",\n  image: cons!CMGT_DOC_IMAGE_AUTOMATION_TYPE_SEND_EMAIL,\n  description: #\"urn:appian:translation-string:v1:5efb7150-37e9-41f6-b9cc-ddbc1850e07d\",\n  isCustom: false(),\n  /*process to be run to send en email*/\n  PmConstant: cons!CMGT_PM_TASK_COMPLETE_AUTOMATED_TASK_SEND_EMAIL,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_SendEmail_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_AUTOMATION,\n  createdBy: \"system\"\n)"
    },
    "_a-0000ecf6-527e-8000-9bbc-011c48011c48_59891": {
      "name": "CMGT_CFG_ENUM_ACT_ASSIGN_CASE",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  actionCode: cons!CMGT_CFG_TXT_ACT_ASSIGN_CASE,\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:340cf3dc-0483-4dd7-b199-d47e56259f94\",\n  /*interface used to configure assignment logic*/\n  configurationRule:rule!CMGT_WFL_AutomationRule_Configure_AssignmentLogic,\n  runtimeConfigurationRule: rule!CMGT_AutomationRule_Configure_AssignmentLogic,\n  configurationDisplayRule: rule!CMGT_WFL_CaseType_Rules_FormatAssignAction,\n  runtimeDisplayRule: rule!CMGT_Case_Rules_FormatAssignAction,\n  /*process to be run to assigne a case*/\n  PmConstant: cons!CMGT_PM_ROLE_MANAGE,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_CaseAssignment_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_CASE,\n  createdBy: \"system\"\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ecf6-527e-8000-9bbc-011c48011c48_59897": {
      "name": "CMGT_CFG_ENUM_ACT_ASSIGN_TASK",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  /*code that is used to help evaluation of what actions needs to be ran*/\n  actionCode: cons!CMGT_CFG_TXT_ACT_ASSIGN_TASK,\n  /*Display text of action type in configuration*/\n  name: #\"urn:appian:translation-string:v1:5f11c5ad-d08d-4d59-86d6-c7464038329c\",\n  /*interface used to configure assignment logic*/\n  configurationRule:rule!CMGT_WFL_AutomationRule_Configure_AssignmentLogic,\n  runtimeConfigurationRule: rule!CMGT_AutomationRule_Configure_AssignmentLogic,\n  configurationDisplayRule: rule!CMGT_WFL_CaseType_Rules_FormatAssignAction,\n  runtimeDisplayRule: rule!CMGT_Case_Rules_FormatAssignAction,\n  /*process to be run to assigne a case*/\n  PmConstant: cons!CMGT_PM_ROLE_MANAGE,\n  /*evaluation rule that runs and outputs the necessary process parameters*/\n  pmParameterEvalRule: rule!CMGT_AUTO_EVAL_TaskAssignment_DetermineProcessParameters,\n  context: cons!CMGT_CFG_TXT_ACT_CONTEXT_TASK,\n  createdBy: \"system\"\n)"
    },
    "000beaeb-2dd9-8000-0981-7f0000014e7a": {
      "name": "CMGT_Task_Complete_AutomatedTask_Wrapper",
      "type": "Process Model",
      "sail_code": "// Output: ?\npv!index + 1\n\n// Input: ?\n=rule!CMGT_UTIL_Filter( records: a!flatten(pv!tasks), fieldValuePairs: { a!map( field: recordType!CMGT_Task.isCurrent, value: true ), a!map( field: recordType!CMGT_Task.taskBehaviorTypeId, value: cons!CMGT_REFID_TASK_BEHAVIOR_TYPE_AUTOMATION ) })\n\n// Output: ?\ncount({ ac!automatedTasks })\n\n// Input: ?\nrule!CMGT_UTIL_Filter(\n  records: rule!CMGT_CFG_ENUM_ACTIONS(),\n  field: \"actionCode\",\n  value: a!flatten(\n    pv!automatedTasks[recordType!CMGT_Task.automationTaskAction.actionCode]\n  )[pv!index],\n  /*To avoid list return type */\n  filterType: \"FIRST_MATCH\"\n).PmConstant\n\n// Input: ?\na!localVariables(\n  local!pmParamsEval: rule!CMGT_UTIL_Filter(\n    records: rule!CMGT_CFG_ENUM_ACTIONS(),\n    field: \"actionCode\",\n    value: a!flatten(\n      pv!automatedTasks[recordType!CMGT_Task.automationTaskAction.actionCode]\n    )[pv!index],\n    /*To avoid list return type */\n    filterType: \"FIRST_MATCH\"\n  ),\n  local!pmParamsEval.pmParameterEvalRule(\n    task: pv!automatedTasks[pv!index]\n  )\n)\n\n// Input: ?\n= {\n  tasks: #\"urn:appian:function:v1:a:update\"(\n    rule!CMGT_QR_GetTask(\n      taskId: pv!automatedTasks[recordType!CMGT_Task.taskId],\n      includeRoles: true(),\n      includeBranches: true(),\n      includeMilestone: true()\n    ),\n    recordType!CMGT_Task.statusId,\n    cons!CMGT_REFID_STATUS_TASK_COMPLETED\n  ),\n  initiator: cons!CMGT_TXT_AUTOMATED_SYSTEM,\n  automationEvaluationLoopExecutions: pv!automationEvaluationLoopExecutions,\n  context: pv!context\n}"
    }
  }
}
{
  "uuid": "_a-0000e3c8-6861-8000-9ba2-011c48011c48_126683-tmg-am-am",
  "name": "AS_GSS_TMG_CPS_manageReferenceTemplate",
  "type": "Interface",
  "description": "Manage template",
  "sail_code": "a!localVariables(\n  local!isExistingTemplate: rule!AS_CO_UT_isNotBlank(ri!selectedTemplate.templateId),\n  local!taskCategories: rule!AS_GSS_TMG_QE_getTaskCategories(\n    returnType: cons!AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  local!addingTaskCategory: rule!AS_CO_UT_initializeBlankLocalVariable(\n    type: 'type!{urn:com:appian:types:AS:GSS:TMG}AS_GSS_TMG_R_TaskCategory'\n  ),\n  if(\n    rule!AS_CO_UT_isBlank(local!addingTaskCategory),\n    /*manage tasks already added by category*/\n    {\n      /*form header*/\n      rule!AS_CO_DSP_displayHeader(\n        headerText: if(\n          local!isExistingTemplate,\n          \"Edit Approach\",\n          \"Add Approach\"\n        )\n      ),\n      /*template name, description, mapping fields*/\n      rule!AS_GSS_TMG_CPS_manageReferenceTemplateProperties(\n        selectedTemplate: ri!selectedTemplate,\n        i18nData: ri!i18nData,\n        readOnly: false,\n        triggerRefresh: ri!triggerRefresh\n      ),\n      /*grid per category*/\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!taskCategories,\n        expression: rule!AS_GSS_TMG_CPS_manageReferenceTemplateCategory(\n          i18nData: ri!i18nData,\n          selectedTemplate: ri!selectedTemplate,\n          taskCategory: fv!item,\n          addingTaskCategory: local!addingTaskCategory,\n          triggerRefresh: ri!triggerRefresh\n        )\n      ),\n      /*save and cancel buttons*/\n      rule!AS_CO_CPS_cancelSaveButtons(\n        confirmLabel: rule!AS_GAM_CO_I18N_UT_displayLabel(\n          bundle: ri!i18nData,\n          bundleKey: if(\n            local!isExistingTemplate,\n            \"btn_SaveChanges\",\n            \"btn_AddTemplate\"\n          )\n        ),\n        cancelLabel: \"Cancel\",\n        confirmSaveInto: {\n          a!save(\n            ri!selectedTemplate.templateType.refDataId,\n            cons!AS_GSS_REF_ID_TEMPLATE_TYPE_CONTRACTING\n          ),\n          rule!AS_ADT_UT_startAuditProcess(\n            newObjects: ri!selectedTemplate,\n            objectType: 'type!{urn:com:appian:types:AS:GSS:TMG}AS_GSS_TMG_R_Template',\n            objectDse: cons!AS_GSS_TMG_ENT_R_TEMPLATE,\n            auditDse: cons!AS_GSS_TMG_ENT_A_R_TEMPLATE,\n            auditConfig: rule!AS_GSS_TMG_ADT_BL_auditConfig_R_Template(),\n            onSuccess: {\n              rule!AS_CO_UT_triggerRefresh(triggerRefresh: ri!triggerRefresh),\n              rule!AS_CO_UT_saveNull(valueToNull: ri!selectedTemplate)\n            }\n          )\n        },\n        cancelSaveInto: rule!AS_CO_UT_saveNull(valueToNull: ri!selectedTemplate),\n        includeDivider: true,\n        confirmAccessibilityText: \"Press Enter to save changes\",\n        cancelAccessibilityText: \"Press Enter to cancel changes\"\n      )\n    },\n    /*add tasks to a category from catalog*/\n    a!localVariables(\n      local!selectedTaskRefs: rule!AS_CO_UT_initializeBlankLocalVariable(\n        type: 'type!{urn:com:appian:types:AS:GSS:TMG}AS_GSS_TMG_R_TaskRef?list'\n      ),\n      rule!AS_GSS_TMG_CPS_manageReferenceTemplateAddTaskToCategory(\n        i18nData: ri!i18nData,\n        addingTaskCategory: local!addingTaskCategory,\n        headerLevel: cons!AS_CO_ENUM_HEADER_LEVEL_ONE,\n        taskRefIdsToHide: a!flatten(ri!selectedTemplate.templateTasks).taskRef.taskRefId,\n        addTaskSaves: {\n          a!save(\n            ri!selectedTemplate.templateTasks,\n            append(\n              ri!selectedTemplate.templateTasks,\n              #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!selectedTaskRefs,\n                expression: rule!AS_GSS_TMG_CDT_mapTaskRefToTemplateTask(taskRef: fv!item)\n              )\n            )\n          )\n        },\n        selectedTaskRefs: local!selectedTaskRefs,\n        showAddCustomTaskBtn: false,\n        triggerRefresh: ri!triggerRefresh\n      )\n    )\n  )\n)",
  "calls": [
    {
      "name": "AS_CO_UT_isNotBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_QE_getTaskCategories",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_initializeBlankLocalVariable",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_DSP_displayHeader",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CPS_manageReferenceTemplateProperties",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CPS_manageReferenceTemplateCategory",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_CPS_cancelSaveButtons",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GAM_CO_I18N_UT_displayLabel",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_ADT_UT_startAuditProcess",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_ADT_BL_auditConfig_R_Template",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_triggerRefresh",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_saveNull",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CPS_manageReferenceTemplateAddTaskToCategory",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CDT_mapTaskRefToTemplateTask",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_REF_ID_TEMPLATE_TYPE_CONTRACTING",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_ENT_R_TEMPLATE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_ENT_A_R_TEMPLATE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_CO_ENUM_HEADER_LEVEL_ONE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_UT_loadBundleByNames",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    }
  ],
  "called_by": [
    {
      "name": "AS_GSS_TMG_CPS_viewOrManageReferenceTaskSettings",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CPS_viewOrManageReferenceTemplateSettings",
      "type": "Interface",
      "dep_type": "CALLS"
    }
  ]
}
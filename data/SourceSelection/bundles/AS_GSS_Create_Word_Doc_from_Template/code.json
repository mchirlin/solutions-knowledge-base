{
  "_metadata": {
    "bundle_id": "AS_GSS_Create_Word_Doc_from_Template"
  },
  "objects": {
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_75782": {
      "name": "AS_CO_UT_isNotBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Boolean',\n  not(rule!AS_CO_UT_isBlank(ri!input))\n)"
    },
    "_a-0000e447-9390-8000-9baa-011c48011c48_41575": {
      "name": "AS_CO_UT_cleanFolderName",
      "type": "Expression Rule",
      "sail_code": "cleanwith(\n  ri!folderName,\n  \" abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\"\n)"
    },
    "000be5ce-7a00-8000-0b30-7f0000014e7a": {
      "name": "AS GSS Create Word Doc from Template",
      "type": "Process Model",
      "sail_code": "// Output: ?\nrule!AS_GSS_UT_constructFactorandvendorDetailsForTemplateMapping(\n  evaluationId:pv!task.evaluation.evaluationId,\n  isRecommendation:true\n)\n\n// Input: ?\n=pv!tempWordDocId\n\n// Output: ?\nnull()\n\n// Input: ?\n=true\n\n// Input: ?\n=task\n\n// Input: ?\n=tempWordDocId\n\n// Output: ?\nrule!AS_GSS_UT_constructFactorandvendorDetailsForTemplateMapping(\n  evaluationId:pv!task.evaluation.evaluationId,\n  isRecommendation:false\n)\n\n// Output: ?\nnow()\n\n// Input: ?\n= rule!AS_GAM_createDocumentNameForTempWordDoc( uniqueText: pv!task.evaluation.evaluationNumber, docName: pv!task.docUploadContext.docTemplate.documentName)\n\n// Input: ?\n=cons!AS_GSS_DOCUMENT_TEMPLATE_CONSENSUS\n\n// Input: ?\n=todate(now())\n\n// Input: ?\n=pv!templateMappingDetails.contractingspecialist\n\n// Input: ?\n=pv!templateMappingDetails.vendorName\n\n// Input: ?\n=pv!templateMappingDetails.chairperson\n\n// Input: ?\n=pv!templateMappingDetails.factorNumber\n\n// Input: ?\n=pv!templateMappingDetails.chairperson\n\n// Input: ?\n=pv!templateMappingDetails.finalRating\n\n// Input: ?\n=pv!templateMappingDetails.finalComment\n\n// Input: ?\n=pv!templateMappingDetails.contractingOfficer\n\n// Input: ?\n= pv!templateMappingDetails.evaluationchief\n\n// Output: ?\nAC!NewDocument\n\n// Output: ?\ndocument(ac!NewDocument, \"name\")\n\n// Output: ?\ndocument(ac!NewDocument, \"id\")\n\n// Output: ?\ndocument(ac!NewDocument, \"id\")\n\n// Input: ?\n= rule!AS_GAM_createDocumentNameForTempWordDoc( uniqueText: pv!task.evaluation.evaluationNumber, docName: pv!task.docUploadContext.docTemplate.documentName)\n\n// Input: ?\n=todate(now())\n\n// Input: ?\n=pv!templateMappingDetails.contractingspecialist\n\n// Input: ?\n=pv!templateMappingDetails.vendorName\n\n// Input: ?\n=pv!templateMappingDetails.chairperson\n\n// Input: ?\n=pv!templateMappingDetails.factorNumber\n\n// Input: ?\n=pv!templateMappingDetails.chairperson\n\n// Input: ?\n=pv!templateMappingDetails.finalRating\n\n// Input: ?\n=pv!templateMappingDetails.finalComment\n\n// Input: ?\n=pv!templateMappingDetails.contractingOfficer\n\n// Output: ?\nAC!NewDocument\n\n// Output: ?\ndocument(ac!NewDocument, \"name\")\n\n// Output: ?\ndocument(ac!NewDocument, \"id\")\n\n// Output: ?\ndocument(ac!NewDocument, \"id\")\n\n// Input: ?\n= rule!AS_GAM_createDocumentNameForTempWordDoc( uniqueText: pv!task.evaluation.evaluationNumber, docName: pv!task.docUploadContext.docTemplate.documentName)\n\n// Input: ?\n=cons!AS_GSS_DOCUMENT_TEMPLATE_RECOMMENDATION\n\n// Input: ?\n=pv!templateMappingDetails.vendorA1\n\n// Input: ?\n=pv!templateMappingDetails.vendorB2\n\n// Input: ?\n=pv!templateMappingDetails.vendorA2\n\n// Input: ?\n=pv!templateMappingDetails.factor2\n\n// Input: ?\n=pv!templateMappingDetails.factor1\n\n// Input: ?\n=pv!templateMappingDetails.vendorB1\n\n// Output: ?\nAC!NewDocument"
    },
    "_a-0000e5da-a251-8000-9bbe-011c48011c48_1103798": {
      "name": "AS_GSS_UT_constructFactorandvendorDetailsForTemplateMapping",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!factorDetails: rule!AS_GSS_QE_getEvaluationCriteria(\n    evaluationId: ri!evaluationId,\n    returnType: cons!AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  local!vendorDetails: rule!AS_GSS_QE_getEvaluationVendor(\n    evaluationId: ri!evaluationId,\n    returnType: cons!AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  /*Fetching only first two factor data*/\n  local!finalFactorDetails: index(\n    rule!AS_CO_UT_rejectNullValuesFromArray(\n      union(\n        local!factorDetails,\n        local!factorDetails\n      )\n    ),\n    enumerate(2) + 1,\n    null\n  ),\n  /*Fetching only first two vendor data*/\n  local!finalVendorDetails: index(\n    rule!AS_CO_UT_rejectNullValuesFromArray(\n      union(\n        local!vendorDetails.legalName,\n        local!vendorDetails.legalName\n      )\n    ),\n    enumerate(2) + 1,\n    null\n  ),\n  if(\n    /* checking if template is recommendation/consensus */\n    ri!isRecommendation,\n    {\n      /*factor 1*/\n      factor1: if(\n        rule!AS_CO_UT_isBlank(\n          local!finalFactorDetails.factorNumber[1]\n        ),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalFactorDetails.factorNumber[1] & \" | \" & local!finalFactorDetails.criteriaName[1]\n      ),\n      /*factor 2*/\n      factor2: if(\n        rule!AS_CO_UT_isBlank(\n          local!finalFactorDetails.factorNumber[2]\n        ),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalFactorDetails.factorNumber[2] & \" | \" & local!finalFactorDetails.criteriaName[2]\n      ),\n      /*vendorA1*/\n      vendorA1: if(\n        rule!AS_CO_UT_isBlank(local!finalVendorDetails[1]),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalVendorDetails[1]\n      ),\n      /*vendorB1*/\n      vendorB1: if(\n        rule!AS_CO_UT_isBlank(local!finalVendorDetails[2]),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalVendorDetails[2]\n      ),\n      /*vendorA2*/\n      vendorA2: if(\n        or(rule!AS_CO_UT_isBlank(local!finalVendorDetails[1]),rule!AS_CO_UT_isBlank(local!finalFactorDetails[2])),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalVendorDetails[1]\n      ),\n      /*vendorB2*/\n      vendorB2: if(\n        or(rule!AS_CO_UT_isBlank(local!finalVendorDetails[2]),rule!AS_CO_UT_isBlank(local!finalFactorDetails[2])),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        local!finalVendorDetails[2]\n      )\n    },\n    {\n      /*vendorName*/\n      /*vendorName: if(*/\n        /*rule!AS_CO_UT_isBlank(local!finalVendorDetails[1]),*/\n        /*cons!AS_GSS_TXT_INSERT_INFO,*/\n        /*local!finalVendorDetails[1]*/\n      /*),*/\n      /* GAM-2883: do not populate vendorName since there are multiple per evaluation */\n      vendorName: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /*evaluator*/\n      /*evaluator: = if(*/\n        /*rule!AS_CO_UT_isBlank(*/\n          /*local!finalFactorDetails[1].assignments*/\n        /*),*/\n        /*cons!AS_GSS_TXT_INSERT_INFO,*/\n        /*rule!AS_GAM_UT_concatUserFirstNameLastName(*/\n          /*firstName: local!finalFactorDetails[1].assignments[1].assignee.firstName,*/\n          /*lastName: local!finalFactorDetails[1].assignments[1].assignee.lastName*/\n        /*)*/\n      /*),*/\n      /* GAM-2883: do not populate evaluator since there are multiple per evaluation */\n      evaluator: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /*factornumber*/\n      /*factorNumber: = if(*/\n        /*rule!AS_CO_UT_isBlank(*/\n          /*local!finalFactorDetails[1].factorNumber*/\n        /*),*/\n        /*cons!AS_GSS_TXT_INSERT_INFO,*/\n        /*local!finalFactorDetails[1].factorNumber*/\n      /*),*/\n      /* GAM-2883: do not populate evaluator since there are multiple per evaluation */\n      factornumber: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /*chairperson*/\n      /*chairPerson: = if(*/\n        /*rule!AS_CO_UT_isBlank(*/\n          /*local!finalFactorDetails[1].criteriaChair*/\n        /*),*/\n        /*cons!AS_GSS_TXT_INSERT_INFO,*/\n        /*rule!AS_GAM_UT_concatUserFirstNameLastName(*/\n          /*firstName: local!finalFactorDetails[1].criteriaChair.firstName,*/\n          /*lastName: local!finalFactorDetails[1].criteriaChair.lastName*/\n        /*)*/\n      /*),*/\n      /* GAM-2883: do not populate chairPerson since there are multiple per evaluation */\n      chairPerson: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /* GAM-2883: do not populate finalRating since there are multiple per evaluation */\n      finalRating: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /* GAM-2883: do not populate finalComment since there are multiple per evaluation */\n      finalComment: cons!AS_GSS_TXT_INSERT_INFO,\n      \n      /*evalchief*/\n      evaluationchief: = if(\n        rule!AS_CO_UT_isBlank(\n          local!finalFactorDetails[1].evaluation.evaluationChief\n        ),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        rule!AS_GAM_UT_concatUserFirstNameLastName(\n          firstName: local!finalFactorDetails[1].evaluation.evaluationChief.firstName,\n          lastName: local!finalFactorDetails[1].evaluation.evaluationChief.lastName\n        )\n      ),\n      /*CO*/\n      contractingOfficer: = if(\n        rule!AS_CO_UT_isBlank(\n          local!finalFactorDetails[1].evaluation.contractingOfficer\n        ),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        rule!AS_GAM_UT_concatUserFirstNameLastName(\n          firstName: local!finalFactorDetails[1].evaluation.contractingOfficer.firstName,\n          lastName: local!finalFactorDetails[1].evaluation.contractingOfficer.lastName\n        )\n      ),\n      /*CS*/\n      contractingspecialist: = if(\n        rule!AS_CO_UT_isBlank(\n          local!finalFactorDetails[1].evaluation.contractingSpecialist\n        ),\n        cons!AS_GSS_TXT_INSERT_INFO,\n        rule!AS_GAM_UT_concatUserFirstNameLastName(\n          firstName: local!finalFactorDetails[1].evaluation.contractingSpecialist.firstName,\n          lastName: local!finalFactorDetails[1].evaluation.contractingSpecialist.lastName\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000e447-9390-8000-9baa-011c48011c48_111553": {
      "name": "AS_GAM_createDocumentNameForTempWordDoc",
      "type": "Expression Rule",
      "sail_code": "if(\n  or(\n    rule!AS_CO_UT_isBlank(ri!uniqueText),\n    rule!AS_CO_UT_isBlank(ri!docName)\n  ),\n  \"Unnamed Document\",\n  trim(rule!AS_CO_UT_cleanFolderName(ri!uniqueText & \" \" & ri!docName))\n)"
    },
    "_a-0000e5bc-4a9a-8000-9bbc-011c48011c48_950323": {
      "name": "AS_GSS_QE_getEvaluationVendor",
      "type": "Expression Rule",
      "sail_code": "rule!AS_CO_UT_queryEntity(\n  entity: cons!AS_GSS_ENT_EVALUATION_VENDOR,\n  entityType: 'type!{urn:com:appian:types:AS:GSS}AS_GSS_EvaluationVendor',\n  returnType: ri!returnType,\n  executeWhen: and(\n    ri!executeWhen,\n    or(\n      any(\n        rule!AS_CO_UT_isNotBlank(_),\n        {\n          a!flatten(ri!additionalFilters.value),\n          ri!logicalExpression,\n          ri!aggregation\n        }\n      ),\n      rule!AS_CO_UT_isNotBlank(ri!vendorId),\n      rule!AS_CO_UT_isNotBlank(ri!evaluationId)\n    )\n  ),\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"vendorId\",\n      operator: \"in\",\n      value: ri!vendorId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"evaluation.evaluationId\",\n      operator: \"=\",\n      value: ri!evaluationId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"isActive\",\n      operator: \"=\",\n      value: true,\n      applyWhen: rule!AS_CO_UT_not(ri!getActiveAndInactive = true)\n    ),\n    ri!additionalFilters\n  },\n  excludeNestedCdts: ri!excludeNestedCdts,\n  logicalExpression: ri!logicalExpression,\n  pagingInfo: ri!pagingInfo,\n  triggerRefresh: ri!triggerRefresh,\n  aggregation: ri!aggregation\n)"
    },
    "_a-0000e40a-de32-8000-9ba8-011c48011c48_260165": {
      "name": "AS_CO_UT_updateCdtFields",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!cdt),\n  if(\n    and(\n      rule!AS_CO_UT_isBlank(ri!cdt),\n      rule!AS_CO_UT_checkIfArrayType(\n        typeOf: ri!cdt\n      )\n    ),\n    ri!cdt,\n    reduce(\n      rule!AS_CO_UT_zINTERNAL_updateCdtFieldsByPath_handler(\n        cdt: _,\n        indices: ri!indices,\n        field: _,\n        newValue: _\n      ),\n      ri!cdt,\n      merge(\n        a!flatten(ri!fields),\n        a!flatten(ri!newValues)\n      )\n    )\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536": {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  length(a!flatten(ri!value)) = 0\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76367": {
      "name": "AS_CO_UT_rejectNullValuesFromArray",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!array),\n  reject(\n    rule!AS_CO_UT_isBlank(_),\n    a!flatten(ri!array)\n  )\n)"
    },
    "_a-0000e5bc-4a9a-8000-9bbc-011c48011c48_950289": {
      "name": "AS_GSS_QE_getEvaluationCriteria",
      "type": "Expression Rule",
      "sail_code": "rule!AS_CO_UT_queryEntity(\n  entity: cons!AS_GSS_ENT_CRITERIA,\n  entityType: 'type!{urn:com:appian:types:AS:GSS}AS_GSS_Criteria',\n  returnType: ri!returnType,\n  excludeNestedCdts: ri!excludeNestedCdts,\n  executeWhen: and(\n    ri!executeWhen,\n    or(\n      rule!AS_CO_UT_isNotBlank(ri!additionalFilters.value),\n      rule!AS_CO_UT_isNotBlank(ri!logicalExpression),\n      rule!AS_CO_UT_isNotBlank(ri!aggregation),\n      rule!AS_CO_UT_isNotBlank(ri!criteriaId),\n      rule!AS_CO_UT_isNotBlank(ri!parentCriteriaId),\n      rule!AS_CO_UT_isNotBlank(ri!evaluationId)\n    )\n  ),\n  /* To ensure proper null checks, we'll force all queryFilter values to not be null */\n  logicalExpression: ri!logicalExpression,\n  pagingInfo: ri!pagingInfo,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"criteriaId\",\n      operator: \"in\",\n      value: ri!criteriaId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"parentCriteriaId\",\n      operator: \"=\",\n      value: ri!parentCriteriaId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"evaluation.evaluationId\",\n      operator: \"in\",\n      value: ri!evaluationId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"isActive\",\n      operator: \"=\",\n      value: true,\n      applyWhen: rule!AS_CO_UT_not(ri!getActiveAndInactive = true)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"criteriaStatus.refDataId\",\n      operator: \"<>\",\n      value: cons!AS_GSS_REF_ID_EVALUATION_STATUS_TEMP,\n      applyWhen: rule!AS_CO_UT_not(ri!getTemp = true)\n    ),\n    ri!additionalFilters\n  },\n  aggregation: ri!aggregation,\n  sort: ri!sort\n)"
    },
    "_a-0000e438-ff39-8000-9ba8-011c48011c48_14666": {
      "name": "AS_GAM_UT_concatUserFirstNameLastName",
      "type": "Expression Rule",
      "sail_code": "if(\n  and(\n    rule!AS_CO_UT_isBlank(\n      value: ri!firstName\n    ),\n    rule!AS_CO_UT_isBlank(\n      value: ri!lastName\n    )\n  ),\n  \"-\",\n  trim(\n    concat(\n      ri!firstName,\n      cons!AS_GAM_TXT_SEPARATOR_SPACE,\n      ri!lastName\n    )\n  )\n)"
    },
    "_a-0000e5bc-4a9a-8000-9bbc-011c48011c48_940968": {
      "name": "AS_GSS_UT_sharepointFolderName",
      "type": "Expression Rule",
      "sail_code": "concat(ri!evaluation.evaluationNumber,\"-\",ri!evaluation.evaluationId)"
    },
    "0002e4ad-3dbb-8000-0046-7f0000014e7a": {
      "name": "AS GAM Create Folder in SharePoint",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=pv!folderName\n\n// Input: ?\n=pv!parentSpFolderId\n\n// Output: ?\nAC!Error\n\n// Output: ?\nac!Result.body.id"
    },
    "000be5ce-8854-8000-0b33-7f0000014e7a": {
      "name": "AS GSS Move Word Doc To Sharepoint and Get Document Link",
      "type": "Process Model",
      "sail_code": "// Output: ?\nrule!AS_CO_UT_updateCdtFields(\ncdt: pv!task.evaluation,\n fields : \"office365FolderId\",\n newValues :pv!office365FolderId\n)\n\n// Input: ?\n=cons!AS_GSS_TMG_ENT_TASK\n\n// Input: ?\n=pv!task\n\n// Output: ?\nAC!StoredValues\n\n// Input: ?\n=cons!AS_GSS_ENT_EVALUATION\n\n// Input: ?\n=pv!evaluation\n\n// Output: ?\nAC!StoredValues\n\n// Output: ?\npv!evaluation\n\n// Input: ?\n=rule!AS_GSS_UT_sharepointFolderName(evaluation: pv!task.evaluation)\n\n// Input: ?\n=cons!AS_GSS_SHAREPOINT_FOLDER_ID\n\n// Input: ?\n=pv!task.evaluation.evaluationId\n\n// Input: ?\n=pv!task.docUploadContext.office365DocumentId\n\n// Output: ?\nAC!Error\n\n// Output: ?\nac!Result.body.link.webUrl\n\n// Input: ?\n=pv!task.evaluation.office365FolderId\n\n// Input: ?\n=pv!tempWordDocId\n\n// Output: ?\nAC!Error\n\n// Output: ?\nac!Result.body.id"
    }
  }
}
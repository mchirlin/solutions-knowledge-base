{
  "_metadata": {
    "bundle_id": "CMGT_KB_Resource_-_urnappiantranslation-stringv1dd59d9b2-b113-409a-b108-e32acc47"
  },
  "objects": {
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000ee70-a572-8000-9d9f-011c48011c48_4646563": {
      "name": "CMGT_KB_Resource_RecordAction_AddUpdate",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: rule!CMGT_CB_UTIL_LoadBrandingMap(),\n  local!isUpdate: a!isNotNullOrEmpty(\n    ri!resource[recordType!CMGT_KB_Resource.resourceId]\n  ),\n  local!visibility: {\n    a!map(\n      label: #\"urn:appian:translation-string:v1:cb5a9a2c-85a3-41e4-954c-b7389db357b2\",\n      value: true\n    ),\n    a!map(\n      label: #\"urn:appian:translation-string:v1:5d107187-07e0-4423-9942-7d392f0d116f\",\n      value: false\n    )\n  },\n  local!resource: if(\n    local!isUpdate,\n    ri!resource,\n    recordType!CMGT_KB_Resource(\n      recordType!CMGT_KB_Resource.resourceTypeId: cons!CMGT_KB_REFID_RESOURCE_TYPE_TEXT,\n      recordType!CMGT_KB_Resource.isPrivate: true,\n      recordType!CMGT_KB_Resource.caseTypeUuid: ri!selectedCaseTypeUuid\n    )\n  ),\n  local!originalResource: a!refreshVariable(\n    value: local!resource,\n    refreshOnReferencedVarChange: false()\n  ),\n  local!resourceTypeMap: {\n    a!map(\n      title: #\"urn:appian:translation-string:v1:f108e993-6f59-4758-8823-2dc942f5d2e7\",\n      description: #\"urn:appian:translation-string:v1:c7e2c3d3-2a0c-4df6-9955-f52e099dc665\",\n      icon: \"pen-nib\",\n      resourceTypeId: cons!CMGT_KB_REFID_RESOURCE_TYPE_TEXT\n    ),\n    a!map(\n      title: #\"urn:appian:translation-string:v1:6ba2851b-6d59-4ff2-b249-4cf4c44e095e\",\n      description: #\"urn:appian:translation-string:v1:73489b0a-ffc6-483d-99e9-d2d8498c55ac\",\n      icon: \"file-upload\",\n      resourceTypeId: cons!CMGT_KB_REFID_RESOURCE_TYPE_DOCUMENT\n    )\n  },\n  #\"SYSTEM_SYSRULES_formLayout_v2\"(\n    titleBar: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n          items: {\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              item: #\"SYSTEM_SYSRULES_stampField\"(\n                icon: \"pen-alt\",\n                contentColor: local!brandingMap.StandardStampContentColor,\n                backgroundColor: local!brandingMap.StandardStampBackgroundColor,\n                size: \"TINY\",\n                shape: local!brandingMap.StandardStampShape\n              ),\n              width: \"MINIMIZE\",\n              showWhen: not(local!isUpdate)\n            ),\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              item: #\"SYSTEM_SYSRULES_headingField\"(\n                text: if(\n                  local!isUpdate,\n                  #\"urn:appian:translation-string:v1:e80d2755-9036-4c74-9e98-667f20146312\"(\n                    #\"urn:appian:translation-variable:v1:f52233a3-4d04-4a57-a9ea-6052cb882933\": local!originalResource[recordType!CMGT_KB_Resource.title]\n                  ),\n                  #\"urn:appian:translation-string:v1:dd59d9b2-b113-409a-b108-e32acc47f1ec\"\n                ),\n                headingTag: \"H1\",\n                fontWeight: \"SEMI_BOLD\",\n                size: local!brandingMap.H1Size,\n                marginAbove: \"STANDARD\",\n                marginBelow: \"NONE\"\n              )\n            )\n          },\n          alignVertical: \"MIDDLE\",\n          spacing: \"STANDARD\",\n          marginBelow: \"NONE\",\n          marginAbove: \"NONE\"\n        ),\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: #\"urn:appian:translation-string:v1:704744ef-820d-412c-8de7-9e18250c0004\",\n            color: local!brandingMap.secondaryTextColor,\n            size: \"SMALL\"\n          ),\n          marginBelow: \"NONE\",\n          marginAbove: \"NONE\"\n        )\n      },\n      padding: \"STANDARD\",\n      showBorder: false,\n      marginBelow: \"NONE\"\n    ),\n    showTitleBarDivider: true,\n    contents: {\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              /*Resource Type*/\n              #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: #\"urn:appian:translation-string:v1:53e9e180-5160-45a1-b030-5ee3b135acbd\",\n                    size: \"STANDARD\",\n                    style: \"STRONG\"\n                  ),\n                  char(32),\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: \"*\",\n                    size: \"SMALL\",\n                    color: local!brandingMap.AccentColor,\n                    style: \"STRONG\"\n                  )\n                },\n                marginBelow: \"NONE\",\n                marginAbove: \"NONE\",\n                showWhen: not(local!isUpdate)\n              ),\n              #\"SYSTEM_SYSRULES_cardGroupLayout\"(\n                cards: {\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    items: local!resourceTypeMap,\n                    expression: #\"SYSTEM_SYSRULES_cardLayout\"(\n                      contents: {\n                        {\n                          #\"SYSTEM_SYSRULES_columnsLayout\"(\n                            columns: {\n                              #\"SYSTEM_SYSRULES_columnLayout\"(\n                                contents: {\n                                  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                    value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n                                      icon: fv!item.icon,\n                                      size: \"MEDIUM_PLUS\",\n                                      color: local!brandingMap.AccentColor\n                                    ),\n                                    align: \"CENTER\"\n                                  )\n                                },\n                                width: \"EXTRA_NARROW\"\n                              ),\n                              #\"SYSTEM_SYSRULES_columnLayout\"(\n                                contents: {\n                                  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                    value: {\n                                      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                        text: fv!item.title,\n                                        size: \"STANDARD\",\n                                        style: \"STRONG\"\n                                      ),\n                                      char(10),\n                                      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                        text: fv!item.description,\n                                        size: \"SMALL\",\n                                        style: \"PLAIN\",\n                                        color: local!brandingMap.SecondaryTextColor\n                                      )\n                                    }\n                                  ),\n\n                                },\n                                width: \"MEDIUM_PLUS\"\n                              )\n                            },\n                            marginAbove: \"STANDARD\",\n                            alignVertical: \"MIDDLE\"\n                          )\n                        }\n                      },\n                      height: \"AUTO\",\n                      style: \"TRANSPARENT\",\n                      shape: local!brandingMap.CardShape,\n                      padding: \"LESS\",\n                      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                        value: fv!item.resourceTypeId,\n                        saveInto: {\n                          local!resource[recordType!CMGT_KB_Resource.resourceTypeId],\n                          a!save(\n                            local!resource[recordType!CMGT_KB_Resource.isPrivate],\n                            true\n                          ),\n                          a!save(\n                            {\n                              local!resource[recordType!CMGT_KB_Resource.resourceText],\n                              local!resource[recordType!CMGT_KB_Resource.document],\n                              local!resource[recordType!CMGT_KB_Resource.title]\n                            },\n                            null\n                          )\n                        },\n                        showWhen: fv!item.resourceTypeId <> local!resource[recordType!CMGT_KB_Resource.resourceTypeId]\n                      ),\n                      borderColor: if(\n                        local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = fv!item.resourceTypeId,\n                        local!brandingMap.AccentColor,\n                        null\n                      )\n                    )\n                  )\n                },\n                cardWidth: \"NARROW\",\n                fillContainer: false,\n                cardHeight: \"AUTO\",\n                marginBelow: \"NONE\",\n                marginAbove: \"NONE\",\n                showWhen: not(local!isUpdate)\n              )\n            }\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"()\n        },\n        marginBelow: if(local!isUpdate, \"LESS\", \"STANDARD\"),\n        showWhen: not(local!isUpdate)\n      ),\n      /*Title*/\n      #\"SYSTEM_SYSRULES_textField\"(\n        label: #\"urn:appian:translation-string:v1:a0555f93-a4d2-455a-9d06-e579b2eb0cff\",\n        labelPosition: \"ABOVE\",\n        value: local!resource[recordType!CMGT_KB_Resource.title],\n        saveInto: {\n          a!save(\n            local!resource[recordType!CMGT_KB_Resource.title],\n            trim(save!value)\n          )\n        },\n        showCharacterCount: false,\n        characterLimit: cons!CMGT_INT_MAX_CHAR_LIMIT_MEDIUM,\n        required: true,\n        requiredMessage: #\"urn:appian:translation-string:v1:4ccebd8a-c774-4d45-a639-6f1141ab5576\"(\n          #\"urn:appian:translation-variable:v1:d2e09d15-6eed-46f7-8669-0cfdd5eea8e2\": #\"urn:appian:translation-string:v1:a0555f93-a4d2-455a-9d06-e579b2eb0cff\"\n        ),\n        showWhen: local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = cons!CMGT_KB_REFID_RESOURCE_TYPE_TEXT,\n        marginBelow: \"STANDARD\",\n        marginAbove: if(local!isUpdate, \"NONE\", \"STANDARD\")\n      ),\n      /*Visibility*/\n      #\"SYSTEM_SYSRULES_radioButtonField_v1\"(\n        label: #\"urn:appian:translation-string:v1:f8836d4b-c23d-4967-ab6e-d658ced58b79\",\n        choiceLabels: local!visibility.label,\n        choiceValues: local!visibility.value,\n        choiceLayout: \"COMPACT\",\n        value: local!resource[recordType!CMGT_KB_Resource.isPrivate],\n        marginBelow: \"STANDARD\",\n        marginAbove: if(\n          and(\n            local!isUpdate = true(),\n            local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = cons!CMGT_KB_REFID_RESOURCE_TYPE_DOCUMENT\n          ),\n          \"NONE\",\n          \"STANDARD\"\n        ),\n        saveInto: local!resource[recordType!CMGT_KB_Resource.isPrivate],\n        helpTooltip: #\"urn:appian:translation-string:v1:220c43f4-d339-4ea0-8ecd-1e21cde46f75\"\n      ),\n      /*Attach Document*/\n      #\"SYSTEM_SYSRULES_fileUploadField_v1\"(\n        label: #\"urn:appian:translation-string:v1:75e706d0-d4c3-4eb1-afcb-6e1bb64daa22\",\n        required: true,\n        requiredMessage: #\"urn:appian:translation-string:v1:4ccebd8a-c774-4d45-a639-6f1141ab5576\"(\n          #\"urn:appian:translation-variable:v1:d2e09d15-6eed-46f7-8669-0cfdd5eea8e2\": #\"urn:appian:translation-string:v1:3a43ad9f-0fc2-420f-b6c2-34088203dbc9\"\n        ),\n        target: a!documentFolderForRecordType(\n          recordType: recordType!CMGT_KB_Document\n        ),\n        value: index(\n          local!resource[recordType!CMGT_KB_Resource.document],\n          recordType!CMGT_KB_Document.appianDocumentId,\n          null\n        ),\n        saveInto: {\n          if(\n            local!isUpdate,\n            a!save(\n              local!resource[recordType!CMGT_KB_Resource.document][1][recordType!CMGT_KB_Document.appianDocumentId],\n              tointeger(save!value)\n            ),\n            a!save(\n              local!resource[recordType!CMGT_KB_Resource.document],\n              recordType!CMGT_KB_Document(\n                recordType!CMGT_KB_Document.appianDocumentId: tointeger(save!value)\n              )\n            )\n          ),\n          a!save(\n            local!resource[recordType!CMGT_KB_Resource.title],\n            if(\n              a!isNotNullOrEmpty(save!value),\n              a!localVariables(\n                local!extractedFileName: extract(\n                  getcontentobjectdetailsbyid(\n                    local!resource[recordType!CMGT_KB_Resource.document.appianDocumentId]\n                  ),\n                  \"Name:\",\n                  \",\"\n                ),\n                local!fileName: split(local!extractedFileName, \".\"),\n                local!fileNameWithoutExt: remove(local!fileName, length(local!fileName)),\n                joinarray(local!fileNameWithoutExt, \".\")\n              ),\n              null\n            )\n          )\n        },\n        placeholder: #\"urn:appian:translation-string:v1:14a9a31e-ad06-4545-bee1-254ce7de4c62\",\n        marginBelow: \"STANDARD\",\n        marginAbove: \"STANDARD\",\n        showWhen: local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = cons!CMGT_KB_REFID_RESOURCE_TYPE_DOCUMENT,\n        maxSelections: 1,\n        validations: a!localVariables(\n          local!invalidExtensions: difference(\n            upper(fv!files.extension),\n            { \"PDF\", \"PNG\", \"JPG\", \"JPEG\" }\n          ),\n          {\n            if(\n              sum(fv!files.size) > 10000000,\n              #\"urn:appian:translation-string:v1:ebe8e585-2027-40a1-be8f-4d95f3ed6eb7\",\n              \"\"\n            ),\n            if(\n              length(local!invalidExtensions) > 0,\n              #\"urn:appian:translation-string:v1:321fc2a1-732f-4888-9ad9-b848456c1da4\"(\n                #\"urn:appian:translation-variable:v1:6ebf3a98-f584-41b8-ae85-85325a71c39a\": joinarray(\n                  index(\n                    fv!files.name,\n                    wherecontains(\n                      local!invalidExtensions,\n                      upper(fv!files.extension)\n                    ),\n                    null\n                  ),\n                  \", \"\n                )\n              ),\n              \"\"\n            )\n          }\n        )\n      ),\n      /*Title*/\n      #\"SYSTEM_SYSRULES_textField\"(\n        label: #\"urn:appian:translation-string:v1:a0555f93-a4d2-455a-9d06-e579b2eb0cff\",\n        labelPosition: \"ABOVE\",\n        value: local!resource[recordType!CMGT_KB_Resource.title],\n        saveInto: {\n          a!save(\n            local!resource[recordType!CMGT_KB_Resource.title],\n            trim(save!value)\n          )\n        },\n        showCharacterCount: false,\n        marginBelow: \"STANDARD\",\n        marginAbove: \"STANDARD\",\n        characterLimit: cons!CMGT_INT_MAX_CHAR_LIMIT_MEDIUM,\n        showWhen: local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = cons!CMGT_KB_REFID_RESOURCE_TYPE_DOCUMENT,\n        required: true,\n        requiredMessage: #\"urn:appian:translation-string:v1:4ccebd8a-c774-4d45-a639-6f1141ab5576\"(\n          #\"urn:appian:translation-variable:v1:d2e09d15-6eed-46f7-8669-0cfdd5eea8e2\": #\"urn:appian:translation-string:v1:a0555f93-a4d2-455a-9d06-e579b2eb0cff\"\n        )\n      ),\n      /*Content*/\n      rule!CMGT_UTIL_RichTextField(\n        label: #\"urn:appian:translation-string:v1:defe713b-a406-457e-b7a5-2d6d238a11ac\",\n        labelPosition: \"ABOVE\",\n        value: local!resource[recordType!CMGT_KB_Resource.resourceText.resourceText],\n        maxSize: cons!CMGT_INT_MAX_CHAR_LIMIT_EXTRA_LARGE,\n        additionalSaves: a!save(\n          local!resource[recordType!CMGT_KB_Resource.resourceText.plainText],\n          trim(\n            /*to remove extra spaces from resource text*/\n            fn!substitute(\n              rule!CMGT_UTIL_StripHtmlTags(value: save!value, isFormatted: false),\n              fn!char(10),\n              \" \"\n            )\n          )\n        ),\n        required: true,\n        showWhen: local!resource[recordType!CMGT_KB_Resource.resourceTypeId] = cons!CMGT_KB_REFID_RESOURCE_TYPE_TEXT,\n        requiredMessage: #\"urn:appian:translation-string:v1:4ccebd8a-c774-4d45-a639-6f1141ab5576\"(\n          #\"urn:appian:translation-variable:v1:d2e09d15-6eed-46f7-8669-0cfdd5eea8e2\": #\"urn:appian:translation-string:v1:defe713b-a406-457e-b7a5-2d6d238a11ac\"\n        )\n      ),\n\n    },\n    buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n      primaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:b7d90381-c5e3-4f9f-8b7f-a8b58415875d\",\n          style: \"SOLID\",\n          submit: true,\n          validate: true,\n          showWhen: local!isUpdate,\n          saveInto: { a!save(ri!resource, local!resource) }\n        ),\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:ce7306a2-418a-46a2-968e-9d79846b7e3a\",\n          style: \"OUTLINE\",\n          submit: true,\n          validate: true,\n          saveInto: {\n            a!save(\n              local!resource,\n              #\"urn:appian:function:v1:a:update\"(\n                local!resource,\n                recordType!CMGT_KB_Resource.status,\n                cons!CMGT_KB_TXT_STATUS_UNPUBLISHED\n              )\n            ),\n            a!save(ri!resource, local!resource)\n          },\n          showWhen: not(local!isUpdate)\n        ),\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:78731c7f-0a8b-4a15-bb13-daa7c62586d6\",\n          style: \"SOLID\",\n          submit: true,\n          validate: true,\n          showWhen: not(local!isUpdate),\n          saveInto: {\n            a!save(\n              local!resource,\n              #\"urn:appian:function:v1:a:update\"(\n                local!resource,\n                recordType!CMGT_KB_Resource.status,\n                cons!CMGT_KB_TXT_STATUS_PUBLISHED\n              )\n            ),\n            a!save(ri!resource, local!resource)\n          }\n        )\n      },\n      secondaryButtons: #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n        label: #\"urn:appian:translation-string:v1:c00a34e6-9f9a-49c5-aa7d-1a3b805d1ff5\",\n        saveInto: {\n          a!save(local!resource, null),\n          a!save(ri!resource, null)\n        },\n        submit: true,\n        style: \"OUTLINE\",\n        validate: false\n      )\n    ),\n    contentsWidth: \"FULL\",\n    showButtonDivider: true\n  )\n)"
    },
    "_a-0000eaf1-7a52-8000-9c42-011c48011c48_1227353": {
      "name": "CMGT_UTIL_StripHtmlTags",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!replacedText: substitute(\n    substitute(ri!value, \"<p>\", \"\"),\n    \"</p>\",\n    \"\"\n  ),\n  if(\n    ri!isFormatted,\n    /*The striphtml() will automatically substitue char(10) for <br>*/striphtml(local!replacedText),\n    striphtml(\n      substitute(local!replacedText, \"<br>\", \" \")\n    )\n  )\n)"
    },
    "_a-0000ee80-67e1-8000-9da5-011c48011c48_4696100": {
      "name": "CMGT_KB_MTR_UserPublishesDocumentResource",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee70-a572-8000-9d9f-011c48011c48_4648829": {
      "name": "CMGT_KB_Resource_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!resources,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_KB_Resource.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_KB_Resource.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    /*Only modify these fields if they are currently null*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_KB_Resource.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_KB_Resource.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_KB_Resource.isActive,\n        value: true\n      )\n    },\n    childRelationships: {}\n  )\n)"
    },
    "_a-0000eb88-676f-8000-9c81-011c48011c48_1925601": {
      "name": "CMGT_CB_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_MergeMaps(\n  map1: rule!CMGT_UTIL_LoadBrandingMap(),\n  map2: a!localVariables(\n    local!branding: getbrandingconfig(\n      cons!CMGT_WFL_DOC_DEFAULT_BRANDING_CONFIG,\n      true\n    ),\n    local!output: reduce(\n      #\"urn:appian:function:v1:a:update\"(_, _, _),\n      a!map(),\n      merge(\n        {\n          local!branding.defaultBranding.key,\n          local!branding.customBranding.key\n        },\n        {\n          local!branding.defaultBranding.value,\n          local!branding.customBranding.value\n        }\n      )\n    ),\n    local!output\n  )\n)"
    },
    "0002ee73-aa70-8000-27fe-7f0000014e7a": {
      "name": "CMGT_KB_Resource_AddUpdate",
      "type": "Process Model",
      "sail_code": "// Input: ?\n={rule!CMGT_KB_Resource_SetMetaData(\n  resources: pv!resources,\n  initiator: pp!initiator\n)}\n\n// Input: ?\n= #\"SYSTEM_SYSRULES_forEach\"( items: pv!resources, expression: if( and( a!isNullOrEmpty( fv!item[recordType!CMGT_KB_Resource.resourceId] ), fv!item[recordType!CMGT_KB_Resource.status] = cons!CMGT_KB_TXT_STATUS_PUBLISHED ), rule!CMGT_KB_MTR_PublishedResourcesWrapper(resource: fv!item), {} )),\n\n// Output: ?\nAC!RecordsUpdated"
    },
    "_a-0000ee80-67e1-8000-9da5-011c48011c48_4696112": {
      "name": "CMGT_KB_MTR_UserPublishesTextResource",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee67-6b40-8000-9d9d-011c48011c48_4632355": {
      "name": "CMGT_KB_QR_GetResources",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_KB_Resource,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_KB_Resource.caseTypeUuid,\n      operator: \"in\",\n      value: ri!caseTypeUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_KB_Resource.resourceId,\n      operator: \"in\",\n      value: ri!resourceIds\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpression,\n  fields: {\n    ri!fields,\n    recordType!CMGT_KB_Resource.document,\n    recordType!CMGT_KB_Resource.resourceText,\n    recordType!CMGT_KB_Resource.resourceType,\n    recordType!CMGT_KB_Resource.createdByUser,\n    recordType!CMGT_KB_Resource.modifiedByUser\n  },\n  relatedRecordData: { ri!relatedRecordData },\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "bd8f3e49-406c-4eab-a3a4-ce119dfbb5ce": {
      "name": "CMGT_UTIL_RichTextField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  /*\n  This should never be above 4000 characters as it will go over the amount allowed in synced records\n  If using the RTE in other places for customization, the field length should be 4000 characters to allow for additional HTML to be added.\n  The RTE calculates the max length allowed on the front end for the end-user, but will not go over that amount on the back-end\n  */\n  local!maxSize: a!defaultValue(\n    value: ri!maxSize,\n    default: cons!CMGT_INT_MAX_CHAR_LIMIT_EXTRA_LARGE\n  ),\n  if(\n    cons!CMGT_BOL_AUTOMATION_TESTING_LABEL_SWITCH,\n    #\"SYSTEM_SYSRULES_paragraphField\"(\n      label: ri!label,\n      labelPosition: if(rule!CMGT_UTIL_IsBlank(ri!label),\"COLLAPSED\",ri!labelPosition),\n      instructions: ri!instructions,\n      helpTooltip: ri!helpToolTip,\n      placeholder: ri!placeholder,\n      value: rule!CMGT_UTIL_StripHtmlTags(value: ri!value, isFormatted: true),\n      saveInto: a!save(\n        ri!value,\n        \"<p>\" & substitute(save!value, char(10), \"<br>\") & \"</p>\"\n      ),\n      refreshAfter: ri!refreshAfter,\n      characterLimit: local!maxSize,\n      height: ri!height,\n      showWhen: ri!showWhen,\n      required: ri!required,\n      requiredMessage: ri!requiredMessage,\n      readOnly: ri!readOnly,\n      disabled: ri!disabled\n    ),\n    #\"SYSTEM_SYSRULES_styledTextEditorField\"(\n      label: ri!label,\n      labelPosition: if(rule!CMGT_UTIL_IsBlank(ri!label),\"COLLAPSED\",ri!labelPosition),\n      instructions: ri!instructions,\n      helpTooltip: ri!helpToolTip,\n      placeholder: ri!placeholder,\n      value: ri!value,\n      saveInto: {\n        ri!value,\n        ri!additionalSaves\n      },\n      sizeLimit: local!maxSize,\n      height: a!defaultValue(ri!height, \"SHORT_PLUS\"),\n      showWhen: ri!showWhen,\n      required: ri!required,\n      requiredMessage: ri!requiredMessage,\n      readOnly: ri!readOnly,\n      disabled: ri!disabled,\n      validations: ri!validations\n    )\n  )\n)"
    },
    "_a-0000ee80-67e1-8000-9da5-011c48011c48_4696119": {
      "name": "CMGT_KB_MTR_PublishedResourcesWrapper",
      "type": "Expression Rule",
      "sail_code": "if(\n  tointeger(\n    ri!resource[recordType!CMGT_KB_Resource.resourceTypeId]\n  ) = cons!CMGT_KB_REFID_RESOURCE_TYPE_DOCUMENT,\n  rule!CMGT_KB_MTR_UserPublishesDocumentResource(),\n  rule!CMGT_KB_MTR_UserPublishesTextResource()\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_33778": {
      "name": "CMGT_UTIL_SetRecordFields",
      "type": "Expression Rule",
      "sail_code": "/*\nFuture enhancement ideas:\n1 Parameter to skip update if the field isn't present in the object\n--- This would also apply to nested fields, as in, don't set a relationship field if the entire relationship object isn't there because it will instantiate it\n2 Parameter to overwrite based on more enhanced logic\n3 Allow list types for the `value`\n4 Allow reuse to apply setting metadata for nested relationships, but using their own set metadata rule\n--- e.g. CMGT_Entity_SetMetaData can be used in both the Case process and the individual Entity process\n*/\nif(\n  a!isNullOrEmpty(ri!record),\n  ri!record,\n  a!localVariables(\n    local!allUpdates: rule!CMGT_UTIL_RejectBlank(a!flatten(\n      {\n        ri!alwaysOverwrite,\n        ri!childRelationships,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!neverOverwrite,\n          expression: #\"urn:appian:function:v1:a:update\"(\n            fv!item,\n            \"value\",\n            /*Specifically using this instead of a!defaultValue() to account for the `{null}` value*/\n            if(\n              rule!CMGT_UTIL_IsBlank(ri!record[fv!item.field]),\n              fv!item.value,\n              ri!record[fv!item.field]\n            )\n          )\n        )\n      }\n    )),\n    local!onlyChangedUpdates: a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!allUpdates,\n        expression: if(\n          or(\n            tostring(ri!record[fv!item.field]) = tostring(fv!item.value),\n            toboolean(fv!item.applyWhen) = false\n          ),\n          {},\n          fv!item\n        )\n      )\n    ),\n    if(\n      a!isNullOrEmpty(local!onlyChangedUpdates),\n      ri!record,\n      #\"urn:appian:function:v1:a:update\"(\n        data: ri!record,\n        index: local!onlyChangedUpdates.field,\n        value: local!onlyChangedUpdates.value\n      )\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25890": {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "sail_code": "length(a!flatten(ri!value)) = 0"
    }
  }
}
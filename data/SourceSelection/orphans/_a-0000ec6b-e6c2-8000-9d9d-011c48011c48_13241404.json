{
  "uuid": "_a-0000ec6b-e6c2-8000-9d9d-011c48011c48_13241404",
  "name": "AS_GSS_BL_returnEvaluationsForMyTasksFilters",
  "type": "Expression Rule",
  "description": "Expression to get the list of evaluations that will be available for selection in My Tasks grid for evaluation filter ",
  "sail_code": "a!localVariables(\n  local!bundle: rule!AS_GSS_CO_UT_loadBundleFromFolder(langISOCode: null),\n  local!isCOUser: rule!AS_CO_UT_isUserMemberOfGroups(\n    groups: { cons!AS_GSS_GRP_CONTRACTING_PERSONNEL },\n    user: ri!user\n  ),\n  local!myTasksEvaluations: rule!AS_GSS_TMG_QR_getTasks(\n    returnType: cons!AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    taskStatusId: {\n      cons!AS_GSS_TMG_REF_ID_TASK_STATUS_ASSIGNED,\n      cons!AS_GSS_TMG_REF_ID_TASK_STATUS_IN_PROGRESS\n    },\n    additionalFilters: {\n      #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.taskBehaviorType.behaviorTypeCode,\n        operator: \"<>\",\n        value: cons!AS_GSS_TMG_ENUM_TASK_BEHAVIOR_TYPE_CODE_AUTOMATED\n      )\n    },\n    logicalExpression: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n      operator: \"OR\",\n      filters: {\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.userAssignee,\n          operator: \"=\",\n          value: ri!user\n        )\n      },\n      logicalExpressions: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n        operator: \"AND\",\n        filters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.userAssignee,\n            operator: \"is null\",\n            applyWhen: local!isCOUser\n          ),\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.groupAssignee,\n            operator: \"in\",\n            value: intersection(\n              a!groupsForUser(username: ri!user),\n              rule!AS_CO_UT_cast(\n                type: 'type!{http://www.appian.com/ae/types/2009}Group?list',\n                value: rule!AS_CO_UT_returnMembersOfAnyGroups(\n                  groups: cons!AS_GSS_GRP_ALL_BUSINESS_USERS,\n                  onlyDirectMembers: false(),\n                  memberType: \"GROUP\"\n                )\n              )\n            ),\n            applyWhen: local!isCOUser\n          )\n        }\n      )\n    ),\n    aggregationFields: #\"SYSTEM_SYSRULES_aggregationFields\"(\n      groupings: {\n        #\"SYSTEM_SYSRULES_grouping\"(\n          field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.evaluationId,\n          alias: \"evaluationId\"\n        ),\n        #\"SYSTEM_SYSRULES_grouping\"(\n          field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.evaluation.evaluationNumber,\n          alias: \"evaluationNumber\"\n        ),\n        #\"SYSTEM_SYSRULES_grouping\"(\n          field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.evaluation.evaluationTitle,\n          alias: \"evaluationTitle\"\n        )\n      }\n    ),\n    sortInfo: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: \"evaluationNumber\",\n      ascending: true()\n    )\n  ),\n  #\"SYSTEM_SYSRULES_recordFilterList\"(\n    name: \"Evaluation\",\n    options: #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!myTasksEvaluations,\n      expression: #\"SYSTEM_SYSRULES_recordFilterListOption\"(\n        id: fv!index,\n        name: concat(\n          index(fv!item, \"evaluationNumber\", null),\n          \" | \",\n          index(fv!item, \"evaluationTitle\", null)\n        ),\n        filter: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS_GSS_TMG_Task_SYNCEDRECORD.evaluationId,\n          operator: \"=\",\n          value: index(fv!item, \"evaluationId\", null)\n        )\n      )\n    )\n  )\n)",
  "calls": [
    {
      "name": "AS_GSS_CO_UT_loadBundleFromFolder",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_isUserMemberOfGroups",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_QR_getTasks",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_cast",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_returnMembersOfAnyGroups",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_GRP_CONTRACTING_PERSONNEL",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_REF_ID_TASK_STATUS_ASSIGNED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_REF_ID_TASK_STATUS_IN_PROGRESS",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_ENUM_TASK_BEHAVIOR_TYPE_CODE_AUTOMATED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_GRP_ALL_BUSINESS_USERS",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_Task_SYNCEDRECORD",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    }
  ],
  "called_by": []
}
{
  "_metadata": {
    "bundle_id": "CMGT_WorkflowPath_CreateUpdate"
  },
  "objects": {
    "_a-0000e990-c462-8000-9ba7-011c48011c48_29411": {
      "name": "CMGT_QR_GetTask",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Task,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  groupByFields: ri!groupByFields,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskId,\n      operator: \"in\",\n      value: ri!taskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.statusId,\n      operator: \"in\",\n      value: ri!statusId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isActive,\n      operator: \"=\",\n      value: true,\n      applyWhen: ri!includeInactive <> true\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isCurrent,\n      operator: \"=\",\n      value: a!defaultValue(ri!isCurrentTask, true),\n      applyWhen: a!defaultValue(ri!isCurrentTaskApplyWhen, true),\n      \n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskIntentionCode,\n      operator: \"in\",\n      value: a!defaultValue(\n        ri!taskIntentionCodes,\n        {\n          cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW\n        }\n      )\n    ),\n    \n  },\n  fields: {\n    ri!fields,\n    if(\n      ri!includeRoles,\n      {\n        recordType!CMGT_Task.roles\n      },\n      {}\n    ),\n    if(\n      ri!includeMilestone,\n      {\n        recordType!CMGT_Task.milestone\n      },\n      {}\n    ),\n    if(\n      ri!includeCase,\n      {\n        recordType!CMGT_Task.case\n      },\n      {}\n    ),\n    if(\n      ri!includeBranches,\n      {\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/73a323c9-ce12-4212-97aa-f89df7d14c09/9644c5ba-af85-48a3-9cda-fcfb028d6113/3280de96-3518-4a9e-b8ae-854a84562f07\"\n      },\n      {}\n    ),\n    recordType!CMGT_Task.taskBehaviorType,\n    recordType!CMGT_Task.status,\n    recordType!CMGT_Task.taskResponseOptions,\n    recordType!CMGT_Task.selectedTaskResponseOption,\n    recordType!CMGT_Task.conditionSet,\n    recordType!CMGT_Task.conditionSet,\n    #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/5189c3ac-98e2-4a82-8598-2e9561baec9d/64b891e4-359b-48b4-9f47-2a3af4695c34/52813580-ecf3-49c7-be71-568ab452d54a\",\n    recordType!CMGT_Task.createCaseTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.automationTaskAction\n  },\n  logicalExpressions: {\n    ri!additionalLogicalExpression,\n    rule!CMGT_Task_AutomationRuleGlobalLogicalExpression(\n      taskIntentionCodes: ri!taskIntentionCodes\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  relatedRecordData: ri!relatedRecordData,\n  sort: ri!sort,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ed1b-3d9b-8000-9d29-011c48011c48_3503092": {
      "name": "CMGT_WorkflowPathMapping_ReturnWorkflowPathMappingsForGivenPath",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Return all possible paths for the each path of the decision or automation activity*/\n  local!allPossiblePathsForInitialTaskUuid: if(\n    and(\n      rule!CMGT_UTIL_IsNotBlank(ri!taskBranches),\n      rule!CMGT_UTIL_IsNotBlank(ri!initialTaskInstanceUuid)\n    ),\n    rule!CMGT_WorkflowPathMapping_GetDependentTasks_Reducer(\n      currentTaskInstanceUuid: ri!initialTaskInstanceUuid,\n      taskBranches: ri!taskBranches,\n      finalWorkflowPathMappingTasks: null\n    ),\n    {}\n  ),\n  /*Construct Workflow Path Mapping CDT*/\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!allPossiblePathsForInitialTaskUuid,\n    expression: {\n      'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPathMapping'(taskInstanceUuid: fv!item)\n    }\n  )\n)"
    },
    "0007ed25-f47f-8000-1c78-7f0000014e7a": {
      "name": "CMGT_WorkflowPath_CreateUpdate",
      "type": "Process Model",
      "sail_code": "// Input: ?\n= { #\"SYSTEM_SYSRULES_entityDataIdentifiers\"( entity: cons!CMGT_ENT_WORKFLOW_PATH, identifiers: pv!pathsToBeDeleted ), #\"SYSTEM_SYSRULES_entityDataIdentifiers\"( entity: cons!CMGT_ENT_WORKFLOW_PATH_MAPPING, identifiers: pv!pathMappingsToBeDeleted )}\n\n// Input: ?\n= #\"SYSTEM_SYSRULES_entityData\"( entity: cons!CMGT_ENT_WORKFLOW_PATH, data: rule!CMGT_WorkflowPath_SetMetaData( workflowPaths: if( pv!context = \"CREATE\", rule!CMGT_WFL_Case_GenerateWorkflowPathAndMapping_Logic(tasks: pv!tasks), rule!CMGT_Case_ConstructWorkflowPathWithMappings_Logic(caseId: pv!caseId) ), initiator: pp!initiator ))\n\n// Output: ?\nindex(\n  rule!CMGT_QE_GetWorkflowPath(\n    returnType: cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n    caseId: pv!caseId,\n    isActive: false,\n    excludeNestedCdts: true\n  ),\n  \"workflowPathId\",\n  null\n)\n\n// Output: ?\nindex(\n  rule!CMGT_QE_GetWorkflowPathMapping(\n    returnType: cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n    isActive: false,\n    workflowPathId: index(\n      rule!CMGT_QE_GetWorkflowPath(\n        returnType: cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n        caseId: pv!caseId,\n        excludeNestedCdts: true\n      ),\n      \"workflowPathId\",\n      null\n    )\n  ),\n  \"workflowPathMappingId\",\n  null\n)"
    },
    "_a-0000ed24-7935-8000-9d2d-011c48011c48_3534834": {
      "name": "CMGT_WFL_Case_GenerateWorkflowPathAndMapping_Logic",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!CMGT_UTIL_IsNotBlank(ri!tasks),\n  a!localVariables(\n    /*Query case for case type Id*/\n    local!case: rule!CMGT_QR_GetCase(\n      caseId: ri!tasks[recordType!CMGT_Task.caseId],\n      fields: {\n        recordType!CMGT_Case.caseTypeUuid\n      },\n      excludeRelatedRecords: true,\n      executeWhen: rule!CMGT_UTIL_IsNotBlank(\n        ri!tasks[recordType!CMGT_Task.caseId]\n      )\n    ),\n    /*Query workflow task for the case type*/\n    local!caseTypeWorkflowTasks: rule!CMGT_WFL_QR_GetCaseTypeWorkflowTask(\n      caseTypeUuId: local!case[recordType!CMGT_Case.caseTypeUuid],\n      executeWhen: rule!CMGT_UTIL_IsNotBlank(\n        local!case[recordType!CMGT_Case.caseTypeUuid]\n      )\n    ),\n    /*Query case type task workflow paths*/\n    local!caseTypeTaskWorklowPaths: rule!CMGT_WFL_QE_GetCaseTypeTaskWorkflowPath(\n      returnType: cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n      isActive: true,\n      caseTypeUuid: local!case[recordType!CMGT_Case.caseTypeUuid],\n      executeWhen: rule!CMGT_UTIL_IsNotBlank(\n        local!case[recordType!CMGT_Case.caseTypeUuid]\n      )\n    ),\n    /*Construct uuid mapping for task and its responses/condition set based on case type workflow task*/\n    local!taskInstanceUuidMapping: #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!tasks,\n      expression: a!localVariables(\n        /*Filter task based on case type workflow tasks*/\n        local!orgItem: cast(\n          recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask,\n          rule!CMGT_UTIL_Filter(\n            records: local!caseTypeWorkflowTasks,\n            field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskUuid,\n            value: fv!item[recordType!CMGT_Task.caseTypeWorkflowTaskUuid]\n          )\n        ),\n        local!orgItemResponses: local!orgItem[recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskResponseOptions.caseTypeWorkflowTaskResponseOptionUuid],\n        local!orgItemConditions: local!orgItem[recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.conditionSet.childConditionSet.conditionSetUuid],\n        /*Construct map for task uuids, response uuids and condition set uuids*/\n        a!map(\n          caseTypeWorkflowTaskUUID: local!orgItem[recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskUuid],\n          taskInstanceUUID: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n          taskResponseOptionsUuidMapping: #\"SYSTEM_SYSRULES_forEach\"(\n            items: fv!item[recordType!CMGT_Task.taskResponseOptions],\n            expression: a!map(\n              caseTypeWorkflowTasksResponseOptionUUID: local!orgItemResponses[fv!index],\n              taskResponseOptionUUID: fv!item[recordType!CMGT_TaskResponseOption.taskResponseOptionUuid]\n            )\n          ),\n          childConditionSetMapping: #\"SYSTEM_SYSRULES_forEach\"(\n            items: fv!item[recordType!CMGT_Task.conditionSet],\n            expression: a!map(\n              caseTypeWorkflowConditionSetUUID: local!orgItemConditions[fv!index],\n              conditionSetUUID: fv!item[recordType!CMGT_ConditionSet.conditionSetUuid]\n            )\n          )\n        )\n      )\n    ),\n    /*Construct case workflow path and mappings from case type paths*/\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!caseTypeTaskWorklowPaths,\n      expression: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath'(\n        caseId: local!case[recordType!CMGT_Case.caseId],\n        startConditionTaskInstanceUuid: rule!CMGT_UTIL_Filter(\n          records: local!taskInstanceUuidMapping,\n          field: \"caseTypeWorkflowTaskUUID\",\n          value: fv!item.startConditionTaskUuid\n        ).taskInstanceUUID,\n        initialTaskInstanceUuid: if(\n          rule!CMGT_UTIL_IsNotBlank(fv!item.initialTaskUuid),\n          rule!CMGT_UTIL_Filter(\n            records: local!taskInstanceUuidMapping,\n            field: \"caseTypeWorkflowTaskUUID\",\n            value: fv!item.initialTaskUuid\n          ).taskInstanceUUID,\n          null\n        ),\n        taskResponseOptionUuid: if(\n          rule!CMGT_UTIL_IsNotBlank(fv!item.caseTypeTaskResponseOptionUuid),\n          index(\n            rule!CMGT_UTIL_Filter(\n              records: rule!CMGT_UTIL_RejectBlank(\n                a!flatten(\n                  local!taskInstanceUuidMapping.taskResponseOptionsUuidMapping\n                )\n              ),\n              field: \"caseTypeWorkflowTasksResponseOptionUUID\",\n              value: fv!item.caseTypeTaskResponseOptionUuid\n            ),\n            \"taskResponseOptionUUID\",\n            null\n          ),\n          {}\n        ),\n        conditionSetUuid: if(\n          rule!CMGT_UTIL_IsNotBlank(fv!item.conditionSetUuid),\n          index(\n            rule!CMGT_UTIL_Filter(\n              records: rule!CMGT_UTIL_RejectBlank(\n                a!flatten(\n                  local!taskInstanceUuidMapping.childConditionSetMapping\n                )\n              ),\n              field: \"caseTypeWorkflowConditionSetUUID\",\n              value: fv!item.conditionSetUuid\n            ),\n            \"conditionSetUUID\",\n            null\n          ),\n          {}\n        ),\n        workflowPathMapping: #\"SYSTEM_SYSRULES_forEach\"(\n          items: fv!item.caseTypeWorkflowPathMapping,\n          expression: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPathMapping'(\n            taskInstanceUuid: rule!CMGT_UTIL_Filter(\n              records: local!taskInstanceUuidMapping,\n              field: \"caseTypeWorkflowTaskUUID\",\n              value: fv!item.caseTypeWorkflowTaskUuid\n            ).taskInstanceUUID,\n            \n          )\n        )\n      )\n    )\n  ),\n  {}\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3499484": {
      "name": "CMGT_UTIL_QueryEntity",
      "type": "Expression Rule",
      "sail_code": "/*\n\nPLEASE REFER TO THE BOTTOM OF THIS RULE FOR INSTRUCTIONS ON HOW TO USE\n\nPlease DO NOT auto-format this rule\n\n*/\n/*Error handling for invalid returnType or entityType*/\nif(\n  rule!CMGT_UTIL_IsBlank(ri!returnType),\n  fn!error(\n    concat(\n      \"Null `returnType` passed to CMGT_UTIL_queryEntity for entityType `\",\n      ri!entityType,\n      \"`.  See documentation in CMGT_UTIL_queryEntity for further information on how to use this parameter.\"\n    )\n  ),\n  not(\n    contains(\n      rule!CMGT_QE_RETURN_TYPES(),\n      ri!returnType\n    )\n  ),\n  fn!error(\n    concat(\n      \"Unknown `returnType` passed to CMGT_UTIL_queryEntity for entityType `\",\n      ri!entityType,\n      \"`.  See documentation in CMGT_UTIL_queryEntity for further information on how to use this parameter.\"\n    )\n  ),\n  rule!CMGT_UTIL_IsBlank(ri!entityType),\n  fn!error(\n    concat(\n      \"Null `entityType` passed to CMGT_UTIL_queryEntity for entity `\",\n      ri!entity,\n      \"`.  See documentation in CMGT_UTIL_queryEntity for further information on how to use this parameter.\"\n    )\n  ),\n  and(\n    ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    rule!CMGT_UTIL_IsBlank(ri!pagingInfo)\n  ),\n  fn!error(\n    concat(\n      \"`pagingInfo` is required (cannot be null) for `returnType` DATA_SUBSET\"\n    )\n  ),\n  and(\n    ri!returnType <> cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    rule!CMGT_UTIL_IsNotBlank(ri!pagingInfo)\n  ),\n  fn!error(\n    concat(\n      \"`pagingInfo` must be null when the `returnType` is not DATA_SUBSET, instead use `sort` to pass custom-sorting and `startIndex` & `batchSize` will be automatically calculated for you\"\n    )\n  ),\n  and(\n    ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    rule!CMGT_UTIL_IsBlank(ri!aggregation)\n  ),\n  fn!error(\n    \"You must provide an input for `aggregation` when `returnType` is AGGREGATION\"\n  ),\n  and(\n    ri!returnType <> cons!CMGT_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    rule!CMGT_UTIL_IsNotBlank(ri!aggregation)\n  ),\n  fn!error(\n    \"You cannot provide an input for `aggregation` when `returnType` is not AGGREGATION\"\n  ),\n  a!localVariables(\n    /*Determine the castResultToType*/\n    local!castResultToType: rule!CMGT_UTIL_DisplayValue(\n      value: ri!returnType,\n      inArray: rule!CMGT_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/'type!{http://www.appian.com/ae/types/2009}DataSubset',\n        /*SINGLE_OBJECT*/ri!entityType,\n        /*OBJECT_ARRAY*/rule!CMGT_UTIL_ReturnArrayTypeNumber(type: ri!entityType),\n        /*AGGREGATION*/'type!{http://www.appian.com/ae/types/2009}Map?list',\n        /*TOTAL_COUNT*/'type!{http://www.appian.com/ae/types/2009}Integer',\n        \n      }\n    ),\n    /*Determine the batchSize*/\n    local!batchSize: rule!CMGT_UTIL_DisplayValue(\n      value: ri!returnType,\n      inArray: rule!CMGT_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/ri!pagingInfo.batchSize,\n        /*SINGLE_OBJECT*/1,\n        /*OBJECT_ARRAY*/rule!CMGT_UTIL_ReplaceNull(\n          nullableValue: ri!pagingInfo.batchSize,\n          replacementValue: cons!CMGT_INT_QUERY_MAX_BATCH_SIZE\n        ),\n        /*AGGREGATION*/cons!CMGT_INT_QUERY_MAX_BATCH_SIZE,\n        /*TOTAL_COUNT*/0,\n        \n      }\n    ),\n    /*Determine the sort*/\n    local!sort: rule!CMGT_zInternal_QueryEntity_DetermineSort(\n      entityType: ri!entityType,\n      returnType: ri!returnType,\n      pagingInfo: ri!pagingInfo,\n      sort: ri!sort\n    ),\n    /*Determine the pagingInfo*/\n    local!pagingInfo: if(\n      ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n      /*Use specific pagingInfo for DATA_SUBSET*/\n      #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: ri!pagingInfo.startIndex,\n        batchSize: ri!pagingInfo.batchSize,\n        sort: local!sort\n      ),\n      /*Otherwise calculate pagingInfo for all other returnTypes*/\n      #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: local!batchSize,\n        sort: local!sort\n      )\n    ),\n    /*Determine the fetchTotalCount*/\n    local!fetchTotalCount: rule!CMGT_UTIL_DisplayValue(\n      value: ri!returnType,\n      inArray: rule!CMGT_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/true,\n        /*SINGLE_OBJECT*/false,\n        /*OBJECT_ARRAY*/false,\n        /*AGGREGATION*/false,\n        /*TOTAL_COUNT*/true,\n        \n      }\n    ),\n    /*Execute the query*/\n    local!queryResult: a!refreshVariable(\n      value: if(\n        ri!executeWhen = false,\n        null,\n        #\"SYSTEM_SYSRULES_queryEntity_v2\"(\n          entity: ri!entity,\n          fetchTotalCount: local!fetchTotalCount,\n          query: #\"SYSTEM_SYSRULES_query\"(\n            pagingInfo: local!pagingInfo,\n            aggregation: ri!aggregation,\n            selection: if(\n              and(\n                ri!excludeNestedCdts = true,\n                rule!CMGT_UTIL_IsBlank(ri!aggregation)\n              ),\n              #\"SYSTEM_SYSRULES_querySelection\"(\n                columns: #\"SYSTEM_SYSRULES_forEach\"(\n                  items: rule!CMGT_UTIL_ReturnCdtFields(\n                    type: ri!entityType,\n                    onlyPrimitiveFields: true\n                  ),\n                  expression: #\"SYSTEM_SYSRULES_queryColumn\"(field: fv!item)\n                )\n              ),\n              null\n            ),\n            logicalExpression: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n              operator: \"AND\",\n              logicalExpressions: {\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  ignoreFiltersWithEmptyValues: true,\n                  filters: rule!CMGT_UTIL_ReplaceNull(\n                    nullableValue: ri!filters,\n                    replacementValue: {}\n                  )\n                ),\n                rule!CMGT_UTIL_ReplaceNull(\n                  nullableValue: ri!logicalExpression,\n                  replacementValue: {}\n                )\n              }\n            )\n          )\n        )\n      ),\n      refreshOnVarChange: ri!triggerRefresh,\n      refreshAfter: { \"RECORD_ACTION\" }\n    ),\n    /*Parse the queryResult*/\n    local!queryResultParse: choose(\n      rule!CMGT_UTIL_ChooseWhereContainsHelper(\n        value: ri!returnType,\n        inArray: rule!CMGT_QE_RETURN_TYPES()\n      ),\n      /*Default, required value based on how CMGT_UTIL_chooseWherecontainsHelper operates*/\"\",\n      /*DATA_SUBSET*/local!queryResult,\n      /*SINGLE_OBJECT*/local!queryResult.data,\n      /*OBJECT_ARRAY*/local!queryResult.data,\n      /*AGGREGATION*/local!queryResult.data,\n      /*TOTAL_COUNT*/local!queryResult.totalCount,\n      \n    ),\n    rule!CMGT_UTIL_cast(\n      type: local!castResultToType,\n      value: local!queryResultParse\n    )\n  )\n)/*\n\nDOCUMENTATION\n\nThis rule is designed to minimize the overhead with querying data and then casting the result\n\n\nRequired Inputs:\n\n1. entity \n- This is the data store entity you are querying\n-- e.g. cons!AS_DATA_STORE_ENTITY_CASES\n\n2. entityType\n- This is a type! input of the data type which maps to the underlying data store entity\n- Note that your type! input should not end in parenthesis; this is NOT designed to take in an empty CDT\n-- e.g. 'type!{urn:com:appian:types}Case'\n\n3. returnType\n- This depends on the purpose for the query, and should be one of the returnTypes in rule!CMGT_QE_RETURN_TYPES\n-- DATA_SUBSET - This will return a DataSubset; pagingInfo is required\n-- SINGLE_OBJECT - This will return a single CDT whose type is the entityType; pagingInfo must be null\n-- ARRAY_OBJECT - This will return an array of CDTs whos type is an array of the entityType; pagingInfo must be null\n-- AGGREGATION - This will return an array of Dictionaries; pagingInfo must be null\n---- NOTE: If you need Aggregation with paging controls, such as for a grid, use returnType DATA_SUBSET\n-- TOTAL_COUNT - This will return an Integer of the total count; pagingInfo must be null\n\n\nOptional Inputs:\n\n4. executeWhen\n- The query will not execute if this is false, the query will execute if this is true or null\n-- This is meant to operate in a similar manner to the showWhen parameter of components\n- Use this to skip execution of a query without needing to wrap if() statements around the rule\n-- Examples of this would be to skip querying if your filter value is a null ID\n- If the query does not execute, this will return a null value whose type is based on the returnType input\n\n5. triggerRefresh\n- By default, the query will always re-execute whenever any inputs change\n- However, by updating the value of triggerRefresh, you can also trigger a re-execution even if none of the other inputs change\n\n6. excludeNestedCdts\n- When true, this will exclude all nested CDTs from the query selection, and only include primitive fields\n- When false or null, all fields will be included in the query, including all nested CDTs\n\n7. filters\n- Array of filters to apply to the query, built with a!queryFilter()\n- These filters will be applied with an AND operator\n- These filters will apply in addition to the logicalExpression input, combining both with an AND operator\n\n8. logicalExpression\n- A logical expression to apply to the query, built with a!queryLogicalExpression()\n- This logical expression will apply in addition to the filters input, combining both with an AND operator\n\n9. aggregation\n- Aggregation to apply to the query, built with a!queryAggregation()\n\n10. pagingInfo\n- Paging info to apply to the query, built with a!pagingInfo() or derived from fv!pagingInfo in grids\n- This is required if passing returnType DATA_SUBSET, otherwise it must be null\n- For returnTypes that are not DATA_SUBSET, the batch size will be automatically calculated depending on the returnType\n-- For example, passing SINGLE_OBJECT will automatically apply a batch size of 1, whereas ARRAY_OBJECT and AGGREGATION will automatically apply a batch size of -1\n\n11. sort\n- Array of sort to apply to the query, built with a!sortInfo()\n- This is meant to be used with returnType ARRAY_OBJECT and AGGREGATION, since pagingInfo is not required for these, but a specified sort may be used\n- If both sort and pagingInfo.sort are passed with valid values, they will be applied in conjuction, with the sort parameter being the primary sort\n\n*/"
    },
    "_a-0000ed20-1ca4-8000-9d2b-011c48011c48_3518562": {
      "name": "CMGT_QE_GetWorkflowPath",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryEntity(\n  entity: cons!CMGT_ENT_WORKFLOW_PATH,\n  entityType: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath',\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"startConditionTaskInstanceUuid\",\n      operator: \"=\",\n      value: ri!startConditionTaskInstanceUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"caseId\",\n      operator: \"=\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"isActive\",\n      operator: \"=\",\n      value: a!defaultValue(ri!isActive, true)\n    ),\n    ri!additionalFilters\n  },\n  logicalExpression: ri!additionalLogicalExpression,\n  returnType: a!defaultValue(\n    ri!returnType,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  pagingInfo: if(\n    ri!returnType <> cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    null,\n    a!defaultValue(\n      ri!pagingInfo,\n      #\"SYSTEM_SYSRULES_pagingInfo\"(1, cons!CMGT_INT_BATCH_SIZE_MEDIUM)\n    )\n  ),\n  excludeNestedCdts:ri!excludeNestedCdts\n)"
    },
    "_a-0000ed24-7935-8000-9d2d-011c48011c48_3527657": {
      "name": "CMGT_WorkflowPathMapping_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!workflowPathMapping,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {},\n    /*Only modify these fields if they are currently null*/\n    neverOverwrite: { a!map(field: \"isActive\", value: true) },\n    /*Set metadata for all child relationships*/\n    childRelationships: {}\n  )\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145917": {
      "name": "CMGT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000ed1b-3d9b-8000-9d29-011c48011c48_3503111": {
      "name": "CMGT_WorkflowPathMapping_GetDependentTasks_Reducer",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Filter after task instance uuid of the current task*/\n  local!afterTaskInstanceUuids: rule!CMGT_UTIL_Distinct(\n    rule!CMGT_UTIL_Filter(\n      records: ri!taskBranches,\n      fieldValuePairs: {\n        a!map(\n          field: recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n          value: ri!currentTaskInstanceUuid\n        ),\n        a!map(\n          field: recordType!CMGT_TaskBranch.isActive,\n          value: true\n        ),\n        a!map(\n          field: recordType!CMGT_TaskBranch.isCurrent,\n          value: true\n        )\n      }\n    )[recordType!CMGT_TaskBranch.afterTaskInstanceUuid]\n  ),\n  /*Append the current task instance UUID with the final path mapping tasks*/\n  local!finalPathMappingTasks: rule!CMGT_UTIL_Distinct(\n    append(\n      ri!finalWorkflowPathMappingTasks,\n      ri!currentTaskInstanceUuid\n    )\n  ),\n  if(\n    /*Recursion END Condition*/\n    /*Check if there are any after task for current task or the current task\n      leads to loopback (Task present in final output of workflow path mapping)*/\n    or(\n      rule!CMGT_UTIL_IsBlank(local!afterTaskInstanceUuids),\n      contains(\n        ri!finalWorkflowPathMappingTasks,\n        ri!currentTaskInstanceUuid\n      )\n    ),\n    /*Return the result if recursion end condition is met*/\n    local!finalPathMappingTasks,\n    /*Call the recursion logic again with the filtered afterTaskUUIDs*/\n    reduce(\n      rule!CMGT_WorkflowPathMapping_GetDependentTasks_Reducer(\n        finalWorkflowPathMappingTasks: _,\n        currentTaskInstanceUuid: _,\n        taskBranches: ri!taskBranches\n      ),\n      local!finalPathMappingTasks,\n      local!afterTaskInstanceUuids\n    )\n  )\n)"
    },
    "_a-0000ed1b-3d9b-8000-9d29-011c48011c48_3503082": {
      "name": "CMGT_Case_ConstructWorkflowPathWithMappings_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Query existing data from workflow path table*/\n  local!originalWorkflowPaths: if(\n    rule!CMGT_UTIL_IsNotBlank(ri!caseId),\n    rule!CMGT_QE_GetWorkflowPath(caseId: ri!caseId),\n    {}\n  ),\n  local!tasks: rule!CMGT_QR_GetTask(\n    caseId: ri!caseId,\n    executeWhen: a!isNotNullOrEmpty(ri!caseId),\n    includeRoles: false,\n    includeMilestone: false,\n    taskIntentionCodes: cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW,\n    relatedRecordData: {\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Task.beforeTaskInstanceBranches,\n        filters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!CMGT_TaskBranch.isActive,\n            operator: \"=\",\n            value: true\n          ),\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!CMGT_TaskBranch.isCurrent,\n            operator: \"=\",\n            value: true\n          )\n        }\n      )\n    },\n    sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!CMGT_Task.sortOrder,\n      ascending: true\n    ),\n    includeBranches: true\n  ),\n  /*Construct workflow path for the current workflow*/\n  local!currentWorkflowPaths: rule!CMGT_WorkflowPath_ReturnWorkflowPathForTasks(caseId: ri!caseId, tasks: local!tasks),\n  if(\n    /*If the workflow is new there won't be any entries in for path and path mappings in DB so return the constructed paths*/\n    rule!CMGT_UTIL_IsBlank(local!originalWorkflowPaths),\n    local!currentWorkflowPaths,\n    a!localVariables(\n      if(\n        rule!CMGT_UTIL_IsNotBlank(local!currentWorkflowPaths),\n        a!localVariables(\n          local!finalWorkflowPaths: #\"SYSTEM_SYSRULES_forEach\"(\n            items: local!currentWorkflowPaths,\n            expression: a!localVariables(\n              /*Filter if there is a DB entry for the workflow path*/\n              local!filteredCurrentWorkflowPath: rule!CMGT_UTIL_Filter(\n                records: local!originalWorkflowPaths,\n                fieldValuePairs: {\n                  a!map(\n                    field: \"startConditionTaskInstanceUuid\",\n                    value: fv!item.startConditionTaskInstanceUuid\n                  ),\n                  a!map(\n                    field: \"initialTaskInstanceUuid\",\n                    value: fv!item.initialTaskInstanceUuid\n                  ),\n                  a!map(\n                    field: \"taskResponseOptionUuid\",\n                    value: fv!item.taskResponseOptionUuid\n                  ),\n                  a!map(\n                    field: \"conditionSetUuid\",\n                    value: fv!item.conditionSetUuid\n                  )\n                }\n              ),\n              local!thisWorkflowPath: cast(\n                'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath',\n                local!filteredCurrentWorkflowPath\n              ),\n              if(\n                rule!CMGT_UTIL_IsBlank(local!filteredCurrentWorkflowPath),\n                /*if there is no entry it is a new one return the constructed path and path mappings*/\n                fv!item,\n                /*If there is an entry for workflow path check for the path mappings if new tasks need to be added or deleted*/\n                #\"urn:appian:function:v1:a:update\"(\n                  local!thisWorkflowPath,\n                  \"workflowPathMapping\",\n                  rule!CMGT_WorkflowPathMapping_ConstructPathMappingForExistingPath(\n                    originalWorkflowPathMappings: index(\n                      local!thisWorkflowPath,\n                      \"workflowPathMapping\",\n                      null\n                    ),\n                    currentWorkflowPathMappings: index(fv!item, \"workflowPathMapping\", null)\n                  )\n                )\n              )\n            )\n          ),\n          /*Filter the removed workflow path ids*/\n          local!removedWorkflowPathsIds: difference(\n            tointeger(\n              index(\n                local!originalWorkflowPaths,\n                \"workflowPathId\",\n                null\n              )\n            ),\n            rule!CMGT_UTIL_RejectBlank(\n              tointeger(\n                index(\n                  local!finalWorkflowPaths,\n                  \"workflowPathId\",\n                  null\n                )\n              )\n            )\n          ),\n          /*Filter the removed workflow paths*/\n          local!removedWorkflowPaths: rule!CMGT_UTIL_Filter(\n            records: local!originalWorkflowPaths,\n            field: \"workflowPathId\",\n            value: local!removedWorkflowPathsIds\n          ),\n          rule!CMGT_UTIL_RejectBlank(\n            array: {\n              local!finalWorkflowPaths,\n              if(\n                rule!CMGT_UTIL_IsBlank(local!removedWorkflowPaths),\n                null,\n                #\"SYSTEM_SYSRULES_forEach\"(\n                  items: local!removedWorkflowPaths,\n                  expression: #\"urn:appian:function:v1:a:update\"(\n                    #\"urn:appian:function:v1:a:update\"(\n                      fv!item,\n                      \"workflowPathMapping\",\n                      if(\n                        rule!CMGT_UTIL_IsNotBlank(fv!item.workflowPathMapping),\n                        #\"urn:appian:function:v1:a:update\"(\n                          fv!item.workflowPathMapping,\n                          \"isActive\",\n                          false\n                        ),\n                        null\n                      )\n                    ),\n                    \"isActive\",\n                    false()\n                  )\n                )\n              )\n            }\n          )\n        ),\n        /*Update isActive=false for all paths and its mappings when workflow is deleted*/\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: local!originalWorkflowPaths,\n          expression: #\"urn:appian:function:v1:a:update\"(\n            #\"urn:appian:function:v1:a:update\"(\n              fv!item,\n              \"workflowPathMapping\",\n              if(\n                rule!CMGT_UTIL_IsNotBlank(fv!item.workflowPathMapping),\n                #\"urn:appian:function:v1:a:update\"(\n                  fv!item.workflowPathMapping,\n                  \"isActive\",\n                  false\n                ),\n                null\n              )\n            ),\n            \"isActive\",\n            false()\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ed24-7935-8000-9d2d-011c48011c48_3526562": {
      "name": "CMGT_WorkflowPath_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!workflowPaths,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {\n      a!map(field: \"modifiedBy\", value: ri!initiator),\n      a!map(field: \"modifiedOn\", value: now())\n    },\n    /*Only modify these fields if they are currently null*/\n    neverOverwrite: {\n      a!map(field: \"createdBy\", value: ri!initiator),\n      a!map(field: \"createdOn\", value: now()),\n      a!map(field: \"isActive\", value: true)\n    },\n    /*Set metadata for all child relationships*/\n    childRelationships: {\n      a!map(\n        field: \"workflowPathMapping\",\n        value: rule!CMGT_WorkflowPathMapping_SetMetaData(\n          workflowPathMapping: index(fv!item, \"workflowPathMapping\", null)\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180568": {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "sail_code": "not(rule!CMGT_UTIL_IsBlank(ri!input))"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500546": {
      "name": "CMGT_UTIL_ReplaceNull",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!CMGT_UTIL_IsBlank(ri!nullableValue),\n  ri!replacementValue,\n  ri!nullableValue\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500561": {
      "name": "CMGT_zInternal_QueryEntity_DetermineSort",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!sortToUse: if(\n    /*SINGLE_OBJECT*/\n    ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_SINGLE_OBJECT,\n    ri!sort,\n    \n    /*AGGREGATION*/\n    ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    ri!sort,\n    \n    /*TOTAL_COUNT*/\n    ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_TOTAL_COUNT,\n    null,\n    \n    /*DATA_SUBSET or OBJECT_ARRAY*/\n    a!localVariables(\n      /*Guess what the primary key is by using the first primitive field in the CDT*/\n      local!primaryKeyField_guess: index(rule!CMGT_UTIL_ReturnCdtFields(\n        type: ri!entityType,\n        onlyPrimitiveFields: true\n      ), 1, null),\n      \n      /*Grab the appropriate input sort by the returnType*/\n      local!inputSort: if(\n        ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n        ri!pagingInfo.sort,\n        \n        ri!returnType = cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n        ri!sort,\n        \n        null\n      ),\n      \n      /*If the primaryKeyField_guess is not null, build a secondary sort by the PK field*/\n      local!secondaryPkSortToAppend: if(\n        isnull(local!primaryKeyField_guess),\n        {},\n        #\"SYSTEM_SYSRULES_sortInfo\"(field: local!primaryKeyField_guess, ascending: true)\n      ),\n      \n      /*Append the secondary PK sort to the sort*/\n      local!sortWithSecondaryPkSortApplied: if(\n        rule!CMGT_UTIL_IsBlank(local!inputSort),\n        local!secondaryPkSortToAppend,\n        append(local!inputSort, local!secondaryPkSortToAppend)\n      ),\n      \n      local!sortWithSecondaryPkSortApplied\n    )\n  ),\n  \n  local!sortToUse\n)"
    },
    "_a-0000ed20-1ca4-8000-9d2b-011c48011c48_3518067": {
      "name": "CMGT_WorkflowPathMapping_ConstructPathMappingForExistingPath",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*If the workflow path mapping is already present in DB return that value else \n  return from the new value*/\n  local!finalWorkflowPathMappings: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!currentWorkflowPathMappings,\n    expression: a!localVariables(\n      local!filteredWorkflowPathMapping: rule!CMGT_UTIL_Filter(\n        records: ri!originalWorkflowPathMappings,\n        fieldValuePairs: {\n          a!map(\n            field: \"taskInstanceUuid\",\n            value: fv!item.taskInstanceUuid\n          )\n        }\n      ),\n      if(\n        rule!CMGT_UTIL_IsBlank(local!filteredWorkflowPathMapping),\n        fv!item,\n        local!filteredWorkflowPathMapping\n      )\n    )\n  ),\n  /*Filter the removed workflow path mapping ids*/\n  local!removedWorkflowPathMappingIds: difference(\n    tointeger(\n      index(\n        ri!originalWorkflowPathMappings,\n        \"workflowPathMappingId\",\n        null\n      )\n    ),\n    rule!CMGT_UTIL_RejectBlank(\n      tointeger(\n        index(\n          local!finalWorkflowPathMappings,\n          \"workflowPathMappingId\",\n          null\n        )\n      )\n    )\n  ),\n  /*Filter the removed workflow path mappings*/\n  local!removedWorkflowPathMappings: rule!CMGT_UTIL_Filter(\n    records: ri!originalWorkflowPathMappings,\n    field: \"workflowPathMappingId\",\n    value: local!removedWorkflowPathMappingIds\n  ),\n  /*Return the workflow path mapping*/\n  rule!CMGT_UTIL_RejectBlank(\n    array: {\n      local!finalWorkflowPathMappings,\n      if(\n        rule!CMGT_UTIL_IsBlank(local!removedWorkflowPathMappings),\n        null,\n        #\"urn:appian:function:v1:a:update\"(\n          local!removedWorkflowPathMappings,\n          \"isActive\",\n          false\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500695": {
      "name": "CMGT_UTIL_ReturnArrayTypeNumber",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer',\n  typeof(\n    a!flatten(\n      rule!CMGT_UTIL_cast(\n        type: ri!type,\n        typeOf: ri!typeOf,\n        value: null\n      )\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180560": {
      "name": "CMGT_UTIL_returnTypeNumber",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer',\n  if(\n    isnull(ri!type),\n    typeof(ri!typeOf),\n    typeof(cast(ri!type, null))\n  )\n)"
    },
    "_a-0000ed1b-3d9b-8000-9d29-011c48011c48_3503101": {
      "name": "CMGT_WorkflowPath_ReturnWorkflowPathForTasks",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!CMGT_UTIL_IsBlank(ri!tasks),\n  {},\n  a!localVariables(\n    local!taskBranches: a!flatten(\n      ri!tasks[recordType!CMGT_Task.beforeTaskInstanceBranches]\n    ),\n    /*Filtering automation task from all tasks*/\n    local!workflowRoutingAutomationTasks: rule!CMGT_UTIL_Filter(\n      records: rule!CMGT_UTIL_Filter(\n        records: ri!tasks,\n        field: recordType!CMGT_Task.taskBehaviorTypeId,\n        value: cons!CMGT_REFID_TASK_BEHAVIOR_TYPE_AUTOMATION\n      ),\n      field: recordType!CMGT_Task.automationTaskAction.actionCode,\n      value: cons!CMGT_CFG_TXT_ACT_WORKFLOW_ROUTING\n    ),\n    /*Filtering decision task from all tasks*/\n    local!decisionTasks: rule!CMGT_UTIL_Filter(\n      records: ri!tasks,\n      field: recordType!CMGT_Task.taskBehaviorTypeId,\n      value: cons!CMGT_REFID_TASK_BEHAVIOR_TYPE_DECISION\n    ),\n    if(\n      and(\n        rule!CMGT_UTIL_IsBlank(local!workflowRoutingAutomationTasks),\n        rule!CMGT_UTIL_IsBlank(local!decisionTasks)\n      ),\n      {},\n      rule!CMGT_UTIL_RejectBlank(\n        {\n          /*Construct path for all decision tasks*/\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: local!decisionTasks,\n            expression: a!localVariables(\n              local!currentTask: fv!item,\n              /*Fetch response option for current decison task*/\n              local!currentTaskResponseOptions: fv!item[recordType!CMGT_Task.taskResponseOptions],\n              #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!currentTaskResponseOptions,\n                expression: a!localVariables(\n                  /*Filter the first task that each response option leads to and construct workflow path*/\n                  local!taskBranchesOfCurrentResponseOption: rule!CMGT_UTIL_Filter(\n                    records: local!taskBranches,\n                    fieldValuePairs: {\n                      a!map(\n                        field: recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n                        value: local!currentTask[recordType!CMGT_Task.taskInstanceUuid]\n                      ),\n                      a!map(\n                        field: recordType!CMGT_TaskBranch.taskResponseOptionUuid,\n                        value: fv!item[recordType!CMGT_TaskResponseOption.taskResponseOptionUuid]\n                      )\n                    }\n                  ),\n                  /*If the response option leads to END then initialTaskUuuid will be null else the dependents\n                tasks' taskInstanceUuid*/\n                  if(\n                    rule!CMGT_UTIL_IsBlank(\n                      local!taskBranchesOfCurrentResponseOption\n                    ),\n                    'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath'(\n                      caseId: ri!caseId,\n                      startConditionTaskInstanceUuid: local!currentTask[recordType!CMGT_Task.taskInstanceUuid],\n                      initialTaskInstanceUuid: null,\n                      taskResponseOptionUuid: fv!item[recordType!CMGT_TaskResponseOption.taskResponseOptionUuid]\n                    ),\n                    #\"SYSTEM_SYSRULES_forEach\"(\n                      items: local!taskBranchesOfCurrentResponseOption,\n                      expression: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath'(\n                        caseId: ri!caseId,\n                        startConditionTaskInstanceUuid: local!currentTask[recordType!CMGT_Task.taskInstanceUuid],\n                        initialTaskInstanceUuid: fv!item[recordType!CMGT_TaskBranch.afterTaskInstanceUuid],\n                        taskResponseOptionUuid: fv!item[recordType!CMGT_TaskBranch.taskResponseOptionUuid],\n                        workflowPathMapping: rule!CMGT_WorkflowPathMapping_ReturnWorkflowPathMappingsForGivenPath(\n                          initialTaskInstanceUuid: fv!item[recordType!CMGT_TaskBranch.afterTaskInstanceUuid],\n                          taskBranches: local!taskBranches\n                        )\n                      )\n                    )\n                  )\n                )\n              )\n            )\n          ),\n          /*Construct path for all automation tasks with start case type workflow tasks*/\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: local!workflowRoutingAutomationTasks,\n            expression: a!localVariables(\n              local!currentTask: fv!item,\n              /*Filter the first task that each task leads to and construct workflow path*/\n              local!taskBranchesOfCurrentTask: rule!CMGT_UTIL_Filter(\n                records: local!taskBranches,\n                fieldValuePairs: {\n                  a!map(\n                    field: recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n                    value: local!currentTask[recordType!CMGT_Task.taskInstanceUuid]\n                  )\n                }\n              ),\n              /*Construct workflow path for each task branch*/\n              local!workflowPathsOfCurrentTaskLeadsToTask: #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!taskBranchesOfCurrentTask,\n                expression: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath'(\n                  caseId: ri!caseId,\n                  startConditionTaskInstanceUuid: local!currentTask[recordType!CMGT_Task.taskInstanceUuid],\n                  initialTaskInstanceUuid: fv!item[recordType!CMGT_TaskBranch.afterTaskInstanceUuid],\n                  conditionSetUuid: fv!item[recordType!CMGT_TaskBranch.conditionSetUuid],\n                  workflowPathMapping: rule!CMGT_WorkflowPathMapping_ReturnWorkflowPathMappingsForGivenPath(\n                    initialTaskInstanceUuid: fv!item[recordType!CMGT_TaskBranch.afterTaskInstanceUuid],\n                    taskBranches: local!taskBranches\n                  )\n                )\n              ),\n              /*Filter condition sets of the current task*/\n              local!conditionSetsOfCurrentTask: fv!item[recordType!CMGT_Task.conditionSet],\n              /*If the condition set leads to end it won't have entry in taskBranch table. So taking the\n          difference of already constructed condition sets in workflow path with existing condition set will return\n          condition set leads to END node*/\n              local!conditionSetLeadsToEnd: difference(\n                touniformstring(\n                  local!conditionSetsOfCurrentTask[recordType!CMGT_ConditionSet.conditionSetUuid]\n                ),\n                touniformstring(\n                  rule!CMGT_UTIL_RejectBlank(\n                    index(\n                      local!workflowPathsOfCurrentTaskLeadsToTask,\n                      \"conditionSetUuid\",\n                      null\n                    )\n                  )\n                )\n              ),\n              /*Construct workflow paths for condition set leads to end node*/\n              local!workflowPathsOfCurrentTaskLeadsToEnd: #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!conditionSetLeadsToEnd,\n                expression: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPath'(\n                  caseId: ri!caseId,\n                  startConditionTaskInstanceUuid: local!currentTask[recordType!CMGT_Task.taskInstanceUuid],\n                  initialTaskInstanceUuid: null,\n                  conditionSetUuid: fv!item\n                )\n              ),\n              rule!CMGT_UTIL_RejectBlank(\n                {\n                  local!workflowPathsOfCurrentTaskLeadsToTask,\n                  local!workflowPathsOfCurrentTaskLeadsToEnd\n                }\n              )\n            )\n          )\n        }\n      )\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180583": {
      "name": "CMGT_UTIL_checkIfSingleType",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Boolean',\n  with(\n    local!typeNumber: rule!CMGT_UTIL_returnTypeNumber(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n  \n    and(\n      /*The type of the input equals the type of the input returned as single type*/\n      local!typeNumber = rule!CMGT_UTIL_returnTypeNumber(\n        typeOf: rule!CMGT_UTIL_returnSingleTypeObject(typeOf: cast(local!typeNumber, null))\n      ),\n      \n      /*And the type of the input is not list of variant*/\n      local!typeNumber <> rule!CMGT_UTIL_returnTypeNumber(\n        typeOf: {}\n      )\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180552": {
      "name": "CMGT_UTIL_cast",
      "type": "Expression Rule",
      "sail_code": "with(  \n  local!typeNumber: rule!CMGT_UTIL_returnTypeNumber(\n    type: ri!type,\n    typeOf: ri!typeOf\n  ),\n\n  /* If the object is empty, use null or {} depending on if it is array type or not */\n  local!objectToCast: if(\n    rule!CMGT_UTIL_IsNotBlank(ri!value),\n    ri!value,\n    rule!CMGT_UTIL_checkIfSingleType(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n    null,\n    {}\n  ),\n\n  cast(\n    local!typeNumber,\n    local!objectToCast\n  )\n  \n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500604": {
      "name": "CMGT_zINTERNAL_ReturnCdtFields_Handler",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Text?list',\n  with(\n    local!blankCdt: rule!CMGT_UTIL_returnSingleTypeObject(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n    split(\n      extract(\n        substitute(\n          tostring(\n            local!blankCdt\n          ),\n          \"[Document:]\",\n          \"\"\n        ),\n        \"[\",\n        \"=]\"\n      ),\n      \"=, \"\n    )\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500627": {
      "name": "CMGT_UTIL_TypeCompare",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  typeof(ri!value1) = typeof(ri!value2)\n)"
    },
    "_a-0000ed24-7935-8000-9d2d-011c48011c48_3533730": {
      "name": "CMGT_QE_GetWorkflowPathMapping",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryEntity(\n  entity: cons!CMGT_ENT_WORKFLOW_PATH_MAPPING,\n  entityType: 'type!{urn:com:appian:types:CMGT}CMGT_WorkflowPathMapping',\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"workflowPathId\",\n      operator: \"in\",\n      value: ri!workflowPathId,\n      applyWhen: rule!CMGT_UTIL_IsNotBlank(ri!workflowPathId)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"isActive\",\n      operator: \"=\",\n      value: a!defaultValue(ri!isActive, true)\n    ),\n    ri!additionalFilters\n  },\n  logicalExpression: ri!additionalLogicalExpression,\n  returnType: a!defaultValue(\n    ri!returnType,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  pagingInfo: if(\n    ri!returnType <> cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    null,\n    a!defaultValue(\n      ri!pagingInfo,\n      #\"SYSTEM_SYSRULES_pagingInfo\"(1, cons!CMGT_INT_BATCH_SIZE_MEDIUM)\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180481": {
      "name": "CMGT_UTIL_RejectBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(a!flatten(ri!array)),\n  reject(a!isNullOrEmpty(_), a!flatten(ri!array))\n)"
    },
    "_a-0000eb60-4595-8000-9c6e-011c48011c48_1742745": {
      "name": "CMGT_WFL_QR_GetCaseTypeWorkflowTask",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask,\n  executeWhen: ri!executeWhen,\n  returnType: ri!returnType,\n  sort: ri!sort,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.taskBlockId,\n      operator: \"in\",\n      value: ri!taskBlockId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.milestoneId,\n      operator: \"=\",\n      value: ri!referenceMilestoneId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeUuid,\n      operator: \"=\",\n      value: ri!caseTypeUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.isActive,\n      operator: \"in\",\n      value: {\n        true,\n        if(\n          a!defaultValue(ri!includeInactive, false),\n          false,\n          {}\n        )\n      }\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.referenceTaskId,\n      operator: \"=\",\n      value: ri!referenceTaskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskId,\n      operator: \"=\",\n      value: ri!caseTypeWorkflowTaskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.taskIntentionCode,\n      operator: \"in\",\n      value: a!defaultValue(ri!taskIntentionCodes,{cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW})\n    ),\n  },\n  fields: {\n    ri!fields,\n    if(\n      ri!includeMilestones,\n      {\n        recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.referenceMilestone\n      },\n      {}\n    ),\n    if(\n      ri!includeCaseType,\n      {\n        recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseType\n      },\n      {}\n    ),\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.referenceTask,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.referenceTask,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.taskBehaviorType,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskResponseOptions,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.beforeCaseTypeWorkflowTaskBranches,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.beforeCaseTypeWorkflowTaskBranches,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.conditionSet,\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.conditionSet,\n    #\"urn:appian:record-relationship:v1:d6ebee27-6e86-47e3-a9b8-71fdd0348854/ef9cc417-d6ce-4fee-bd86-fa71ab64f8a1/eb49dd52-e1ed-4e4c-a3ab-903f4eadb20c/aa71274b-fe14-4420-b400-573007a0049d\",\n    recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.automationTaskAction,\n  },\n  relatedRecordData: {\n    ri!relatedRecordData,\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTask.caseTypeWorkflowTaskResponseOptions,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!CMGT_WFL_CFG_CaseTypeWorkflowTaskResponseOption.sortOrder,\n        ascending: true\n      )\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  triggerRefresh: ri!triggerRefresh,\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500619": {
      "name": "CMGT_zINTERNAL_ReturnCdtFields_PrimitiveTypeCheckHandler",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  any(\n    rule!CMGT_UTIL_TypeCompare(\n      value1: ri!singleType[ri!field],\n      value2: _\n    ),\n    apply(\n      cast(_, null),\n      rule!CMGT_CONS_PRIMITIVE_TYPE_ARRAY()\n    )\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3499492": {
      "name": "CMGT_QE_RETURN_TYPES",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Text?list',\n  {\n    cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_SINGLE_OBJECT,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_TOTAL_COUNT,\n  }\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500538": {
      "name": "CMGT_UTIL_DisplayValue",
      "type": "Expression Rule",
      "sail_code": "displayvalue(\n  \n  ri!value,\n  \n  ri!inArray,\n  \n  ri!replacement,\n  \n  if(\n    \n    ri!firstIsDefault,\n    ri!replacement[1],\n    \n    ri!lastIsDefault,\n    ri!replacement[count(ri!replacement)],\n    \n    ri!customDefault\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500589": {
      "name": "CMGT_UTIL_ReturnCdtFields",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Text?list',\n  with(\n    local!cdtFields: rule!CMGT_zINTERNAL_ReturnCdtFields_Handler(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n    \n    if(\n      ri!onlyPrimitiveFields,\n      filter(\n        rule!CMGT_zINTERNAL_ReturnCdtFields_PrimitiveTypeCheckHandler(\n          singleType: rule!CMGT_UTIL_returnSingleTypeObject(\n            type: ri!type,\n            typeOf: ri!typeOf\n          ),\n          field: _\n        ),\n        local!cdtFields\n      ),\n      ri!onlyComplexFields,\n      reject(\n        rule!CMGT_zINTERNAL_ReturnCdtFields_PrimitiveTypeCheckHandler(\n          singleType: rule!CMGT_UTIL_returnSingleTypeObject(\n            type: ri!type,\n            typeOf: ri!typeOf\n          ),\n          field: _\n        ),\n        local!cdtFields\n      ),\n      local!cdtFields\n    )\n  )\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500635": {
      "name": "CMGT_CONS_PRIMITIVE_TYPE_ARRAY",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Type?list',\n  {\n    /* 1*/ 'type!{http://www.appian.com/ae/types/2009}Text',\n    /* 2*/ 'type!{http://www.appian.com/ae/types/2009}Integer',\n    /* 3*/ 'type!{http://www.appian.com/ae/types/2009}Decimal',\n    /* 4*/ 'type!{http://www.appian.com/ae/types/2009}Boolean',\n    /* 5*/ 'type!{http://www.appian.com/ae/types/2009}Date',\n    /* 6*/ 'type!{http://www.appian.com/ae/types/2009}Datetime',\n    /* 7*/ 'type!{http://www.appian.com/ae/types/2009}Time',\n    /* 8*/ 'type!{http://www.appian.com/ae/types/2009}User',\n    /* 9*/ 'type!{http://www.appian.com/ae/types/2009}Group',\n    /*10*/ 'type!{http://www.appian.com/ae/types/2009}UserOrGroup',\n    /*11*/ 'type!{http://www.appian.com/ae/types/2009}Document',\n    /*12*/ 'type!{http://www.appian.com/ae/types/2009}Folder',\n  }\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180598": {
      "name": "CMGT_UTIL_returnSingleTypeObject",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!typeOf: if(\n    isnull(ri!type),\n    ri!typeOf,\n    cast(\n      ri!type,\n      {}\n    )\n  ),\n\n  index(\n    cast(\n      typeof({local!typeOf}), \n      updatearray({local!typeOf}, 1, {})\n    ), \n    1,\n    {}\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_33778": {
      "name": "CMGT_UTIL_SetRecordFields",
      "type": "Expression Rule",
      "sail_code": "/*\nFuture enhancement ideas:\n1 Parameter to skip update if the field isn't present in the object\n--- This would also apply to nested fields, as in, don't set a relationship field if the entire relationship object isn't there because it will instantiate it\n2 Parameter to overwrite based on more enhanced logic\n3 Allow list types for the `value`\n4 Allow reuse to apply setting metadata for nested relationships, but using their own set metadata rule\n--- e.g. CMGT_Entity_SetMetaData can be used in both the Case process and the individual Entity process\n*/\nif(\n  a!isNullOrEmpty(ri!record),\n  ri!record,\n  a!localVariables(\n    local!allUpdates: rule!CMGT_UTIL_RejectBlank(a!flatten(\n      {\n        ri!alwaysOverwrite,\n        ri!childRelationships,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!neverOverwrite,\n          expression: #\"urn:appian:function:v1:a:update\"(\n            fv!item,\n            \"value\",\n            /*Specifically using this instead of a!defaultValue() to account for the `{null}` value*/\n            if(\n              rule!CMGT_UTIL_IsBlank(ri!record[fv!item.field]),\n              fv!item.value,\n              ri!record[fv!item.field]\n            )\n          )\n        )\n      }\n    )),\n    local!onlyChangedUpdates: a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!allUpdates,\n        expression: if(\n          or(\n            tostring(ri!record[fv!item.field]) = tostring(fv!item.value),\n            toboolean(fv!item.applyWhen) = false\n          ),\n          {},\n          fv!item\n        )\n      )\n    ),\n    if(\n      a!isNullOrEmpty(local!onlyChangedUpdates),\n      ri!record,\n      #\"urn:appian:function:v1:a:update\"(\n        data: ri!record,\n        index: local!onlyChangedUpdates.field,\n        value: local!onlyChangedUpdates.value\n      )\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25890": {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "sail_code": "length(a!flatten(ri!value)) = 0"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_19509": {
      "name": "CMGT_QR_GetCase",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Case,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpression,\n  fields: {\n    ri!fields,\n    if(\n      ri!excludeRelatedRecords,\n      {},\n      {\n        recordType!CMGT_Case.status,\n        recordType!CMGT_Case.priority,\n        recordType!CMGT_Case.caseType\n      }\n    ),\n    if(\n      ri!includeAssignees,\n      {\n        recordType!CMGT_Case.roles,\n        recordType!CMGT_Case.roles\n      },\n      {}\n    ),\n    if(\n      ri!includePrimaryContact,\n      {\n        recordType!CMGT_Case.caseEntityMap,\n        #\"urn:appian:record-relationship:v1:d81cdd0e-c54d-4b8e-beec-b7ae37fefe7f/9455b8a8-142d-4976-8b8d-83403eedad6a/043457e2-ee0b-4c7a-8210-8671bbe73128/2a2b64c2-0530-4e0a-a173-d26a396e3cc9\"\n      },\n      {}\n    )\n  },\n  relatedRecordData: {\n    ri!relatedRecordData,\n    if(\n      ri!includePrimaryContact,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.caseEntityMap,\n        limit: 1,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_CaseEntityMap.entity.entityTypeId,\n          operator: \"=\",\n          value: cons!CMGT_REFID_ENTITY_TYPE_CONTACT\n        )\n      ),\n      {}\n    ),\n    if(\n      ri!includeAssignees,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.roles,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_Role.roleTypeId,\n          operator: \"in\",\n          value: {\n            cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n            cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE\n          }\n        )\n      ),\n      {}\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500665": {
      "name": "CMGT_UTIL_WhereContains",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer?list',\n  with(\n    local!array: a!flatten(ri!array),\n  \n    if(\n    \n      /*Have to handle separately for document types due to how it casts to string*/\n      rule!CMGT_UTIL_TypeCompare(\n        value1: local!array,\n        value2: {todocument(null)}\n      ),\n      wherecontains(\n        todocument(ri!values),\n        local!array\n      ),\n    \n      /*Have to handle separately for group types due to how it casts to string*/\n      rule!CMGT_UTIL_TypeCompare(\n        value1: local!array,\n        value2: {togroup(null)}\n      ),\n      wherecontains(\n        togroup(ri!values),\n        local!array\n      ),\n    \n      /*Casting to string accounts for any primitive type (integer, boolean, ect.)*/\n      wherecontains(\n        if(\n          rule!CMGT_UTIL_IsBlank(ri!values),\n          touniformstring(ri!values),\n          touniformstring(a!flatten(ri!values))\n        ),\n        touniformstring(local!array)\n      )\n    )\n  )\n)"
    },
    "_a-0000ed12-0330-8000-9d27-011c48011c48_3500657": {
      "name": "CMGT_UTIL_ChooseWhereContainsHelper",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Integer',\n  rule!CMGT_UTIL_ReplaceNull(\n    nullableValue: rule!CMGT_UTIL_WhereContains(values: ri!value, array: ri!inArray) + 1,\n    replacementValue: 1\n  )\n)"
    },
    "_a-0000ed24-7935-8000-9d2d-011c48011c48_3532252": {
      "name": "CMGT_WFL_QE_GetCaseTypeTaskWorkflowPath",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryEntity(\n  entity: cons!CMGT_WFL_ENT_CASE_TYPE_TASK_WORKFLOW_PATH,\n  entityType: 'type!{urn:com:appian:types:CMGT_WFL}CMGT_WFL_CFG_CaseTypeTaskWorkflowPath',\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"caseTypeTaskWorkflowPathId\",\n      operator: \"in\",\n      value: ri!caseTypeTaskWorkflowPathId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"isActive\",\n      operator: \"=\",\n      value: ri!isActive\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: \"caseTypeUuid\",\n      operator: \"=\",\n      value: ri!caseTypeUuid\n    ),\n    ri!additionalFilters\n  },\n  logicalExpression: ri!additionalLogicalExpression,\n  returnType: a!defaultValue(\n    ri!returnType,\n    cons!CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n  ),\n  pagingInfo: if(\n    ri!returnType <> cons!CMGT_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    null,\n    a!defaultValue(\n      ri!pagingInfo,\n      #\"SYSTEM_SYSRULES_pagingInfo\"(1, cons!CMGT_INT_BATCH_SIZE_MEDIUM)\n    )\n  ),\n  excludeNestedCdts: ri!excludeNestedCdts,\n  sort: ri!sort,\n  aggregation: ri!aggregation,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh\n)"
    }
  }
}
{
  "_metadata": {
    "bundle_id": "CMGT_EML_TRI_SitePage_Triage"
  },
  "objects": {
    "_a-0000ecbe-e702-8000-9cf8-011c48011c48_3242655": {
      "name": "CMGT_EML_TRI_QPA_GetMigrateBatchEmailsReport",
      "type": "Expression Rule",
      "sail_code": "a!queryProcessAnalytics(\n  report: cons!CMGT_EML_TRI_RPT_INGEST_EMAIL,\n  contextProcessModels: ri!contextProcessModel,\n  query: #\"SYSTEM_SYSRULES_query\"(\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 100,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(field: \"c2\", ascending: false)\n    ),\n    logicalExpression: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n      operator: \"AND\",\n      filters: {\n        /*check if the sub process is trigerred by the mentioned parent process*/\n        if(\n          ri!excludeParentProcess,\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: \"c3\",\n          operator: \"<>\",\n          value: ri!parentProcessId,\n          applyWhen: a!isNotNullOrEmpty(ri!parentProcessId)\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: \"c5\",\n          operator: \"=\",\n          value: ri!parentProcessId\n        )\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(field: \"c2\", operator: \"<\", value: now()),\n        /*check if the subprocess is completed*/\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: \"c1\",\n          operator: \"in\",\n          value: wherecontains(\n            ri!status,\n            {\n              \"ACTIVE\",\n              \"COMPLETED\",\n              \"PAUSED\",\n              \"CANCELLED\",\n              \"PAUSED_BY_EXCEPTION\"\n            }\n          ) - 1,\n          applyWhen: rule!CMGT_UTIL_IsNotBlank(input: ri!status)\n        )\n      }\n    )\n  )\n).data"
    },
    "_a-0000ea01-8773-8000-9bde-011c48011c48_356157": {
      "name": "CMGT_UTIL_CardGroupHandler",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!maxPerRow: a!defaultValue(ri!maxPerRow, count(ri!cardLayouts)),\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: enumerate(\n      ceiling(\n        count(ri!cardLayouts) / local!maxPerRow,\n        1\n      )\n    ),\n    expression: a!localVariables(\n      local!rowIndex: fv!index,\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        marginBelow: ri!marginBelow,\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            showWhen: contains({ \"RIGHT\", \"CENTER\" }, ri!align)\n          ),\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: enumerate(local!maxPerRow),\n            expression: a!localVariables(\n              local!adjustedIndex: (local!rowIndex - 1) * local!maxPerRow + fv!index,\n              local!cardLayout: a!refreshVariable(\n                value: index(ri!cardLayouts, local!adjustedIndex, {}),\n                refreshAlways: true\n              ),\n              #\"SYSTEM_SYSRULES_columnLayout\"(\n                width: ri!columnWidth,\n                contents: local!cardLayout\n              )\n            )\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            showWhen: contains({ \"LEFT\", \"CENTER\" }, ri!align)\n          )\n        },\n        stackWhen: ri!stackWhen,\n        spacing: a!defaultValue(ri!spacing,\"DENSE\")\n      )\n    )\n  )\n)"
    },
    "_a-0000e99c-1217-8000-9ba9-011c48011c48_58807": {
      "name": "CMGT_UTIL_TruncateText",
      "type": "Expression Rule",
      "sail_code": "if(\n  or(isnull(ri!text), isnull(ri!maxLength)),\n  ri!text,\n  if(\n    len(ri!text) > ri!maxLength,\n    left(\n      ri!text,\n      max(\n        search(\" \", ri!text, ri!maxLength + 1) - 1,\n        ri!maxLength\n      )\n    ) & \"...\",\n    ri!text\n  )\n)"
    },
    "_a-0000ec87-8877-8000-9ce8-011c48011c48_3013769": {
      "name": "CMGT_EML_TRI_EmailListPane",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!allRecipients: rule!CMGT_UTIL_Distinct(\n    touniformstring(\n      ri!availableThreads.data[recordType!CMGT_EML_TRI_Thread.originalSender.recipient]\n    )\n  ),\n  local!recipientsUserRecords: rule!CMGT_QR_GetUser(username: local!allRecipients),\n  {\n    /*expanded pane view*/\n    #\"SYSTEM_SYSRULES_columnsLayout\"(\n      columns: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_cardLayout\"(\n              contents: {\n                #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                  items: {\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        value: {\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: {\n                              #\"urn:appian:translation-string:v1:af19991d-7910-4e8f-acda-17ac9e6ba401\"(\n                                #\"urn:appian:translation-variable:v1:5fce0dc8-edec-429b-b284-25c90868c7ab\": a!defaultValue(ri!availableThreads.totalCount, 0)\n                              )\n                            },\n                            size: \"MEDIUM\",\n                            color: ri!brandingMap.SecondaryTextColor,\n                            style: \"STRONG\"\n                          )\n                        },\n                        marginBelow: \"NONE\"\n                      )\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      /*Call compose action here*/\n                      item: #\"SYSTEM_SYSRULES_recordActionField_v1\"(\n                        actions: #\"SYSTEM_SYSRULES_recordActionItem\"(\n                          action: #\"urn:appian:record-action:v1:d81cdd0e-c54d-4b8e-beec-b7ae37fefe7f/7ffab74c-2945-4eba-839d-ee44fae211ba\",\n                          identifier: ri!caseId\n                        ),\n                        display: \"LABEL_AND_ICON\",\n                        style: \"TOOLBAR_PRIMARY\",\n                        showWhen: a!isNotNullOrEmpty(ri!caseId),\n                        align: \"END\"\n                      )\n                    )\n                  }\n                )\n              },\n              height: \"AUTO\",\n              style: \"TRANSPARENT\",\n              padding: \"LESS\",\n              marginBelow: \"NONE\",\n              showBorder: false\n            )\n          },\n          width: \"AUTO\"\n        ),\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_cardLayout\"(\n              contents: {\n                #\"SYSTEM_SYSRULES_cardLayout\"(\n                  contents: {\n                    #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                      labelPosition: \"COLLAPSED\",\n                      value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n                        icon: \"angle-left\",\n                        caption: #\"urn:appian:translation-string:v1:8e0b249d-1b07-4a10-b4a7-024b97c4900d\"(\n                          #\"urn:appian:translation-variable:v1:d2825f6c-303a-4270-bda0-59bb9b1dc960\": #\"urn:appian:translation-string:v1:297cf25d-abb6-4d91-b9ed-ab0139f56398\"\n                        ),\n                        link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                          value: true,\n                          saveInto: ri!isEmailPaneCollapsed\n                        ),\n                        linkStyle: \"STANDALONE\",\n                        color: ri!brandingMap.InfoTextColor,\n                        size: \"MEDIUM\"\n                      ),\n                      align: \"CENTER\",\n                      marginAbove: \"NONE\",\n                      marginBelow: \"NONE\"\n                    )\n                  },\n                  style: ri!brandingMap.InfoBackgroundColor,\n                  shape: \"SEMI_ROUNDED\",\n                  padding: \"EVEN_LESS\",\n                  marginAbove: \"NONE\",\n                  marginBelow: \"NONE\",\n                  showBorder: false\n                )\n              },\n              style: \"TRANSPARENT\",\n              shape: ri!brandingMap.cardShape,\n              padding: \"LESS\",\n              marginBelow: \"NONE\",\n              showBorder: false\n            )\n          },\n          width: \"EXTRA_NARROW\",\n          showWhen: a!defaultValue(ri!showEmailPaneCollapsible, true)\n        )\n      },\n      alignVertical: \"MIDDLE\",\n      showWhen: not(ri!isEmailPaneCollapsed),\n      marginAbove: \"STANDARD\",\n      marginBelow: \"NONE\",\n      stackWhen: \"NEVER\"\n    ),\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_textField\"(\n          placeholder: #\"urn:appian:translation-string:v1:73f69162-de73-4a56-b768-844aae60dadd\",\n          value: ri!searchTerm,\n          saveInto: a!save(ri!searchTerm, trim(save!value))\n        ),\n        if(\n          rule!CMGT_UTIL_IsBlank(ri!availableThreads.data),\n          #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n            value: {\n              #\"SYSTEM_SYSRULES_richTextIcon\"(\n                icon: \"box-open\",\n                color: ri!brandingMap.SecondaryTextColor,\n                size: \"LARGE_PLUS\"\n              ),\n              char(10),\n              #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                text: #\"urn:appian:translation-string:v1:3584e785-51af-4007-9127-3dd419ef7cac\"\n              )\n            },\n            align: \"CENTER\",\n            marginAbove: \"STANDARD\"\n          ),\n          {\n            a!localVariables(\n              /*Querying for the latest message for each thread once at the top and passing them inside the loop*/\n              local!messages: rule!CMGT_EML_TRI_QR_getMessages(\n                returnType: \"OBJECT_ARRAY\",\n                messageIds: ri!availableThreads.data[recordType!CMGT_EML_TRI_Thread.latestMessageId],\n                triggerRefresh: ri!triggerRefresh,\n                fields: recordType!CMGT_EML_TRI_Message.messageRecipients\n              ),\n              #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!availableThreads.data,\n                expression: rule!CMGT_EML_TRI_SingleEmailThreadSummary(\n                  thread: fv!item,\n                  selectedThread: ri!selectedThread,\n                  brandingMap: ri!brandingMap,\n                  messages: local!messages,\n                  isShowMore: ri!isShowMore,\n                  selectedOption: ri!selectedOption,\n                  showDivider: if(fv!isLast, false, true),\n                  recipientUserRecords: local!recipientsUserRecords\n                )\n              )\n            ),\n            #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n              contents: rule!CMGT_UTIL_CustomPaging(\n                pagingInfo: ri!pagingInfo,\n                totalCount: ri!availableThreads.totalCount,\n                size: \"MEDIUM\",\n                brandingMap: ri!brandingMap\n              ),\n              showWhen: and(\n                a!isNotNullOrEmpty(ri!availableThreads.data),\n                ri!availableThreads.totalCount > 15\n              ),\n              marginAbove: \"STANDARD\",\n              marginBelow: \"LESS\"\n            )\n          }\n        )\n      },\n      showWhen: not(ri!isEmailPaneCollapsed),\n      padding: \"LESS\",\n      showBorder: false\n    ),\n    /*collapsed pane view*/\n    #\"SYSTEM_SYSRULES_columnsLayout\"(\n      columns: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_cardLayout\"(\n              contents: {\n                #\"SYSTEM_SYSRULES_cardLayout\"(\n                  contents: {\n                    #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                      labelPosition: \"COLLAPSED\",\n                      value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n                        icon: \"angle-right\",\n                        caption: #\"urn:appian:translation-string:v1:28bf48e8-a1e3-422f-ab81-1e5010cb8a09\"(\n                          #\"urn:appian:translation-variable:v1:422b4f72-686e-4e56-9249-d6a31670e8b3\": #\"urn:appian:translation-string:v1:297cf25d-abb6-4d91-b9ed-ab0139f56398\"\n                        ),\n                        link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                          value: false,\n                          saveInto: ri!isEmailPaneCollapsed\n                        ),\n                        linkStyle: \"STANDALONE\",\n                        color: ri!brandingMap.InfoTextColor,\n                        size: \"MEDIUM\"\n                      ),\n                      align: \"CENTER\",\n                      marginAbove: \"NONE\",\n                      marginBelow: \"NONE\"\n                    )\n                  },\n                  style: ri!brandingMap.TertiaryBackgroundColor,\n                  shape: ri!brandingMap.cardShape,\n                  padding: \"EVEN_LESS\",\n                  marginAbove: \"NONE\",\n                  marginBelow: \"NONE\",\n                  showBorder: false\n                )\n              },\n              style: \"TRANSPARENT\",\n              padding: \"LESS\",\n              marginBelow: \"NONE\",\n              showBorder: false\n            )\n          },\n          width: \"EXTRA_NARROW\"\n        )\n      },\n      showWhen: ri!isEmailPaneCollapsed,\n      marginBelow: \"STANDARD\",\n      spacing: \"NONE\",\n      stackWhen: \"NEVER\"\n    ),\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: #\"urn:appian:translation-string:v1:297cf25d-abb6-4d91-b9ed-ab0139f56398\",\n              color: ri!brandingMap.SecondaryTextColor\n            )\n          },\n          align: \"CENTER\"\n        )\n      },\n      showWhen: ri!isEmailPaneCollapsed,\n      shape: \"SEMI_ROUNDED\",\n      padding: \"EVEN_LESS\",\n      marginBelow: \"STANDARD\",\n      showBorder: false\n    )\n  }\n)"
    },
    "_a-0000ecac-72b0-8000-9cf2-011c48011c48_3150828": {
      "name": "CMGT_EML_TRI_ReplyToEmail",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!metrics,\n  local!replyTo: null,\n  #\"SYSTEM_SYSRULES_columnsLayout\"(\n    columns: {\n      /*User Initial*/\n      #\"SYSTEM_SYSRULES_columnLayout\"(\n        contents: rule!CMGT_EML_TRI_UTIL_DisplayUserPhotoOrInitials(\n          brandingMap: ri!brandingMap,\n          userName: ri!loggedInUser,\n          size: \"TINY\",\n          userRecord: rule!CMGT_QR_GetUser(\n            username: ri!loggedInUser,\n            returnType: \"SINGLE_OBJECT\"\n          )\n        ),\n        width: \"EXTRA_NARROW\",\n\n      ),\n      #\"SYSTEM_SYSRULES_columnLayout\"(\n        contents: {\n          #\"SYSTEM_SYSRULES_cardLayout\"(\n            contents: {\n              /*display the reply to details*/\n              #\"SYSTEM_SYSRULES_multipleDropdownField_v1\"(\n                label: #\"urn:appian:translation-string:v1:e8e8e2ac-0d9b-460b-af8f-c1a3bdc29dc8\",\n                labelPosition: \"ABOVE\",\n                placeholder: #\"urn:appian:translation-string:v1:a08241db-5f3a-4401-aaa0-ec10c03167c1\",\n                choiceLabels:ri!messageRecipients,\n                choiceValues: ri!messageRecipients,\n                value: rule!CMGT_UTIL_Filter(\n                  records: ri!message[recordType!CMGT_EML_TRI_Message.messageRecipients],\n                  field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n                  value: false\n                )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail],\n                saveInto: a!save(\n                  ri!message,\n                  rule!CMGT_EML_TRI_ConstructMessageRecipientsForCompose(\n                    message: ri!message,\n                    emailAddresses: save!value,\n                    loggedInUser: ri!loggedInUser\n                  )\n                ),\n                required: true\n              ),\n              /*Email section*/\n              rule!CMGT_UTIL_RichTextField(\n                value: ri!message[recordType!CMGT_EML_TRI_Message.messageText.message],\n                additionalSaves: a!save(\n                  ri!message[recordType!CMGT_EML_TRI_Message.messageText.plainTextMessage],\n                  trim(\n                    /*to remove extra spaces from email body*/fn!substitute(\n                      rule!CMGT_UTIL_StripHtmlTags(value: save!value, isFormatted: false),\n                      fn!char(10),\n                      \" \"\n                    )\n                  )\n                )\n              ),\n              /*Display info message*/\n              #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                labelPosition: \"COLLAPSED\",\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextIcon\"(\n                    icon: \"info-circle\",\n                    color: ri!brandingMap.TaskStatusReadyAccentColor\n                  ),\n                  char(32),\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: #\"urn:appian:translation-string:v1:22fce3c1-8d65-4efb-9d72-8cf82c09899b\",\n\n                  )\n\n                },\n                marginAbove: \"LESS\"\n              ),\n\n              #\"SYSTEM_SYSRULES_ButtonLayout\"(\n                primaryButtons: {\n                  #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n                    label: #\"urn:appian:translation-string:v1:9d852b05-3c66-460f-9f70-57695e5f84ac\",\n                    style: \"LINK\",\n                    saveInto: {\n                      /* Resetting message*/\n                      a!save(\n                        ri!message,\n                        recordType!CMGT_EML_TRI_Message(\n                          recordType!CMGT_EML_TRI_Message.threadId: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n                          recordType!CMGT_EML_TRI_Message.messageText: {}\n                        )\n                      ),\n                      a!save(local!replyTo, null),\n                      a!save(ri!messageRecipients, null),\n                      a!save(ri!action, null),\n                      /*once the cancel button is clicked, this reply section should not be displayed.*/\n                      a!save(ri!showWhen, false())\n                    },\n                    submit: true,\n                    validate: false\n                  ),\n                  #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n                    label: #\"urn:appian:translation-string:v1:6ad438fc-fc46-40e7-9eb3-200071808fc1\",\n                    saveInto: {\n                      a!save(\n                        local!metrics,\n                        rule!CMGT_EML_TRI_MTR_ReplytoEmail()\n                      ),\n                      #\"SYSTEM_SYSRULES_startProcess3\"(\n                        processModel: cons!CMGT_EML_TRI_PM_SEND_REPLY,\n                        processParameters: { message: ri!message, thread: ri!thread },\n                        onSuccess: {\n                          /* Resetting message*/\n                          a!save(\n                            ri!message,\n                            recordType!CMGT_EML_TRI_Message(\n                              recordType!CMGT_EML_TRI_Message.threadId: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n                              recordType!CMGT_EML_TRI_Message.messageText: {}\n                            )\n                          ),\n                          a!save(local!replyTo, null),\n                          a!save(ri!messageRecipients, null),\n                          a!save(ri!triggerRefresh, now()),\n                          a!save(ri!action, null),\n                          /*once the send button is clicked, this reply section should not be displayed.*/\n                          a!save(ri!showWhen, false()),\n\n                        }\n                      )\n                    },\n                    submit: true,\n                    style: \"SOLID\",\n                    validate: true,\n                    disabled: or(\n                      a!isNullOrEmpty(\n                        ri!message[recordType!CMGT_EML_TRI_Message.messageText.message]\n                      ),\n                      rule!CMGT_UTIL_IsBlank(\n                        rule!CMGT_UTIL_Filter(\n                          records: ri!message[recordType!CMGT_EML_TRI_Message.messageRecipients],\n                          field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n                          value: false\n                        )\n                      )\n                    )\n                  )\n                }\n              )\n            },\n            style: ri!brandingMap.TertiaryBackgroundColor,\n            shape: ri!brandingMap.CardShape,\n            padding: \"LESS\",\n            showBorder: ri!brandingMap.CardShowBorder\n          )\n        },\n        width: \"10X\"\n      )\n    },\n    alignVertical: \"TOP\",\n    marginBelow: \"STANDARD\",\n    spacing: \"NONE\",\n    stackWhen: { \"NEVER\" },\n    showWhen: ri!showWhen\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25890": {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "sail_code": "length(a!flatten(ri!value)) = 0"
    },
    "_a-0000e882-ff68-8000-9bb2-011c48011c48_34992-cmgt_eml_tri": {
      "name": "CMGT_EML_TRI_QR_getMessages",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_EML_TRI_Message,\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.threadId,\n      operator: \"in\",\n      value: ri!threadIds,\n      applywhen: rule!CMGT_UTIL_IsNotBlank(ri!threadIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.createdBy,\n      operator: \"includes\",\n      value: ri!createdBy,\n      applywhen: rule!CMGT_UTIL_IsNotBlank(ri!createdBy)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.messageId,\n      operator: \"in\",\n      value: ri!messageIds,\n      applywhen: rule!CMGT_UTIL_IsNotBlank(ri!messageIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.messageId,\n      operator: \"not in\",\n      value: ri!excludeMessageIds,\n      applywhen: rule!CMGT_UTIL_IsNotBlank(ri!excludeMessageIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.messageRecipients.recipient,\n      operator: \"in\",\n      value: ri!recipients\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Message.isActive,\n      operator: \"in\",\n      value: { a!defaultValue(ri!isActive, true) }\n    ),\n    ri!additionalFilters\n  },\n  logicalExpressions: { ri!additionalLogicalExpressions },\n  fields: {\n    ri!fields,\n    recordType!CMGT_EML_TRI_Message.messageText\n  },\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  sort: ri!sort,\n  pagingInfo: ri!pagingInfo,\n  relatedRecordData: ri!relatedRecordData,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000e87b-f03a-8000-9bac-011c48011c48_31514-cmgt_eml_tri": {
      "name": "CMGT_EML_TRI_QR_GetMessageRecipients",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_EML_TRI_MessageRecipient,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    ri!additionalFilter,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_MessageRecipient.message.threadId,\n      operator: \"in\",\n      value: ri!threadIds\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_MessageRecipient.messageId,\n      operator: \"in\",\n      value: ri!messageIds\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_MessageRecipient.recipient,\n      operator: \"in\",\n      value: ri!recipients\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_MessageRecipient.recipient,\n      operator: \"not in\",\n      value: ri!recipientsToIgnore\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_MessageRecipient.message.isActive,\n      operator: \"in\",\n      value: { a!defaultValue(ri!isActive, true) }\n    ),\n    \n  },\n  logicalExpressions: { ri!additionalLogicalExpressions },\n  fields: ri!fields,\n  relatedRecordData: ri!relatedRecordData,\n  sort: ri!sort,\n  pagingInfo: ri!pagingInfo,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ee5e-30bb-8000-9d99-011c48011c48_4591307": {
      "name": "CMGT_EML_TRI_ReplyToEmail_Recipients_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Get the sender*/\n  local!sender: rule!CMGT_UTIL_Filter(\n    records: ri!latestMessageRecipients,\n    field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n    value: true\n  ),\n  /*Get all recipients of latest message excluding system main box*/\n  local!latestMessageRecipients: rule!CMGT_UTIL_Filter(\n    records: ri!latestMessageRecipients,\n    field: recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail,\n    value: cons!CMGT_EML_TRI_MAILBOX_EMAIL_ADDRESS,\n    filterType: \"REJECT\"\n  ),\n  if(\n    ri!action = \"REPLY\",\n    /*If the latest sender if from system, then reply to will be first recipient else the latest sender*/\n    if(\n      local!sender[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail] = cons!CMGT_EML_TRI_MAILBOX_EMAIL_ADDRESS,\n      index(\n        rule!CMGT_UTIL_Filter(\n          records: local!latestMessageRecipients,\n          field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n          value: false\n        ),\n        1,\n        null\n      ),\n      local!sender\n    ),\n    /*For reply all fetch all the recipients of the latest message excluding system mailbox*/\n    local!latestMessageRecipients\n  )\n)"
    },
    "_a-0000ec90-c257-8000-9cea-011c48011c48_3032894": {
      "name": "CMGT_EML_TRI_SingleEmailThreadSummary",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  /*true() if the thread is selected*/\n  local!isSelected: if(\n    a!isNotNullOrEmpty(ri!selectedThread),\n    ri!selectedThread[recordType!CMGT_EML_TRI_Thread.threadId] = ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n    false\n  ),\n  local!message: rule!CMGT_UTIL_TruncateText(\n    text: rule!CMGT_UTIL_Filter(\n      records: ri!messages,\n      field: recordType!CMGT_EML_TRI_Message.threadId,\n      value: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId]\n    )[recordType!CMGT_EML_TRI_Message.messageText.plainTextMessage],\n    maxLength: 40\n  ),\n  {\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n          items: {\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              /*sender's icon/initials */\n              item: rule!CMGT_EML_TRI_UTIL_DisplayUserPhotoOrInitials(\n                brandingMap: ri!brandingMap,\n                userName: ri!thread[recordType!CMGT_EML_TRI_Thread.originalSender.recipient],\n                stampBackgroundColor: ri!brandingMap.SecondaryTextColor,\n                stampContentColor: ri!brandingMap.WhiteColor,\n                userRecord: rule!CMGT_UTIL_Filter(\n                  records: ri!recipientUserRecords,\n                  field: #\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_username\",\n                  value: ri!thread[recordType!CMGT_EML_TRI_Thread.originalSender.recipient]\n                )\n              ),\n              width: \"MINIMIZE\"\n            ),\n            /*sender's full name */\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                labelPosition: \"COLLAPSED\",\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: rule!CMGT_UTIL_DisplayUser(\n                      user: ri!thread[recordType!CMGT_EML_TRI_Thread.originalSender.recipient]\n                    )\n                  )\n                }\n              )\n            ),\n            /*warning indicating the thread is locked */\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                labelPosition: \"COLLAPSED\",\n                value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"user-lock\",\n                  color: ri!brandingMap.TaskStatusInProgressAccentColor,\n                  size: \"MEDIUM_PLUS\"\n                ),\n                align: \"LEFT\"\n              ),\n              width: \"MINIMIZE\",\n              showWhen: and(\n                ri!thread[recordType!CMGT_EML_TRI_Thread.threadStatus] = cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS,\n                ri!thread[recordType!CMGT_EML_TRI_Thread.owner] <> loggedInUser()\n              )\n            )\n          },\n          alignVertical: \"MIDDLE\"\n        ),\n        /*thread subject*/\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: ri!thread[recordType!CMGT_EML_TRI_Thread.subject],\n            size: \"STANDARD\",\n            style: \"STRONG\"\n          ),\n          preventWrapping: true,\n          marginBelow: \"NONE\"\n        ),\n        /*thread's latest message*/\n        rule!CMGT_UTIL_RichTextField(value: local!message, readOnly: true),\n        #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n          items: {\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              /*latest message sent date and time*/\n              item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: rule!CMGT_UTIL_FormatDateTime(\n                      dateTime: ri!thread[recordType!CMGT_EML_TRI_Thread.latestMessageSentDateTime],\n                      includeTime: true()\n                    ),\n                    color: ri!brandingMap.SecondaryTextColor,\n                    size: \"STANDARD\"\n                  )\n                }\n              )\n            ),\n            /*number of attachments and messages in thread*/\n            #\"SYSTEM_SYSRULES_sideBySideItem\"(\n              item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                labelPosition: \"COLLAPSED\",\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextIcon\"(\n                    icon: \"paperclip\",\n                    altText: #\"urn:appian:translation-string:v1:55e01f23-be46-4797-bbbc-4c0ea3062e55\",\n                    color: ri!brandingMap.SecondaryTextColor,\n                    size: \"MEDIUM\"\n                  ),\n                  char(32),\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: ri!thread[recordType!CMGT_EML_TRI_Thread.numAttachments],\n                    color: ri!brandingMap.SecondaryTextColor,\n                    size: \"STANDARD\"\n                  ),\n                  char(32),\n                  char(32),\n                  char(32),\n                  char(32),\n                  #\"SYSTEM_SYSRULES_richTextIcon\"(\n                    icon: \"comments-o\",\n                    altText: #\"urn:appian:translation-string:v1:f24547fc-ca3e-45f6-ba18-df75c6cbf428\",\n                    color: ri!brandingMap.SecondaryTextColor,\n                    size: \"STANDARD\"\n                  ),\n                  char(32),\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: ri!thread[recordType!CMGT_EML_TRI_Thread.numMessages],\n                    color: ri!brandingMap.SecondaryTextColor\n                  )\n                },\n                align: \"LEFT\"\n              ),\n              width: \"MINIMIZE\"\n            )\n          },\n          alignVertical: \"MIDDLE\"\n        )\n      },\n      /*saves the current thread as selected thread if the user clicks the card*/\n      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n        saveInto: {\n          a!save(ri!selectedThread, ri!thread),\n          a!save(ri!isShowMore, false()),\n          a!save(ri!selectedOption, null())\n        }\n      ),\n      style: if(\n        local!isSelected,\n        ri!brandingMap.ConfigBackgroundColor,\n        \"NONE\"\n      ),\n      padding: \"LESS\",\n      marginAbove: \"NONE\",\n      marginBelow: \"LESS\",\n      showBorder: false(),\n      decorativeBarPosition: if(local!isSelected, \"START\", \"NONE\"),\n      decorativeBarColor: \"ACCENT\",\n      accessibilityText: if(\n        local!isSelected,\n        #\"urn:appian:translation-string:v1:a514ed92-a868-46ef-a466-46b4d72bc8d8\",\n        null()\n      )\n    ),\n    #\"SYSTEM_SYSRULES_horizontalLine\"(\n      marginAbove: \"EVEN_LESS\",\n      marginBelow: \"EVEN_LESS\",\n      showWhen: ri!showDivider\n    )\n  }\n)"
    },
    "_a-0000e9ae-873e-8000-9baf-011c48011c48_97439": {
      "name": "CMGT_QR_GetUser",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: #\"urn:appian:record-type:v1:SYSTEM_RECORD_TYPE_USER\",\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: #\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_username\",\n      operator: \"in\",\n      value: ri!username\n    )\n  },\n  fields: ri!fields,\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  triggerRefresh: ri!triggerRefresh,\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ec90-c257-8000-9cea-011c48011c48_3042876": {
      "name": "CMGT_EML_TRI_UTIL_DisplayUserPhotoOrInitials",
      "type": "Interface",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!userName),\n  {},\n  if(\n    /*Is a valid appian user*/\n    rule!CMGT_UTIL_IsNotBlank(ri!userRecord),\n    #\"SYSTEM_SYSRULES_imageField_v1\"(\n      labelPosition: \"COLLAPSED\",\n      images: #\"SYSTEM_SYSRULES_userImage\"(user: ri!userName),\n      size: a!defaultValue(value: ri!size, default: \"ICON\"),\n      style: \"AVATAR\"\n    ),\n    #\"SYSTEM_SYSRULES_stampField\"(\n      label: #\"urn:appian:translation-string:v1:740cff3b-6016-4d70-ae95-e8ed22572860\",\n      labelPosition: \"COLLAPSED\",\n      text: concat(\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: split(ri!userName, \" \"),\n          expression: upper(left(fv!item, 1))\n        )\n      ),\n      backgroundColor: a!defaultValue(\n        ri!stampBackgroundColor,\n        ri!brandingMap.StandardStampBackgroundColor\n      ),\n      contentColor: a!defaultValue(\n        ri!stampContentColor,\n        ri!brandingMap.StandardStampContentColor\n      ),\n      size: a!defaultValue(value: ri!size, default: \"TINY\")\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180568": {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "sail_code": "not(rule!CMGT_UTIL_IsBlank(ri!input))"
    },
    "_a-0000ec90-c257-8000-9cea-011c48011c48_3041407": {
      "name": "CMGT_EML_TRI_Document_Sub_DocumentCard",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_cardLayout\"(\n  contents: {\n    #\"SYSTEM_SYSRULES_columnsLayout\"(\n      columns: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n            label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(testingLabel: \"Document icon\"),\n            labelPosition: \"COLLAPSED\",\n            value: {\n              #\"SYSTEM_SYSRULES_richTextIcon\"(\n                icon: ri!attachment[recordType!CMGT_EML_TRI_Attachment.extensionIcon],\n                size: \"MEDIUM_PLUS\",\n                color: rule!CMGT_Document_IconColorLogic(\n                  documentExtension: ri!attachment[#\"urn:appian:record-field:v1:ca01ca7e-1df0-49cc-b45a-25788b78d2b1-cmgt_eml_tri/3511349f-6e15-4c01-a2b4-3927b3d8debf/SYSTEM_RECORD_TYPE_DOCUMENT_FIELD_extension\"],\n                  brandingMap: ri!brandingMap\n                )\n              )\n            },\n            marginBelow: \"NONE\"\n          ),\n          width: \"AUTO\",\n\n        ),\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(testingLabel: \"Document Details\"),\n              labelPosition: \"COLLAPSED\",\n              value: {\n                /*document name*/\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: ri!attachment[recordType!CMGT_EML_TRI_Attachment.fullName],\n                  color: ri!brandingMap.StandardTextColor,\n                  style: \"STRONG\",\n                  linkStyle: \"STANDALONE\",\n                  size: \"STANDARD\"\n                ),\n                char(10),\n                /*size*/\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: {\n                    concat(\n                      ri!attachment[recordType!CMGT_EML_TRI_Attachment.sizeInKb],\n                      \" KB\"\n                    )\n                  },\n                  color: ri!brandingMap.SecondaryTextColor,\n                  size: \"SMALL\"\n                ),\n\n              }\n            )\n          },\n          width: \"WIDE\"\n        )\n      },\n      spacing: \"NONE\",\n      stackWhen: \"NEVER\"\n    )\n  },\n  showWhen: a!isNotNullOrEmpty(\n    ri!attachment[recordType!CMGT_EML_TRI_Attachment.appianDocumentId]\n  ),\n  link: #\"SYSTEM_SYSRULES_documentDownloadLink\"(\n    document: ri!attachment[recordType!CMGT_EML_TRI_Attachment.appianDocumentId]\n  ),\n  shape: ri!brandingMap.CardShape,\n  showBorder: ri!brandingMap.CardShowBorder,\n  showShadow: ri!brandingMap.CardShowShadow,\n  padding: \"LESS\",\n  style: ri!brandingMap.CardBackgroundColor\n)"
    },
    "_a-0000eaf1-7a52-8000-9c42-011c48011c48_1227353": {
      "name": "CMGT_UTIL_StripHtmlTags",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!replacedText: substitute(\n    substitute(ri!value, \"<p>\", \"\"),\n    \"</p>\",\n    \"\"\n  ),\n  if(\n    ri!isFormatted,\n    /*The striphtml() will automatically substitue char(10) for <br>*/striphtml(local!replacedText),\n    striphtml(\n      substitute(local!replacedText, \"<br>\", \" \")\n    )\n  )\n)"
    },
    "_a-0000ee54-f700-8000-9d97-011c48011c48_4577698": {
      "name": "CMGT_EML_TRI_ConstructMessageRecipientsForCompose",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_SetRecordFields(\n  record: ri!message,\n  childRelationships: a!map(\n    field: recordType!CMGT_EML_TRI_Message.messageRecipients,\n    value: a!flatten(\n      {\n        /*message recipient entry for sender */\n        recordType!CMGT_EML_TRI_MessageRecipient(\n          recordType!CMGT_EML_TRI_MessageRecipient.recipient: concat(\n            user(ri!loggedInUser, \"firstName\"),\n            char(32),\n            user(ri!loggedInUser, \"lastName\")\n          ),\n          recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail: cons!CMGT_EML_TRI_MAILBOX_EMAIL_ADDRESS,\n          recordType!CMGT_EML_TRI_MessageRecipient.isSender: true\n        ),\n        /*message recipient entry for receiver*/\n        a!flatten(\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: rule!CMGT_UTIL_RejectBlank(\n              array: union(\n                ri!emailAddresses,\n                if(\n                  a!isNotNullOrEmpty(ri!caseAssociatedEmails),\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    ri!caseAssociatedEmails,\n                    index(split(fv!item, \"#\"), 2, null)\n                  ),\n                  null\n                )\n              )\n            ),\n            expression: recordType!CMGT_EML_TRI_MessageRecipient(\n              recordType!CMGT_EML_TRI_MessageRecipient.recipient: null(),\n              recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail: fv!item,\n              recordType!CMGT_EML_TRI_MessageRecipient.isSender: false\n            )\n          )\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000ee4b-bb3a-8000-9d95-011c48011c48_4547823": {
      "name": "CMGT_EML_TRI_SyncEmailButton",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_ButtonArrayLayout\"(\n  align: ri!align,\n  buttons: #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n    label: #\"urn:appian:translation-string:v1:d04f78a6-417b-4946-91e6-55c343475038\",\n    style: \"SOLID\",\n    value: true,\n    icon: \"refresh\",\n    disabled: ri!processRunningInfo.isProcessRunning,\n    saveInto: {\n      a!save(ri!bannerMessage, null),\n      if(\n        a!isNotNullOrEmpty(ri!manualSyncProcessId),\n        a!save(ri!manualSyncProcessId, null),\n        {}\n      ),\n      #\"SYSTEM_SYSRULES_startProcess3\"(\n        processModel: cons!CMGT_EML_TRI_PM_INGEST_MAIL_VIA_POLLER,\n        processParameters: a!map(),\n        isSynchronous: true,\n        onSuccess: {\n          a!save(\n            ri!bannerMessage,\n            fv!processInfo.pv.currentProcessInfo.errorStatus\n          ),\n          a!save(\n            ri!manualSyncProcessId,\n            fv!processInfo.pv.parentProcessId\n          ),\n          a!save(ri!triggerProcessRefresh, now()),\n          a!save(\n            ri!processRunningInfo,\n            fv!processInfo.pv.currentProcessInfo\n          ),\n\n        }\n      )\n    },\n\n  ),\n  marginBelow: \"EVEN_LESS\"\n)"
    },
    "_a-0000ea2f-ac11-8000-9bf4-011c48011c48_588925": {
      "name": "CMGT_UTIL_DisplayUserFullName",
      "type": "Expression Rule",
      "sail_code": "if(\n  and(a!isNotNullOrEmpty(ri!username), isusernametaken(ri!username)),\n  concat(\n    user(ri!username, \"firstName\"),\n    \" \",\n    user(ri!username, \"lastName\")\n  ),\n  ri!username\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145648": {
      "name": "CMGT_UTIL_GetSiteUrl",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!authedPath: cast(\n    'type!{http://www.appian.com/ae/types/2009}Text',\n    extract(linktodocument(0, \"doc\"), \"\"\"\", \"/doc/\")\n  ),\n  local!subdomainWithDomain: extract(local!authedPath, \"//\", \"/suite\")[1],\n  local!subdomain: split(local!subdomainWithDomain, \".\")[1],\n  a!map(\n    subdomain: local!subdomain,\n    authedPath: local!authedPath,\n    subdomainWithDomain: local!subdomainWithDomain\n  )\n)"
    },
    "_a-0000ec90-c257-8000-9cea-011c48011c48_3036616": {
      "name": "CMGT_EML_TRI_SingleEmailThreadDisplay",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!loggedInUser: loggedInUser(),\n  local!messageDataSubset: rule!CMGT_EML_TRI_QR_getMessages(\n    threadIds: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n    returnType: \"DATA_SUBSET\",\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 1000,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!CMGT_EML_TRI_Message.modifiedOn\n      )\n    ),\n    triggerRefresh: ri!triggerMessageRefresh\n  ),\n  local!totalCount: index(\n    local!messageDataSubset,\n    \"totalCount\",\n    null()\n  ),\n  local!messages: a!flatten(\n    index(local!messageDataSubset, \"data\", null())\n  ),\n  /*we want to check if the thread has been action before updating the record on clicking edit anyways*/\n  local!unlockThread: if(\n    rule!CMGT_EML_TRI_QR_GetThreads(\n      threadIds: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n      fields: recordType!CMGT_EML_TRI_Thread.threadStatus\n    )[recordType!CMGT_EML_TRI_Thread.threadStatus] <> cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS,\n    {},\n    recordType!CMGT_EML_TRI_Thread(\n      recordType!CMGT_EML_TRI_Thread.threadId: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n      recordType!CMGT_EML_TRI_Thread.owner: local!loggedInUser,\n      recordType!CMGT_EML_TRI_Thread.modifiedBy: local!loggedInUser,\n      recordType!CMGT_EML_TRI_Thread.modifiedOn: now()\n    )\n  ),\n  /*local to control the text shown in the banner*/\n  local!showTriagedTextInBanner: false,\n  local!isViewAllAttachments: #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!messages,\n    expression: a!map(\n      messageId: fv!item[recordType!CMGT_EML_TRI_Message.messageId],\n      viewAll: false()\n    )\n  ),\n  local!replyToMessage: recordType!CMGT_EML_TRI_Message(\n    recordType!CMGT_EML_TRI_Message.threadId: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId],\n    recordType!CMGT_EML_TRI_Message.messageText: {}\n  ),\n  local!allMessageRecipients: rule!CMGT_EML_TRI_QR_GetMessageRecipients(\n    returnType: \"OBJECT_ARRAY\",\n    messageIds: local!messages[recordType!CMGT_EML_TRI_Message.messageId],\n    sort: {\n      #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!CMGT_EML_TRI_MessageRecipient.messageId,\n        ascending: true()\n      )\n    }\n  ),\n  local!action,\n  local!messageRecipientsEmail: a!refreshVariable(\n    value: if(\n      rule!CMGT_UTIL_IsNotBlank(local!allMessageRecipients),\n      rule!CMGT_UTIL_Distinct(\n        rule!CMGT_UTIL_Filter(\n          records: local!allMessageRecipients,\n          field: recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail,\n          value: cons!CMGT_EML_TRI_MAILBOX_EMAIL_ADDRESS,\n          filterType: \"REJECT\"\n        )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n      ),\n      null\n    ),\n    refreshOnVarChange: local!action\n  ),\n  local!allSenders: rule!CMGT_UTIL_Distinct(\n    touniformstring(\n      rule!CMGT_UTIL_Filter(\n        records: local!allMessageRecipients,\n        field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n        value: true\n      )[recordType!CMGT_EML_TRI_MessageRecipient.recipient]\n    )\n  ),\n  local!sendersUserRecords: rule!CMGT_QR_GetUser(username: local!allSenders),\n  local!allMessageAttachments: rule!CMGT_EML_TRI_QR_GetMessageAttachments(\n    returnType: \"OBJECT_ARRAY\",\n    messageIds: tointeger(\n      local!messages[recordType!CMGT_EML_TRI_Message.messageId]\n    )\n  ),\n  local!firstMessage: ldrop(local!messages, local!totalCount - 1),\n  local!latestMessageRecipients: rule!CMGT_UTIL_Filter(\n    records: local!allMessageRecipients,\n    field: recordType!CMGT_EML_TRI_MessageRecipient.messageId,\n    value: index(\n      index(local!messages, 1, null),\n      recordType!CMGT_EML_TRI_Message.messageId,\n      null\n    )\n  ),\n  #\"SYSTEM_SYSRULES_cardLayout\"(\n    contents: {\n      #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n        items: {\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                text: ri!thread[recordType!CMGT_EML_TRI_Thread.subject],\n                color: \"STANDARD\",\n                size: \"MEDIUM_PLUS\",\n                style: \"STRONG\"\n              ),\n              marginBelow: \"STANDARD\"\n            )\n          ),\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: {\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"reply\",\n                  link: if(\n                    ri!isReplyThread,\n                    {},\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: {\n                        a!save(local!action, \"REPLY\"),\n                        a!save(\n                          local!replyToMessage,\n                          rule!CMGT_EML_TRI_ConstructMessageRecipientsForCompose(\n                            message: local!replyToMessage,\n                            loggedInUser: local!loggedInUser,\n                            emailAddresses: rule!CMGT_EML_TRI_ReplyToEmail_Recipients_Logic(\n                              action: local!action,\n                              latestMessageRecipients: local!latestMessageRecipients\n                            )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n                          )\n                        ),\n                        a!save(ri!isReplyThread, true)\n                      }\n                    )\n                  ),\n                  linkStyle: \"STANDALONE\",\n                  color: if(\n                    ri!isReplyThread,\n                    ri!brandingMap.DividerColor,\n                    ri!brandingMap.AccentColor\n                  ),\n                  size: \"STANDARD\"\n                ),\n                \" \",\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: #\"urn:appian:translation-string:v1:dbcd9b8e-eda9-47bf-8fca-4131e52103be\",\n                  link: if(\n                    ri!isReplyThread,\n                    {},\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: {\n                        a!save(local!action, \"REPLY\"),\n                        a!save(\n                          local!replyToMessage,\n                          rule!CMGT_EML_TRI_ConstructMessageRecipientsForCompose(\n                            message: local!replyToMessage,\n                            loggedInUser: local!loggedInUser,\n                            emailAddresses: rule!CMGT_EML_TRI_ReplyToEmail_Recipients_Logic(\n                              action: local!action,\n                              latestMessageRecipients: local!latestMessageRecipients\n                            )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n                          )\n                        ),\n                        a!save(ri!isReplyThread, true)\n                      }\n                    )\n                  ),\n                  linkStyle: \"STANDALONE\",\n                  color: if(\n                    ri!isReplyThread,\n                    ri!brandingMap.DividerColor,\n                    ri!brandingMap.AccentColor\n                  ),\n                  size: \"STANDARD\"\n                ),\n                \" \",\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"reply\",\n                  link: if(\n                    ri!isReplyThread,\n                    {},\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: {\n                        a!save(local!action, \"REPLY_ALL\"),\n                        a!save(\n                          local!replyToMessage,\n                          rule!CMGT_EML_TRI_ConstructMessageRecipientsForCompose(\n                            message: local!replyToMessage,\n                            loggedInUser: local!loggedInUser,\n                            emailAddresses: rule!CMGT_EML_TRI_ReplyToEmail_Recipients_Logic(\n                              action: local!action,\n                              latestMessageRecipients: local!latestMessageRecipients\n                            )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n                          )\n                        ),\n                        a!save(ri!isReplyThread, true)\n                      }\n                    )\n                  ),\n                  linkStyle: \"STANDALONE\",\n                  color: if(\n                    ri!isReplyThread,\n                    ri!brandingMap.DividerColor,\n                    ri!brandingMap.AccentColor\n                  ),\n                  size: \"STANDARD\"\n                ),\n                \" \",\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: #\"urn:appian:translation-string:v1:af42c477-aff6-43d3-b8fe-914460d7ad3f\",\n                  link: if(\n                    ri!isReplyThread,\n                    {},\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: {\n                        a!save(local!action, \"REPLY_ALL\"),\n                        a!save(\n                          local!replyToMessage,\n                          rule!CMGT_EML_TRI_ConstructMessageRecipientsForCompose(\n                            message: local!replyToMessage,\n                            loggedInUser: local!loggedInUser,\n                            emailAddresses: rule!CMGT_EML_TRI_ReplyToEmail_Recipients_Logic(\n                              action: local!action,\n                              latestMessageRecipients: local!latestMessageRecipients\n                            )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n                          )\n                        ),\n                        a!save(ri!isReplyThread, true)\n                      }\n                    )\n                  ),\n                  linkStyle: \"STANDALONE\",\n                  color: if(\n                    ri!isReplyThread,\n                    ri!brandingMap.DividerColor,\n                    ri!brandingMap.AccentColor\n                  ),\n                  size: \"STANDARD\"\n                )\n              },\n              align: \"RIGHT\",\n              marginBelow: \"STANDARD\"\n            )\n          )\n        },\n        /*Hide subject when ri!showOnlyMessages=true*/\n        showWhen: not(\n          a!defaultValue(ri!showOnlyMessages, false)\n        )\n      ),\n      /*Display locked thread details*/\n      #\"SYSTEM_SYSRULES_cardLayout\"(\n        contents: {\n          #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n            items: {\n              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                  value: {\n                    #\"SYSTEM_SYSRULES_richTextIcon\"(\n                      icon: \"exclamation-triangle\",\n                      color: ri!brandingMap.TaskStatusInProgressAccentColor\n                    ),\n                    char(32),\n                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: if(\n                        local!showTriagedTextInBanner,\n                        #\"urn:appian:translation-string:v1:8b22c831-e06b-4af3-b39c-8e2c629d465f\",\n                        #\"urn:appian:translation-string:v1:e357537a-cd28-49bc-807c-249b0729a99d\"(\n                          #\"urn:appian:translation-variable:v1:fa601a49-4872-4d66-94a5-8395f6174c72\": rule!CMGT_UTIL_DisplayUserFullName(\n                            username: ri!thread[recordType!CMGT_EML_TRI_Thread.owner]\n                          )\n                        )\n                      ),\n                      color: \"STANDARD\"\n                    )\n                  },\n                  marginBelow: \"EVEN_LESS\"\n                )\n              ),\n              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                  value: {\n                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: upper(\n                        #\"urn:appian:translation-string:v1:bf6b2db7-b962-4c94-966f-f5f0c1251552\"\n                      ),\n                      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                        saveInto: if(\n                          a!isNullOrEmpty(local!unlockThread),\n                          a!save(local!showTriagedTextInBanner, true),\n                          #\"SYSTEM_SYSRULES_writeRecords_v2\"(\n                            records: local!unlockThread,\n                            onSuccess: {\n                              a!save(ri!triggerThreadRefresh, now()),\n                              a!save(ri!unlockThread, true()),\n                              a!save(\n                                ri!thread,\n                                rule!CMGT_EML_TRI_QR_GetThreads(\n                                  threadIds: local!unlockThread[recordType!CMGT_EML_TRI_Thread.threadId]\n                                )\n                              )\n                            }\n                          )\n                        )\n                      ),\n                      linkStyle: \"STANDALONE\",\n                      style: \"PLAIN\"\n                    )\n                  },\n                  align: \"RIGHT\",\n                  marginBelow: \"NONE\"\n                ),\n                showWhen: not(local!showTriagedTextInBanner)\n              )\n            },\n            alignVertical: \"MIDDLE\"\n          )\n        },\n        showWhen: and(\n          ri!thread[recordType!CMGT_EML_TRI_Thread.threadStatus] = cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS,\n          ri!thread[recordType!CMGT_EML_TRI_Thread.owner] <> local!loggedInUser,\n          or(\n            a!isNullOrEmpty(ri!showOnlyMessages),\n            ri!showOnlyMessages = false\n          )\n        ),\n        style: ri!brandingMap.WarningBackgroundColor,\n        padding: \"LESS\",\n        marginBelow: \"STANDARD\",\n        showBorder: false\n      ),\n      /*list of triage actions if it is a triage screen*/\n      #\"SYSTEM_SYSRULES_recordActionField_v1\"(\n        actions: {\n          #\"SYSTEM_SYSRULES_recordActionItem\"(\n            action: #\"urn:appian:record-action:v1:53d3f93d-ccb6-423d-9238-2edf8811d08f-cmgt_eml_tri/c61346a9-f2c4-4647-a8e2-74d7f7d1dc2f\",\n            identifier: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId]\n          ),\n          #\"SYSTEM_SYSRULES_recordActionItem\"(\n            action: #\"urn:appian:record-action:v1:53d3f93d-ccb6-423d-9238-2edf8811d08f-cmgt_eml_tri/53ec188a-f722-4b82-8c43-f98eab560662\",\n            identifier: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId]\n          ),\n          #\"SYSTEM_SYSRULES_recordActionItem\"(\n            action: #\"urn:appian:record-action:v1:53d3f93d-ccb6-423d-9238-2edf8811d08f-cmgt_eml_tri/8f980dac-e980-4339-b41b-93bd87558052\",\n            identifier: ri!thread[recordType!CMGT_EML_TRI_Thread.threadId]\n          )\n        },\n        style: \"TOOLBAR\",\n        display: \"LABEL\",\n        openActionsIn: \"DIALOG\",\n        align: \"START\",\n        showWhen: and(\n          a!defaultValue(ri!showTriageActions, true),\n          or(\n            ri!thread[recordType!CMGT_EML_TRI_Thread.threadStatus] = cons!CMGT_EML_TRI_TRIAGE_STATUS_OPEN,\n            and(\n              ri!thread[recordType!CMGT_EML_TRI_Thread.threadStatus] = cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS,\n              ri!thread[recordType!CMGT_EML_TRI_Thread.owner] = local!loggedInUser\n            )\n          )\n        ),\n        securityOnDemand: false()\n      ),\n      /*Reply to Screen*/\n      rule!CMGT_EML_TRI_ReplyToEmail(\n        brandingMap: ri!brandingMap,\n        showWhen: ri!isReplyThread,\n        thread: ri!thread,\n        triggerRefresh: ri!triggerMessageRefresh,\n        message: local!replyToMessage,\n        messageRecipients: local!messageRecipientsEmail,\n        action: local!action,\n        loggedInUser: local!loggedInUser\n      ),\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: if(\n          and(\n            tointeger(local!totalCount) > 4,\n            ri!isShowMore <> true()\n          ),\n          rdrop(local!messages, local!totalCount - 3),\n          local!messages\n        ),\n        expression: {\n          rule!CMGT_EML_TRI_SingleMessageDisplay(\n            message: fv!item,\n            showDivider: fv!isLast <> true(),\n            brandingMap: ri!brandingMap,\n            showOnlyMessages: ri!showOnlyMessages,\n            isViewAllAttachments: local!isViewAllAttachments,\n            stackMessageMetadata: ri!stackMessageMetadata,\n            marginAbove: ri!marginAboveForSingleMessage,\n            marginBelow: ri!marginBelowForSingleMessage,\n            messageRecipients: rule!CMGT_UTIL_Filter(\n              records: local!allMessageRecipients,\n              field: recordType!CMGT_EML_TRI_MessageRecipient.messageId,\n              value: fv!item[recordType!CMGT_EML_TRI_Message.messageId]\n            ),\n            messageAttachments: rule!CMGT_UTIL_Filter(\n              records: local!allMessageAttachments,\n              field: recordType!CMGT_EML_TRI_Attachment.messageId,\n              value: fv!item[recordType!CMGT_EML_TRI_Message.messageId]\n            ),\n            senderUserRecords: local!sendersUserRecords\n          )\n        }\n      ),\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_horizontalLine\"(marginAbove: \"STANDARD\")\n            }\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                labelPosition: \"COLLAPSED\",\n                value: {\n                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                    text: concat(\n                      #\"urn:appian:translation-string:v1:e61e5622-da28-4900-a6dd-488f4aa36ccf\"(\n                        #\"urn:appian:translation-variable:v1:4d27a062-8bbb-43b2-9366-ef0aed6c47a5\": local!totalCount - 4,\n                        #\"urn:appian:translation-variable:v1:cce255c8-825a-43aa-8a3f-b566e5c273d8\": if(\n                          (local!totalCount - 4) = 1,\n                          #\"urn:appian:translation-string:v1:db0ffb44-65cb-48b1-9692-0cccbfd79a4b\",\n                          #\"urn:appian:translation-string:v1:7effe7c4-6502-4420-b91f-476c96eeaab9\"\n                        )\n                      )\n                    ),\n                    link: #\"SYSTEM_SYSRULES_dynamicLink\"(saveInto: { a!save(ri!isShowMore, true) }),\n                    linkStyle: \"STANDALONE\",\n                    showWhen: ri!isShowMore = false,\n                    color: \"ACCENT\",\n                    style: \"STRONG\"\n                  )\n                },\n                align: \"CENTER\",\n                marginAbove: \"NONE\",\n                marginBelow: \"NONE\",\n                accessibilityText: #\"urn:appian:translation-string:v1:970c37f2-e638-4b3d-821f-704712caef0f\"\n              )\n            },\n            width: \"NARROW\"\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_horizontalLine\"(marginAbove: \"STANDARD\")\n            }\n          )\n        },\n        alignVertical: \"MIDDLE\",\n        showWhen: and(not(ri!isShowMore), local!totalCount > 4),\n        marginAbove: \"LESS\",\n        marginBelow: \"STANDARD\",\n        spacing: \"NONE\"\n      ),\n      if(\n        and(\n          tointeger(local!totalCount) > 4,\n          ri!isShowMore <> true()\n        ),\n        rule!CMGT_EML_TRI_SingleMessageDisplay(\n          message: local!firstMessage,\n          showDivider: false(),\n          brandingMap: ri!brandingMap,\n          showOnlyMessages: ri!showOnlyMessages,\n          isViewAllAttachments: local!isViewAllAttachments,\n          stackMessageMetadata: ri!stackMessageMetadata,\n          marginAbove: ri!marginAboveForSingleMessage,\n          marginBelow: ri!marginBelowForSingleMessage,\n          messageRecipients: rule!CMGT_UTIL_Filter(\n            records: local!allMessageRecipients,\n            field: recordType!CMGT_EML_TRI_MessageRecipient.messageId,\n            value: local!firstMessage[recordType!CMGT_EML_TRI_Message.messageId]\n          ),\n          messageAttachments: rule!CMGT_UTIL_Filter(\n            records: local!allMessageAttachments,\n            field: recordType!CMGT_EML_TRI_Attachment.messageId,\n            value: local!firstMessage[recordType!CMGT_EML_TRI_Message.messageId]\n          ),\n          senderUserRecords: local!sendersUserRecords\n        ),\n        null()\n      )\n    },\n    height: \"AUTO\",\n    style: a!defaultValue(\n      ri!cardBackgroundColor,\n      ri!brandingMap.CardBackgroundColor\n    ),\n    shape: a!defaultValue(ri!cardShape, ri!brandingMap.CardShape),\n    padding: a!defaultValue(ri!cardPadding, \"STANDARD\"),\n    marginBelow: a!defaultValue(ri!marginBelowAtEnd, \"STANDARD\"),\n    showBorder: \"NONE\",\n    showShadow: a!defaultValue(\n      ri!cardShowShadow,\n      ri!brandingMap.CardShowShadow\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_33778": {
      "name": "CMGT_UTIL_SetRecordFields",
      "type": "Expression Rule",
      "sail_code": "/*\nFuture enhancement ideas:\n1 Parameter to skip update if the field isn't present in the object\n--- This would also apply to nested fields, as in, don't set a relationship field if the entire relationship object isn't there because it will instantiate it\n2 Parameter to overwrite based on more enhanced logic\n3 Allow list types for the `value`\n4 Allow reuse to apply setting metadata for nested relationships, but using their own set metadata rule\n--- e.g. CMGT_Entity_SetMetaData can be used in both the Case process and the individual Entity process\n*/\nif(\n  a!isNullOrEmpty(ri!record),\n  ri!record,\n  a!localVariables(\n    local!allUpdates: rule!CMGT_UTIL_RejectBlank(a!flatten(\n      {\n        ri!alwaysOverwrite,\n        ri!childRelationships,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!neverOverwrite,\n          expression: #\"urn:appian:function:v1:a:update\"(\n            fv!item,\n            \"value\",\n            /*Specifically using this instead of a!defaultValue() to account for the `{null}` value*/\n            if(\n              rule!CMGT_UTIL_IsBlank(ri!record[fv!item.field]),\n              fv!item.value,\n              ri!record[fv!item.field]\n            )\n          )\n        )\n      }\n    )),\n    local!onlyChangedUpdates: a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!allUpdates,\n        expression: if(\n          or(\n            tostring(ri!record[fv!item.field]) = tostring(fv!item.value),\n            toboolean(fv!item.applyWhen) = false\n          ),\n          {},\n          fv!item\n        )\n      )\n    ),\n    if(\n      a!isNullOrEmpty(local!onlyChangedUpdates),\n      ri!record,\n      #\"urn:appian:function:v1:a:update\"(\n        data: ri!record,\n        index: local!onlyChangedUpdates.field,\n        value: local!onlyChangedUpdates.value\n      )\n    )\n  )\n)"
    },
    "_a-0000e9dc-ab93-8000-9bc2-011c48011c48_205262": {
      "name": "CMGT_UTIL_CustomPaging",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_richTextDisplayField\"(\n  labelPosition: \"COLLAPSED\",\n  value: {\n    #\"SYSTEM_SYSRULES_richTextIcon\"(\n      icon: \"angle-double-left\",\n      altText: if(\n        ri!pagingInfo.startIndex = 1,\n        {},\n        #\"urn:appian:translation-string:v1:ed587018-95bf-4158-b3aa-49f5ce54059a\"\n      ),\n      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n        saveInto: { a!save(ri!pagingInfo.startIndex, 1) },\n        showWhen: not(ri!pagingInfo.startIndex = 1)\n      ),\n      linkStyle: \"STANDALONE\",\n      color: if(\n        ri!pagingInfo.startIndex = 1,\n        ri!brandingMap.SecondaryTextColor,\n        ri!brandingMap.AccentColor\n      ),\n      size: ri!size\n    ),\n    #\"SYSTEM_SYSRULES_richTextIcon\"(\n      icon: \"angle-left\",\n      altText: if(\n        ri!pagingInfo.startIndex = 1,\n        {},\n        #\"urn:appian:translation-string:v1:577b13c4-f7eb-4811-b548-f8cf995c101a\"\n      ),\n      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n        saveInto: {\n          a!save(\n            ri!pagingInfo.startIndex,\n            max(\n              1,\n              ri!pagingInfo.startIndex - ri!pagingInfo.batchSize\n            )\n          )\n        },\n        showWhen: not(ri!pagingInfo.startIndex = 1)\n      ),\n      linkStyle: \"STANDALONE\",\n      color: if(\n        ri!pagingInfo.startIndex = 1,\n        ri!brandingMap.SecondaryTextColor,\n        ri!brandingMap.AccentColor\n      ),\n      size: ri!size\n    ),\n    \" \",\n    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n      text: {\n        min(ri!pagingInfo.startIndex, ri!totalCount),\n        \" - \",\n        min(\n          ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1,\n          ri!totalCount\n        )\n      },\n      size: ri!size,\n      style: \"STRONG\"\n    ),\n    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n      text: {\n        \" \",\n        #\"urn:appian:translation-string:v1:163f6484-a689-4dc0-a84a-23eba79ab2c1\",\n        \" \",\n        text(ri!totalCount, \"###,###,###,###,###\")\n      },\n      size: ri!size\n    ),\n    \" \",\n    #\"SYSTEM_SYSRULES_richTextIcon\"(\n      icon: \"angle-right\",\n      altText: if(\n        ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount,\n        {},\n        #\"urn:appian:translation-string:v1:358b472b-b442-4c8f-a00b-c9e5427a2ded\"\n      ),\n      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n        saveInto: {\n          a!save(\n            ri!pagingInfo.startIndex,\n            ri!pagingInfo.startIndex + ri!pagingInfo.batchSize\n          )\n        },\n        showWhen: not(\n          ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount\n        )\n      ),\n      linkStyle: \"STANDALONE\",\n      color: if(\n        ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount,\n        ri!brandingMap.SecondaryTextColor,\n        ri!brandingMap.AccentColor\n      ),\n      size: ri!size\n    ),\n    #\"SYSTEM_SYSRULES_richTextIcon\"(\n      icon: \"angle-double-right\",\n      altText: if(\n        ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount,\n        {},\n        #\"urn:appian:translation-string:v1:9d646fda-f9c2-461b-992a-ca32d38f237b\"\n      ),\n      link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n        saveInto: {\n          a!save(\n            ri!pagingInfo.startIndex,\n            if(\n              mod(ri!totalCount, ri!pagingInfo.batchSize) = 0,\n              ri!totalCount - ri!pagingInfo.batchSize + 1,\n              ri!totalCount - mod(ri!totalCount, ri!pagingInfo.batchSize) + 1\n            )\n          )\n        },\n        showWhen: not(\n          ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount\n        )\n      ),\n      linkStyle: \"STANDALONE\",\n      color: if(\n        ri!pagingInfo.startIndex + ri!pagingInfo.batchSize - 1 >= ri!totalCount,\n        ri!brandingMap.SecondaryTextColor,\n        ri!brandingMap.AccentColor\n      ),\n      size: ri!size\n    )\n  },\n  showWhen: ri!totalCount > 0,\n  align: \"RIGHT\"\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000e99c-1217-8000-9ba9-011c48011c48_52277": {
      "name": "CMGT_UTIL_HeaderField",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n  label: \"\",\n  contents: {\n    #\"SYSTEM_SYSRULES_columnsLayout\"(\n      columns: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            if(\n              and(\n                rule!CMGT_UTIL_IsBlank(ri!secondaryText),\n                rule!CMGT_UTIL_IsBlank(ri!labelIcon)\n              ),\n              #\"SYSTEM_SYSRULES_headingField\"(\n                text: rule!CMGT_UTIL_ReplaceArgs(string: ri!label, args: ri!labelArguments),\n                color: a!defaultValue(\n                  value: ri!labelColor,\n                  default: ri!brandingMap.SecondaryHeaderColor\n                ),\n                fontWeight: a!defaultValue(\n                  value: ri!labelFontWeight,\n                  default: ri!brandingMap.SecondaryHeaderFontWeight\n                ),\n                size: a!defaultValue(\n                  value: ri!labelSize,\n                  default: ri!brandingMap.SecondaryHeaderSize\n                ),\n                headingTag: \"H2\",\n                marginAbove: \"LESS\",\n                marginBelow: \"LESS\"\n              ),\n              #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n                label: rule!CMGT_UTIL_ReplaceArgs(string: ri!label, args: ri!labelArguments),\n                contents: {\n                  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                    value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: ri!secondaryText,\n                      style: \"EMPHASIS\",\n                      color: a!defaultValue(\n                        value: ri!labelColor,\n                        default: ri!brandingMap.SecondaryTextColor\n                      ),\n                      size: \"SMALL\"\n                    ),\n                    labelPosition: \"COLLAPSED\",\n                    showWhen: a!isNotNullOrEmpty(ri!secondaryText)\n                  )\n                },\n                labelIcon: ri!labelIcon,\n                iconAltText: ri!iconAltText,\n                labelSize: a!defaultValue(value: ri!labelSize, default: \"SMALL\"),\n                labelHeadingTag: \"H2\",\n                labelColor: a!defaultValue(\n                  value: ri!labelColor,\n                  default: ri!brandingMap.SecondaryTextColor\n                ),\n                marginAbove: \"NONE\",\n                marginBelow: \"NONE\"\n              )\n            )\n          },\n          width: if(\n            a!isNotNullOrEmpty(ri!rightSideContents),\n            \"AUTO\",\n            \"MEDIUM\"\n          )\n        ),\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: ri!rightSideContents,\n          width: \"AUTO\"\n        )\n      },\n      alignVertical: \"MIDDLE\",\n      marginAbove: \"NONE\",\n      marginBelow: \"NONE\",\n      stackWhen: { \"NEVER\" }\n    )\n  },\n  showWhen: a!defaultValue(ri!showWhen, true),\n  divider: a!defaultValue(ri!divider, \"BELOW\"),\n  dividerColor: ri!brandingMap.DividerColor,\n  marginAbove: a!defaultValue(ri!marginAbove, \"NONE\"),\n  marginBelow: a!defaultValue(ri!marginBelow, \"NONE\")\n)"
    },
    "_a-0000eb2c-b6af-8000-9c5d-011c48011c48_1453742": {
      "name": "CMGT_UTIL_ReplaceArgs",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!args),\n  ri!string,\n  reduce(\n    substitute(_, _, _),\n    ri!string,\n    merge(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: a!keys(ri!args),\n        expression: \"@|\" & fv!item & \"|@\"\n      ),\n      touniformstring(ri!args[a!keys(ri!args)])\n    )\n  )\n)"
    },
    "_a-0000e882-ff68-8000-9bb2-011c48011c48_38719-cmgt_eml_tri": {
      "name": "CMGT_EML_TRI_SingleMessageDisplay",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  /*Get Message Details*/\n  local!messageId: ri!message[recordType!CMGT_EML_TRI_Message.messageId],\n  local!sender: rule!CMGT_UTIL_Filter(\n    records: ri!messageRecipients,\n    field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n    value: true\n  ),\n  local!countofAttachments: tointeger(count({ ri!messageAttachments })),\n  local!index: wherecontains(\n    tointeger(local!messageId),\n    tointeger(\n      index(\n        ri!isViewAllAttachments,\n        \"messageId\",\n        null()\n      )\n    )\n  ),\n  local!isViewAllAttachments: toboolean(\n    index(\n      ri!isViewAllAttachments[local!index].viewAll,\n      1,\n      null()\n    )\n  ),\n  #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n    contents: {\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_cardLayout\"(\n                contents: {\n                  /*Header info with Message metadata*/\n                  #\"SYSTEM_SYSRULES_columnsLayout\"(\n                    columns: {\n                      /*User Initial*/\n                      #\"SYSTEM_SYSRULES_columnLayout\"(\n                        contents: rule!CMGT_EML_TRI_UTIL_DisplayUserPhotoOrInitials(\n                          brandingMap: ri!brandingMap,\n                          size: \"TINY\",\n                          userName: local!sender[recordType!CMGT_EML_TRI_MessageRecipient.recipient],\n                          userRecord: rule!CMGT_UTIL_Filter(\n                            records: ri!senderUserRecords,\n                            field: #\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_username\",\n                            value: local!sender[recordType!CMGT_EML_TRI_MessageRecipient.recipient]\n                          )\n                        ),\n                        width: \"EXTRA_NARROW\",\n                        /*Hide stamp icon when ri!showOnlyMessages=true*/\n                        showWhen: not(\n                          a!defaultValue(ri!showOnlyMessages, false)\n                        )\n                      ),\n                      #\"SYSTEM_SYSRULES_columnLayout\"(\n                        contents: {\n                          #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                            items: {\n                              /*Sender Name*/\n                              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                                item: #\"SYSTEM_SYSRULES_headingField\"(\n                                  text: rule!CMGT_UTIL_DisplayUserFullName(\n                                    username: local!sender[recordType!CMGT_EML_TRI_MessageRecipient.recipient]\n                                  ),\n                                  size: \"EXTRA_SMALL\",\n                                  headingTag: \"H6\",\n                                  fontWeight: \"BOLD\",\n                                  marginBelow: \"NONE\"\n                                ),\n                                width: \"MINIMIZE\"\n                              ),\n                              /*Sender Email*/\n                              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                                item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                  label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(testingLabel: \"Sender Email\"),\n                                  labelPosition: \"COLLAPSED\",\n                                  value: {\n                                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                      text: #\"urn:appian:translation-string:v1:6537cf70-d052-4326-abdd-fe2c9b203403\"(\n                                        #\"urn:appian:translation-variable:v1:6f3fbc69-ea39-40cc-9fa3-23307d24fc95\": local!sender[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail]\n                                      ),\n                                      color: ri!brandingMap.SecondaryTextColor,\n                                      size: \"STANDARD\"\n                                    )\n                                  },\n                                  marginAbove: \"NONE\",\n                                  marginBelow: \"NONE\"\n                                ),\n                                showWhen: not(\n                                  a!defaultValue(ri!showOnlyMessages, false)\n                                )\n                              )\n                            },\n                            marginBelow: \"EVEN_LESS\",\n                            stackWhen: \"PHONE\"\n                          ),\n                          #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                            items: {\n                              /*Message Recipient Name*/\n                              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                                item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                  label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(testingLabel: \"Message Recipient Name\"),\n                                  labelPosition: \"COLLAPSED\",\n                                  value: {\n                                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                      text: #\"urn:appian:translation-string:v1:277536a1-40d4-4181-8810-e433d55c47d0\"(\n                                        #\"urn:appian:translation-variable:v1:928b5d95-8ec2-4369-b788-7d610f502c8e\": joinarray(\n                                          rule!CMGT_UTIL_Filter(\n                                            records: ri!messageRecipients,\n                                            field: recordType!CMGT_EML_TRI_MessageRecipient.isSender,\n                                            value: false\n                                          )[recordType!CMGT_EML_TRI_MessageRecipient.recipientEmail],\n                                          \",\"\n                                        )\n                                      ),\n                                      color: ri!brandingMap.SecondaryTextColor,\n                                      size: \"STANDARD\"\n                                    )\n                                  },\n                                  marginBelow: if(\n                                    ri!stackMessageMetadata,\n                                    \"EVEN_LESS\",\n                                    \"NONE\"\n                                  )\n                                ),\n                                width: \"MINIMIZE\"\n                              ),\n                              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                                /*Message Sent Date and Time*/\n                                item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                  label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(\n                                    testingLabel: \"Message Sent Date and Time\"\n                                  ),\n                                  labelPosition: \"COLLAPSED\",\n                                  value: {\n                                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                      text: rule!CMGT_UTIL_FormatDateTime(\n                                        dateTime: ri!message[recordType!CMGT_EML_TRI_Message.modifiedOn],\n                                        includeTime: true\n                                      ),\n                                      color: ri!brandingMap.SecondaryTextColor,\n                                      size: \"STANDARD\"\n                                    )\n                                  },\n                                  align: if(\n                                    #\"SYSTEM_SYSRULES_isPageWidth\"({ \"PHONE\" }),\n                                    \"LEFT\",\n                                    \"RIGHT\"\n                                  ),\n                                  marginBelow: \"NONE\"\n                                ),\n                                showWhen: not(\n                                  a!defaultValue(ri!stackMessageMetadata, false)\n                                ),\n\n                              )\n                            },\n                            spacing: \"NONE\",\n                            marginBelow: \"NONE\",\n                            stackWhen: \"PHONE\"\n                          ),\n                          #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                            items: #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                              item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                label: rule!CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch(\n                                  testingLabel: \"Message Sent Date and Time\"\n                                ),\n                                labelPosition: \"COLLAPSED\",\n                                value: {\n                                  #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                    text: rule!CMGT_UTIL_FormatDateTime(\n                                      dateTime: ri!message[recordType!CMGT_EML_TRI_Message.modifiedOn],\n                                      includeTime: true\n                                    ),\n                                    color: ri!brandingMap.SecondaryTextColor,\n                                    size: \"STANDARD\"\n                                  )\n                                },\n                                align: if(ri!stackMessageMetadata, \"LEFT\", \"RIGHT\"),\n                                marginBelow: \"NONE\"\n                              ),\n                              showWhen: a!defaultValue(ri!stackMessageMetadata, false),\n\n                            )\n                          )\n                        },\n                        width: \"10X\"\n                      )\n                    },\n                    alignVertical: \"MIDDLE\",\n                    marginBelow: \"LESS\",\n                    spacing: \"NONE\",\n                    stackWhen: { \"NEVER\" }\n                  ),\n                  /*Message and Documents*/\n                  #\"SYSTEM_SYSRULES_columnsLayout\"(\n                    columns: {\n                      #\"SYSTEM_SYSRULES_columnLayout\"(\n                        width: \"EXTRA_NARROW\",\n                        showWhen: not(\n                          a!defaultValue(ri!showOnlyMessages, false)\n                        ),\n\n                      ),\n                      #\"SYSTEM_SYSRULES_columnLayout\"(\n                        contents: {\n                          /*Message*/\n                          rule!CMGT_UTIL_RichTextField(\n                            value: ri!message[recordType!CMGT_EML_TRI_Message.messageText.message],\n                            readOnly: true(),\n                            labelPosition: \"COLLAPSED\"\n                          ),\n                          if(\n                            /*Hide Document section when ri!showOnlyMessages=true*/\n                            ri!showOnlyMessages,\n                            {},\n                            {\n                              /*Document display*/\n                              #\"SYSTEM_SYSRULES_columnsLayout\"(\n                                columns: {\n                                  #\"SYSTEM_SYSRULES_columnLayout\"(\n                                    contents: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                      value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                        text: if(\n                                          local!countofAttachments > 1,\n                                          #\"urn:appian:translation-string:v1:59d36243-1b31-4c38-91f1-eb9111b86fee\"(\n                                            #\"urn:appian:translation-variable:v1:2ef36e90-2708-41c5-820f-545a757b4e50\": local!countofAttachments\n                                          ),\n                                          #\"urn:appian:translation-string:v1:d978c78f-bd6d-43c9-9b4d-36a898d9900c\"(\n                                            #\"urn:appian:translation-variable:v1:043a52bf-64e6-46d8-865b-a85ffd33f46d\": local!countofAttachments\n                                          )\n                                        ),\n                                        style: \"STRONG\",\n                                        showWhen: local!countofAttachments >= 1\n                                      )\n                                    )\n                                  ),\n                                  #\"SYSTEM_SYSRULES_columnLayout\"(\n                                    contents: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                                      labelPosition: \"COLLAPSED\",\n                                      value: {\n                                        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                          text: #\"urn:appian:translation-string:v1:532a3776-544f-4531-9b5f-17f3509f2ca3\",\n                                          link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                                            saveInto: {\n                                              a!save(\n                                                ri!isViewAllAttachments[local!index].viewAll,\n                                                true()\n                                              )\n                                            }\n                                          ),\n                                          linkStyle: \"STANDALONE\",\n                                          showWhen: local!isViewAllAttachments = false,\n                                          color: \"ACCENT\"\n                                        )\n                                      },\n                                      showWhen: local!countofAttachments > 5,\n                                      align: \"RIGHT\",\n                                      marginAbove: \"NONE\",\n                                      marginBelow: \"NONE\"\n                                    )\n                                  )\n                                }\n                              ),\n                              rule!CMGT_UTIL_CardGroupHandler(\n                                maxPerRow: a!match(\n                                  value: true,\n                                  whenTrue: #\"SYSTEM_SYSRULES_isPageWidth\"(\n                                    {\n                                      \"PHONE\",\n                                      \"TABLET_PORTRAIT\",\n                                      \"TABLET_LANDSCAPE\",\n                                      \"DESKTOP_NARROW\"\n                                    }\n                                  ),\n                                  then: 2,\n                                  whenTrue: #\"SYSTEM_SYSRULES_isPageWidth\"({ \"DESKTOP_WIDE\" }),\n                                  then: 3,\n                                  default: 4\n                                ),\n                                cardLayouts: {\n                                  #\"SYSTEM_SYSRULES_forEach\"(\n                                    items: if(\n                                      local!isViewAllAttachments,\n                                      ri!messageAttachments,\n                                      rdrop(\n                                        ri!messageAttachments,\n                                        if(\n                                          (local!countofAttachments - 5) < 0,\n                                          0,\n                                          local!countofAttachments - 5\n                                        )\n                                      )\n                                    ),\n                                    expression: rule!CMGT_EML_TRI_Document_Sub_DocumentCard(\n                                      brandingMap: ri!brandingMap,\n                                      attachment: fv!item\n                                    )\n                                  )\n                                }\n                              )\n                            }\n                          )\n                        },\n                        width: \"10X\"\n                      )\n                    },\n                    alignVertical: \"MIDDLE\",\n                    marginBelow: \"LESS\",\n                    spacing: \"NONE\",\n                    stackWhen: { \"NEVER\" }\n                  )\n                },\n                style: \"TRANSPARENT\",\n                shape: \"SQUARED\",\n                padding: \"NONE\",\n                marginAbove: \"NONE\",\n                showBorder: false\n              )\n            }\n          )\n        }\n      )\n    },\n    divider: if(ri!showDivider, \"BELOW\", \"NONE\"),\n    dividerColor: ri!brandingMap.DividerColor,\n    marginAbove: a!defaultValue(ri!marginAbove, \"LESS\"),\n    marginBelow: a!defaultValue(ri!marginBelow, \"LESS\")\n  )\n)"
    },
    "_a-0000ea26-2ced-8000-9bf1-011c48011c48_576741": {
      "name": "CMGT_UTIL_ReturnLabelGivenAutomationTestingSwitch",
      "type": "Expression Rule",
      "sail_code": "if(\n  cons!CMGT_BOL_AUTOMATION_TESTING_LABEL_SWITCH,\n  ri!testingLabel,\n  ri!shipmentLabel\n)"
    },
    "_a-0000e882-ff68-8000-9bb2-011c48011c48_48731-cmgt_eml_tri": {
      "name": "CMGT_EML_TRI_QR_GetMessageAttachments",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_EML_TRI_Attachment,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Attachment.threadId,\n      operator: \"in\",\n      value: ri!threadIds,\n      applyWhen: rule!CMGT_UTIL_IsNotBlank(ri!threadIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Attachment.messageId,\n      operator: \"in\",\n      value: ri!messageIds,\n      applyWhen: rule!CMGT_UTIL_IsNotBlank(ri!messageIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Attachment.attachmentId,\n      operator: \"in\",\n      value: ri!attachmentIds,\n      applyWhen: rule!CMGT_UTIL_IsNotBlank(ri!attachmentIds)\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Attachment.appianDocumentId,\n      operator: \"in\",\n      value: ri!appianDocIds,\n      applyWhen: rule!CMGT_UTIL_IsNotBlank(ri!appianDocIds)\n    ),\n    \n  },\n  logicalExpressions: ri!additionalLogicalExpressions,\n  fields: {\n    ri!fields,\n    recordType!CMGT_EML_TRI_Attachment.documentProperties\n  },\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ecbe-e702-8000-9cf8-011c48011c48_3225200": {
      "name": "CMGT_EML_TRI_MTR_ReplytoEmail",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ecbe-e702-8000-9cf8-011c48011c48_3256246": {
      "name": "CMGT_EML_TRI_ProcessBannerDisplay",
      "type": "Interface",
      "sail_code": "if(\n  and(\n    a!isNotNullOrEmpty(ri!manualSyncProcessId),\n    rule!CMGT_UTIL_IsNotBlank(ri!processRunningInfo)\n  ),\n  a!match(\n    value: true,\n    whenTrue: a!isNotNullOrEmpty(ri!bannerMessage),\n    then: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextIcon\"(\n              icon: \"exclamation-triangle\",\n              color: ri!brandingMap.WarningAccentColor\n            ),\n            char(32),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!bannerMessage,\n              color: ri!brandingMap.StandardTextColor\n            )\n          },\n          marginBelow: \"EVEN_LESS\"\n        )\n      },\n      style: ri!brandingMap.WarningBackgroundColor,\n      padding: \"LESS\",\n      marginBelow: \"STANDARD\",\n      showBorder: false\n    ),\n    whenTrue: and(\n      a!isNullOrEmpty(ri!bannerMessage),\n      ri!processRunningInfo.isProcessRunning\n    ),\n    then: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextIcon\"(\n              icon: \"info-circle\",\n              color: ri!brandingMap.InfoAccentColor\n            ),\n            char(32),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: #\"urn:appian:translation-string:v1:0b933f73-6100-489d-9e65-3253bfec2c62\",\n              color: ri!brandingMap.StandardTextColor,\n\n            ),\n            char(32),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: #\"urn:appian:translation-string:v1:b5ad4eda-ab60-484e-ac39-a1da93bc9a43\",\n              link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                saveInto: a!save(\n                  ri!processRunningInfo,\n                  a!map(\n                    isProcessRunning: rule!CMGT_UTIL_IsNotBlank(\n                      rule!CMGT_EML_TRI_QPA_GetMigrateBatchEmailsReport(\n                        contextProcessModel: cons!CMGT_EML_TRI_PM_INGEST_MAIL_VIA_POLLER,\n                        parentProcessId: ri!manualSyncProcessId,\n                        status: \"ACTIVE\",\n                        excludeParentProcess: false\n                      )\n                    ),\n                    errorStatus: \"\"\n                  )\n                )\n              ),\n              linkStyle: \"STANDALONE\"\n            )\n          },\n          marginBelow: \"EVEN_LESS\"\n        )\n      },\n      style: ri!brandingMap.InfoBackgroundColor,\n      padding: \"LESS\",\n      marginBelow: \"STANDARD\",\n      showBorder: false\n    ),\n    whenTrue: and(\n      a!isNullOrEmpty(ri!bannerMessage),\n      not(ri!processRunningInfo.isProcessRunning)\n    ),\n    then: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextIcon\"(\n              icon: \"check-circle\",\n              color: ri!brandingMap.PositiveAccentColor\n            ),\n            char(32),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: #\"urn:appian:translation-string:v1:452b1aca-4803-49c4-bced-176c3908c4fb\",\n              color: ri!brandingMap.StandardTextColor\n            )\n          },\n          marginBelow: \"EVEN_LESS\"\n        )\n      },\n      style: ri!brandingMap.PositiveBackgroundColor,\n      padding: \"LESS\",\n      marginBelow: \"STANDARD\",\n      showBorder: false\n    ),\n    default: {}\n  ),\n  {}\n)"
    },
    "_a-0000ee4b-bb3a-8000-9d95-011c48011c48_4529414": {
      "name": "CMGT_EML_TRI_DisplayEmptyState",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_columnsLayout\"(\n  showWhen: ri!showWhen,\n  columns: {\n    #\"SYSTEM_SYSRULES_columnLayout\"(\n      width: \"EXTRA_NARROW\",\n      showWhen: if(ri!condensed, false, true)\n    ),\n    #\"SYSTEM_SYSRULES_columnLayout\"(\n      contents: {\n        if(\n          a!isNotNullOrEmpty(ri!docImage),\n          #\"SYSTEM_SYSRULES_imageField_v1\"(\n            images: #\"SYSTEM_SYSRULES_documentImage\"(document: ri!docImage),\n            size: a!defaultValue(value: ri!imageSize, default: \"TINY\"),\n            align: \"CENTER\",\n            marginBelow: a!defaultValue(\n              value: ri!imageMarginBelow,\n              default: \"TINY\"\n            )\n          ),\n          {}\n        ),\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!primaryText,\n              color: ri!brandingMap.PrimaryTextColor,\n              style: ri!primaryTextStyle,\n              size: a!defaultValue(\n                value: ri!primaryTextSize,\n                default: \"MEDIUM\"\n              )\n            )\n          },\n          align: \"CENTER\",\n          marginBelow: if(\n            rule!CMGT_UTIL_IsNotBlank(ri!secondaryText),\n            \"EVEN_LESS\",\n            \"STANDARD\"\n          )\n        ),\n        #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          value: {\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!secondaryText,\n              color: ri!brandingMap.SecondaryTextColor,\n              style: ri!secondaryTextStyle,\n              size: a!defaultValue(\n                value: ri!secondaryTextSize,\n                default: \"STANDARD\"\n              )\n            )\n          },\n          labelPosition: \"COLLAPSED\",\n          align: \"CENTER\",\n          showWhen: rule!CMGT_UTIL_IsNotBlank(ri!secondaryText),\n          marginBelow: a!defaultValue(\n            value: ri!secondaryTextMarginBelow,\n            default: \"STANDARD\"\n          )\n        ),\n        a!defaultValue(ri!additionalContent, {})\n      }\n    ),\n    #\"SYSTEM_SYSRULES_columnLayout\"(\n      width: \"EXTRA_NARROW\",\n      showWhen: if(ri!condensed, false, true)\n    ),\n\n  },\n  marginBelow: \"NONE\"\n)"
    },
    "_a-0000e9fa-aa45-8000-9bda-011c48011c48_301090": {
      "name": "CMGT_UTIL_DisplayUser",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!user,\n  expression: a!localVariables(\n    local!currentUserRecord: if(\n      isusernametaken(fv!item),\n      rule!CMGT_UTIL_Filter(\n        records: ri!userRecord,\n        field: #\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_username\",\n        value: fv!item\n      ),\n      null()\n    ),\n    cast(\n      'type!{http://www.appian.com/ae/types/2009}Text',\n      if(\n        rule!CMGT_UTIL_IsNotBlank(input: local!currentUserRecord),\n        if(\n          or(\n            local!currentUserRecord[#\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_isServiceAccount\"] = true,\n            #\"urn:appian:function:v1:a:isusermemberofgroup?okey=a!isUserMemberOfGroup\"(\n              username: fv!item,\n              groups: cons!CMGT_GRP_SERVICE_ACCOUNTS\n            )\n          ),\n          cons!CMGT_TXT_AUTOMATED_SYSTEM,\n          local!currentUserRecord[#\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_firstAndLastName\"]\n        ),\n        if(\n          isnull(fv!item),\n          if(\n            ri!returnNullForEmpty,\n            null,\n            cons!CMGT_TXT_EMPTY_VALUE\n          ),\n          fv!item\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000e99c-1217-8000-9ba9-011c48011c48_56349": {
      "name": "CMGT_UTIL_FormatDateTime",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!dateTime),\n  \"\",\n  a!localVariables(\n    /*Converting dateTime to system time zone if  convertToSystemTimeZone is passed true */\n    local!dateTimeToFormat: if(\n      ri!convertToSystemTimeZone,\n      rule!CMGT_UTIL_ConvertDateTimeToTimezone(\n        dateTime: ri!dateTime,\n        timezone: rule!CMGT_UTIL_SystemTimezone()\n      ),\n      ri!dateTime\n    ),\n    if(\n      ri!returnTime,\n      text(local!dateTimeToFormat, \"h:mm a\"),\n      if(\n        ri!includeTime,\n        text(\n          local!dateTimeToFormat,\n          \"mmm d, yyyy h:mm a\"\n        ),\n        if(\n          ri!returnMonthAndDay,\n          text(local!dateTimeToFormat, \"mmm.d\"),\n          text(local!dateTimeToFormat, \"mmm d, yyyy\")\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145917": {
      "name": "CMGT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000e9f4-1323-8000-9bd3-011c48011c48_267840": {
      "name": "CMGT_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!branding: getbrandingconfig(\n    cons!CMGT_DOC_DEFAULT_BRANDING_CONFIG,\n    true\n  ),\n  local!output: reduce(\n    #\"urn:appian:function:v1:a:update\"(_, _, _),\n    a!map(),\n    merge(\n      {\n        local!branding.defaultBranding.key,\n        local!branding.customBranding.key\n      },\n      {\n        local!branding.defaultBranding.value,\n        local!branding.customBranding.value\n      }\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ec87-8877-8000-9ce8-011c48011c48_3012911": {
      "name": "CMGT_EML_TRI_SitePage_TriageEmail",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: rule!CMGT_UTIL_LoadBrandingMap(),\n  local!isEmailPaneCollapsed: false,\n  local!manualSyncProcessId,\n  local!bannerMessage,\n  local!selectedTriageOption,\n  local!searchTerm,\n  local!processRunningInfo,\n  local!triggerProcessRefresh: a!refreshVariable(\n    value: now(),\n    refreshAfter: \"RECORD_ACTION\",\n    refreshOnVarChange: local!processRunningInfo\n  ),\n  local!triggerMessageRefresh: a!refreshVariable(\n    value: now(),\n    refreshAfter: \"RECORD_ACTION\",\n    refreshOnVarChange: local!triggerProcessRefresh\n  ),\n  local!triggerThreadRefresh: a!refreshVariable(\n    value: now(),\n    refreshAfter: \"RECORD_ACTION\",\n    refreshOnVarChange: {\n      local!triggerProcessRefresh,\n      local!triggerMessageRefresh\n    }\n  ),\n  local!pagingInfo: a!refreshVariable(\n    value: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 15,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!CMGT_EML_TRI_Thread.latestMessageSentDateTime,\n        ascending: false\n      )\n    ),\n    refreshOnVarChange: local!triggerMessageRefresh\n  ),\n  /*query to fetch threads and to fetch the threads with search term in subject or recipient*/\n  local!availableThreads: rule!CMGT_EML_TRI_QR_GetThreads(\n    pagingInfo: local!pagingInfo,\n    returnType: \"DATA_SUBSET\",\n    triggerRefresh: local!triggerThreadRefresh,\n    sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n      recordType!CMGT_EML_TRI_Thread.latestMessageSentDateTime,\n      false\n    ),\n    fields: {\n      recordType!CMGT_EML_TRI_Thread.originalSender\n    },\n    threadStatuses: {\n      cons!CMGT_EML_TRI_TRIAGE_STATUS_OPEN,\n      cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS\n    },\n    searchTerm: local!searchTerm,\n    searchFields: {\n      recordType!CMGT_EML_TRI_Thread.subject,\n      recordType!CMGT_EML_TRI_Thread.messages.messageRecipients.recipient,\n      recordType!CMGT_EML_TRI_Thread.messages.messageRecipients.recipientEmail,\n      recordType!CMGT_EML_TRI_Thread.messages.messageText.plainTextMessage\n    }\n  ),\n  local!unlockThread: false(),\n  local!selectedThread: a!refreshVariable(\n    value: index(local!availableThreads.data, 1, null),\n    /*RefreshOnReferenceVarChange is purposely added as local!selectedThread is getting overwritten on\n    Edit Anyways even though it is requeried as we are setting refreshThread to now()*/\n    refreshOnReferencedVarChange: toboolean(local!unlockThread) <> true()\n  ),\n  local!isShowMore: false(),\n  /*Show Reply Thread Box*/\n  local!isReplyThread: a!refreshVariable(\n    value: false,\n    refreshOnVarChange: { local!selectedThread },\n\n  ),\n  local!totalCountOfThreads: rule!CMGT_EML_TRI_QR_GetThreads(\n    returnType: \"TOTAL_COUNT\",\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 1),\n    threadStatuses: {\n      cons!CMGT_EML_TRI_TRIAGE_STATUS_OPEN,\n      cons!CMGT_EML_TRI_TRIAGE_STATUS_IN_PROGRESS\n    },\n    triggerRefresh: local!triggerThreadRefresh,\n\n  ),\n  #\"SYSTEM_SYSRULES_headerContentLayout\"(\n    header: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        rule!CMGT_UTIL_HeaderField(\n          label: #\"urn:appian:translation-string:v1:913cbe12-d23c-4542-b556-f0a24df13ff0\",\n          labelSize: \"LARGE\",\n          divider: \"NONE\",\n          rightSideContents: {\n            if(\n              local!totalCountOfThreads > 0,\n              rule!CMGT_EML_TRI_SyncEmailButton(\n                processRunningInfo: local!processRunningInfo,\n                bannerMessage: local!bannerMessage,\n                manualSyncProcessId: local!manualSyncProcessId,\n                triggerProcessRefresh: local!triggerProcessRefresh\n              ),\n              {}\n            )\n          },\n          brandingMap: local!brandingMap,\n          marginBelow: \"NONE\",\n          marginAbove: \"NONE\",\n          labelColor: local!brandingMap.StandardTextColor\n        ),\n        rule!CMGT_EML_TRI_ProcessBannerDisplay(\n          brandingMap: local!brandingMap,\n          bannerMessage: local!bannerMessage,\n          manualSyncProcessId: local!manualSyncProcessId,\n          processRunningInfo: local!processRunningInfo\n        )\n      }\n    ),\n    contents: {\n      if(\n        local!totalCountOfThreads > 0,\n        #\"SYSTEM_SYSRULES_paneLayout\"(\n          panes: {\n            #\"SYSTEM_SYSRULES_pane\"(\n              contents: rule!CMGT_EML_TRI_EmailListPane(\n                brandingMap: local!brandingMap,\n                isEmailPaneCollapsed: local!isEmailPaneCollapsed,\n                availableThreads: local!availableThreads,\n                pagingInfo: local!pagingInfo,\n                selectedThread: local!selectedThread,\n                searchTerm: local!searchTerm,\n                isShowMore: local!isShowMore,\n                selectedOption: local!selectedTriageOption,\n                showEmailPaneCollapsible: true,\n                triggerRefresh: local!triggerThreadRefresh\n              ),\n              width: if(\n                local!isEmailPaneCollapsed,\n                \"EXTRA_NARROW\",\n                if(\n                  #\"SYSTEM_SYSRULES_isPageWidth\"(\"DESKTOP_NARROW\"),\n                  \"NARROW_PLUS\",\n                  \"MEDIUM\"\n                )\n              ),\n              padding: if(\n                local!isEmailPaneCollapsed,\n                \"EVEN_LESS\",\n                \"NONE\"\n              ),\n              accessibilityText: #\"urn:appian:translation-string:v1:297cf25d-abb6-4d91-b9ed-ab0139f56398\"\n            ),\n            #\"SYSTEM_SYSRULES_pane\"(\n              contents: if(\n                rule!CMGT_UTIL_IsBlank(local!selectedThread),\n                #\"SYSTEM_SYSRULES_cardLayout\"(\n                  contents: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                    value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: #\"urn:appian:translation-string:v1:3e0fc9e7-c6d2-4a9f-8c8d-4aa05e5db601\",\n                      color: local!brandingMap.SecondaryTextColor\n                    ),\n                    align: \"CENTER\",\n                    marginAbove: \"EVEN_MORE\"\n                  ),\n                  marginAbove: \"EVEN_MORE\",\n                  showBorder: false\n                ),\n                rule!CMGT_EML_TRI_SingleEmailThreadDisplay(\n                  thread: local!selectedThread,\n                  brandingMap: local!brandingMap,\n                  isShowMore: local!isShowMore,\n                  triggerThreadRefresh: local!triggerThreadRefresh,\n                  showTriageActions: true,\n                  showOnlyMessages: false,\n                  unlockThread: local!unlockThread,\n                  isReplyThread: local!isReplyThread,\n                  triggerMessageRefresh: local!triggerMessageRefresh\n                )\n              ),\n              width: \"AUTO\",\n              backgroundColor: if(\n                rule!CMGT_UTIL_IsBlank(local!selectedThread),\n                local!brandingMap.CardBackgroundColor,\n                local!brandingMap.DefaultBackgroundColor\n              ),\n              accessibilityText: #\"urn:appian:translation-string:v1:97278c4f-8d42-480c-a08d-8fdec081de09\"\n            )\n          }\n        ),\n        #\"SYSTEM_SYSRULES_cardLayout\"(\n          contents: rule!CMGT_EML_TRI_DisplayEmptyState(\n            brandingMap: local!brandingMap,\n            primaryText: #\"urn:appian:translation-string:v1:d524db8c-da5c-4985-9230-7f0ba519bf31\",\n            primaryTextSize: \"MEDIUM\",\n            primaryTextStyle: \"STRONG\",\n            secondaryText: #\"urn:appian:translation-string:v1:0b13d44c-b3c2-42ae-85d0-df5b9256be85\",\n            docImage: cons!CMGT_EML_TRI_DOC_EMAIL_EMPTY_STATE,\n            imageSize: \"SMALL_PLUS\",\n            imageMarginBelow: \"MORE\",\n            additionalContent: {\n              rule!CMGT_EML_TRI_SyncEmailButton(\n                processRunningInfo: local!processRunningInfo,\n                bannerMessage: local!bannerMessage,\n                manualSyncProcessId: local!manualSyncProcessId,\n                triggerProcessRefresh: local!triggerProcessRefresh,\n                align: \"CENTER\"\n              )\n            }\n          ),\n          padding: \"EVEN_MORE\",\n          marginAbove: \"STANDARD\",\n          style: \"TRANSPARENT\",\n          showBorder: false()\n        )\n      )\n    },\n    backgroundColor: local!brandingMap.DefaultBackgroundColor\n  )\n)"
    },
    "_a-0000e882-ff68-8000-9bb2-011c48011c48_37819-cmgt_eml_tri": {
      "name": "CMGT_EML_TRI_QR_GetThreads",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_EML_TRI_Thread,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.threadId,\n      operator: \"in\",\n      value: ri!threadIds\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.threadSetId,\n      operator: \"in\",\n      value: ri!threadSetIds\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.threadStatus,\n      operator: \"in\",\n      value: ri!threadStatuses\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.subject,\n      operator: \"in\",\n      value: ri!subjects\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.messages.messageId,\n      operator: \"in\",\n      value: ri!messageIds\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_EML_TRI_Thread.isActive,\n      operator: \"in\",\n      value: { a!defaultValue(ri!isActive, true) }\n    ),\n    ri!additionalFilter\n  },\n  logicalExpressions: {\n    if(\n      a!isNotNullOrEmpty(ri!searchTerm),\n      {\n        #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n          operator: \"AND\",\n          logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n            items: split(trim(ri!searchTerm), \" \"),\n            expression: a!localVariables(\n              local!splitSearchTerm: fv!item,\n              #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                operator: \"OR\",\n                filters: #\"SYSTEM_SYSRULES_forEach\"(\n                  items: ri!searchFields,\n                  expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                    field: fv!item,\n                    operator: \"includes\",\n                    value: local!splitSearchTerm\n                  )\n                )\n              )\n            )\n          )\n        )\n      },\n      {}\n    ),\n    ri!additionalLogicalExpressions\n  },\n  fields: ri!fields,\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n)"
    },
    "_a-0000ec7e-4d3b-8000-9ce6-011c48011c48_2997534": {
      "name": "CMGT_Document_IconColorLogic",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: lower(ri!documentExtension),\n  /* red4*/\n  equals: \"pdf\",\n  then: ri!brandingMap.NegativeTextColor,\n  equals: \"img\",\n  equals: \"png\",\n  equals: \"mov\",\n  equals: \"jpg\",\n  /* red3*/\n  then: ri!brandingMap.NegativeAccentColor,\n  equals: \"xlsx\",\n  equals: \"xls\",\n  equals: \"xlsm\",\n  /* green4*/\n  then: ri!brandingMap.PositiveTextColor,\n  equals: \"ppt\",\n  equals: \"pptx\",\n  /* orange3*/\n  then: ri!brandingMap.TaskStatusInProgressAccentColor,\n  equals: \"doc\",\n  equals: \"docx\",\n  equals: \"txt\",\n  equals: \"properties\",\n  /* blue3*/\n  then: ri!brandingMap.InfoAccentColor,\n  default: ri!brandingMap.SecondaryTextColor\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180481": {
      "name": "CMGT_UTIL_RejectBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(a!flatten(ri!array)),\n  reject(a!isNullOrEmpty(_), a!flatten(ri!array))\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "bd8f3e49-406c-4eab-a3a4-ce119dfbb5ce": {
      "name": "CMGT_UTIL_RichTextField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  /*\n  This should never be above 4000 characters as it will go over the amount allowed in synced records\n  If using the RTE in other places for customization, the field length should be 4000 characters to allow for additional HTML to be added.\n  The RTE calculates the max length allowed on the front end for the end-user, but will not go over that amount on the back-end\n  */\n  local!maxSize: a!defaultValue(\n    value: ri!maxSize,\n    default: cons!CMGT_INT_MAX_CHAR_LIMIT_EXTRA_LARGE\n  ),\n  if(\n    cons!CMGT_BOL_AUTOMATION_TESTING_LABEL_SWITCH,\n    #\"SYSTEM_SYSRULES_paragraphField\"(\n      label: ri!label,\n      labelPosition: if(rule!CMGT_UTIL_IsBlank(ri!label),\"COLLAPSED\",ri!labelPosition),\n      instructions: ri!instructions,\n      helpTooltip: ri!helpToolTip,\n      placeholder: ri!placeholder,\n      value: rule!CMGT_UTIL_StripHtmlTags(value: ri!value, isFormatted: true),\n      saveInto: a!save(\n        ri!value,\n        \"<p>\" & substitute(save!value, char(10), \"<br>\") & \"</p>\"\n      ),\n      refreshAfter: ri!refreshAfter,\n      characterLimit: local!maxSize,\n      height: ri!height,\n      showWhen: ri!showWhen,\n      required: ri!required,\n      requiredMessage: ri!requiredMessage,\n      readOnly: ri!readOnly,\n      disabled: ri!disabled\n    ),\n    #\"SYSTEM_SYSRULES_styledTextEditorField\"(\n      label: ri!label,\n      labelPosition: if(rule!CMGT_UTIL_IsBlank(ri!label),\"COLLAPSED\",ri!labelPosition),\n      instructions: ri!instructions,\n      helpTooltip: ri!helpToolTip,\n      placeholder: ri!placeholder,\n      value: ri!value,\n      saveInto: {\n        ri!value,\n        ri!additionalSaves\n      },\n      sizeLimit: local!maxSize,\n      height: a!defaultValue(ri!height, \"SHORT_PLUS\"),\n      showWhen: ri!showWhen,\n      required: ri!required,\n      requiredMessage: ri!requiredMessage,\n      readOnly: ri!readOnly,\n      disabled: ri!disabled,\n      validations: ri!validations\n    )\n  )\n)"
    }
  }
}
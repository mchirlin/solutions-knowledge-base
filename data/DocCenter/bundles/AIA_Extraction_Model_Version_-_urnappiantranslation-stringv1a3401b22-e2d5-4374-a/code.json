{
  "_metadata": {
    "bundle_id": "AIA_Extraction_Model_Version_-_urnappiantranslation-stringv1a3401b22-e2d5-4374-a"
  },
  "objects": {
    "_a-0000ecfc-48c9-8000-9c55-011c48011c48_234937": {
      "name": "AIA_ENUM_LlmVersions",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!allModels: a!flatten(\n    {\n      a!map(\n        label: \"Anthropic Claude Haiku 3.0 (Fast)\",\n        value: cons!AIA_MODEL_HAIKU_3,\n      ),\n      a!map(\n        label: \"Anthropic Claude Haiku 4.5 (Fast)\",\n        value: cons!AIA_MODEL_HAIKU_4_5,\n      ),\n      a!map(\n        label: \"Anthropic Claude Sonnet 3.0 (Legacy, Reasoning)\",\n        value: cons!AIA_MODEL_SONNET_3,\n      ),\n      a!map(\n        label: \"Anthropic Claude Sonnet 3.5 (Reasoning)\",\n        value: cons!AIA_MODEL_SONNET_3_5\n      ),\n      a!map(\n        label: \"Anthropic Claude Sonnet 3.7 (Reasoning)\",\n        value: cons!AIA_MODEL_SONNET_3_7\n      ),\n      a!map(\n        label: \"Anthropic Claude Sonnet 4.5 (Reasoning)\",\n        value: cons!AIA_MODEL_SONNET_4_5\n      ),\n      if(\n        ri!includeVision,\n        {\n          /*model values iwth | to split name and mode are used in AI Reviewer/Judge*/\n          a!map(\n            label: \"Anthropic Claude Haiku 4.5 (Vision)\",\n            value: cons!AIA_MODEL_HAIKU_4_5_MULTIMODAL,\n          ),\n          a!map(\n            label: \"Anthropic Claude Sonnet 3.5 (Vision)\",\n            value: cons!AIA_MODEL_SONNET_3_5_MULTIMODAL\n          ),\n          a!map(\n            label: \"Anthropic Claude Sonnet 3.7 (Vision)\",\n            value: cons!AIA_MODEL_SONNET_3_7_MULTIMODAL\n          ),\n          a!map(\n            label: \"Anthropic Claude Sonnet 4.5 (Vision)\",\n            value: cons!AIA_MODEL_SONNET_4_5_MULTIMODAL\n          )\n        },\n        null\n      )\n    }\n  ),\n  if(\n    a!defaultValue(ri!returnOnlySupportedLlms, true),\n    a!localVariables(\n      local!supportedModels: a!genAiModels(),\n      reject(\n        fn!isnull,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: local!allModels,\n          expression: if(\n            or(\n              a!isNullOrEmpty(fv!item.value),\n              contains(\n                touniformstring(local!supportedModels.id),\n                tostring(split(fv!item.value,\"|\")[1])\n              )\n            ),\n            fv!item,\n            null\n          )\n        )\n      )\n    ),\n    local!allModels\n  )\n)"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_38240": {
      "name": "AIA_Template_GreyCardWithInnerTitle",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: a!defaultValue(ri!brandingMap, rule!AIA_UTIL_LoadBrandingMap()),\n  local!headerField: a!refreshVariable(\n    refreshAlways: true,\n    value: #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n      alignVertical: \"MIDDLE\",\n      items: {\n        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n          item: #\"SYSTEM_SYSRULES_headingField\"(\n            text: ri!title,\n            headingTag: ri!headingTag,\n            size: a!defaultValue(\n              value: ri!headerSize,\n              default: \"EXTRA_SMALL\"\n            ),\n            marginBelow: \"NONE\"\n          ),\n          width: \"MINIMIZE\"\n        ),\n        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n          item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n            labelPosition: \"COLLAPSED\",\n            value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n              icon: \"info-circle\",\n              caption: ri!caption,\n              color: local!brandingMap.Blue3\n            )\n          ),\n          showWhen: a!isNotNullOrEmpty(ri!caption)\n        )\n      }\n    )\n  ),\n  local!subHeaderField: a!refreshVariable(\n    refreshAlways: true,\n    value: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n      labelPosition: \"COLLAPSED\",\n      showWhen: a!isNotNullOrEmpty(ri!subheader),\n      value: {\n        char(10),\n        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: ri!subheader,\n          color: local!brandingMap.Gray3\n        )\n      },\n      marginBelow: \"LESS\"\n    )\n  ),\n  #\"SYSTEM_SYSRULES_cardLayout\"(\n    contents: a!match(\n      value: ri!headerPosition,\n      equals: \"ADJACENT\",\n      then: #\"SYSTEM_SYSRULES_columnsLayout\"(\n        alignVertical: \"MIDDLE\",\n        marginAbove: \"NONE\",\n        marginBelow: \"NONE\",\n        spacing: \"DENSE\",\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              local!headerField,\n              local!subHeaderField\n            }\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: ri!contents\n          )\n        }\n      ),\n      /*default to ABOVE style display*/\n      default: {\n        local!headerField,\n        local!subHeaderField,\n        ri!contents\n      }\n    ),\n    height: a!defaultValue(ri!height, \"SHORT_PLUS\"),\n    style: local!brandingMap.DefaultPageBackground,\n    shape: \"SEMI_ROUNDED\",\n    padding: \"STANDARD\",\n    marginBelow: \"STANDARD\",\n    showBorder: false\n  )\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92467": {
      "name": "AIA_MTR_ClassificationInstanceClassifiedWithErrors",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eec9-5676-8000-9c92-011c48011c48_179359": {
      "name": "AIA_MTR_ConfidenceThresholdDisabled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eeca-c121-8000-9cab-011c48011c48_182002": {
      "name": "AIA_MTR_ClassificationModelVersionRestore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180853": {
      "name": "AIA_MTR_ExtractionInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eed9-05f0-8000-9d10-011c48011c48_194872": {
      "name": "AIA_DefaultModel",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!default: cons!AIA_MODEL_HAIKU_4_5,\n  if(\n    /*check default model is enabled in env*/\n    contains(\n      a!genAiModels().id,\n      local!default\n    ),\n    /*if so, use default*/\n    local!default,\n    /*else default to first available model*/\n    tostring(index(a!genAiModels().id,1,\"\"))\n  )\n)"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483991": {
      "name": "AIA_MTR_ModelTestSuiteUpdated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92592": {
      "name": "AIA_MTR_ExtractionInstanceValidationIgnore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483964": {
      "name": "AIA_MTR_ModelTestRunInitiated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_31384": {
      "name": "AIA_FieldJsonSchema",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!isMultiple: a!defaultValue(\n    ri!item.isMultiple,\n    false\n  ),\n  local!baseType: #\"53aa98e0-80da-4eb1-88f9-a989a8fe1aee\"(\n    type: ri!item.type\n  ),\n  local!baseField: a!map(\n    title: ri!item.label,\n    description: ri!item.description,\n    type: local!baseType.type,\n    format: local!baseType.format\n  ),\n  local!schemaType: displayValue(\n    ri!mode,\n    rule!AIA_ENUM_FieldSchemas().name,\n    rule!AIA_ENUM_FieldSchemas(),\n    null\n  ),\n  local!type: #\"53aa98e0-80da-4eb1-88f9-a989a8fe1aee\"(\n    type: ri!item.type,\n    isMultiple: local!isMultiple,\n    includeArrays: ri!includeArrays,\n    mode: ri!mode\n  ),\n  local!enum: rule!AIA_Extraction_GetFieldOptions(ModelVersionField: ri!item),\n  local!columns: reject(\n    fn!isnull,\n    #\"SYSTEM_SYSRULES_forEach\"(\n      ri!item.columns,\n      a!match(\n        value: fv!item,\n        whenTrue: a!isNullOrEmpty(index(fv!value, \"key\", null)),\n        then: null,\n        whenTrue: and(\n          ri!operation = cons!AIA_PROMPT_OPERATION_MODE_MULTIMODAL,\n          a!defaultValue(fv!value.useVision, false) = true\n        ),\n        then: fv!item,\n        whenTrue: and(\n          ri!operation = cons!AIA_PROMPT_OPERATION_MODE_TEXT,\n          a!defaultValue(fv!value.useVision, false) = false\n        ),\n        then: fv!item,\n        default: fv!item\n      )\n    )\n  ),\n  local!properties: if(\n    and(\n      a!isNotNullOrEmpty(local!schemaType.fields),\n      or(\n        and(\n          not(local!isMultiple),\n          a!isNullOrEmpty(local!columns),\n        ),\n        not(a!defaultValue(ri!includeArrays, true))\n      )\n    ),\n    reduce(\n      #\"urn:appian:function:v1:a:update\",\n      a!map(),\n      merge(\n        local!schemaType.fields.key,\n        a!flatten({\n          #\"SYSTEM_SYSRULES_forEach\"(\n            local!schemaType.fields,\n            a!map(\n              type: a!defaultValue(fv!item.type, local!baseField.type),\n              description: fv!item.description,\n              format: if(\n                fv!item.useFormat,\n                local!baseField.format,\n                null\n              ),\n              items: if(\n                and(\n                  a!isNullOrEmpty(fv!item.type),\n                  ri!includeArrays = false\n                ),\n                rule!AIA_FieldJsonSchema(\n                  item: ri!item,\n                  mode: cons!AIA_SCHEMA_MODE_PLAIN,\n                  operation: ri!operation,\n                  includeArrays: true\n                ).items,\n                null\n              ),\n              enum: if(\n                fv!item.useFormat,\n                index(local!enum, \"options\", null),\n                null\n              ),\n            )\n          )\n        })\n      )\n    ),\n    null\n  ),\n  local!required: if(\n    and(\n      a!isNotNullOrEmpty(local!schemaType.fields),\n      a!isNullOrEmpty(local!columns),\n      not(local!isMultiple)\n    ),\n    reject(\n      fn!isnull,\n      index(\n        local!schemaType.fields.key,\n        where(local!schemaType.fields.required)\n      )\n    ),\n    null\n  ),\n  local!items: a!match(\n    value: ri!includeArrays,\n    equals: false,\n    then: null,\n    whenTrue: and(\n      a!isNotNullOrEmpty(local!columns),\n      ri!includeArrays\n    ),\n    then: a!map(\n      type: \"object\",\n      properties: reduce(\n        #\"urn:appian:function:v1:a:update\",\n        a!map(),\n        merge(\n          local!columns.key,\n          #\"SYSTEM_SYSRULES_forEach\"(\n            local!columns,\n            rule!AIA_FieldJsonSchema(\n              item: fv!item,\n              mode: ri!mode\n            )\n          )\n        )\n      ),\n      required: reject(\n        fn!isnull,\n        index(\n          local!columns.key,\n          where(local!columns.required)\n        )\n      )\n    ),\n    whenTrue: local!isMultiple,\n    then: a!localVariables(\n      local!item: rule!AIA_FieldJsonSchema(\n        item: #\"urn:appian:function:v1:a:update\"(\n          ri!item, \n          {\"label\", \"description\", \"isMultiple\"},\n          {null, null, false}\n        ),\n        mode: ri!mode\n      ),\n      if(\n        and(\n          a!isNullOrEmpty(local!schemaType.fields),\n          a!isNotNullOrEmpty(local!enum)\n        ),\n        #\"urn:appian:function:v1:a:update\"(\n          local!item,\n          \"enum\",\n          index(local!enum, \"options\", null),\n        ),\n        local!item\n      )\n    ),\n    default: null\n  ),\n  a!map(\n    title: local!baseField.title,\n    description: local!baseField.description,\n    type: local!type.type,\n    format: local!type.format,\n    properties: local!properties,\n    items: local!items,\n    required: local!required\n  )\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92585": {
      "name": "AIA_MTR_ExtractionInstanceValidationAccept",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92578": {
      "name": "AIA_MTR_ExtractionModelVersionAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92488": {
      "name": "AIA_MTR_ExtractionInstanceError",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_38770": {
      "name": "AIA_Extraction_DefaultAiReviwRole",
      "type": "Expression Rule",
      "sail_code": "=#\"urn:appian:translation-string:v1:ef6f89d7-ee52-4817-8a91-cb880fa01818\" & char(10) & char(10) & #\"urn:appian:translation-string:v1:65728831-0b11-4fa9-9454-3bb1c9d3e371\""
    },
    "_a-0000ec36-59aa-8000-9be0-011c48011c48_53600": {
      "name": "AIA_Test_GetLatestExtractionModelVersion",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!modelVersion: a!refreshVariable(\n    value: rule!AIA_Extraction_GetModelVersionById(\n      identifier: index(\n        #\"SYSTEM_SYSRULES_queryRecordType_v4\"(\n          recordType: recordType!AIA Extraction Model Version,\n          fields: {\n            recordType!AIA Extraction Model Version.modelVersionId\n          },\n          pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n            startIndex: 1,\n            batchSize: 1,\n            sort: {\n              #\"SYSTEM_SYSRULES_sortInfo\"(\n                field: recordType!AIA Extraction Model Version.modelVersionId\n              )\n            }\n          )\n        ).data[recordType!AIA Extraction Model Version.modelVersionId],\n        1,\n        null\n      )\n    ),\n    refreshAlways: true\n  ),\n  local!modelVersion\n)"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_39601": {
      "name": "AIA_SubDisplayFieldSelections",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  ri!fields,\n  a!localVariables(\n    local!fieldIndex: index(wherecontains(\n      tostring(fv!item[recordType!AIA Extraction Model Version Field.key]),\n      touniformstring(ri!allFields[recordType!AIA Extraction Model Version Field.key])\n    ), 1, null),\n    local!defaultValue: ri!defaultRule(fv!item),\n    rule!AIA_Template_Checkbox(\n      label: fv!item[recordType!AIA Extraction Model Version Field.label],\n      brandingMap: ri!brandingMap,\n      record: fv!item,\n      field: recordType!AIA Extraction Model Version Field.useAiReview,\n      defaultValue: local!defaultValue,\n      caption: #\"urn:appian:translation-string:v1:bc4134b8-90b8-4c69-bd21-40f7f05650f5\",\n      /* Show everything < length / numColumns rounded up */\n      showWhen: a!localVariables(\n        local!batchSize: roundup(length(ri!allFields) / ri!numColumns, 0),\n        local!lowIndex: (ri!columnIndex - 1) * local!batchSize + 1,\n        local!highIndex:  local!lowIndex + local!batchSize,\n        and(\n          fv!index >= local!lowIndex,\n          fv!index < local!highIndex\n        )\n      ),\n      saveInto: {\n        a!save(\n          ri!allFields[local!fieldIndex][recordType!AIA Extraction Model Version Field.useAiReview],\n          not(\n            a!defaultValue(ri!allFields[local!fieldIndex][recordType!AIA Extraction Model Version Field.useAiReview], local!defaultValue)\n          )\n        )\n      },\n      saveIntoRecord: false\n    )\n  )\n)"
    },
    "_a-0000ee35-0ca2-8000-9ba6-011c48011c48_13646": {
      "name": "AIA_LogMetric",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!name,\n  /* Classification Model Created */\n  equals: cons!AIA_MTR_CLASSIFICATION_MODEL_CREATED,\n  then: rule!AIA_MTR_ClassificationModelCreated(),\n  /* Classification Instance Created */\n  equals: cons!AIA_MTR_CLASSIFICATION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_ClassificationInstanceCreated(),\n  /* Classification Instance Reconciled */\n  equals: cons!AIA_MTR_CLASSIFICATION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_ClassificationInstanceReconciled(),\n  /* Classification Instance with Validation Errors */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFIED_WITH_ERRORS,\n  then: rule!AIA_MTR_ClassificationInstanceClassifiedWithErrors(),\n  /* Classification Instance with Critical Error */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFICATION_CRITICAL_ERROR,\n  then: rule!AIA_MTR_ClassificationInstanceError(),\n  \n  /* Extraction Model Created */\n  equals: cons!AIA_MTR_EXTRACTION_MODEL_CREATED,\n  then: rule!AIA_MTR_ExtractionModelCreated(),\n  /* Extraction Instance Created */\n  equals: cons!AIA_MTR_EXTRACTION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_ExtractionInstanceCreated(),\n  /* Extraction Instance Reconciled */\n  equals: cons!AIA_MTR_EXTRACTION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_ExtractionInstanceReconciled(),\n  /* Extraction Instance with Validation Errors */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTED_WITH_ERRORS,\n  then: rule!AIA_MTR_ExtractionInstanceExtractedWithErrors(),\n  /* Extraction Instance with Critical Error */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTION_CRITICAL_ERROR,\n  then: rule!AIA_MTR_ExtractionInstanceError(),\n  \n  /* Triggered when AI review raises an error (field level) */\n  equals: cons!AIA_MTR_AI_REVIEW_FIELD,\n  then: rule!AIA_MTR_ExtractionInstanceFieldAiReview(),\n  /* Triggered when AI review raises an error (instance level, this instance has 1 or more errors raised by AI review) */\n  equals: cons!AIA_MTR_AI_REVIEW_INSTANCE,\n  then: rule!AIA_MTR_ExtractionInstanceAiReview(),\n  /* Triggered when model is created with AI review turned on OR AI review is turned on for a model */\n  equals: cons!AIA_MTR_AI_REVIEW_MODEL_VERSION,\n  then: rule!AIA_MTR_ExtractionModelVersionAiReview(),\n  /* Triggered when user clicks accept */\n  equals: cons!AIA_MTR_AI_REVIEW_ACCEPT,\n  then: rule!AIA_MTR_ExtractionInstanceValidationAccept(),\n  /* Triggered when user clicks ignored */\n  equals: cons!AIA_MTR_AI_REVIEW_IGNORE,\n  then: rule!AIA_MTR_ExtractionInstanceValidationIgnore(),\n  /*triggered when spot check ocnfigured*/\n  equals: cons!AIA_MTR_SPOT_CHECK_MODEL_VERSION,\n  then: rule!AIA_MTR_ModelVersionConfigureSampling(),\n  /* Triggered when a model validation rule of type AI validation creates a validation instance */\n  equals: cons!AIA_MTR_AI_VALIDATION_RULE_OCCURANCE,\n  then: rule!AIA_MTR_InstanceValidationAiRuleOccurance(),\n  /*Confidence Threshold Enabled*/\n  equals: cons!AIA_MTR_CONFIDENCE_THRESHOLD_ENABLED,\n  then: rule!AIA_MTR_ConfidenceThresholdEnabled(),\n  /*Confidence Threshold Disabled*/\n  equals: cons!AIA_MTR_CONFIDENCE_THRESHOLD_DISABLED,\n  then: rule!AIA_MTR_ConfidenceThresholdDisabled(),\n  /*Extraction Model Version Restored*/\n  equals: cons!AIA_MTR_EXTRACTION_MODEL_VERSION_RESTORE,\n  then: rule!AIA_MTR_ExtractionModelVersionRestore(),\n  /*Classification Model Version Restored*/\n  equals: cons!AIA_MTR_CLASSIFICATION_MODEL_VERSION_RESTORE,\n  then: rule!AIA_MTR_ClassificationModelVersionRestore(),\n  /*Model Test Suite Created*/\n  equals: cons!AIA_MTR_MODEL_TEST_SUITE_CREATED,\n  then: rule!AIA_MTR_ModelTestSuiteCreated(),\n  /*Model Test Suite Updated*/\n  equals: cons!AIA_MTR_MODEL_TEST_SUITE_UPDATED,\n  then: rule!AIA_MTR_ModelTestSuiteUpdated(),\n  /*Model Test Run Initiated*/\n  equals: cons!AIA_MTR_MODEL_TEST_RUN_INITIATED,\n  then: rule!AIA_MTR_ModelTestRunInitiated(),\n  /*Classification Model Version Created with Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_MODEL_VERSION_CREATED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationModelVersionCreated(),\n  /*Classification Instance Created for a Model Version that Allows Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationInstanceCreated(),\n  /*Classification Instance Reconciled for a Model Version that Allows Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationInstanceReconciled(),\n  default: null\n)"
    },
    "_a-0000eeb2-df20-8000-9bfe-011c48011c48_154565": {
      "name": "AIA_MTR_InstanceValidationAiRuleOccurance",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180846": {
      "name": "AIA_MTR_ClassificationModelCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180860": {
      "name": "AIA_MTR_ClassificationInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180834": {
      "name": "AIA_MTR_ExtractionModelCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_12129": {
      "name": "AIA_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!brandingDefault: getbrandingconfig(\n    cons!AIA_DOC_DEFAULT_BRANDING_CONFIG,\n    true()\n  ),\n  local!output: reduce(\n    #\"urn:appian:function:v1:a:update\"(_, _, _),\n    a!map(),\n    merge(\n      {\n        local!brandingDefault.defaultBranding.key,\n        local!brandingDefault.customBranding.key\n      },\n      {\n        local!brandingDefault.defaultBranding.value,\n        local!brandingDefault.customBranding.value\n      }\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_38276": {
      "name": "AIA_Template_GreyBoxWithTitle",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: a!defaultValue(ri!brandingMap, rule!AIA_UTIL_LoadBrandingMap()),\n  #\"SYSTEM_SYSRULES_boxLayout\"(\n    label: ri!header,\n    labelHeadingTag: \"H2\",\n    contents: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        ri!contents\n      },\n      style: local!brandingMap.DefaultPageBackground,\n      shape: \"SEMI_ROUNDED\",\n      padding: \"STANDARD\",\n      marginAbove: \"NONE\",\n      marginBelow: \"NONE\",\n      showBorder: false\n    ),\n    style: local!brandingMap.Blue0,\n    shape: \"SEMI_ROUNDED\",\n    isCollapsible: true,\n    padding: \"NONE\",\n    marginBelow: \"STANDARD\",\n    showBorder: false\n  )\n)"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505631": {
      "name": "AIA_MTR_MultipleOutputsClassificationInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee3e-060c-8000-9bb8-011c48011c48_204932": {
      "name": "AIA_Extraction_CreateJsonSchema",
      "type": "Expression Rule",
      "sail_code": "\na!localVariables(\n  local!modelFields: #\"SYSTEM_SYSRULES_fromJson_v1\"(#\"SYSTEM_SYSRULES_toJson_v1\"(\n    a!defaultValue(\n      ri!fields,\n      filter(\n        rule!AIA_Extraction_DisplayPromptField(\n          field: _,\n          mode: ri!mode,\n          operation: ri!operation\n        ),\n        ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.fields]\n      )\n    )\n  )),\n  if(\n    a!isNotNullOrEmpty(local!modelFields),\n    a!localVariables(\n      local!fields: reduce(\n        #\"urn:appian:function:v1:a:update\",\n        a!map(),\n        merge(\n          local!modelFields.key,\n          #\"SYSTEM_SYSRULES_forEach\"(\n            local!modelFields,\n            rule!AIA_FieldJsonSchema(\n              item: fv!item,\n              mode: ri!mode,\n              operation: ri!operation,\n              includeArrays: a!defaultValue(ri!includeArrays, true)\n            )\n          )\n        )\n      ),\n      local!map: #\"SYSTEM_SYSRULES_fromJson_v1\"(\n        #\"SYSTEM_SYSRULES_toJson_v1\"(\n          value: a!map(\n            \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n            type: \"object\",\n            properties: local!fields,\n            required: reject(\n              fn!isnull,\n              index(\n                local!modelFields.key,\n                where(local!modelFields.required)\n              )\n            )\n          ),\n          removeNullOrEmptyFields: true\n        )\n      ),\n      if(\n        ri!returnJson,\n        prettyprintjson(#\"SYSTEM_SYSRULES_toJson_v1\"(local!map)),\n        local!map\n      )\n    ),\n    null\n  )\n)"
    },
    "_a-0000eed9-05f0-8000-9d10-011c48011c48_197052": {
      "name": "AIA_ViewMoreField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!viewMore: false,\n  local!numChars: a!defaultValue(\n    ri!numChars,\n    500\n  ),\n  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n    showWhen: ri!showWhen,\n    label: ri!label,\n    labelPosition: a!defaultValue(ri!labelPosition, \"COLLAPSED\"),\n    value: {\n      if(\n        local!viewMore,\n        ri!value,\n        left(\n          ri!value,\n          local!numChars\n        )\n      ),\n      if(\n        len(\n          ri!value\n        ) > local!numChars,\n        {\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: {\n              \"... \",\n              #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                text: #\"urn:appian:translation-string:v1:898d2964-2288-4709-a5ba-aba0dd098bd6\",\n                linkStyle: \"STANDALONE\",\n                link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                  saveInto: a!save(\n                    local!viewMore,\n                    not(\n                      local!viewMore\n                    )\n                  )\n                )\n              )\n            },\n            showWhen: not(\n              local!viewMore\n            )\n          ),\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: #\"urn:appian:translation-string:v1:b0b89a5a-3446-45e5-89e5-dc8b1c26caca\",\n            linkStyle: \"STANDALONE\",\n            link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n              saveInto: a!save(\n                local!viewMore,\n                not(\n                  local!viewMore\n                )\n              )\n            ),\n            showWhen: local!viewMore\n          )\n        },\n        {}\n      )\n    }\n  )\n)"
    },
    "_a-0000eec9-5676-8000-9c92-011c48011c48_179352": {
      "name": "AIA_MTR_ConfidenceThresholdEnabled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eea3-15ee-8000-9bd4-011c48011c48_137447": {
      "name": "AIA_MTR_ModelVersionConfigureSampling",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eeca-c121-8000-9cab-011c48011c48_181995": {
      "name": "AIA_MTR_ExtractionModelVersionRestore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180874": {
      "name": "AIA_MTR_ClassificationInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_73130": {
      "name": "AIA_Template_ToggleField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!useRecord: and(\n    a!isNotNullOrEmpty(ri!record),\n    a!isNotNullOrEmpty(ri!field)\n  ),\n  local!value: a!defaultValue(\n    ri!value,\n    if(\n      local!useRecord,\n      a!defaultValue(ri!record[ri!field], ri!defaultValue),\n      ri!defaultValue\n    )\n  ),\n  #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n    spacing: \"SPARSE\",\n    items: {\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          labelPosition: \"COLLAPSED\",\n          value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n            icon: if(\n              local!value,\n              \"toggle-on\",\n              \"toggle-off\"\n            ),\n            size: \"MEDIUM_PLUS\",\n            color: if(\n              local!value,\n              \"ACCENT\",\n              ri!brandingMap.gray3\n            ),\n            link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n              saveInto: {\n                if(\n                  local!useRecord,\n                  a!save(\n                    ri!record[ri!field],\n                    not(local!value)\n                  ),\n                  {}\n                ),\n                ri!saveInto\n              }\n            ),\n            linkStyle: \"STANDALONE\",\n            altText: if(\n              local!value,\n              #\"urn:appian:translation-string:v1:2bcaa33e-f7f3-49e1-a731-448d50b81aa5\"(#\"urn:appian:translation-variable:v1:579fd534-6b9b-425f-bc9f-b634242559ae\": ri!label),\n              #\"urn:appian:translation-string:v1:5d5ccfce-4251-4290-af1d-2bca780b08dd\"(#\"urn:appian:translation-variable:v1:aa7f15e8-7ec1-4fe5-bee9-f84f3f6c85ca\": ri!label)\n            )\n          ),\n\n        ),\n        width: \"MINIMIZE\"\n      ),\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          labelPosition: \"COLLAPSED\",\n          value: {\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!label,\n              style: \"STRONG\",\n            ),\n            char(\n              10\n            ),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!description,\n              color: ri!brandingMap.gray3\n            )\n          }\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180867": {
      "name": "AIA_MTR_ExtractionInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92474": {
      "name": "AIA_MTR_ClassificationInstanceError",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ec44-cb49-8000-9be6-011c48011c48_79495": {
      "name": "AIA_Extraction_GetFieldOptions",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNotNullOrEmpty(\n    ri!ModelVersionField[recordType!AIA Extraction Model Version Field.optionRule]\n  ),\n  a!localVariables(\n    local!optionsRule: a!refreshVariable(\n      refreshAlways: true,\n      value: getrulereferencebyname(\n        ri!ModelVersionField[recordType!AIA Extraction Model Version Field.optionRule]\n      )\n    ),\n    a!map(options: local!optionsRule())\n  ),\n  null\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92481": {
      "name": "AIA_MTR_ExtractionInstanceExtractedWithErrors",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_39672": {
      "name": "AIA_UseAiReviewDefault",
      "type": "Expression Rule",
      "sail_code": "not(\n  a!defaultValue(\n    ri!ModelVersionField[recordType!AIA Extraction Model Version Field.isNotTracked], false\n  ) = true\n)"
    },
    "_a-0000eed9-05f0-8000-9d10-011c48011c48_196878": {
      "name": "AIA_AIReviewPromptSettings",
      "type": "Interface",
      "sail_code": "{\n  rule!AIA_LlmOptionField(\n    value: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewLlm],\n    saveInto: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewLlm],\n    defaultValue: rule!AIA_AiReviewDefaultModel(),\n    includeVision: true,\n    required: true\n  ),\n  #\"SYSTEM_SYSRULES_paragraphField\"(\n    label: #\"urn:appian:translation-string:v1:bf997137-f6fd-4bc0-9f80-aecac9328d8d\",\n    value: a!defaultValue(\n      ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewRole],\n      rule!AIA_Extraction_DefaultAiReviwRole()\n    ),\n    saveInto: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewRole],\n    height: \"MEDIUM\"\n  ),\n  rule!AIA_ViewMoreField(\n    numChars: 500,\n    label: #\"urn:appian:translation-string:v1:c38ee063-c9c5-473e-83ba-ac8481afcf40\",\n    value: rule!AIA_AiReviewPromptFixed(\n      ModelVersion: ri!ExtractionModelVersion\n    )\n  ),\n  #\"SYSTEM_SYSRULES_paragraphField\"(\n    label: #\"urn:appian:translation-string:v1:bdd579f6-3b22-433e-9a38-762e59ccaaa6\",\n    placeholder: #\"urn:appian:translation-string:v1:53a25e30-cd29-4633-83d1-455142abd72c\",\n    value: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewInstructions],\n    saveInto: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewInstructions],\n    height: \"MEDIUM\"\n  )\n}"
    },
    "_a-0000ee66-4fc0-8000-9baa-011c48011c48_68871": {
      "name": "AIA_LlmOptionField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!options: rule!AIA_ENUM_LlmVersions(\n    includeVision: ri!includeVision\n  ),\n  local!notFound: and(\n    not(contains(local!options.value, ri!value)),\n    a!isNotNullOrEmpty(ri!value)\n  ),\n  local!newOptions: if(\n    local!notFound,\n    append(local!options, a!map(label: ri!value, value: ri!value)),\n    local!options\n  ),\n  #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n    label: #\"urn:appian:translation-string:v1:444b9cec-06e7-41a0-834f-1394a5adb599\",\n    showWhen: cons!AIA_FLAG_SHOW_LLM_OPTIONS,\n    choiceLabels: local!newOptions.label,\n    choiceValues: local!newOptions.value,\n    required: a!defaultValue(ri!required, false),\n    value: a!defaultValue(\n      ri!value,\n      ri!defaultValue\n    ),\n    validations: if(\n      local!notFound,\n      #\"urn:appian:translation-string:v1:4576c941-6317-448f-b5b7-aed17e4f8499\",\n      null\n    ),\n    placeholder: #\"urn:appian:translation-string:v1:efc088df-03da-46cb-a23f-3dfc806289d4\",\n    saveInto: ri!saveInto\n  )\n)"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_26889": {
      "name": "AIA_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: a!flatten(ri!field),\n      expression: a!map(\n        field: fv!item,\n        value: if(\n          fv!itemCount = 1,\n          ri!value,\n          index(a!flatten(ri!value), fv!index, null)\n        )\n      )\n    )\n  ),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!AIA_UTIL_Filter_Reducer(\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _\n      ),\n      enumerate(count(a!flatten(ri!records))) + 1,\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  )\n)"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505670": {
      "name": "AIA_MTR_MultipleOutputsClassificationInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_38234": {
      "name": "AIA_Extraction_CreateUpdateAiReview_RecordAction",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: rule!AIA_UTIL_LoadBrandingMap(),\n  local!filteredFields: #\"SYSTEM_SYSRULES_forEach\"(\n    rule!AIA_UTIL_Filter(\n      records: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.fields],\n      field: recordType!AIA Extraction Model Version Field.isHidden,\n      value: true,\n      filterType: \"REJECT\"\n    ),\n    fv!item\n  ),\n  local!allNull: rule!AIA_UTIL_Filter(\n    records: local!filteredFields,\n    field: recordType!AIA Extraction Model Version Field.useAiReview,\n    value: false,\n    filterType: \"REJECT_COUNT\"\n  ) = 0,\n  local!fields: if(\n    local!allNull,\n    #\"SYSTEM_SYSRULES_forEach\"(\n      local!filteredFields,\n      #\"urn:appian:function:v1:a:update\"(\n        fv!item,\n        recordType!AIA Extraction Model Version Field.useAiReview,\n        rule!AIA_UseAiReviewDefault(ModelVersionField: fv!item)\n      )\n    ),\n    local!filteredFields\n  ),\n  #\"SYSTEM_SYSRULES_formLayout_v2\"(\n    titleBar: #\"urn:appian:translation-string:v1:a3401b22-e2d5-4374-a9c2-f2f8265ef509\",\n    showTitleBarDivider: true,\n    contents: {\n      rule!AIA_Template_ToggleField(\n        label: #\"urn:appian:translation-string:v1:24d7dbd5-458e-438d-84d3-99659fe1c198\",\n        description: #\"urn:appian:translation-string:v1:f21d2ab4-1371-4a0a-8961-1ecaa8898fe6\",\n        field: recordType!AIA Extraction Model Version.useAiReview,\n        saveInto: {\n          a!save(\n            ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewLlm],\n            if(\n              ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.useAiReview],\n              a!defaultValue(\n                ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.aiReviewLlm],\n                rule!AIA_AiReviewDefaultModel()\n              ),\n              null\n            )\n          )\n        },\n        record: ri!ExtractionModelVersion,\n        defaultValue: false,\n        brandingMap: local!brandingMap\n      ),\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        showWhen: ri!ExtractionModelVersion[recordType!AIA Extraction Model Version.useAiReview] = true,\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"( contents: rule!AIA_Template_GreyCardWithInnerTitle(\n              title: #\"urn:appian:translation-string:v1:cf5a4b43-0ed0-41b3-8a07-48df7df5a536\",\n              contents: {\n                if(\n                  a!isNotNullOrEmpty(\n                    rule!AIA_UTIL_Filter(\n                      records: local!fields,\n                      field: recordType!AIA Extraction Model Version Field.type,\n                      value: cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n                      filterType: \"REJECT\"\n                    )\n                  ),\n                  a!localVariables(\n                    local!selectedNum: length(\n                      where(\n                        #\"SYSTEM_SYSRULES_forEach\"(\n                          local!fields,\n                          a!defaultValue(\n                            fv!item[recordType!AIA Extraction Model Version Field.useAiReview],\n                            rule!AIA_UseAiReviewDefault(ModelVersionField: fv!item)\n                          )\n                        )\n                      )\n                    ),\n                    {\n                      #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        label: #\"urn:appian:translation-string:v1:15d21e83-aadd-4b1f-9cdf-d9db8556efc3\",\n                        labelPosition: \"COLLAPSED\",\n                        value: {\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: #\"urn:appian:translation-string:v1:15d21e83-aadd-4b1f-9cdf-d9db8556efc3\",\n                            color: local!brandingMap.gray3,\n                            style: \"STRONG\"\n                          ),\n                          char(10),\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: #\"urn:appian:translation-string:v1:a0fe443d-7fc3-46ee-b080-547e902ff97c\",\n                            color: local!brandingMap.gray3,\n                            size: \"SMALL\"\n                          )\n                        }\n                      ),\n                      #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        value: {\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: #\"urn:appian:translation-string:v1:1cad37d6-f663-4bbe-8945-8448b49fa6ed\",\n                            link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                              saveInto: {\n                                #\"SYSTEM_SYSRULES_forEach\"(\n                                  items: local!fields,\n                                  expression: a!save(\n                                    fv!item[recordType!AIA Extraction Model Version Field.useAiReview],\n                                    true\n                                  )\n                                )\n                              },\n                              showWhen: local!selectedNum < length(local!fields)\n                            ),\n                            linkStyle: \"STANDALONE\"\n                          ),\n                          \" | \",\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: #\"urn:appian:translation-string:v1:9a6db0b2-b94b-42aa-b471-512a34bab8fb\",\n                            link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                              saveInto: {\n                                #\"SYSTEM_SYSRULES_forEach\"(\n                                  items: local!fields,\n                                  expression: a!save(\n                                    fv!item[recordType!AIA Extraction Model Version Field.useAiReview],\n                                    false\n                                  )\n                                )\n                              },\n                              showWhen: local!selectedNum > 0\n                            ),\n                            linkStyle: \"STANDALONE\"\n                          )\n                        }\n                      ),\n                      #\"SYSTEM_SYSRULES_columnsLayout\"(\n                        columns: #\"SYSTEM_SYSRULES_forEach\"(\n                          enumerate(2),\n                          #\"SYSTEM_SYSRULES_columnLayout\"(\n                            contents: {\n                              rule!AIA_SubDisplayFieldSelections(\n                                fields: rule!AIA_UTIL_Filter(\n                                  records: local!fields,\n                                  field: recordType!AIA Extraction Model Version Field.type,\n                                  value: cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n                                  filterType: \"REJECT\"\n                                ),\n                                allFields: local!fields,\n                                columnIndex: fv!index,\n                                numColumns: 2,\n                                defaultRule: if(\n                                  local!allNull,\n                                  rule!AIA_UseAiReviewDefault,\n                                  fn!false\n                                ),\n                                brandingMap: local!brandingMap\n                              )\n                            }\n                          )\n                        )\n                      )\n                    }\n                  ),\n                  {}\n                ),\n                if(\n                  a!isNotNullOrEmpty(\n                    rule!AIA_UTIL_Filter(\n                      records: local!fields,\n                      field: recordType!AIA Extraction Model Version Field.type,\n                      value: cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n                      filterType: \"FILTER\"\n                    )\n                  ),\n                  {\n                    #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                      label: #\"urn:appian:translation-string:v1:0980bd92-ce71-4958-a780-474e7ef58f42\",\n                      labelPosition: \"COLLAPSED\",\n                      value: {\n                        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                          text: #\"urn:appian:translation-string:v1:0980bd92-ce71-4958-a780-474e7ef58f42\",\n                          color: local!brandingMap.gray3,\n                          style: \"STRONG\"\n                        ),\n                        char(10),\n                        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                          text: #\"urn:appian:translation-string:v1:83c65f90-1272-4327-b7be-fcc52a5728de\",\n                          color: local!brandingMap.gray3,\n                          size: \"SMALL\"\n                        )\n                      }\n                    ),\n                    #\"SYSTEM_SYSRULES_columnsLayout\"(\n                      columns: #\"SYSTEM_SYSRULES_forEach\"(\n                        enumerate(2),\n                        #\"SYSTEM_SYSRULES_columnLayout\"(\n                          contents: {\n                            rule!AIA_SubDisplayFieldSelections(\n                              fields: rule!AIA_UTIL_Filter(\n                                records: local!fields,\n                                field: recordType!AIA Extraction Model Version Field.type,\n                                value: cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n                                filterType: \"FILTER\"\n                              ),\n                              allFields: local!fields,\n                              columnIndex: fv!index,\n                              numColumns: 2,\n                              defaultRule: if(\n                                local!allNull,\n                                rule!AIA_UseAiReviewDefault,\n                                fn!false\n                              ),\n                              brandingMap: local!brandingMap\n                            )\n                          }\n                        )\n                      )\n                    )\n                  },\n                  {}\n                )\n              },\n              brandingMap: local!brandingMap,\n              headerPosition: \"STRONG\",\n              height: \"AUTO\"\n            )\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            rule!AIA_Template_GreyBoxWithTitle(\n              header: #\"urn:appian:translation-string:v1:c25a01cf-0d91-4f6e-a836-b185dc1105a8\",\n              contents: {\n                rule!AIA_AIReviewPromptSettings(\n                  ExtractionModelVersion: ri!ExtractionModelVersion\n                )\n              },\n              brandingMap: local!brandingMap\n            )\n          )\n        },\n        marginAbove: \"STANDARD\"\n      )\n    },\n    contentsWidth: \"FULL\",\n    focusOnFirstInput: false,\n    buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n      primaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:4d40defb-10bc-4a8a-bd4e-a7d76f054fdc\",\n          saveInto: {\n            #\"SYSTEM_SYSRULES_forEach\"(\n              local!fields,\n              a!save(\n                fv!item[recordType!AIA Extraction Model Version Field.useAiReview],\n                if(\n                  a!isNullOrEmpty(fv!item[recordType!AIA Extraction Model Version Field.useAiReview]),\n                  if(\n                    local!allNull,\n                    rule!AIA_UseAiReviewDefault(fv!item),\n                    false\n                  ),\n                  fv!item[recordType!AIA Extraction Model Version Field.useAiReview]\n                )\n              )\n            ),\n            a!save(\n              ri!ExtractionModelVersion,\n              #\"urn:appian:function:v1:a:update\"(\n                ri!ExtractionModelVersion,\n                recordType!AIA Extraction Model Version.fields,\n                local!fields\n              )\n            )\n          },\n          submit: true,\n          style: \"SOLID\"\n        )\n      },\n      secondaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:df61ccad-fe9a-4d7a-ba9a-d89b08f3467a\",\n          saveInto: a!save(ri!isCancel, true),\n          submit: true\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000ecea-6c5f-8000-9c4b-011c48011c48_190177": {
      "name": "AIA_Extraction_DisplayPromptField",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!mode,\n  whenTrue: a!isNullOrEmpty(ri!field[recordType!AIA Extraction Model Version Field.key]),\n  then: false,\n  equals: cons!AIA_SCHEMA_MODE_AI_REVIEW,\n  then: a!defaultValue(ri!field[recordType!AIA Extraction Model Version Field.useAiReview], false) = true,\n  equals: cons!AIA_PROMPT_MODE_CALCULATED,\n  then: or(\n    ri!field[recordType!AIA Extraction Model Version Field.extractionType] = cons!AIA_EXTRACTION_TYPES[4],\n    and(\n      ri!field[recordType!AIA Extraction Model Version Field.type] = cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n      contains(\n        touniformstring(\n          ri!field[recordType!AIA Extraction Model Version Field.columns.extractionType]\n        ),\n        cons!AIA_EXTRACTION_TYPES[4]\n      )\n    )\n  ),\n  default: and(\n    /* Filter out field by section */\n    or(\n      and(\n        a!isNullOrEmpty(ri!sectionFilter),\n        a!isNullOrEmpty(ri!sectionId)\n      ),\n      and(\n        a!isNotNullOrEmpty(ri!sectionFilter),\n        a!isNotNullOrEmpty(\n          ri!field[recordType!AIA Extraction Model Version Field.section]\n        ),\n        ri!field[recordType!AIA Extraction Model Version Field.section] = ri!sectionFilter\n      ),\n      or(\n        and(\n          a!isNotNullOrEmpty(ri!sectionId),\n          a!isNotNullOrEmpty(\n            ri!field[recordType!AIA Extraction Model Version Field.sectionId]\n          ),\n          ri!field[recordType!AIA Extraction Model Version Field.sectionId] = ri!sectionId\n        ),\n        and(\n          a!isNotNullOrEmpty(ri!sectionId),\n          a!isNullOrEmpty(\n            ri!field[recordType!AIA Extraction Model Version Field.sectionId]\n          ),\n          ri!sectionId = - 1\n        )\n      )\n    ),\n    /* Filter out field by extraction type - Generative AI */\n    or(\n      ri!field[recordType!AIA Extraction Model Version Field.extractionType] = cons!AIA_EXTRACTION_TYPES[1],\n      a!isNullOrEmpty(\n        ri!field[recordType!AIA Extraction Model Version Field.extractionType]\n      )\n    ),\n    /* Filter out field by operation type */\n    or(\n      /* Filter out field by operation type - Generative AI - Text */\n      and(\n        or(\n          a!isNullOrEmpty(ri!operation),\n          ri!operation = cons!AIA_PROMPT_OPERATION_MODE_TEXT\n        ),\n        or(\n          a!isNullOrEmpty(ri!field[recordType!AIA Extraction Model Version Field.useVision]),\n          ri!field[recordType!AIA Extraction Model Version Field.useVision] = false,\n        )\n      ),\n      /* Filter out field by operation type - Generative AI - Vision */\n      and(\n        ri!operation = cons!AIA_PROMPT_OPERATION_MODE_MULTIMODAL,\n        or(\n          and(\n            a!isNotNullOrEmpty(ri!field[recordType!AIA Extraction Model Version Field.useVision]),\n            ri!field[recordType!AIA Extraction Model Version Field.useVision] = true\n          ),\n          and(\n            a!isNotNullOrEmpty(ri!parentField[recordType!AIA Extraction Model Version Field.useVision]),\n            ri!parentField[recordType!AIA Extraction Model Version Field.useVision] = true\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505575": {
      "name": "AIA_MTR_MultipleOutputsClassificationModelVersionCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483943": {
      "name": "AIA_MTR_ModelTestSuiteCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92571": {
      "name": "AIA_MTR_ExtractionInstanceAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "0002ee65-8cbf-8000-fb31-7f0000014e7a": {
      "name": "AIA Extraction Model Configure AI Review",
      "type": "Process Model",
      "sail_code": "// Input: ?\n={pv!ExtractionModelVersion}\n\n// Input: ?\n={recordType!AIA Extraction Model Version}\n\n// Input: ?\n=rule!AIA_LogMetric( name: cons!AIA_MTR_AI_REVIEW_MODEL_VERSION)"
    },
    "_a-0000ee66-4fc0-8000-9baa-011c48011c48_43003": {
      "name": "AIA_ENUM_FieldSchemas",
      "type": "Expression Rule",
      "sail_code": "{\n  a!map(\n    name: cons!AIA_SCHEMA_MODE_PLAIN,\n    fields: {}\n  ),\n  a!map(\n    name: cons!AIA_SCHEMA_MODE_SPAN,\n    fields: {\n      a!map(\n        key: \"value\",\n        useFormat: true\n      ),\n      a!map(\n        key: \"spanId\",\n        required: false,\n        type: \"string\"\n      )\n    }\n  ),\n  a!map(\n    name: cons!AIA_PROMPT_MODE_CALCULATED,\n    fields: {\n      a!map(\n        key: \"value\",\n        useFormat: true\n      ),\n      a!map(\n        key: \"spanId\",\n        description: \"spanIds from all of the values that were used to derive the result. Return null if the values did not have spanId.\",\n        required: false,\n        type: \"string\"\n      ),\n      a!map(\n        key: \"reasoning\",\n        required: true,\n        type: \"string\"\n      )\n    }\n  ),\n  a!map(\n    name: cons!AIA_SCHEMA_MODE_AI_REVIEW,\n    fields: {\n      a!map(\n        key: \"extractedValue\",\n        required: false,\n        useFormat: true\n      ),\n      a!map(\n        key: \"suggestedValue\",\n        required: false,\n        useFormat: true\n      ),\n      a!map(\n        key: \"isCorrect\",\n        required: true,\n        type: \"boolean\"\n      ),\n      a!map(\n        key: \"reasoning\",\n        required: true,\n        type: \"string\"\n      )\n    }\n  )\n}"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_39721": {
      "name": "AIA_Template_Checkbox",
      "type": "Interface",
      "sail_code": "if(\n  a!defaultValue(\n    ri!showWhen,\n    true\n  ),\n  a!localVariables(\n    local!brandingMap: a!defaultValue(\n      ri!brandingMap,\n      rule!AIA_UTIL_LoadBrandingMap()\n    ),\n    #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n      labelPosition: \"COLLAPSED\",\n      value: {\n        #\"SYSTEM_SYSRULES_richTextIcon\"(\n          color: a!defaultValue(\n            ri!color,\n            if(\n              a!defaultValue(\n                ri!record[ri!field],\n                ri!defaultValue\n              ),\n              local!brandingMap.Blue3,\n              local!brandingMap.Gray3,\n            )\n          ),\n          icon: if(\n            a!defaultValue(\n              ri!record[ri!field],\n              ri!defaultValue\n            ),\n            \"check-square\",\n            \"square-o\"\n          ),\n          link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n            saveInto: {\n              if(\n                a!defaultValue(ri!saveIntoRecord, true),\n                a!save(\n                  ri!record[ri!field],\n                  not(a!defaultValue(ri!record[ri!field], ri!defaultValue))\n                ),\n                {}\n              ),\n              ri!saveInto\n            },\n            showWhen: a!defaultValue(\n              ri!linkShowWhen,\n              true\n            )\n          ),\n          linkStyle: \"STANDALONE\",\n          altText: if(\n            a!defaultValue(\n              ri!record[ri!field],\n              ri!defaultValue\n            ),\n            #\"urn:appian:translation-string:v1:2bcaa33e-f7f3-49e1-a731-448d50b81aa5\"(#\"urn:appian:translation-variable:v1:579fd534-6b9b-425f-bc9f-b634242559ae\": ri!caption),\n            #\"urn:appian:translation-string:v1:5d5ccfce-4251-4290-af1d-2bca780b08dd\"(#\"urn:appian:translation-variable:v1:aa7f15e8-7ec1-4fe5-bee9-f84f3f6c85ca\": ri!caption)\n          )\n        ),\n        if(\n          a!isNotNullOrEmpty(ri!label),\n          {\n            \" \",\n            ri!label\n          },\n          {}\n        )\n      },\n      align: a!defaultValue(ri!align, \"LEFT\")\n    )\n  ),\n  {}\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92564": {
      "name": "AIA_MTR_ExtractionInstanceFieldAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eed9-05f0-8000-9d10-011c48011c48_194771": {
      "name": "AIA_AiReviewDefaultModel",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: rule!AIA_ENUM_LlmVersions(\n    includeVision: true,\n    returnOnlySupportedLlms: true\n  ),\n  default: rule!AIA_DefaultModel(),\n  whenTrue: contains(fv!value.value,cons!AIA_MODEL_SONNET_3_7_MULTIMODAL),\n  then: cons!AIA_MODEL_SONNET_3_7_MULTIMODAL,\n  whenTrue: contains(fv!value.value,cons!AIA_MODEL_SONNET_3_5_MULTIMODAL),\n  then: cons!AIA_MODEL_SONNET_3_5_MULTIMODAL\n)"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_38807": {
      "name": "AIA_AiReviewPromptFixed",
      "type": "Expression Rule",
      "sail_code": "\"## Task Overview\n1. Analyze the provided source document carefully\n2. Compare the extracted data (provided as JSON) against the source document field by field\n3. Determine if each extracted value is correct based on the source document\n4. Provide corrected values where necessary\n5. Output a structured JSON with verification results\n\n## Input\nA source document containing the original information\nJSON data previously extracted from the document\n\n## Output Format\n\nYour final output must be a single **JSON object** representing the original data, with each field enriched to include its location. The schema for an enriched field is as follows:\n\n```json\n\" & rule!AIA_Extraction_CreateJsonSchema(\n  ExtractionModelVersion: ri!ModelVersion,\n  mode: cons!AIA_SCHEMA_MODE_AI_REVIEW,\n  returnJson: true,\n  includeArrays: false\n) & \"\n```\n\n## Verification Guidelines\n* Be thorough and precise in your verification\n* Check exact values, not just approximate matches\n* For dates, verify the value against the ISO extracted date value.  **Do not return errors for dates not matching the correct format**\n* For monetary amounts, verify the exact number\n* For text fields, verify the exact spelling and formatting\n* For arrays, verify each item and its fields individually\n\n------------\n\n## Instructions\n\n1.  **Analyze the source document** provided.\n2.  **Review the extracted data** provided under `[EXTRACTED DATA]`.\n3.  **Only return fields referenced in the output format, make sure the output json matches the Output Format schema.\n4.  **For each field referenced in the output schema** (including nested fields within `arrays`), create an object containing three keys: `value`, `isCorrect`, and `reasoning`.\n    * `extractedValue`: This should be value original extracted from the document before the review.\n    * `suggestedValue`: This should be the **correct** value as found in the document. If the original extraction was wrong, you must provide the correct value here. If the **correct** value should be blank, return back \"\".\n    * `isCorrect`: A boolean (`true` or `false`). Set to `true` if the originally extracted data matches the document, and `false` otherwise.\n    * `reasoning`: A brief string explaining your decision. If correct, state where you found the information (e.g., \"\"The invoice number matches the value at the top right of the document.\"\"). If incorrect, explain the discrepancy (e.g., \"\"The extracted date was 2023-10-26, but the document clearly shows 2023-10-27.\"\").\n\""
    }
  }
}
{
  "_metadata": {
    "bundle_id": "AIA_Process_Model_-_newProcessModel"
  },
  "objects": {
    "7f9e302e-c75b-4726-bdc6-3f89ed413523": {
      "name": "AIA Create Or Update Process Model",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=deletedStepsRecords\n\n// Output: ?\nAC!CountOfRecordsDeleted\n\n// Input: ?\n=pv!record\n\n// Input: ?\n=recordType!AIA Process Model\n\n// Output: ?\nAC!RecordsUpdated"
    },
    "_a-0000ec40-0355-8000-9be4-011c48011c48_65141": {
      "name": "SHRD_MovePositionInArray",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!item: index(ri!array, ri!fromIndex, null),\n\n  local!removeFromArray: remove(ri!array, ri!fromIndex),\n\n  insert(local!removeFromArray, local!item, ri!toIndex)\n)"
    },
    "86eaf788-14a7-4450-a515-3f5f707e993f": {
      "name": "AIA_CreateOrUpdateProcessModel",
      "type": "Interface",
      "sail_code": "#\"SYSTEM_SYSRULES_formLayout_v1\"(\n  skipAutoFocus: true(),\n  label: if(\n    ri!isUpdate,\n    \"Update Process Model\",\n    \"Create Process Model\"\n  ),\n  contents: {\n    #\"SYSTEM_SYSRULES_columnsLayout\"(\n      columns: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_textField\"(\n              label: \"Name\",\n              labelPosition: \"ABOVE\",\n              required: true,\n              value: ri!record[recordType!AIA Process Model.name],\n              saveInto: ri!record[recordType!AIA Process Model.name],\n              characterLimit: 255\n            )\n          }\n        ),\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          contents: {\n            #\"SYSTEM_SYSRULES_textField\"(\n              label: \"Description\",\n              labelPosition: \"ABOVE\",\n              required: false,\n              value: ri!record[recordType!AIA Process Model.description],\n              saveInto: ri!record[recordType!AIA Process Model.description],\n              characterLimit: 255\n            )\n          }\n        )\n      }\n    ),\n    #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n      label: \"Steps\",\n      labelSize: \"MEDIUM_PLUS\",\n      labelColor: \"STANDARD\",\n      labelHeadingTag: \"H2\",\n      isCollapsible: false,\n      contents: {\n        #\"SYSTEM_SYSRULES_gridLayout\"(\n          height: \"SHORT_PLUS\",\n          labelPosition: \"COLLAPSED\",\n          shadeAlternateRows: true,\n          headerCells: {\n            #\"SYSTEM_SYSRULES_gridLayoutHeaderCell\"(label: \"Model Type\"),\n            #\"SYSTEM_SYSRULES_gridLayoutHeaderCell\"(label: \"Model\"),\n            #\"SYSTEM_SYSRULES_gridLayoutHeaderCell\"(),\n            #\"SYSTEM_SYSRULES_gridLayoutHeaderCell\"(),\n            #\"SYSTEM_SYSRULES_gridLayoutHeaderCell\"()\n          },\n          columnConfigs: {\n            #\"SYSTEM_SYSRULES_gridLayoutColumnConfig\"(width: \"DISTRIBUTE\", weight: \"1X\"),\n            #\"SYSTEM_SYSRULES_gridLayoutColumnConfig\"(width: \"DISTRIBUTE\", weight: \"2X\"),\n            #\"SYSTEM_SYSRULES_gridLayoutColumnConfig\"(width: \"ICON\"),\n            #\"SYSTEM_SYSRULES_gridLayoutColumnConfig\"(width: \"ICON\"),\n            #\"SYSTEM_SYSRULES_gridLayoutColumnConfig\"(width: \"ICON\")\n          },\n          rows: #\"SYSTEM_SYSRULES_forEach\"(\n            items: ri!record[recordType!AIA Process Model.steps],\n            expression: #\"SYSTEM_SYSRULES_gridRowLayout\"(\n              id: fv!index,\n              contents: {\n                #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                  choiceLabels: cons!AIA_MODEL_TYPE_LABELS,\n                  choiceValues: cons!AIA_MODEL_TYPE_VALUES,\n                  value: fv!item[recordType!AIA Process Model Step.modelType],\n                  required: true,\n                  saveInto: {\n                    fv!item[recordType!AIA Process Model Step.modelType],\n                    a!save(\n                      fv!item[recordType!AIA Process Model Step.modelId],\n                      null\n                    )\n                  },\n                  placeholder: \"Select type\"\n                ),\n                #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                  data: if(\n                    fv!item[recordType!AIA Process Model Step.modelType] = cons!AIA_MODEL_TYPE_VALUES[1],\n                    recordType!AIA Extraction Model,\n                    recordType!AIA Classification Model\n                  ),\n                  choiceLabels: if(\n                    fv!item[recordType!AIA Process Model Step.modelType] = cons!AIA_MODEL_TYPE_VALUES[1],\n                    recordType!AIA Extraction Model.name,\n                    recordType!AIA Classification Model.name\n                  ),\n                  choiceValues: if(\n                    fv!item[recordType!AIA Process Model Step.modelType] = cons!AIA_MODEL_TYPE_VALUES[1],\n                    recordType!AIA Extraction Model.modelId,\n                    recordType!AIA Classification Model.modelId\n                  ),\n                  placeholder: \"Select model\",\n                  required: true,\n                  value: fv!item[recordType!AIA Process Model Step.modelId],\n                  saveInto: fv!item[recordType!AIA Process Model Step.modelId],\n                  disabled: a!isNullOrEmpty(\n                    fv!item[recordType!AIA Process Model Step.modelType]\n                  )\n                ),\n                #\"SYSTEM_SYSRULES_imageField_v1\"(\n                  images: #\"SYSTEM_SYSRULES_documentImage\"(\n                    document: #\"SYSTEM_SYSRULES_iconIndicator\"(\n                      icon: if(\n                        fv!isFirst,\n                        \"MOVE_UP_DISABLED\",\n                        \"MOVE_UP\"\n                      )\n                    ),\n                    altText: \"Move up\",\n                    link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      showWhen: not(fv!isFirst),\n                      value: fv!index,\n                      saveInto: {\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps.order][fv!index],\n                          fv!index - 1\n                        ),\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps.order][fv!index - 1],\n                          fv!index\n                        ),\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps],\n                          rule!SHRD_MovePositionInArray(\n                            array: ri!record[recordType!AIA Process Model.steps],\n                            fromIndex: fv!index,\n                            toIndex: fv!index - 1\n                          )\n                        )\n                      }\n                    )\n                  ),\n                  size: \"ICON\"\n                ),\n                #\"SYSTEM_SYSRULES_imageField_v1\"(\n                  images: #\"SYSTEM_SYSRULES_documentImage\"(\n                    document: #\"SYSTEM_SYSRULES_iconIndicator\"(\n                      icon: if(\n                        fv!isLast,\n                        \"MOVE_DOWN_DISABLED\",\n                        \"MOVE_DOWN\"\n                      )\n                    ),\n                    altText: \"Move down\",\n                    link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      showWhen: not(fv!isLast),\n                      value: fv!index,\n                      saveInto: {\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps.order][fv!index],\n                          fv!index + 1\n                        ),\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps.order][fv!index + 1],\n                          fv!index\n                        ),\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps],\n                          rule!SHRD_MovePositionInArray(\n                            array: ri!record[recordType!AIA Process Model.steps],\n                            fromIndex: fv!index,\n                            toIndex: fv!index + 1\n                          )\n                        ),\n\n                      }\n                    )\n                  ),\n                  size: \"ICON\"\n                ),\n                #\"SYSTEM_SYSRULES_imageField_v1\"(\n                  size: \"ICON\",\n                  images: #\"SYSTEM_SYSRULES_documentImage\"(\n                    document: #\"SYSTEM_SYSRULES_iconIndicator\"(icon: \"REMOVE\"),\n                    altText: \"Remove Row\",\n                    link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      value: fv!index,\n                      saveInto: {\n                        a!save(\n                          ri!deletedStepsRecords,\n                          fn!if(\n                            a!isNotNullOrEmpty(\n                              ri!record[recordType!AIA Process Model.steps][save!value][recordType!AIA Process Model Step.id]\n                            ),\n                            append(\n                              ri!deletedStepsRecords,\n                              ri!record[recordType!AIA Process Model.steps][save!value]\n                            ),\n                            ri!deletedStepsRecords\n                          )\n                        ),\n                        a!save(\n                          ri!record[recordType!AIA Process Model.steps],\n                          remove(\n                            ri!record[recordType!AIA Process Model.steps],\n                            save!value\n                          )\n                        )\n                      }\n                    )\n                  )\n                )\n              }\n            )\n          ),\n          addRowLink: #\"SYSTEM_SYSRULES_dynamicLink\"(\n            label: \"Add Row\",\n            value: {\n              recordType!AIA Process Model.steps: {\n                recordType!AIA Process Model Step()\n              }\n            },\n            showWhen: or(\n              a!isNullOrEmpty(\n                ri!record[recordType!AIA Process Model.steps]\n              ),\n              length(\n                ri!record[recordType!AIA Process Model.steps]\n              ) < 10\n            ),\n            saveInto: a!save(\n              ri!record[recordType!AIA Process Model.steps],\n              append(\n                ri!record[recordType!AIA Process Model.steps],\n                save!value\n              )\n            )\n          )\n        )\n      }\n    )\n  },\n  buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n    primaryButtons: {\n      #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n        label: if(ri!isUpdate, \"Save\", \"Create\"),\n        submit: true,\n        validate: true,\n        saveInto: if(\n          ri!isUpdate,\n          {\n            a!save(\n              target: ri!record[recordType!AIA Process Model.modifiedBy],\n              value: loggedInUser()\n            ),\n            a!save(\n              target: ri!record[recordType!AIA Process Model.modifiedOn],\n              value: now()\n            )\n          },\n          {\n            a!save(\n              target: ri!record[recordType!AIA Process Model.createdBy],\n              value: loggedInUser()\n            ),\n            a!save(\n              target: ri!record[recordType!AIA Process Model.createdOn],\n              value: now()\n            )\n          }\n        ),\n        style: \"SOLID\"\n      )\n    },\n    secondaryButtons: {\n      #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n        label: \"Cancel\",\n        value: true,\n        saveInto: ri!cancel,\n        submit: true,\n        style: \"OUTLINE\",\n        validate: false\n      )\n    }\n  )\n)"
    }
  }
}
{
  "_metadata": {
    "bundle_id": "AS_GCM_QNM_Write_Questionnaire"
  },
  "objects": {
    "_a-0000e5da-a251-8000-9bbe-011c48011c48_1021202": {
      "name": "AS_GAM_UT_ArrayLength",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!AS_CO_UT_isBlank(ri!array),\n  0,\n  length(ri!array)\n)"
    },
    "_a-0000ec46-fcf4-8000-9d91-011c48011c48_12823624": {
      "name": "AS_GCM_QNM_setMetaDataForTemplateQuestionnaireRecord",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!questionnaires,\n  expression: rule!AS_GCM_setRecordFields(\n    record: fv!item,\n    neverOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.createdDatetime,\n        value: now()\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.isActive,\n        value: true\n      )\n    },\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.modifiedBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.modifiedDatetime,\n        value: now()\n      )\n    },\n    childRelationships: {\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questionCategories,\n        value: rule!AS_GCM_QNM_setMetaDataForTemplateQuestionCategoryRecord(\n          questionCategory: fv!item[recordType!AS GCM QNM T Questionnaire.questionCategories],\n          \n        )\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questions,\n        value: rule!AS_GCM_QNM_setMetaDataForTemplateQuestionsRecord(\n          questions: fv!item[recordType!AS GCM QNM T Questionnaire.questions],\n          initiator: ri!initiator\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73980": {
      "name": "AS_CO_UT_replaceNull",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!AS_CO_UT_isBlank(ri!nullableValue),\n  ri!replacementValue,\n  ri!nullableValue\n)"
    },
    "0002e4d4-c334-8000-1229-7f0000014e7a-gcm": {
      "name": "AS GCM QNM Delete Template Responses",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=pv!deletedTemplateResponseRequirements\n\n// Input: ?\n=pv!deletedTemplateResponses\n\n// Output: ?\nrule!AS_GCM_QNM_populateResponsesToBeDeleted(\n  writtenResponseOptions: pv!templateQuestions[recordType!AS GCM QNM T Question.responseOptions],\n  initialResponseOptions: pv!initialTemplateQuestions[recordType!AS GCM QNM T Question.responseOptions]\n)\n\n// Output: ?\nrule!AS_GCM_QNM_populateResponseRequirementsToBeDeleted(\n  writtenResponseRequirements: pv!templateQuestions[recordType!AS GCM QNM T Question.responseRequirements],\n  initialResponseRequirements: pv!initialTemplateQuestions[recordType!AS GCM QNM T Question.responseRequirements]\n)"
    },
    "_a-0000ec46-fcf4-8000-9d91-011c48011c48_12816472": {
      "name": "AS_GCM_QNM_setMetaDataForTemplateQuestionCategoryRecord",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!questionCategory,\n  expression: rule!AS_GCM_setRecordFields(\n    record: fv!item,\n    neverOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Question Category.isActive,\n        value: true\n      )\n    }\n  )\n)"
    },
    "_a-0000ec62-ac34-8000-9d9a-011c48011c48_13169774": {
      "name": "AS_GCM_QNM_populateResponsesToBeDeleted",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!AS_CO_UT_isBlank(ri!initialResponseOptions),\n  null,\n  a!localVariables(\n    local!responseIdstobeDeleted: if(\n      rule!AS_CO_UT_isBlank(ri!writtenResponseOptions),\n      ri!initialResponseOptions[recordType!AS GCM QNM T Response.responseTemplateId],\n      difference(\n        tointeger(\n          ri!initialResponseOptions[recordType!AS GCM QNM T Response.responseTemplateId]\n        ),\n        tointeger(\n          ri!writtenResponseOptions[recordType!AS GCM QNM T Response.responseTemplateId]\n        )\n      )\n    ),\n    rule!AS_CO_UT_indexWhere(\n      value: local!responseIdstobeDeleted,\n      initialArray: ri!initialResponseOptions[recordType!AS GCM QNM T Response.responseTemplateId],\n      finalArray: ri!initialResponseOptions\n    )\n  )\n)"
    },
    "_a-0000e40a-de32-8000-9ba8-011c48011c48_272151": {
      "name": "AS_CO_UT_whereContains",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer?list',\n  with(\n    local!array: a!flatten(ri!array),\n  \n    if(\n    \n      /*Have to handle separately for document types due to how it casts to string*/\n      rule!AS_CO_UT_typeCompare(\n        value1: local!array,\n        value2: {todocument(null)}\n      ),\n      wherecontains(\n        todocument(ri!values),\n        local!array\n      ),\n    \n      /*Have to handle separately for group types due to how it casts to string*/\n      rule!AS_CO_UT_typeCompare(\n        value1: local!array,\n        value2: {togroup(null)}\n      ),\n      wherecontains(\n        togroup(ri!values),\n        local!array\n      ),\n    \n      /*Casting to string accounts for any primitive type (integer, boolean, ect.)*/\n      wherecontains(\n        if(\n          rule!AS_CO_UT_isBlank(ri!values),\n          touniformstring(ri!values),\n          touniformstring(a!flatten(ri!values))\n        ),\n        touniformstring(local!array)\n      )\n    )\n  )\n)"
    },
    "_a-0000ec50-376f-8000-9d94-011c48011c48_12937069": {
      "name": "AS_GCM_UT_queryRecordByIdentifier",
      "type": "Expression Rule",
      "sail_code": "/*\n\nPLEASE REFER TO THE BOTTOM OF THIS RULE FOR INSTRUCTIONS ON HOW TO USE\n\nPlease DO NOT auto-format this rule\n\n*/\na!localVariables(\n  /*Determine the castResultToType*/\n  local!castResultToType: a!defaultValue(ri!castToCdtType, ri!recordType),\n  /*Execute the query*/\n  local!queryResult: a!refreshVariable(\n    value: if(\n      ri!executeWhen = false,\n      null(ri!recordType),\n      #\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n        recordType: ri!recordType,\n        identifier: ri!identifier,\n        fields: rule!AS_CO_UT_rejectNullValuesFromArray(\n          {\n            ri!fields,\n            index(\n              ri!relatedRecordData,\n              \"relationship\",\n              null\n            )\n          }\n        ),\n        relatedRecordData: ri!relatedRecordData\n      )\n    ),\n    refreshOnVarChange: ri!triggerRefresh,\n    refreshInterval: ri!refreshInterval,\n    refreshAfter: { \"RECORD_ACTION\" }\n  ),\n  rule!AS_CO_UT_cast(\n    type: local!castResultToType,\n    value: local!queryResult\n  )\n)/*\n\nDOCUMENTATION\n\nThis rule is designed to minimize the overhead with querying data and then casting the result\n\n\nRequired Inputs:\n\n1. recordType\n- This is a recordtype! input of the data type to be queried against\n\n2. identifier\n- The primary key of the record type which needs to be queried\n\nOptional Inputs:\n\n3. executeWhen\n- The query will not execute if this is false, the query will execute if this is true or null\n-- This is meant to operate in a similar manner to the showWhen parameter of components\n- Use this to skip execution of a query without needing to wrap if() statements around the rule\n-- Examples of this would be to skip querying if your filter value is a null ID\n- If the query does not execute, this will return a null value whose type is based on the returnType input\n\n4. triggerRefresh\n- By default, the query will always re-execute whenever any inputs change\n- However, by updating the value of triggerRefresh, you can also trigger a re-execution even if none of the other inputs change (e.g. after a record action)\n\n5. castToCdtType\n- Any cdt type to the cast the result set. \n\n6. fields\n- The record fields that need to be queried\n\n7. relatedRecordData\n- the relatedRecordData in which the filters and limit can be specified for each relationship\n\n*/"
    },
    "_a-0000e3e6-fb42-8000-9ba5-011c48011c48_162769": {
      "name": "AS_CO_UT_typeCompare",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  typeof(ri!value1) = typeof(ri!value2)\n)"
    },
    "_a-0000ec62-ac34-8000-9d9a-011c48011c48_13179551": {
      "name": "AS_GCM_QNM_refreshNegativeFksInQuestionnaire",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!sections: ri!questionnaire[recordType!AS GCM QNM T Questionnaire.questionCategories],\n  local!questions: ri!questionnaire[recordType!AS GCM QNM T Questionnaire.questions],\n  local!finalisedSections: a!flatten(\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!sections,\n      expression: rule!AS_GCM_setRecordFields(\n        record: fv!item,\n        alwaysOverwrite: {\n          a!map(\n            field: recordType!AS GCM QNM T Question Category.isActive,\n            value: true\n          ),\n          a!map(\n            field: recordType!AS GCM QNM T Question Category.questionCategoryTemplateId,\n            value: if(\n              fv!item[recordType!AS GCM QNM T Question Category.questionCategoryTemplateId] < 0,\n              null,\n              fv!item[recordType!AS GCM QNM T Question Category.questionCategoryTemplateId]\n            )\n          )\n        }\n      )\n    )\n  ),\n  local!finalisedQuestions: a!flatten(\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!questions,\n      expression: a!localVariables(\n        local!currentQuestion: fv!item,\n        local!isAlwaysVisible: local!currentQuestion[recordType!AS GCM QNM T Question.questionVisibility] = cons!AS_GCM_QNM_ENUM_TEMPLATE_QUESTION_VISIBILITY_ALWAYS_VISIBLE,\n        local!conditionalVisibilities: if(\n          local!isAlwaysVisible,\n          null,\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: local!currentQuestion[recordType!AS GCM QNM T Question.isDisplayedPrecedentSets],\n            expression: rule!AS_GCM_setRecordFields(\n              record: fv!item,\n              alwaysOverwrite: {\n                /*a!map(*/\n                  /*field: 'recordType!{e2cf072a-7e15-42a5-8c16-db069819e29d}AS GCM QNM T Question Precedent.fields.{b8329f6d-507e-42e4-9f0e-106440f1ff83}questionTemplateId_precedent',*/\n                  /*value: null*/\n                /*),*/\n                a!map(\n                  field: recordType!AS GCM QNM T Question Precedent.isActive,\n                  value: true\n                )\n              }\n            )\n          )\n        ),\n        local!currentPrecedentSet: if(\n          local!isAlwaysVisible,\n          null,\n          rule!AS_GCM_setRecordFields(\n            record: local!currentQuestion[recordType!AS GCM QNM T Question.isDisplayedPrecedentSets],\n            alwaysOverwrite: {\n              a!map(\n                field: recordType!AS GCM QNM T Question Precedent Set.questionPrecedents,\n                value: local!conditionalVisibilities\n              ),\n              a!map(\n                field: recordType!AS GCM QNM T Question Precedent Set.isActive,\n                value: true\n              )\n            }\n          )\n        ),\n        rule!AS_GCM_setRecordFields(\n          record: local!currentQuestion,\n          alwaysOverwrite: {\n            a!map(\n              field: recordType!AS GCM QNM T Question.questionTemplateId,\n              value: if(\n                local!currentQuestion[recordType!AS GCM QNM T Question.questionTemplateId] < 0,\n                null,\n                local!currentQuestion[recordType!AS GCM QNM T Question.questionTemplateId]\n              )\n            ),\n            a!map(\n              field: recordType!AS GCM QNM T Question.isDisplayedPrecedentSets,\n              value: local!currentPrecedentSet\n            )\n          }\n        )\n      )\n    )\n  ),\n  rule!AS_GCM_setRecordFields(\n    record: ri!questionnaire,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questionCategories,\n        value: local!finalisedSections\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questions,\n        value: local!finalisedQuestions\n      )\n    }\n  )\n)"
    },
    "_a-0000ec62-ac34-8000-9d9a-011c48011c48_13170714": {
      "name": "AS_GCM_QNM_populateResponseRequirementsToBeDeleted",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!AS_CO_UT_isBlank(ri!initialResponseRequirements),\n  null,\n  a!localVariables(\n    local!responseIdstobeDeleted: if(\n      rule!AS_CO_UT_isBlank(ri!writtenResponseRequirements),\n      ri!initialResponseRequirements[recordType!AS GCM QNM T Response Requirement.responseRequirementTemplateId],\n      difference(\n        tointeger(\n          ri!initialResponseRequirements[recordType!AS GCM QNM T Response Requirement.responseRequirementTemplateId]\n        ),\n        tointeger(\n          ri!writtenResponseRequirements[recordType!AS GCM QNM T Response Requirement.responseRequirementTemplateId]\n        )\n      )\n    ),\n    rule!AS_CO_UT_indexWhere(\n      value: local!responseIdstobeDeleted,\n      initialArray: ri!initialResponseRequirements[recordType!AS GCM QNM T Response Requirement.responseRequirementTemplateId],\n      finalArray: ri!initialResponseRequirements\n    )\n  )\n)"
    },
    "_a-0000eb32-2fbb-8000-9d0d-011c48011c48_9760853": {
      "name": "AS_GCM_setRecordFields",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!record),\n  ri!record,\n  a!localVariables(\n    local!allUpdates: rule!AS_CO_UT_rejectNullValuesFromArray(\n      a!flatten(\n        {\n          ri!alwaysOverwrite,\n          ri!childRelationships,\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: ri!neverOverwrite,\n            expression: #\"urn:appian:function:v1:a:update\"(\n              fv!item,\n              \"value\",\n              /*Specifically using this instead of a!defaultValue() to account for the `{null}` value*/\n              rule!AS_CO_UT_replaceNull(\n                nullableValue: ri!record[fv!item.field],\n                replacementValue: fv!item.value\n              )\n            )\n          )\n        }\n      )\n    ),\n    local!onlyChangedUpdates: a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!allUpdates,\n        expression: if(\n          or(\n            tostring(ri!record[fv!item.field]) = tostring(fv!item.value),\n            toboolean(fv!item.applyWhen) = false\n          ),\n          {},\n          fv!item\n        )\n      )\n    ),\n    if(\n      a!isNullOrEmpty(local!onlyChangedUpdates),\n      ri!record,\n      #\"urn:appian:function:v1:a:update\"(\n        data: ri!record,\n        index: local!onlyChangedUpdates.field,\n        value: local!onlyChangedUpdates.value\n      )\n    )\n  )\n)"
    },
    "_a-0000e6c8-d132-8000-9bbe-011c48011c48_469266": {
      "name": "AS_CO_UT_queryRecord",
      "type": "Expression Rule",
      "sail_code": "/*\n\nPLEASE REFER TO THE BOTTOM OF THIS RULE FOR INSTRUCTIONS ON HOW TO USE\n\nPlease DO NOT auto-format this rule\n\n*/\n\n\n/*Error handling*/\nif(\n  rule!AS_CO_UT_isBlank(ri!returnType),\n  fn!error(concat(\"Null `returnType` passed to AS_CO_UT_queryRecord for recordType `\", ri!recordType, \"`.  See documentation in AS_CO_UT_queryRecord for further information on how to use this parameter.\")),\n  not(contains(rule!AS_CO_CONS_QE_RETURN_TYPES(), ri!returnType)),\n  fn!error(concat(\"Unknown `returnType` passed to AS_CO_UT_queryRecord for recordType `\", ri!recordType, \"`.  See documentation in AS_CO_UT_queryRecord for further information on how to use this parameter.\")),\n  rule!AS_CO_UT_isBlank(ri!recordType),\n  fn!error(concat(\"Null `recordType` passed to AS_CO_UT_queryRecord.  See documentation in AS_CO_UT_queryRecord for further information on how to use this parameter.\")),\n  and(\n    ri!returnType = cons!AS_CO_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    rule!AS_CO_UT_isBlank(ri!pagingInfo)\n  ),\n  fn!error(concat(\"`pagingInfo` is required (cannot be null) for `returnType` DATA_SUBSET\")),\n  and(\n    ri!returnType <> cons!AS_CO_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n    rule!AS_CO_UT_isNotBlank(ri!pagingInfo)\n  ),\n  fn!error(concat(\"`pagingInfo` must be null when the `returnType` is not DATA_SUBSET, instead use `sort` to pass custom-sorting and `startIndex` & `batchSize` will be automatically calculated for you\")),\n  and(\n    not(isnull(ri!pagingInfo)),\n    rule!AS_CO_UT_isNotBlank(ri!sort)\n  ),\n  fn!error(concat(\"`sort` parameter must be null when `pagingInfo` is provided.  Use the sort field of the provided `pagingInfo` instead.\")),\n  and(\n    ri!returnType = cons!AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    rule!AS_CO_UT_isBlank(ri!aggregationFields)\n  ),\n  fn!error(\"You must provide an input for `aggregationFields` when `returnType` is AGGREGATION\"),\n  and(\n    ri!returnType = cons!AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    rule!AS_CO_UT_isNotBlank(ri!fields)\n  ),\n  fn!error(\"You cannot provide an input for `fields` when `returnType` is AGGREGATION.  Use `aggregationFields` instead.\"),\n  and(\n    ri!returnType <> cons!AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION,\n    rule!AS_CO_UT_isNotBlank(ri!aggregationFields)\n  ),\n  fn!error(\"You cannot provide an input for `aggregationFields` when `returnType` is not AGGREGATION.  Use `fields` instead.\"),\n  and(\n    rule!AS_CO_UT_isNotBlank(ri!castToCdtType),\n    not(contains(\n      {cons!AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY, cons!AS_CO_ENUM_QE_RETURN_TYPE_SINGLE_OBJECT, cons!AS_CO_ENUM_QE_RETURN_TYPE_DATA_SUBSET},\n      ri!returnType\n    )),\n  ),\n  fn!error(\"'castToCdtType' is only supported for SINGLE_OBJECT, OBJECT_ARRAY, and DATA_SUBSET return types\"),\n\n  a!localVariables(\n\n    /*Determine the castResultToType*/\n    local!castResultToType: rule!AS_CO_UT_displayValue(\n      value: ri!returnType,\n      inArray: rule!AS_CO_CONS_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/   'type!{http://www.appian.com/ae/types/2009}Map',\n        /*SINGLE_OBJECT*/ a!defaultValue(ri!castToCdtType, ri!recordType),\n        /*OBJECT_ARRAY*/  rule!AS_CO_UT_returnArrayTypeNumber(type: a!defaultValue(ri!castToCdtType, ri!recordType)),\n        /*AGGREGATION*/   'type!{http://www.appian.com/ae/types/2009}Map?list',\n        /*TOTAL_COUNT*/   'type!{http://www.appian.com/ae/types/2009}Integer',\n      }\n    ),\n\n    /*Determine the batchSize*/\n    local!batchSize: rule!AS_CO_UT_displayValue(\n      value: ri!returnType,\n      inArray: rule!AS_CO_CONS_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/   ri!pagingInfo.batchSize,\n        /*SINGLE_OBJECT*/ 1,\n        /*OBJECT_ARRAY*/  a!defaultValue(ri!pagingInfo.batchSize, cons!AS_CO_INT_QUERY_MAX_BATCH_SIZE),\n        /*AGGREGATION*/   cons!AS_CO_INT_QUERY_MAX_BATCH_SIZE,\n        /*TOTAL_COUNT*/   1,\n      }\n    ),\n\n    /*Determine the pagingInfo*/\n    local!pagingInfo: if(\n      ri!returnType = cons!AS_CO_ENUM_QE_RETURN_TYPE_DATA_SUBSET,\n      /*Use specific pagingInfo for DATA_SUBSET*/\n      ri!pagingInfo,\n      /*Otherwise calculate pagingInfo for all other returnTypes*/\n      #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: local!batchSize,\n        sort: ri!sort\n      )\n    ),\n\n    /*Determine the fetchTotalCount*/\n    local!fetchTotalCount: rule!AS_CO_UT_displayValue(\n      value: ri!returnType,\n      inArray: rule!AS_CO_CONS_QE_RETURN_TYPES(),\n      replacement: {\n        /*DATA_SUBSET*/   true,\n        /*SINGLE_OBJECT*/ false,\n        /*OBJECT_ARRAY*/  false,\n        /*AGGREGATION*/   false,\n        /*TOTAL_COUNT*/   true,\n      }\n    ),\n\n    /*Execute the query*/\n    local!queryResult: a!refreshVariable(\n      value: if(\n        ri!executeWhen = false,\n        null(\n          if(\n            ri!returnType = cons!AS_CO_ENUM_QE_RETURN_TYPE_AGGREGATION,\n            rule!AS_CO_TYPE_Dictionary(),\n            ri!recordType\n          )\n        ),\n        #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n          recordType: ri!recordType,\n          fields: a!defaultValue(\n            ri!fields,\n            ri!aggregationFields\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            logicalExpressions: {\n              #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                operator: \"AND\",\n                ignoreFiltersWithEmptyValues: true,\n                filters: a!defaultValue(ri!filters, {})\n              ),\n              a!defaultValue(ri!logicalExpression, {})\n            }\n          ),\n          pagingInfo: local!pagingInfo,\n          fetchTotalCount: local!fetchTotalCount,\n          relatedRecordData: ri!relatedRecordData\n        )\n      ),\n      refreshOnVarChange: ri!triggerRefresh,\n      refreshAfter: {\"RECORD_ACTION\"}\n    ),\n\n    /*Parse the queryResult*/\n    local!queryResultParse: choose(\n      rule!AS_CO_UT_chooseWherecontainsHelper(\n        value: ri!returnType,\n        inArray: rule!AS_CO_CONS_QE_RETURN_TYPES()\n      ),\n      /*Default, required value based on how AS_CO_UT_chooseWherecontainsHelper operates*/ \"\",\n      /*DATA_SUBSET*/   if(\n        rule!AS_CO_UT_isNotBlank(ri!castToCdtType),\n        /*Note that for a data subset, the parent is a map, but we allow casting the child 'data' field as well*/\n        rule!AS_CO_UT_updateCdtFieldsByFieldValuePairs(\n          cdt: local!queryResult,\n          fieldValuePairs: {\n            field: \"data\",\n            value: cast(\n              rule!AS_CO_UT_returnArrayTypeNumber(type: ri!castToCdtType),\n              local!queryResult.data\n            )\n          }\n        ),\n        local!queryResult\n      ),\n      /*SINGLE_OBJECT*/ local!queryResult.data,\n      /*OBJECT_ARRAY*/  local!queryResult.data,\n      /*AGGREGATION*/   local!queryResult.data,\n      /*TOTAL_COUNT*/   local!queryResult.totalCount,\n    ),\n\n    rule!AS_CO_UT_cast(\n      type: local!castResultToType,\n      value: local!queryResultParse\n    )\n  )\n)\n\n/*\n\nDOCUMENTATION\n\nThis rule is designed to minimize the overhead with querying data and then casting the result\n\n\nRequired Inputs:\n\n1. recordType\n- This is a recordtype! input of the data type to be queried against\n\n2. returnType\n- This depends on the purpose for the query, and should be one of the returnTypes in rule!AS_CO_CONS_QE_RETURN_TYPES\n-- DATA_SUBSET - This will return a DataSubset; pagingInfo is required\n-- SINGLE_OBJECT - This will return a single record whose type is the recordType; pagingInfo must be null\n-- ARRAY_OBJECT - This will return an array of records whose type is an array of the recordType; pagingInfo must be null\n-- AGGREGATION - This will return an array of Dictionaries; pagingInfo must be null\n---- NOTE: If you need Aggregation with paging controls, such as for a grid, use returnType DATA_SUBSET\n-- TOTAL_COUNT - This will return an Integer of the total count; pagingInfo must be null\n\n\nOptional Inputs:\n\n3. executeWhen\n- The query will not execute if this is false, the query will execute if this is true or null\n-- This is meant to operate in a similar manner to the showWhen parameter of components\n- Use this to skip execution of a query without needing to wrap if() statements around the rule\n-- Examples of this would be to skip querying if your filter value is a null ID\n- If the query does not execute, this will return a null value whose type is based on the returnType input\n\n4. triggerRefresh\n- By default, the query will always re-execute whenever any inputs change\n- However, by updating the value of triggerRefresh, you can also trigger a re-execution even if none of the other inputs change (e.g. after a record action)\n\n5. filters\n- Array of filters to apply to the query, built with a!queryFilter()\n- These filters will be applied with an AND operator\n- These filters will apply in addition to the logicalExpression input, combining both with an AND operator\n\n6. logicalExpression\n- A logical expression to apply to the query, built with a!queryLogicalExpression()\n- This logical expression will apply in addition to the filters input, combining both with an AND operator\n\n7. aggregationFields\n- Aggregation to apply to the query, built with a!aggregationField()\n\n8. fields\n- List of recordFields and relatedRecordFields to return.  When querying a record, any relatedRecordFields are not returned\nby default, and must be specifically requested.\n\n9. pagingInfo\n- Paging info to apply to the query, built with a!pagingInfo() or derived from fv!pagingInfo in grids\n- This is required if passing returnType DATA_SUBSET, otherwise it must be null\n- For returnTypes that are not DATA_SUBSET, the batch size will be automatically calculated depending on the returnType\n-- For example, passing SINGLE_OBJECT will automatically apply a batch size of 1, whereas ARRAY_OBJECT and AGGREGATION will automatically apply a batch size of the defined query batch size maximum\n\n10. sort\n- Array of sort to apply to the query, built with a!sortInfo()\n- This is meant to be used with returnType ARRAY_OBJECT and AGGREGATION, since pagingInfo is not required for these, but a specified sort may be used\n- Cannot be used in conjunction with pagingInfo.sort\n\n11. castToCdtType\n- Any cdt type to the cast the result set. \n- This is meant to be used with only returnType OBJECT_ARRAY and SINGLE_OBJECT.\n\n*/"
    },
    "_a-0000ec46-fcf4-8000-9d91-011c48011c48_12812729": {
      "name": "AS_GCM_QNM_setMetaDataForTemplateQuestionsRecord",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!questions,\n  expression: rule!AS_GCM_setRecordFields(\n    record: fv!item,\n    neverOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Question.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Question.createdDatetime,\n        value: now()\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Question.isActive,\n        value: true\n      )\n    },\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Question.modifiedBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Question.modifiedDatetime,\n        value: now()\n      )\n    }\n  )\n)"
    },
    "_a-0000e447-933d-8000-9baa-011c48011c48_39379-gcm": {
      "name": "AS_GCM_QNM_QR_getQuestionnaire_Template",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!relatedRecordData: {\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AS GCM QNM T Questionnaire.questionCategories,\n      filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AS GCM QNM T Question Category.isActive,\n        operator: \"in\",\n        value: rule!AS_CO_UT_replaceNull(\n          nullableValue: ri!isActive,\n          replacementValue: { true }\n        )\n      ),\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AS GCM QNM T Question Category.displayOrder,\n        ascending: true()\n      )\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AS GCM QNM T Questionnaire.questions,\n      filters: {\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Question.isActive,\n          operator: \"in\",\n          value: rule!AS_CO_UT_replaceNull(\n            nullableValue: ri!isActive,\n            replacementValue: { true }\n          )\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Question.questionTemplateId,\n          operator: \"not in\",\n          value: ri!questionTemplateIdsToExclude,\n          applyWhen: a!isNotNullOrEmpty(ri!questionTemplateIdsToExclude)\n        )\n      },\n      sort: {\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AS GCM QNM T Question.groupNumber,\n          ascending: true\n        ),\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AS GCM QNM T Question.orderNumber,\n          ascending: true\n        )\n      }\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AS GCM QNM T Questionnaire.questions,\n      \n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AS GCM QNM T Questionnaire.questions,\n      \n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AS GCM QNM T Questionnaire.questions,\n      filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AS GCM QNM T Question Precedent Set.isActive,\n        operator: \"in\",\n        value: rule!AS_CO_UT_replaceNull(\n          nullableValue: ri!isActive,\n          replacementValue: { true }\n        )\n      )\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: #\"urn:appian:record-relationship:v1:9f80ae61-036a-46c1-8975-aebefe443c6e/60d96863-683c-425f-8d9b-7dd94d1cd5ba/35500f1d-7bad-40e6-8728-6bd75b0d3f03/8dca9ba9-cfbd-46c6-92b8-6a7d21aad4c4\",\n      filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AS GCM QNM T Question Precedent.isActive,\n        operator: \"in\",\n        value: rule!AS_CO_UT_replaceNull(\n          nullableValue: ri!isActive,\n          replacementValue: { true }\n        )\n      )\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: #\"urn:appian:record-relationship:v1:9f80ae61-036a-46c1-8975-aebefe443c6e/60d96863-683c-425f-8d9b-7dd94d1cd5ba/35500f1d-7bad-40e6-8728-6bd75b0d3f03/8dca9ba9-cfbd-46c6-92b8-6a7d21aad4c4/b37fc648-4c9c-4add-b535-2cbb861e4e19\",\n      \n    ),\n    ri!relatedRecordData\n  },\n  if(\n    and(\n      ri!getAllRelatedRecord,\n      a!isNullOrEmpty(ri!additionalFilters),\n      a!isNullOrEmpty(ri!logicalExpression),\n      rule!AS_GAM_UT_ArrayLength(ri!questionnaireTemplateId) = 1,\n      ri!executeWhen\n    ),\n    rule!AS_GCM_UT_queryRecordByIdentifier(\n      recordType: recordType!AS GCM QNM T Questionnaire,\n      identifier: ri!questionnaireTemplateId,\n      relatedRecordData: local!relatedRecordData\n    ),\n    rule!AS_CO_UT_queryRecord(\n      recordType: recordType!AS GCM QNM T Questionnaire,\n      returnType: a!defaultValue(\n        value: ri!returnType,\n        default: cons!AS_CO_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY\n      ),\n      fields: rule!AS_CO_UT_rejectNullValuesFromArray(\n        {\n          ri!fields,\n          if(\n            ri!includeRelatedRecords,\n            index(\n              local!relatedRecordData,\n              \"relationship\",\n              null\n            ),\n            {}\n          )\n        }\n      ),\n      filters: {\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Questionnaire.questionnaireTemplateId,\n          operator: \"in\",\n          value: ri!questionnaireTemplateId\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Questionnaire.questionnaireTemplateId,\n          operator: \"not in\",\n          value: ri!questionnaireTemplateIdsToExclude\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Questionnaire.name,\n          operator: \"=\",\n          value: ri!name\n        ),\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AS GCM QNM T Questionnaire.isActive,\n          operator: \"in\",\n          value: rule!AS_CO_UT_replaceNull(\n            nullableValue: ri!isActive,\n            replacementValue: { true }\n          )\n        ),\n        ri!additionalFilters\n      },\n      logicalExpression: ri!logicalExpression,\n      triggerRefresh: ri!triggerRefresh,\n      executeWhen: ri!executeWhen,\n      pagingInfo: ri!pagingInfo,\n      relatedRecordData: local!relatedRecordData\n    )\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76367": {
      "name": "AS_CO_UT_rejectNullValuesFromArray",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!array),\n  reject(\n    rule!AS_CO_UT_isBlank(_),\n    a!flatten(ri!array)\n  )\n)"
    },
    "_a-0000e6a4-3c85-8000-9ba5-011c48011c48_45984": {
      "name": "AS_CO_UT_indexWhere",
      "type": "Expression Rule",
      "sail_code": "if(\n  rule!AS_CO_UT_isBlank(value: ri!initialArray),\n  {},\n  if(\n    ri!isRemove,\n    remove(\n      ri!finalArray,\n      wherecontains(\n        cast(typeof({ \"\" }), ri!value),\n        cast(typeof({ \"\" }), ri!initialArray)\n      )\n    ),\n    index(\n      ri!finalArray,\n      wherecontains(\n        cast(typeof({ \"\" }), ri!value),\n        cast(typeof({ \"\" }), ri!initialArray)\n      ),\n      {}\n    )\n  )\n)"
    },
    "_a-0000e3e6-fb42-8000-9ba5-011c48011c48_157603": {
      "name": "AS_CO_UT_cast",
      "type": "Expression Rule",
      "sail_code": "with(  \n  local!typeNumber: rule!AS_CO_UT_returnTypeNumber(\n    type: ri!type,\n    typeOf: ri!typeOf\n  ),\n\n  /* If the object is empty, use null or {} depending on if it is array type or not */\n  local!objectToCast: if(\n    rule!AS_CO_UT_isNotBlank(ri!value),\n    ri!value,\n    rule!AS_CO_UT_checkIfSingleType(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n    null,\n    {}\n  ),\n\n  cast(\n    local!typeNumber,\n    local!objectToCast\n  )\n  \n)"
    },
    "_a-0000ec62-ac34-8000-9d9a-011c48011c48_13180304": {
      "name": "AS_GCM_QNM_updateQuestionnaireRecordAfterWrite",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!questionnaireFromForm: #\"urn:appian:function:v1:a:update\"(\n    ri!questionnaireFromForm,\n    recordType!AS GCM QNM T Questionnaire.questions,\n    todatasubset(\n      ri!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions],\n      #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: -1,\n        sort: {\n          #\"SYSTEM_SYSRULES_sortInfo\"(\n            field: recordType!AS GCM QNM T Question.groupNumber,\n            ascending: true\n          ),\n          #\"SYSTEM_SYSRULES_sortInfo\"(\n            field: recordType!AS GCM QNM T Question.orderNumber,\n            ascending: true\n          )\n        }\n      )\n    ).data\n  ),\n  local!questionsFromForm: local!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n  local!writtenQuestions: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n  local!finalisedWrittenQuestionIds: remove(\n    local!writtenQuestions,\n    rule!AS_CO_UT_whereContains(\n      array: local!writtenQuestions,\n      values: tointeger(\n        ri!deletedPksMap.questionIdsToBeDeleted\n      )\n    )\n  ),\n  local!sectionssFromForm: local!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questionCategories.questionCategoryTemplateId],\n  local!writtenSections: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questionCategories.questionCategoryTemplateId],\n  local!finalisedWrittenSectionIds: remove(\n    local!writtenSections,\n    rule!AS_CO_UT_whereContains(\n      array: local!writtenSections,\n      values: tointeger(ri!deletedPksMap.sectionIdsToBeDeleted)\n    )\n  ),\n  local!finalisedConditions: #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!finalisedWrittenQuestionIds,\n    expression: a!localVariables(\n      local!currentQuestionFromDB: index(\n        rule!AS_CO_UT_indexWhere(\n          value: fv!item,\n          initialArray: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n          finalArray: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions]\n        ),\n        1,\n        null\n      ),\n      local!currentQuestionFromForm: index(\n        local!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions],\n        fv!index,\n        null\n      ),\n      local!conditionsFromDB: if(\n        a!isNullOrEmpty(\n          local!currentQuestionFromDB[recordType!AS GCM QNM T Question.isDisplayedPrecedentSets]\n        ),\n        null,\n        index(\n          local!currentQuestionFromDB,\n          recordType!AS GCM QNM T Question.isDisplayedPrecedentSets,\n          null\n        )\n      ),\n      local!conditionsFromForm: if(\n        a!isNullOrEmpty(\n          local!currentQuestionFromForm[recordType!AS GCM QNM T Question.isDisplayedPrecedentSets]\n        ),\n        null,\n        index(\n          local!currentQuestionFromForm,\n          recordType!AS GCM QNM T Question.isDisplayedPrecedentSets,\n          null\n        )\n      ),\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!conditionsFromDB,\n        expression: rule!AS_GCM_QNM_updatePrecedentsAfterInitialWrite(\n          deletedPksMap: ri!deletedPksMap,\n          precedentsFromForm: local!conditionsFromForm,\n          precedentsFromDB: local!conditionsFromDB,\n          questionsFromForm: local!questionsFromForm,\n          finalisedWrittenQuestionIds: local!finalisedWrittenQuestionIds\n        )\n      )\n    )\n  ),\n  local!finalisedPrecedentSets: #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!finalisedWrittenQuestionIds,\n    expression: a!localVariables(\n      local!currentPrecSetFromDB: index(\n        rule!AS_CO_UT_indexWhere(\n          value: fv!item,\n          initialArray: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n          finalArray: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions]\n        ),\n        1,\n        null\n      ),\n      a!map(\n        questionId: fv!item,\n        precSet: if(\n          a!isNullOrEmpty(local!currentPrecSetFromDB),\n          null,\n          if(\n            and(\n              a!isNotNullOrEmpty(\n                index(\n                  local!currentPrecSetFromDB,\n                  recordType!AS GCM QNM T Question Precedent Set.questionPrecedentSetTemplateId,\n                  null\n                )\n              ),\n              contains(\n                tointeger(\n                  ri!deletedPksMap.questionPrecedentSetIdsToBeDeleted\n                ),\n                tointeger(\n                  index(\n                    local!currentPrecSetFromDB,\n                    recordType!AS GCM QNM T Question Precedent Set.questionPrecedentSetTemplateId,\n                    null\n                  )\n                )\n              )\n            ),\n            rule!AS_GCM_setRecordFields(\n              record: local!currentPrecSetFromDB,\n              alwaysOverwrite: {\n                a!map(\n                  field: recordType!AS GCM QNM T Question Precedent Set.isActive,\n                  value: false\n                ),\n                a!map(\n                  field: recordType!AS GCM QNM T Question Precedent Set.questionPrecedents,\n                  value: index(\n                    local!finalisedConditions,\n                    fv!Index,\n                    null\n                  )\n                )\n              }\n            ),\n            rule!AS_GCM_setRecordFields(\n              record: local!currentPrecSetFromDB,\n              alwaysOverwrite: {\n                a!map(\n                  field: recordType!AS GCM QNM T Question Precedent Set.questionPrecedents,\n                  value: index(\n                    local!finalisedConditions,\n                    fv!Index,\n                    null\n                  )\n                )\n              }\n            )\n          )\n        )\n      )\n    )\n  ),\n  rule!AS_GCM_setRecordFields(\n    record: ri!writtenQuestionnaire,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questions,\n        value: #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions],\n          expression: a!localVariables(\n            local!currentQuestionTempId: fv!item[recordType!AS GCM QNM T Question.questionTemplateId],\n            /* If the question is present in deleted map it is removed in Edit hence we need to deactivate it         */\n            if(\n              contains(\n                tointeger(\n                  ri!deletedPksMap.questionIdsToBeDeleted\n                ),\n                local!currentQuestionTempId\n              ),\n              rule!AS_GCM_setRecordFields(\n                record: fv!item,\n                alwaysOverwrite: {\n                  a!map(\n                    field: recordType!AS GCM QNM T Question.isActive,\n                    value: false\n                  )\n                }\n              ),\n              rule!AS_GCM_setRecordFields(\n                record: fv!item,\n                alwaysOverwrite: {\n                  a!map(\n                    field: recordType!AS GCM QNM T Question.isActive,\n                    value: true\n                  ),\n                  a!map(\n                    field: recordType!AS GCM QNM T Question.isDisplayedPrecedentSets,\n                    value: rule!AS_CO_UT_indexWhere(\n                      value: fv!item[recordType!AS GCM QNM T Question.questionTemplateId],\n                      initialArray: local!finalisedPrecedentSets.questionId,\n                      finalArray: local!finalisedPrecedentSets.precSet\n                    )\n                  ),\n                  a!map(\n                    field: recordType!AS GCM QNM T Question.questionCategoryTemplateId,\n                    value: displayvalue(\n                      fv!item[recordType!AS GCM QNM T Question.questionCategoryTemplateId],\n                      local!sectionssFromForm,\n                      local!finalisedWrittenSectionIds,\n                      null\n                    )\n                  )\n                }\n              )\n            )\n          )\n        ),\n        \n      ),\n      a!map(\n        field: recordType!AS GCM QNM T Questionnaire.questionCategories,\n        value: #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questionCategories],\n          expression: a!localVariables(\n            local!currentSectionId: fv!item[recordType!AS GCM QNM T Question Category.questionCategoryTemplateId],\n            /* If the qn is present in deleted map it is removed in Edit we need to deactivate it         */\n            if(\n              contains(\n                tointeger(ri!deletedPksMap.sectionIdsToBeDeleted),\n                local!currentSectionId\n              ),\n              rule!AS_GCM_setRecordFields(\n                record: fv!item,\n                alwaysOverwrite: {\n                  a!map(\n                    field: recordType!AS GCM QNM T Question Category.isActive,\n                    value: false\n                  )\n                }\n              ),\n              fv!item\n            )\n          )\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000ec75-2131-8000-9da0-011c48011c48_13308878": {
      "name": "AS_GCM_QNM_updatePrecedentsAfterInitialWrite",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!precedentsFromDB),\n  null,\n  a!localVariables(\n    local!precIdsFromDB: ri!precedentsFromDB[recordType!AS GCM QNM T Question Precedent.questionPrecedentTemplateId],\n    local!finalisedPrecIds: remove(\n      local!precIdsFromDB,\n      rule!AS_CO_UT_whereContains(\n        array: local!precIdsFromDB,\n        values: tointeger(\n          ri!deletedPksMap.questionPrecedentIdsToBeDeleted\n        )\n      )\n    ),\n    a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: ri!precedentsFromDB,\n        expression: a!localVariables(\n          if(\n            and(\n              a!isNotNullOrEmpty(\n                tointeger(\n                  fv!item[recordType!AS GCM QNM T Question Precedent.questionPrecedentTemplateId]\n                )\n              ),\n              contains(\n                tointeger(\n                  ri!deletedPksMap.questionPrecedentIdsToBeDeleted\n                ),\n                tointeger(\n                  fv!item[recordType!AS GCM QNM T Question Precedent.questionPrecedentTemplateId]\n                )\n              )\n            ),\n            rule!AS_GCM_setRecordFields(\n              record: fv!item,\n              alwaysOverwrite: {\n                a!map(\n                  field: recordType!AS GCM QNM T Question Precedent.isActive,\n                  value: false\n                )\n              }\n            ),\n            a!localVariables(\n              local!findIndexInForm: rule!AS_CO_UT_whereContains(\n                values: fv!item[recordType!AS GCM QNM T Question Precedent.questionPrecedentTemplateId],\n                array: local!finalisedPrecIds\n              ),\n              local!currentConditionFromForm: index(\n                ri!precedentsFromForm,\n                local!findIndexInForm,\n                null\n              ),\n              local!dependentQuestionId: if(\n                a!isNullOrEmpty(local!currentConditionFromForm),\n                null,\n                index(\n                  local!currentConditionFromForm,\n                  recordType!AS GCM QNM T Question Precedent.questionTemplateId_precedent,\n                  null\n                ),\n                \n              ),\n              rule!AS_GCM_setRecordFields(\n                record: fv!item,\n                alwaysOverwrite: {\n                  a!map(\n                    field: recordType!AS GCM QNM T Question Precedent.questionTemplateId_precedent,\n                    value: displayvalue(\n                      local!dependentQuestionId,\n                      ri!questionsFromForm,\n                      ri!finalisedWrittenQuestionIds,\n                      null\n                    )\n                  )\n                }\n              )\n            )\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ec62-ac34-8000-9d9a-011c48011c48_13177701": {
      "name": "AS_GCM_QNM_populateQuestionsAndSectionsToBeDeleted",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!sectionIdsFromDb: ri!questionnaireFromDb[recordType!AS GCM QNM T Questionnaire.questionCategories.questionCategoryTemplateId],\n  local!sectionIdsFromForm: ri!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questionCategories.questionCategoryTemplateId],\n  local!questionIdsFromDb: ri!questionnaireFromDb[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n  local!questionIdsFromForm: ri!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions.questionTemplateId],\n  /*section data*/\n  local!sectionIdsToBeDeleted: rule!AS_CO_UT_rejectNullValuesFromArray(\n    array: difference(\n      tointeger(local!sectionIdsFromDb),\n      tointeger(local!sectionIdsFromForm)\n    )\n  ),\n  /*question data*/\n  local!questionIdsToBeDeleted: rule!AS_CO_UT_rejectNullValuesFromArray(\n    array: difference(\n      tointeger(local!questionIdsFromDb),\n      tointeger(local!questionIdsFromForm)\n    )\n  ),\n  /*question precedent set data*/\n  local!questionPrecedentSetIdsFromDb: tointeger(\n    index(\n      ri!questionnaireFromDb,\n      recordType!AS GCM QNM T Questionnaire.questions.isDisplayedPrecedentSets.questionPrecedentSetTemplateId,\n      null\n    )\n  ),\n  local!questionPrecedentSetIdsFromForm: tointeger(\n    index(\n      ri!questionnaireFromForm,\n      recordType!AS GCM QNM T Questionnaire.questions.isDisplayedPrecedentSets.questionPrecedentSetTemplateId,\n      {}\n    )\n  ),\n  local!questionPrecedentSetIdsToBeDeleted: rule!AS_CO_UT_rejectNullValuesFromArray(\n    array: difference(\n      local!questionPrecedentSetIdsFromDb,\n      local!questionPrecedentSetIdsFromForm\n    )\n  ),\n  /*question precedent data*/\n  /*question precedent data*/\n  local!questionPrecedentIdsFromDb: tointeger(\n    ri!questionnaireFromDb[recordType!AS GCM QNM T Questionnaire.questions.isDisplayedPrecedentSets.questionPrecedents.questionPrecedentTemplateId],\n    \n  ),\n  local!questionPrecedentIdsFromForm: tointeger(\n    ri!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions.isDisplayedPrecedentSets.questionPrecedents.questionPrecedentTemplateId]\n  ),\n  local!questionPrecedentIdsToBeDeleted: rule!AS_CO_UT_rejectNullValuesFromArray(\n    array: difference(\n      local!questionPrecedentIdsFromDb,\n      local!questionPrecedentIdsFromForm\n    )\n  ),\n  a!map(\n    sectionIdsToBeDeleted: local!sectionIdsToBeDeleted,\n    questionIdsToBeDeleted: local!questionIdsToBeDeleted,\n    questionPrecedentSetIdsToBeDeleted: a!flatten(\n      local!questionPrecedentSetIdsToBeDeleted\n    ),\n    questionPrecedentIdsToBeDeleted: a!flatten(local!questionPrecedentIdsToBeDeleted)\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536": {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  length(a!flatten(ri!value)) = 0\n)"
    },
    "0002e4ce-c67e-8000-1182-7f0000014e7a-gcm": {
      "name": "AS GCM QNM Write Questionnaire",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=pv!finalisedQuestionnaire\n\n// Input: ?\n=recordType!AS GCM QNM T Questionnaire\n\n// Input: ?\n= if( pv!isEditQuestionnaire, rule!AS_GCM_QNM_QR_getQuestionnaire_Template( questionnaireTemplateId: pv!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questionnaireTemplateId], executeWhen: true ), null)\n\n// Output: ?\nif(\n  pv!isEditQuestionnaire,\n  rule!AS_GCM_QNM_populateQuestionsAndSectionsToBeDeleted(\n    questionnaireFromDb: ac!oldQuestionnaire,\n    questionnaireFromForm: pv!questionnaireFromForm\n  ),\n  null\n)\n\n// Input: ?\nrule!AS_GCM_QNM_setMetaDataForTemplateQuestionnaireRecord(\n  questionnaires: rule!AS_GCM_QNM_refreshNegativeFksInQuestionnaire(questionnaire: pv!questionnaireFromForm),\n  initiator: pp!initiator\n)\n\n// Input: ?\n=recordType!AS GCM QNM T Questionnaire\n\n// Output: ?\nAC!RecordsUpdated\n\n// Input: ?\n=pv!oldQuestionnaire[recordType!AS GCM QNM T Questionnaire.questions]\n\n// Input: ?\n=pv!questionnaireFromForm[recordType!AS GCM QNM T Questionnaire.questions]\n\n// Input: ?\n= rule!AS_GCM_QNM_QR_getQuestionnaire_Template( executeWhen: true, questionnaireTemplateId: pv!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questionnaireTemplateId])\n\n// Output: ?\nrule!AS_GCM_QNM_updateQuestionnaireRecordAfterWrite(\n  questionnaireFromForm: pv!questionnaireFromForm,\n  writtenQuestionnaire: ac!writtenQuestionnaire,\n  deletedPksMap: pv!deletedQuestionnairePKMap\n)\n\n// Input: ?\n=cons!AS_GCM_QNM_PM_SET_DEFAULT_QUESTIONNAIRE_TEMPLATE\n\n// Input: ?\n={ questionnaireTemplateId: pv!writtenQuestionnaire[recordType!AS GCM QNM T Questionnaire.questionnaireTemplateId], questionnaireTemplate: #\"urn:appian:function:v1:a:update\"( pv!writtenQuestionnaire, recordType!AS GCM QNM T Questionnaire.isDefault, true() ), originalquestionnaireTemplate: pv!writtenQuestionnaire, userAction: cons!AS_CO_ENUM_USER_ACTION_SUBMIT}"
    }
  }
}
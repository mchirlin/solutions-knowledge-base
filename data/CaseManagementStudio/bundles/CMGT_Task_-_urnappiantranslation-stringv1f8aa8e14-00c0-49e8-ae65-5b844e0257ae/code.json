{
  "_metadata": {
    "bundle_id": "CMGT_Task_-_urnappiantranslation-stringv1f8aa8e14-00c0-49e8-ae65-5b844e0257ae"
  },
  "objects": {
    "_a-0000e99c-1217-8000-9ba9-011c48011c48_58807": {
      "name": "CMGT_UTIL_TruncateText",
      "type": "Expression Rule",
      "sail_code": "if(\n  or(isnull(ri!text), isnull(ri!maxLength)),\n  ri!text,\n  if(\n    len(ri!text) > ri!maxLength,\n    left(\n      ri!text,\n      max(\n        search(\" \", ri!text, ri!maxLength + 1) - 1,\n        ri!maxLength\n      )\n    ) & \"...\",\n    ri!text\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25890": {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "sail_code": "length(a!flatten(ri!value)) = 0"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1720975": {
      "name": "CMGT_NCF_updateNodeHorizontalOrderFromIndex",
      "type": "Expression Rule",
      "sail_code": "#\"urn:appian:function:v1:a:update\"(\n  data: ri!currentNode,\n  index: \"horizontalOrder\",\n  value: wherecontains(\n    ri!currentNode,\n    append(ri!sortedNodes, a!map())\n  )[1] * 100 / (length(ri!sortedNodes) + 1)\n)"
    },
    "_a-0000eda5-abee-8000-9d5c-011c48011c48_4012192": {
      "name": "CMGT_Automation_SendEmail_ChooseVisualizationImage",
      "type": "Expression Rule",
      "sail_code": "if(\n  ri!isSelected,\n  a!match(\n    value: ri!task[recordType!CMGT_Task.statusId],\n    equals: cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_COMPLETED_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_IN_PROGRESS_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_NOT_NEEDED_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_READY,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_READY_SELECTED,\n    default: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_QUEUED_SELECTED,\n    \n  ),\n  a!match(\n    value: ri!task[recordType!CMGT_Task.statusId],\n    equals: cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_COMPLETED,\n    equals: cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_IN_PROGRESS,\n    equals: cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_NOT_NEEDED,\n    equals: cons!CMGT_REFID_STATUS_TASK_READY,\n    then: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_READY,\n    default: cons!CMGT_DOC_IMAGE_SEND_EMAIL_AUTOMATION_QUEUED,\n    \n  )\n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1720993": {
      "name": "CMGT_NCF_orderNodesHorizontallyTopDown",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!nodesOnCurrentLevel: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!allNodes,\n      field: \"verticalOrder\",\n      value: ri!level\n    ),\n    refreshAlways: true\n  ),\n  local!eachNodeWithHorizontalOrder: a!refreshVariable(\n    value: apply(\n      rule!CMGT_NCF_setAverageHorizontalOrderOfPrecedents(\n        currentNode: _,\n        /*can pass in just sorted nodes because parents will always be above children*/\n        orderedNodes: ri!orderedNodes,\n        allEdges: ri!allEdges\n      ),\n      local!nodesOnCurrentLevel\n    ),\n    refreshAlways: true\n  ),\n  local!sortedNodesForThisLevel: a!refreshVariable(\n    value: rule!CMGT_UTIL_sortList(\n      records: local!eachNodeWithHorizontalOrder,\n      field: \"horizontalOrder\",\n      ascending: true\n    ),\n    refreshAlways: true\n  ),\n  local!updatedHorizontalOrder: a!refreshVariable(\n    value: apply(\n      rule!CMGT_NCF_updateNodeHorizontalOrderFromIndex(\n        sortedNodes: local!sortedNodesForThisLevel,\n        currentNode: _\n      ),\n      local!sortedNodesForThisLevel\n    ),\n    refreshAlways: true\n  ),\n  {\n    ri!orderedNodes,\n    local!updatedHorizontalOrder\n  }\n)"
    },
    "_a-0000ea72-a399-8000-9c0d-011c48011c48_852274": {
      "name": "CMGT_Task_TaskWorkflow",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: rule!CMGT_UTIL_LoadBrandingMap(),\n  local!allTasksInWorkflow: rule!CMGT_QR_GetTask(\n    caseId: ri!caseId,\n    includeBranches: true,\n    includeMilestone: true,\n    taskIntentionCodes: cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW\n  ),\n  local!selectedTaskUuid,\n  #\"SYSTEM_SYSRULES_formLayout_v1\"(\n    label: #\"urn:appian:translation-string:v1:2f4f2cde-9986-47cb-ac2a-1ecfeeddc693\",\n    contents: {\n      rule!CMGT_Task_Visualization(\n        tasks: local!allTasksInWorkflow,\n        selectedTaskId: ri!taskId,\n        selectable: false,\n        brandingMap: local!brandingMap,\n        selectedTaskInstanceUUID: local!selectedTaskUuid,\n        conditionSets: local!allTasksInWorkflow[recordType!CMGT_Task.conditionSet]\n      )\n    },\n    buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n      primaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:20b88c70-3142-41f9-a977-bc0781e5eac8\",\n          submit: true,\n          style: \"SOLID\",\n          loadingIndicator: true\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180568": {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "sail_code": "not(rule!CMGT_UTIL_IsBlank(ri!input))"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145769": {
      "name": "CMGT_PLUGIN_NetworkChartField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!formattingOptions: rule!CMGT_UTIL_MergeMaps(\n    map1: rule!CMGT_NetworkChartField_StandardFormatting(brandingMap: ri!brandingMap),\n    map2: ri!formattingOptions\n  ),\n  /*The actual rendering is very hard to predict based on what notes are actually present and their complexity*/\n  /*Therefore, these are 2 parameters, each with 2 options, that drastically impact the rendering*/\n  local!renderingOptions: {\n    a!map(st: \"roots\", te: false),\n    a!map(st: \"roots\", te: true)\n  },\n  /*NOTE: So far this seems the best rendering algorithm that accounts for the most node complexity*/\n  local!selectedRenderingOption: 1,\n  {\n    #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n      labelPosition: \"COLLAPSED\",\n      value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: #\"urn:appian:translation-string:v1:638a9b48-01a5-4947-9ef0-ae787ea16196\"\n      ),\n      showWhen: a!isNullOrEmpty(ri!nodes),\n      align: \"CENTER\",\n      marginAbove: \"MORE\",\n      marginBelow: \"MORE\"\n    ),\n    #\"SYSTEM_SYSRULES_radioButtonField_v1\"(\n      choiceLabels: enumerate(count(local!renderingOptions)) + 1,\n      choiceValues: enumerate(count(local!renderingOptions)) + 1,\n      label: rule!CMGT_UTIL_ReplaceArgs(\n        string: #\"urn:appian:translation-string:v1:105f6b59-5f21-49e4-bd84-13d867a2580e\",\n        args: a!map(option: local!selectedRenderingOption)\n      ),\n      labelPosition: \"ADJACENT\",\n      value: local!selectedRenderingOption,\n      saveInto: local!selectedRenderingOption,\n      showWhen: and(\n        /*Decided to hide showing this 'Rendering Algorithm' option going forward, to put it back just remove the `false` below this line*/\n        false,\n        ri!showRenderingToggle,\n        a!isNotNullOrEmpty(ri!nodes)\n      ),\n      choiceLayout: \"COMPACT\"\n    ),\n    fn!networkChartField(\n      labelPosition: \"COLLAPSED\",\n      validations: {},\n      height: a!defaultValue(ri!height, \"TALL\"),\n      showWhen: a!isNotNullOrEmpty(ri!nodes),\n      nodes: ri!nodes,\n      edges: ri!edges,\n      nodeSelectionValue: a!flatten(ri!selectedNodeUuid),\n      nodeSelectionSaveInto: ri!onNodeSelection,\n      edgeOptions: local!formattingOptions.defaultEdge,\n      groups: local!formattingOptions.nodeOptionGroups,\n      layout: local!formattingOptions.layout,\n      interaction: a!map(\n        selectable: a!defaultValue(ri!selectable, true),\n        navigationButtons: a!defaultValue(ri!showNavButtons, true),\n        hover: true\n      ),\n      physics: local!formattingOptions.physics\n    )\n  }\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180583": {
      "name": "CMGT_UTIL_checkIfSingleType",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Boolean',\n  with(\n    local!typeNumber: rule!CMGT_UTIL_returnTypeNumber(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n  \n    and(\n      /*The type of the input equals the type of the input returned as single type*/\n      local!typeNumber = rule!CMGT_UTIL_returnTypeNumber(\n        typeOf: rule!CMGT_UTIL_returnSingleTypeObject(typeOf: cast(local!typeNumber, null))\n      ),\n      \n      /*And the type of the input is not list of variant*/\n      local!typeNumber <> rule!CMGT_UTIL_returnTypeNumber(\n        typeOf: {}\n      )\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180552": {
      "name": "CMGT_UTIL_cast",
      "type": "Expression Rule",
      "sail_code": "with(  \n  local!typeNumber: rule!CMGT_UTIL_returnTypeNumber(\n    type: ri!type,\n    typeOf: ri!typeOf\n  ),\n\n  /* If the object is empty, use null or {} depending on if it is array type or not */\n  local!objectToCast: if(\n    rule!CMGT_UTIL_IsNotBlank(ri!value),\n    ri!value,\n    rule!CMGT_UTIL_checkIfSingleType(\n      type: ri!type,\n      typeOf: ri!typeOf\n    ),\n    null,\n    {}\n  ),\n\n  cast(\n    local!typeNumber,\n    local!objectToCast\n  )\n  \n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1720580": {
      "name": "CMGT_NCF_orderNodesHorizontallyBottomUp",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!nodesOnCurrentLevel: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!allNodes,\n      field: \"verticalOrder\",\n      value: ri!level\n    ),\n    refreshAlways: true\n  ),\n  local!eachNodeWithHorizontalOrder: a!refreshVariable(\n    value: apply(\n      rule!CMGT_NCF_setAverageHorizontalOrderOfDependents(\n        currentNode: _,\n        /*can pass in just sorted nodes because parents will always be above children*/\n        orderedNodes: ri!orderedNodes,\n        allEdges: ri!allEdges\n      ),\n      local!nodesOnCurrentLevel\n    ),\n    refreshAlways: true\n  ),\n  local!sortedNodesForThisLevel: a!refreshVariable(\n    value: rule!CMGT_UTIL_sortList(\n      records: local!eachNodeWithHorizontalOrder,\n      field: \"horizontalOrder\",\n      ascending: true\n    ),\n    refreshAlways: true\n  ),\n  local!updatedHorizontalOrder: a!refreshVariable(\n    value: apply(\n      rule!CMGT_NCF_updateNodeHorizontalOrderFromIndex(\n        sortedNodes: local!sortedNodesForThisLevel,\n        currentNode: _\n      ),\n      local!sortedNodesForThisLevel\n    ),\n    refreshAlways: true\n  ),\n  {\n    ri!orderedNodes,\n    local!updatedHorizontalOrder\n  }\n)"
    },
    "_a-0000ecb5-acf8-8000-9cf6-011c48011c48_3202674": {
      "name": "CMGT_Automation_returnImageURL",
      "type": "Expression Rule",
      "sail_code": "/*By default all automation type tasks should use the OOB images. \nAny additional or task behavior type specific images should be added here*/\na!match(\n  value: ri!task[recordType!CMGT_Task.taskBehaviorTypeId],\n  equals: cons!CMGT_REFID_TASK_BEHAVIOR_TYPE_AUTOMATION,\n  then: a!match(\n    value: tostring(\n      ri!task[recordType!CMGT_Task.automationTaskAction.actionCode]\n    ),\n    equals: cons!CMGT_CFG_TXT_ACT_WORKFLOW_ROUTING,\n    then: document(\n      rule!CMGT_Automation_WorkflowRouting_ChooseVisualizationImage(task: ri!task, isSelected: ri!isSelected),\n      \"url\"\n    ),\n    equals: cons!CMGT_CFG_TXT_ACT_SEND_EMAIL,\n    then: document(\n      rule!CMGT_Automation_SendEmail_ChooseVisualizationImage(task: ri!task, isSelected: ri!isSelected),\n      \"url\"\n    ),\n    /*Add additional automation type specific images here*/\n    default: document(\n      rule!CMGT_Automation_WorkflowRouting_ChooseVisualizationImage(task: ri!task, isSelected: ri!isSelected),\n      \"url\"\n    )\n  ),\n  /*Add new task behaviour type specific images here*/\n  default: null\n)"
    },
    "_a-0000e99c-1217-8000-9ba9-011c48011c48_64064": {
      "name": "CMGT_Task_Visualization",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!activeTasks: rule!CMGT_UTIL_Filter(\n    records: ri!tasks,\n    field: recordType!CMGT_Task.isActive,\n    value: true\n  ),\n  local!activeTaskBranches: rule!CMGT_UTIL_Filter(\n    records: a!flatten(\n      ri!tasks[recordType!CMGT_Task.beforeTaskInstanceBranches]\n    ),\n    fieldValuePairs: {\n      a!map(\n        field: recordType!CMGT_TaskBranch.isActive,\n        value: true()\n      ),\n      a!map(\n        field: recordType!CMGT_TaskBranch.isCurrent,\n        value: true()\n      )\n    }\n  ),\n  local!startMilestoneReferenceMilestoneId: a!defaultValue(ri!startTaskInstanceUUID, \"m-0\"),\n  /*\n  -------\n  Build all nodes\n  -------\n  */\n  /*Start with parent milestone nodes for each distinct milestone*/\n  local!milestoneNodes: #\"SYSTEM_SYSRULES_forEach\"(\n    items: {\n      a!map(\n        referenceMilestone: a!map(\n          referenceMilestoneId: local!startMilestoneReferenceMilestoneId,\n          label: #\"urn:appian:translation-string:v1:ca8737d3-bee3-452c-9475-419cf1366475\"\n        ),\n        tasks: local!activeTasks\n      ),\n      a!map(\n        referenceMilestone: a!map(\n          referenceMilestoneId: \"m-\" & if(\n            rule!CMGT_UTIL_IsBlank(local!activeTasks),\n            1,\n            length(local!activeTasks) + 1\n          ),\n          label: #\"urn:appian:translation-string:v1:36adaa76-dce1-43bf-9939-c889275129bd\"\n        )\n      )\n    },\n    expression: a!map(\n      id: fv!item.referenceMilestone.referenceMilestoneId,\n      group: \"terminal\",\n      label: concat(\n        \"<b>\",\n        substitute(\n          upper(fv!item.referenceMilestone.label),\n          char(10),\n          \"</b>\" & char(10) & \"<b>\"\n        ),\n        \"</b>\"\n      ),\n      font: a!map(\n        multi: \"html\",\n        align: \"center\",\n        size: 12,\n        vadjust: 2,\n        color: ri!brandingMap.BlackColor,\n        bold: a!map(size: 14, vadjust: 0, mod: \"bold\")\n      ),\n      color: a!map(\n        border: ri!brandingMap.DividerColor,\n        background: ri!brandingMap.WhiteColor\n      ),\n      shadow: a!map(),\n      /*For each milestone, create the children nodes within that milestone*/\n      children: #\"SYSTEM_SYSRULES_forEach\"(\n        items: fv!item.tasks,\n        expression: a!localVariables(\n          if(\n            fv!item[recordType!CMGT_Task.taskBehaviorType.isAutomated],\n            /*Automated Tasks */\n            a!map(\n              id: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n              group: \"task\",\n              label: if(\n                tostring(ri!selectedTaskInstanceUUID) = fv!item[recordType!CMGT_Task.taskInstanceUuid],\n                concat(\n                  \"<b>\",\n                  rule!CMGT_UTIL_TruncateText(\n                    text: a!defaultValue(\n                      fv!item[recordType!CMGT_Task.title],\n                      #\"urn:appian:translation-string:v1:f1a2114c-0453-4665-b358-be59650c55bc\"\n                    ),\n                    maxLength: 44\n                  ),\n                  \"</b>\"\n                ),\n                rule!CMGT_UTIL_TruncateText(\n                  text: a!defaultValue(\n                    fv!item[recordType!CMGT_Task.title],\n                    #\"urn:appian:translation-string:v1:f1a2114c-0453-4665-b358-be59650c55bc\"\n                  ),\n                  maxLength: 44\n                )\n              ),\n              font: a!map(\n                multi: \"html\",\n                align: \"left\",\n                size: 12,\n                vadjust: 2,\n                color: ri!brandingMap.BlackColor,\n                bold: a!map(size: 14, vadjust: - 4, mod: \"bold\"),\n\n              ),\n              shape: \"image\",\n              image: rule!CMGT_Automation_returnImageURL(\n                task: fv!item,\n                isSelected: tostring(ri!selectedTaskInstanceUUID) = fv!item[recordType!CMGT_Task.taskInstanceUuid]\n              ),\n              color: a!map(\n                border: ri!brandingMap.DividerColor,\n                background: null\n              ),\n              shadow: a!map()\n            ),\n            a!map(\n              id: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n              group: \"task\",\n              label: concat(\n                \"<b>\",\n                if(\n                  fv!item[recordType!CMGT_Task.taskBehaviorType.isAutomated],\n                  char(9881) & \" \",\n                  \"\"\n                ),\n                /*Trim the title to 44 characters at the next space to prevent wrapping text*/\n                substitute(\n                  rule!CMGT_UTIL_TruncateText(\n                    text: a!defaultValue(\n                      fv!item[recordType!CMGT_Task.title],\n                      #\"urn:appian:translation-string:v1:f1a2114c-0453-4665-b358-be59650c55bc\"\n                    ),\n                    maxLength: 44\n                  ),\n                  char(10),\n                  \"</b>\" & char(10) & \"<b>\"\n                ),\n                \"</b>\",\n                char(10),\n                fv!item[recordType!CMGT_Task.status.statusLabel],\n                if(\n                  a!isNotNullOrEmpty(\n                    fv!item[recordType!CMGT_Task.milestone.label]\n                  ),\n                  concat(\n                    char(10),\n                    char(10),\n                    \"<i>\" & char(9679) & \" \" & \"</i>\" & fv!item[recordType!CMGT_Task.milestone.label]\n                  ),\n                  \"\"\n                )\n              ),\n              font: a!map(\n                multi: \"html\",\n                align: \"left\",\n                size: 12,\n                vadjust: 2,\n                color: ri!brandingMap.BlackColor,\n                bold: a!map(size: 14, vadjust: - 4, mod: \"bold\"),\n                ital: a!map(\n                  color: fv!item[recordType!CMGT_Task.milestone.milestoneColor],\n                  size: 20\n                )\n              ),\n              color: a!map(\n                border: ri!brandingMap.DividerColor,\n                background: if(\n                  or(\n                    fv!item[recordType!CMGT_Task.isCompleted],\n                    tointeger(\n                      fv!item[recordType!CMGT_Task.statusId]\n                    ) = cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n                  ),\n                  ri!brandingMap.TaskStatusResolvedBackgroundColor,\n                  ri!brandingMap.WhiteColor\n                )\n              ),\n              shadow: a!map(\n                enabled: true,\n                color: if(\n                  tointeger(\n                    fv!item[recordType!CMGT_Task.status.statusId]\n                  ) = cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED,\n                  rule!CMGT_UTIL_DisplayBranding(\n                    brandingMap: ri!brandingMap,\n                    key: \"TaskStatusCompletedAccentColor\"\n                  ),\n                  rule!CMGT_UTIL_DisplayBranding(\n                    brandingMap: ri!brandingMap,\n                    key: fv!item[recordType!CMGT_Task.status.accentColor]\n                  )\n                ),\n                size: 0,\n                x: 0,\n                y: - 5\n              )\n            )\n          )\n        )\n      )\n    )\n  ),\n  /*\n  -------\n  Build all edges\n  -------\n  */\n  /*Build edges for all VALID branches between tasks*/\n  /*Note that branches can become inActive through SAIL manipulation in forms, so we hide them*/\n  local!taskToTaskEdges: if(\n    rule!CMGT_UTIL_IsBlank(local!activeTasks),\n    {},\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: rule!CMGT_UTIL_DistinctRecords(\n        records: local!activeTaskBranches,\n        fields: {\n          recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n          recordType!CMGT_TaskBranch.afterTaskInstanceUuid,\n          recordType!CMGT_TaskBranch.taskResponseOption.taskResponseOptionId\n        }\n      ),\n      expression: a!localVariables(\n        local!taskBeforeBranch: displayvalue(\n          fv!item[recordType!CMGT_TaskBranch.beforeTaskInstanceUuid],\n          local!activeTasks[recordType!CMGT_Task.taskInstanceUuid],\n          local!activeTasks,\n          null\n        ),\n        local!taskAfterBranch: displayvalue(\n          fv!item[recordType!CMGT_TaskBranch.afterTaskInstanceUuid],\n          local!activeTasks[recordType!CMGT_Task.taskInstanceUuid],\n          local!activeTasks,\n          null\n        ),\n        local!isTraversed: and(\n          a!defaultValue(\n            local!taskBeforeBranch[recordType!CMGT_Task.isCompleted],\n            false\n          ),\n          local!taskBeforeBranch[recordType!CMGT_Task.selectedTaskResponseOption.taskResponseOptionUuid] = fv!item[recordType!CMGT_TaskBranch.taskResponseOptionUuid]\n        ),\n        local!edgeLabel: displayvalue(\n          fv!item[recordType!CMGT_TaskBranch.taskResponseOptionUuid],\n          local!taskBeforeBranch[recordType!CMGT_Task.taskResponseOptions.taskResponseOptionUuid],\n          local!taskBeforeBranch[recordType!CMGT_Task.taskResponseOptions.label],\n          null\n        ),\n        a!map(\n          from: local!taskBeforeBranch[recordType!CMGT_Task.taskInstanceUuid],\n          to: local!taskAfterBranch[recordType!CMGT_Task.taskInstanceUuid],\n          label: if(\n            local!isTraversed,\n            concat(\n              \"<b>\",\n              rule!CMGT_UTIL_TruncateText(text: local!edgeLabel, maxLength: 15),\n              \"</b>\"\n            ),\n            rule!CMGT_UTIL_TruncateText(text: local!edgeLabel, maxLength: 15)\n          ),\n          title: local!edgeLabel,\n          color: ri!brandingMap.SecondaryColor,\n          dashes: if(\n            fv!item[recordType!CMGT_TaskBranch.isRequired],\n            false,\n            true\n          ),\n          font: a!map(\n            multi: \"html\",\n            align: \"horizontal\",\n            color: ri!brandingMap.SecondaryColor,\n            bold: a!map(mod: \"bold\", size: 15)\n          )\n        )\n      )\n    )\n  ),\n  /*Build edges for all tasks that connect to their milestone start node*/\n  local!milestoneToTaskEdges: #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!activeTasks,\n    expression: a!map(\n      from: local!startMilestoneReferenceMilestoneId,\n      to: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n      color: if(\n        or(\n          isnull(\n            fv!item[recordType!CMGT_Task.statusId]\n          ),\n          fv!item[recordType!CMGT_Task.statusId] = cons!CMGT_REFID_STATUS_TASK_QUEUED\n        ),\n        null,\n        ri!brandingMap.SecondaryColor\n      ),\n      /*- Connect to start if starts by default or has nothing before it*/\n      showWhen: fv!item[recordType!CMGT_Task.startsByDefault],\n      dashes: false,\n      font: a!map()\n    )\n  ),\n  /*Build edges for all tasks that connect to the \"End\" node*/\n  local!taskToMilestoneEdges: rule!CMGT_UTIL_RejectBlank(\n    a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!activeTasks,\n        expression: a!localVariables(\n          local!taskDependentBranches: rule!CMGT_UTIL_Filter(\n            records: local!activeTaskBranches,\n            field: recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n            value: fv!item[recordType!CMGT_Task.taskInstanceUuid]\n          ),\n          local!taskPrecedentBranches: rule!CMGT_UTIL_Filter(\n            records: local!activeTaskBranches,\n            field: recordType!CMGT_TaskBranch.afterTaskInstanceUuid,\n            value: fv!item[recordType!CMGT_Task.taskInstanceUuid]\n          ),\n          local!responseOptionToEnd: rule!CMGT_UTIL_Filter(\n            records: fv!item[recordType!CMGT_Task.taskResponseOptions],\n            field: recordType!CMGT_TaskResponseOption.taskResponseOptionUuid,\n            value: local!taskDependentBranches[recordType!CMGT_TaskBranch.taskResponseOptionUuid],\n            filterType: \"REJECT\"\n          ),\n          /* The below 2 locals are specific to automation */\n          local!currentTaskActiveConditionSets: cast(\n            #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(\n              recordType!CMGT_ConditionSet\n            ),\n            rule!CMGT_UTIL_Filter(\n              records: a!flatten(\n                rule!CMGT_UTIL_Filter(\n                  records: ri!conditionSets,\n                  field: recordType!CMGT_ConditionSet.taskInstanceUuid,\n                  value: fv!item[recordType!CMGT_Task.taskInstanceUuid]\n                )[recordType!CMGT_ConditionSet.childConditionSet]\n              ),\n              field: recordType!CMGT_ConditionSet.isActive,\n              value: true\n            )\n          ),\n          local!currentTaskActiveConditionSetCount: length(\n            rule!CMGT_UTIL_DistinctRecords(\n              records: rule!CMGT_UTIL_Filter(\n                records: a!flatten(\n                  local!currentTaskActiveConditionSets[recordType!CMGT_ConditionSet.condition]\n                ),\n                field: recordType!CMGT_Condition.isActive,\n                value: true\n              ),\n              fields: recordType!CMGT_Condition.conditionSetUuid\n            )\n          ),\n          /* This local is used to drive logic to connect activities with End */\n          local!hasDefaultEdgeToEnd: a!match(\n            value: fv!item[recordType!CMGT_Task.taskBehaviorTypeId],\n            whenTrue: and(\n              fv!value = cons!CMGT_REFID_TASK_BEHAVIOR_TYPE_AUTOMATION,\n              fv!item[recordType!CMGT_Task.automationTaskAction.actionCode] = cons!CMGT_CFG_TXT_ACT_WORKFLOW_ROUTING\n            ),\n            /* Checking if the after task branch count is less than active condition set count(with conditions)+1 (If no rule met go to) for workflow routing automation */\n            then: length(\n              rule!CMGT_UTIL_DistinctRecords(\n                records: rule!CMGT_UTIL_Filter(\n                  records: local!activeTaskBranches,\n                  field: recordType!CMGT_TaskBranch.beforeTaskInstanceUuid,\n                  value: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n\n                ),\n                fields: recordType!CMGT_TaskBranch.conditionSetUuid\n              )\n            ) < local!currentTaskActiveConditionSetCount + 1,\n            whenTrue: and(\n              rule!CMGT_UTIL_IsBlank(local!taskDependentBranches),\n              rule!CMGT_UTIL_IsBlank(local!responseOptionToEnd)\n            ),\n            then: true,\n            /* add additional logics here */\n            default: false\n          ),\n          local!item: fv!item,\n          local!isTraversed: and(\n            a!defaultValue(\n              fv!item[recordType!CMGT_Task.isCompleted],\n              false\n            ),\n            rule!CMGT_UTIL_IsBlank(\n              value: rule!CMGT_UTIL_Filter(\n                records: local!activeTaskBranches,\n                field: recordType!CMGT_TaskBranch.taskResponseOptionUuid,\n                value: fv!item[recordType!CMGT_Task.selectedTaskResponseOption.taskResponseOptionUuid]\n              )\n            )\n          ),\n          if(\n            and(\n              local!item[recordType!CMGT_Task.startsByDefault] = false,\n              rule!CMGT_UTIL_IsBlank(local!taskPrecedentBranches)\n            ),\n            {},\n            {\n              /* Constructing edge for each response option */\n              #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!responseOptionToEnd,\n                expression: a!map(\n                  from: local!item[recordType!CMGT_Task.taskInstanceUuid],\n                  to: \"m-\" & length(local!activeTasks) + 1,\n                  color: ri!brandingMap.BlackColor,\n                  label: if(\n                    and(\n                      toboolean(local!isTraversed) = true(),\n                      fv!item[recordType!CMGT_TaskResponseOption.taskResponseOptionUuid] = local!item[recordType!CMGT_Task.selectedTaskResponseOption.taskResponseOptionUuid]\n                    ),\n                    concat(\n                      \"<b>\",\n                      rule!CMGT_UTIL_TruncateText(\n                        text: fv!item[recordType!CMGT_TaskResponseOption.label],\n                        maxLength: 15\n                      ),\n                      \"</b>\"\n                    ),\n                    rule!CMGT_UTIL_TruncateText(\n                      text: fv!item[recordType!CMGT_TaskResponseOption.label],\n                      maxLength: 15\n                    )\n                  ),\n                  title: fv!item[recordType!CMGT_TaskResponseOption.label],\n                  dashes: false,\n                  font: a!map(\n                    multi: \"html\",\n                    align: \"horizontal\",\n                    color: ri!brandingMap.BlackColor,\n                    bold: a!map(mod: \"bold\", size: 15)\n                  )\n                )\n              ),\n              a!map(\n                from: fv!item[recordType!CMGT_Task.taskInstanceUuid],\n                to: \"m-\" & if(\n                  rule!CMGT_UTIL_IsBlank(local!activeTasks),\n                  1,\n                  length(local!activeTasks) + 1\n                ),\n                color: ri!brandingMap.SecondaryColor,\n                /*- Connect to end if has default edge to end*/\n                showWhen: local!hasDefaultEdgeToEnd,\n                dashes: false,\n                font: a!map()\n              )\n            }\n          )\n        )\n      )\n    )\n  ),\n  /*Combine all edges before passing to component*/\n  /*Set the arrows parameter on the individual edges since we may need to swap these around to optimize rendering*/\n  local!allEdges: #\"SYSTEM_SYSRULES_forEach\"(\n    items: rule!CMGT_UTIL_Filter(\n      records: {\n        local!taskToTaskEdges,\n        local!milestoneToTaskEdges,\n        local!taskToMilestoneEdges\n      },\n      field: \"showWhen\",\n      value: false,\n      filterType: \"REJECT\"\n    ),\n    expression: #\"urn:appian:function:v1:a:update\"(\n      fv!item,\n      \"arrows\",\n      rule!CMGT_NetworkChartField_StandardFormatting(brandingMap: ri!brandingMap).defaultArrow\n    )\n  ),\n  local!fixNodesEdgesOrder: if(\n    a!isNullOrEmpty(local!activeTasks),\n    a!map(nodes: {}, edges: {}),\n    rule!CMGT_NetworkChartField_FixNodeEdgeOrder_Logic(\n      nodes: local!milestoneNodes,\n      edges: local!allEdges\n    )\n  ),\n  /*\n  -------\n  local variables that refreshes after load based on selection\n  -------\n  */\n  local!selectedTask: rule!CMGT_UTIL_cast(\n    type: recordType!CMGT_Task,\n    value: if(\n      a!isNullOrEmpty(ri!selectedTaskInstanceUUID),\n      null,\n      rule!CMGT_UTIL_Filter(\n        records: local!activeTasks,\n        field: recordType!CMGT_Task.taskInstanceUuid,\n        value: ri!selectedTaskInstanceUUID\n      )\n    )\n  ),\n  local!finalNodesToDisplay: if(\n    a!isNullOrEmpty(ri!selectedTaskInstanceUUID),\n    /*display as it is, if no task node is selected*/\n    local!fixNodesEdgesOrder.nodes,\n    /*Update selected task's border and unrelated task nodes*/\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!fixNodesEdgesOrder.nodes,\n      expression: a!localVariables(\n        local!currentTask: rule!CMGT_UTIL_cast(\n          type: recordType!CMGT_Task,\n          value: rule!CMGT_UTIL_Filter(\n            records: local!activeTasks,\n            field: recordType!CMGT_Task.taskInstanceUuid,\n            value: fv!item.id\n          )\n        ),\n        local!isSelected: touniformstring(ri!selectedTaskInstanceUUID) = touniformstring(fv!item.id),\n        local!isRelatedToSelected: or(\n          contains(\n            local!currentTask[recordType!CMGT_Task.beforeTaskInstanceBranches.beforeTaskInstanceUuid],\n            touniformstring(ri!selectedTaskInstanceUUID)\n          ),\n          contains(\n            local!selectedTask[recordType!CMGT_Task.beforeTaskInstanceBranches.beforeTaskInstanceUuid],\n            touniformstring(fv!item.id)\n          )\n        ),\n        #\"urn:appian:function:v1:a:update\"(\n          fv!item,\n          { \"font\", \"color\", \"shadow\" },\n          {\n            #\"urn:appian:function:v1:a:update\"(\n              fv!item.font,\n              \"color\",\n              if(\n                or(\n                  local!isSelected,\n                  local!isRelatedToSelected\n                ),\n                { ri!brandingMap.BlackColor },\n                { ri!brandingMap.SecondaryTextColor }\n              )\n            ),\n            #\"urn:appian:function:v1:a:update\"(\n              fv!item.color,\n              { \"background\", \"border\" },\n              {\n                if(\n                  or(\n                    local!isSelected,\n                    local!isRelatedToSelected\n                  ),\n                  { fv!item.color.background },\n                  { ri!brandingMap.WhiteColor }\n                ),\n                if(\n                  local!isSelected,\n                  ri!brandingMap.BlackColor,\n                  ri!brandingMap.DividerColor\n                )\n              }\n            ),\n            #\"urn:appian:function:v1:a:update\"(\n              fv!item.shadow,\n              \"color\",\n              if(\n                or(\n                  local!isSelected,\n                  local!isRelatedToSelected\n                ),\n                { fv!item.shadow.color },\n                { ri!brandingMap.WhiteColor }\n              )\n            )\n          }\n        )\n      )\n    )\n  ),\n  local!finalEdgesToDisplay: if(\n    a!isNullOrEmpty(ri!selectedTaskInstanceUUID),\n    /*display as it is if no task node is selected*/\n    local!fixNodesEdgesOrder.edges,\n    /*Update edges to selected and related nodes to be black in color*/\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!fixNodesEdgesOrder.edges,\n      expression: if(\n        /*if it is a edge to selected or related node - update color*/\n        contains(\n          touniformstring({ fv!item.from, fv!item.to }),\n          touniformstring(ri!selectedTaskInstanceUUID)\n        ),\n        #\"urn:appian:function:v1:a:update\"(\n          data: fv!item,\n          index: \"color\",\n          value: ri!brandingMap.BlackColor\n        ),\n        {\n          #\"urn:appian:function:v1:a:update\"(\n            data: fv!item,\n            index: { \"font\", \"color\" },\n            value: {\n              #\"urn:appian:function:v1:a:update\"(\n                data: fv!item.font,\n                index: \"color\",\n                value: ri!brandingMap.SecondaryTextColor\n              ),\n              ri!brandingMap.DividerColor\n            }\n          )\n        }\n      )\n    )\n  ),\n  local!validations: if(\n    ri!showValidation,\n    a!localVariables(\n      local!isEndNodePresentAndConnected: and(\n        contains(\n          index(local!finalNodesToDisplay, \"label\", \"\"),\n          \"<b>END</b>\"\n        ),\n        contains(\n          touniformstring(\n            index(local!finalEdgesToDisplay, \"to\", \"\")\n          ),\n          \"m-\" & if(\n            rule!CMGT_UTIL_IsBlank(local!activeTasks),\n            1,\n            length(local!activeTasks) + 1\n          )\n        )\n      ),\n      {\n        #\"SYSTEM_SYSRULES_validationMessage\"(\n          message: #\"urn:appian:translation-string:v1:b1c8fa44-5ad7-4c3d-adab-2b29d020ce6f\"(\n            #\"urn:appian:translation-variable:v1:7202908f-19dc-44a8-a741-9d1f47227cbe\": ri!additionalValidationConditions.taskNamesInViolation\n          ),\n          validateAfter: \"SUBMIT\",\n          showWhen: rule!CMGT_UTIL_IsNotBlank(\n            ri!additionalValidationConditions.taskNamesInViolation\n          )\n        ),\n        /*display validation message if there are no tasks mapped to START*/\n        #\"SYSTEM_SYSRULES_validationMessage\"(\n          message: #\"urn:appian:translation-string:v1:459be6ff-55b0-47f3-81fc-6c7386747126\",\n          validateAfter: \"SUBMIT\",\n          showWhen: and(\n            rule!CMGT_UTIL_IsBlank(\n              ri!additionalValidationConditions.tasksMappedtoStart\n            ),\n            ri!additionalValidationConditions.doesNonStartTasksExist\n          )\n        ),\n        /*display validation message if there is not end node*/\n        #\"SYSTEM_SYSRULES_validationMessage\"(\n          message: #\"urn:appian:translation-string:v1:2c2e7b04-c771-4f76-94e6-06f65f4c162f\",\n          validateAfter: \"SUBMIT\",\n          showWhen: and(\n            not(local!isEndNodePresentAndConnected),\n            count(\n              index(local!finalNodesToDisplay, \"label\", null)\n            ) > 1\n          )\n        ),\n        /*display validation message if there are tasks with no required precedents*/\n        #\"SYSTEM_SYSRULES_validationMessage\"(\n          message: #\"urn:appian:translation-string:v1:cb8b665a-6708-48a7-a046-0581dfad9bdd\"(\n            #\"urn:appian:translation-variable:v1:5f1e4161-3b84-4604-a027-ed934750ece6\": joinarray(\n              index(\n                ri!additionalValidationConditions,\n                \"tasksWithNoPrecedents\",\n                null\n              )[recordType!CMGT_Task.title],\n              \", \"\n            )\n          ),\n          validateAfter: \"SUBMIT\",\n          showWhen: rule!CMGT_UTIL_IsNotBlank(\n            index(\n              ri!additionalValidationConditions,\n              \"tasksWithNoPrecedents\",\n              null\n            )\n          )\n        ),\n        /*display validation message if there are tasks with invalid basic details*/\n        #\"SYSTEM_SYSRULES_validationMessage\"(\n          message: #\"urn:appian:translation-string:v1:1954697c-c9b5-4ac7-b349-d5d298d0f929\"(\n            #\"urn:appian:translation-variable:v1:f8f512c7-0b6c-4d3d-9aaf-482aa193d182\": joinarray(\n              index(\n                ri!additionalValidationConditions,\n                \"tasksWithInvalidBasicDetails\",\n                null\n              )[recordType!CMGT_Task.title],\n              \", \"\n            )\n          ),\n          validateAfter: \"SUBMIT\",\n          showWhen: rule!CMGT_UTIL_IsNotBlank(\n            index(\n              ri!additionalValidationConditions,\n              \"tasksWithInvalidBasicDetails\",\n              null\n            )\n          )\n        )\n      }\n    ),\n    {}\n  ),\n  {\n    #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n      showWhen: rule!CMGT_UTIL_IsNotBlank(local!validations),\n      validations: local!validations,\n      validationGroup: ri!validationGroup\n    ),\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: rule!CMGT_PLUGIN_NetworkChartField(\n        nodes: local!finalNodesToDisplay,\n        edges: local!finalEdgesToDisplay,\n        selectedNodeUuid: ri!selectedTaskInstanceUUID,\n        height: if(\n          rule!CMGT_UTIL_IsMobileScreenSize(),\n          \"MEDIUM\",\n          \"TALL\"\n        ),\n        selectable: ri!selectable,\n        brandingMap: ri!brandingMap,\n        onNodeSelection: {\n          a!save(\n            ri!selectedTaskInstanceUUID,\n            rule!CMGT_UTIL_cast(\n              typeOf: { \"\" },\n              value: if(\n                touniformstring(ri!selectedTaskInstanceUUID) = save!value,\n                {},\n                save!value\n              )\n            )\n          ),\n          if(\n            rule!CMGT_UTIL_IsNotBlank(\n              input: rule!CMGT_UTIL_Filter(\n                records: local!activeTasks,\n                field: recordType!CMGT_Task.taskInstanceUuid,\n                value: ri!selectedTaskInstanceUUID\n              )[recordType!CMGT_Task.taskId]\n            ),\n            a!save(\n              ri!selectedTaskId,\n              rule!CMGT_UTIL_Filter(\n                records: local!activeTasks,\n                field: recordType!CMGT_Task.taskInstanceUuid,\n                value: ri!selectedTaskInstanceUUID\n              )[recordType!CMGT_Task.taskId]\n            ),\n            {}\n          )\n        }\n      ),\n      style: ri!brandingMap.CardBackgroundColor,\n      shape: ri!brandingMap.CardShape,\n      padding: \"EVEN_LESS\",\n      showBorder: ri!brandingMap.CardShowBorder,\n      showShadow: ri!brandingMap.CardShowShadow\n    )\n  }\n)"
    },
    "_a-0000ecb5-acf8-8000-9cf6-011c48011c48_3198037": {
      "name": "CMGT_Automation_WorkflowRouting_ChooseVisualizationImage",
      "type": "Expression Rule",
      "sail_code": "if(\n  ri!isSelected,\n  a!match(\n    value: ri!task[recordType!CMGT_Task.statusId],\n    equals: cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_COMPLETED_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_IN_PROGRESS_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_NOT_NEEDED_SELECTED,\n    equals: cons!CMGT_REFID_STATUS_TASK_READY,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_READY_SELECTED,\n    default: cons!CMGT_DOC_IMAGE_AUTOMATION_QUEUED_SELECTED,\n    \n  ),\n  a!match(\n    value: ri!task[recordType!CMGT_Task.statusId],\n    equals: cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_COMPLETED,\n    equals: cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_IN_PROGRESS,\n    equals: cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_NOT_NEEDED,\n    equals: cons!CMGT_REFID_STATUS_TASK_READY,\n    then: cons!CMGT_DOC_IMAGE_AUTOMATION_READY,\n    default: cons!CMGT_DOC_IMAGE_AUTOMATION_QUEUED,\n    \n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_29411": {
      "name": "CMGT_QR_GetTask",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Task,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  groupByFields: ri!groupByFields,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskId,\n      operator: \"in\",\n      value: ri!taskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.statusId,\n      operator: \"in\",\n      value: ri!statusId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn, true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isActive,\n      operator: \"=\",\n      value: true,\n      applyWhen: ri!includeInactive <> true\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.isCurrent,\n      operator: \"=\",\n      value: a!defaultValue(ri!isCurrentTask, true),\n      applyWhen: a!defaultValue(ri!isCurrentTaskApplyWhen, true),\n      \n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Task.taskIntentionCode,\n      operator: \"in\",\n      value: a!defaultValue(\n        ri!taskIntentionCodes,\n        {\n          cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW\n        }\n      )\n    ),\n    \n  },\n  fields: {\n    ri!fields,\n    if(\n      ri!includeRoles,\n      {\n        recordType!CMGT_Task.roles\n      },\n      {}\n    ),\n    if(\n      ri!includeMilestone,\n      {\n        recordType!CMGT_Task.milestone\n      },\n      {}\n    ),\n    if(\n      ri!includeCase,\n      {\n        recordType!CMGT_Task.case\n      },\n      {}\n    ),\n    if(\n      ri!includeBranches,\n      {\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        recordType!CMGT_Task.beforeTaskInstanceBranches,\n        #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/73a323c9-ce12-4212-97aa-f89df7d14c09/9644c5ba-af85-48a3-9cda-fcfb028d6113/3280de96-3518-4a9e-b8ae-854a84562f07\"\n      },\n      {}\n    ),\n    recordType!CMGT_Task.taskBehaviorType,\n    recordType!CMGT_Task.status,\n    recordType!CMGT_Task.taskResponseOptions,\n    recordType!CMGT_Task.selectedTaskResponseOption,\n    recordType!CMGT_Task.conditionSet,\n    recordType!CMGT_Task.conditionSet,\n    #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/5189c3ac-98e2-4a82-8598-2e9561baec9d/64b891e4-359b-48b4-9f47-2a3af4695c34/52813580-ecf3-49c7-be71-568ab452d54a\",\n    recordType!CMGT_Task.createCaseTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.sendEmailTask,\n    recordType!CMGT_Task.automationTaskAction\n  },\n  logicalExpressions: {\n    ri!additionalLogicalExpression,\n    rule!CMGT_Task_AutomationRuleGlobalLogicalExpression(\n      taskIntentionCodes: ri!taskIntentionCodes\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  relatedRecordData: ri!relatedRecordData,\n  sort: ri!sort,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_137280": {
      "name": "CMGT_UTIL_DistinctRecords",
      "type": "Expression Rule",
      "sail_code": "if(\n  or(\n    a!isNullOrEmpty(ri!records),\n    a!isNullOrEmpty(ri!fields)\n  ),\n  ri!records,\n  with(\n    local!indexed: #\"SYSTEM_SYSRULES_forEach\"(\n      items: a!flatten(ri!records),\n      expression: a!map(\n        record: fv!item,\n        distinct: joinarray(\n          apply(\n            index(fv!item, _, null),\n            a!flatten(ri!fields)\n          ),\n          \"|\"\n        )\n      )\n    ),\n    local!distinctItems: union(\n      local!indexed.distinct,\n      local!indexed.distinct\n    ),\n    apply(\n      displayvalue(\n        _,\n        local!indexed.distinct,\n        local!indexed.record,\n        null\n      ),\n      local!distinctItems\n    )\n  )\n)"
    },
    "_a-0000eb2c-b6af-8000-9c5d-011c48011c48_1453742": {
      "name": "CMGT_UTIL_ReplaceArgs",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!args),\n  ri!string,\n  reduce(\n    substitute(_, _, _),\n    ri!string,\n    merge(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: a!keys(ri!args),\n        expression: \"@|\" & fv!item & \"|@\"\n      ),\n      touniformstring(ri!args[a!keys(ri!args)])\n    )\n  )\n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1719960": {
      "name": "CMGT_NCF_orderNodesBasedOnDistanceFromStart",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!edgesFromOrderedNodes: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!allEdges,\n      field: \"from\",\n      value: ri!orderedNodes.id\n    ),\n    refreshAlways: true\n  ),\n  local!edgesToUnorderedNodes: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      filterType: \"REJECT\",\n      records:local!edgesFromOrderedNodes,\n      field: \"to\",\n      value: ri!orderedNodes.id\n    ),\n    refreshAlways: true\n  ),\n  local!dependentUnorderedNodes: a!refreshVariable(\n    value:  rule!CMGT_UTIL_Filter(\n      records: ri!allNodes,\n      field: \"id\",\n      value: local!edgesToUnorderedNodes.to\n    ),\n    refreshAlways: true\n  ),\n  local!nodesToOrder: a!refreshVariable(\n    value: rule!CMGT_UTIL_cast(\n      typeOf: {a!map()},\n      value: apply(\n        rule!CMGT_NCF_updateNodeOrderBasedOnPrecedents(\n          allEdges: ri!allEdges,\n          currentNode: _,\n          edgesToUnorderedNodes: local!edgesToUnorderedNodes,\n          orderedNodes: ri!orderedNodes\n        ),\n        local!dependentUnorderedNodes\n      )\n    ),\n    refreshAlways: true\n  ),\n  union(ri!orderedNodes, local!nodesToOrder)\n)"
    },
    "_a-0000ea2f-ac11-8000-9bf4-011c48011c48_619938": {
      "name": "CMGT_NetworkChartField_StandardFormatting",
      "type": "Expression Rule",
      "sail_code": "a!map(\n  nodeOptionGroups: a!map(\n    task: a!map(\n      chosen: false,\n      shape: \"box\",\n      shapeProperties: a!map(\n        borderRadius: if(\n          search(\n            \"ROUND\",\n            tostring(ri!brandingMap.CardShape)\n          ),\n          6,\n          0\n        )\n      ),\n      font: a!map(\n        multi: \"html\",\n        align: \"left\",\n        size: 12,\n        vadjust: 2,\n        color: ri!brandingMap.BlackColor,\n        bold: a!map(size: 14, vadjust: - 4, mod: \"bold\")\n      ),\n      color: a!map(\n        border: ri!brandingMap.DividerColor,\n        background: ri!brandingMap.WhiteColor\n      ),\n      margin: 12,\n      widthConstraint: a!map(maximum: 250),\n      heightConstraint: a!map(valign: \"middle\"),\n      /*shadow: a!map(enabled: true, size: 0, x: 0, y: - 5)*/\n    ),\n    terminal: a!map(\n      chosen: false,\n      shape: \"box\",\n      shapeProperties: a!map(\n        borderRadius: if(\n          search(\n            \"ROUND\",\n            tostring(ri!brandingMap.CardShape)\n          ),\n          6,\n          0\n        )\n      ),\n      font: a!map(\n        multi: \"html\",\n        align: \"left\",\n        size: 12,\n        vadjust: 2,\n        color: ri!brandingMap.BlackColor,\n        bold: a!map(size: 14, vadjust: 0, mod: \"bold\")\n      ),\n      margin: 10,\n      color: a!map(\n        border: ri!brandingMap.DividerColor,\n        background: ri!brandingMap.WhiteColor\n      )\n    )\n  ),\n  defaultEdge: a!map(\n    color: ri!brandingMap.SecondaryTextColor,\n    width: 1,\n    dashes: true,\n    chosen: false\n  ),\n  defaultArrow: a!map(to: a!map(enabled: true, scaleFactor: .75)),\n  layout: a!map(\n    improvedLayout: true,\n    clusterThreshold: 1000000,\n    hierarchical: a!map(\n      enabled: true,\n      levelSeparation: 175,\n      nodeSpacing: 250,\n      treeSpacing: 400,\n      blockShifting: true,\n      edgeMinimization: true,\n      parentCentralization: true,\n      direction: \"UD\",\n      sortMethod: \"directed\",\n      shakeTowards: \"roots\"\n    )\n  ),\n  physics: a!map(\n    enabled: true,\n    solver: \"hierarchicalRepulsion\",\n    hierarchicalRepulsion: a!map(avoidOverlap: 1, nodeDistance: 80),\n    maxVelocity: .00001,\n    stabilization: a!map(\n      iterations: 1000000,\n      onlyDynamicEdges: true\n    )\n  )\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145917": {
      "name": "CMGT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1720774": {
      "name": "CMGT_NCF_setAverageHorizontalOrderOfDependents",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!dependentEdges: a!refreshVariable(\n    value:rule!CMGT_UTIL_Filter(\n      records: ri!allEdges,\n      field: \"from\",\n      value: ri!currentNode.id\n    ),\n    refreshAlways: true\n  ),\n  local!dependentNodes: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!orderedNodes,\n      field: \"id\",\n      value: local!dependentEdges.to\n    ),\n    refreshAlways: true\n  ),\n  /*setting this as a percent 1-100*/\n  /*if there are no children the score is 50*/\n  local!averageChildHorizontalOrder: a!refreshVariable(\n    value: if(\n      a!isNullOrEmpty(local!dependentNodes),\n      50.0,\n      average(local!dependentNodes.horizontalOrder)\n    ),\n    refreshAlways: true\n  ),\n  #\"urn:appian:function:v1:a:update\"(\n    data: ri!currentNode,\n    index: \"horizontalOrder\",\n    value: local!averageChildHorizontalOrder\n  )\n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1719972": {
      "name": "CMGT_NCF_updateNodeOrderBasedOnPrecedents",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!precedentEdges: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!allEdges,\n      fieldValuePairs: {\n        a!map(field: \"to\", value: ri!currentNode.id)\n      }\n    ),\n    refreshAlways: true\n  ),\n  local!requiredPrecedentEdges: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: local!precedentEdges,\n      fieldValuePairs: { a!map(field: \"dashes\", value: false) }\n    ),\n    refreshAlways: true\n  ),\n  local!precedentEdgesFromSortedNodes: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!edgesToUnorderedNodes,\n      field: \"to\",\n      value: ri!currentNode.id\n    ),\n    refreshAlways: true\n  ),\n  if(\n    /*since the currentNode is sourced from dependentUnorderedNodes, it will always have at least one precedent*/\n    /*if there are no required precedents and the non-required precedents are not sorted, return nothing*/\n    and(\n      a!isNullOrEmpty(local!requiredPrecedentEdges),\n      a!isNullOrEmpty(local!precedentEdgesFromSortedNodes)\n    ),\n    {},\n    or(\n      /*if there are no required precedents and any of the non-required precedents are sorted, give it an order */\n      and(\n        a!isNullOrEmpty(local!requiredPrecedentEdges),\n        a!isNotNullOrEmpty(local!precedentEdgesFromSortedNodes)\n      ),\n      /*if all required precedents are already sorted, give it an order*/\n      a!isNullOrEmpty(\n        difference(\n          local!requiredPrecedentEdges,\n          local!precedentEdgesFromSortedNodes\n        )\n      )\n    ),\n    #\"urn:appian:function:v1:a:update\"(\n      data: ri!currentNode,\n      index: \"verticalOrder\",\n      value: tointeger(\n        max(ri!orderedNodes.verticalOrder) + 1\n      )\n    ),\n    /*if the node has required precedents which are not already sorted, return nothing*/\n    {}\n  )\n)"
    },
    "_a-0000eb57-0ad2-8000-9c6b-011c48011c48_1721000": {
      "name": "CMGT_NCF_setAverageHorizontalOrderOfPrecedents",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!precedentEdges: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!allEdges,\n      field: \"to\",\n      value: ri!currentNode.id\n    ),\n    refreshAlways: true\n  ),\n  local!precedentNodes: a!refreshVariable(\n    value: rule!CMGT_UTIL_Filter(\n      records: ri!orderedNodes,\n      field: \"id\",\n      value: local!precedentEdges.from\n    ),\n    refreshAlways: true\n  ),\n  /*setting this as a percent 1-100*/\n  /*if there are no parents the score is 50*/\n  local!averageParentHorizontalOrder: a!refreshVariable(\n    value: if(\n      a!isNullOrEmpty(local!precedentNodes),\n      50.0,\n      average(local!precedentNodes.horizontalOrder)\n    ),\n    refreshAlways: true\n  ),\n  #\"urn:appian:function:v1:a:update\"(\n    data: ri!currentNode,\n    index: \"horizontalOrder\",\n    value: local!averageParentHorizontalOrder\n  )\n)"
    },
    "_a-0000e9f4-1323-8000-9bd3-011c48011c48_267840": {
      "name": "CMGT_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!branding: getbrandingconfig(\n    cons!CMGT_DOC_DEFAULT_BRANDING_CONFIG,\n    true\n  ),\n  local!output: reduce(\n    #\"urn:appian:function:v1:a:update\"(_, _, _),\n    a!map(),\n    merge(\n      {\n        local!branding.defaultBranding.key,\n        local!branding.customBranding.key\n      },\n      {\n        local!branding.defaultBranding.value,\n        local!branding.customBranding.value\n      }\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180560": {
      "name": "CMGT_UTIL_returnTypeNumber",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer',\n  if(\n    isnull(ri!type),\n    typeof(ri!typeOf),\n    typeof(cast(ri!type, null))\n  )\n)"
    },
    "_a-0000eafa-b342-8000-9c45-011c48011c48_1299921": {
      "name": "CMGT_UTIL_IsMobileScreenSize",
      "type": "Expression Rule",
      "sail_code": "=#\"SYSTEM_SYSRULES_isPageWidth\"({\"PHONE\", \"TABLET_PORTRAIT\"})"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_19509": {
      "name": "CMGT_QR_GetCase",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Case,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpression,\n  fields: {\n    ri!fields,\n    if(\n      ri!excludeRelatedRecords,\n      {},\n      {\n        recordType!CMGT_Case.status,\n        recordType!CMGT_Case.priority,\n        recordType!CMGT_Case.caseType\n      }\n    ),\n    if(\n      ri!includeAssignees,\n      {\n        recordType!CMGT_Case.roles,\n        recordType!CMGT_Case.roles\n      },\n      {}\n    ),\n    if(\n      ri!includePrimaryContact,\n      {\n        recordType!CMGT_Case.caseEntityMap,\n        #\"urn:appian:record-relationship:v1:d81cdd0e-c54d-4b8e-beec-b7ae37fefe7f/9455b8a8-142d-4976-8b8d-83403eedad6a/043457e2-ee0b-4c7a-8210-8671bbe73128/2a2b64c2-0530-4e0a-a173-d26a396e3cc9\"\n      },\n      {}\n    )\n  },\n  relatedRecordData: {\n    ri!relatedRecordData,\n    if(\n      ri!includePrimaryContact,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.caseEntityMap,\n        limit: 1,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_CaseEntityMap.entity.entityTypeId,\n          operator: \"=\",\n          value: cons!CMGT_REFID_ENTITY_TYPE_CONTACT\n        )\n      ),\n      {}\n    ),\n    if(\n      ri!includeAssignees,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.roles,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_Role.roleTypeId,\n          operator: \"in\",\n          value: {\n            cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n            cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE\n          }\n        )\n      ),\n      {}\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180481": {
      "name": "CMGT_UTIL_RejectBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(a!flatten(ri!array)),\n  reject(a!isNullOrEmpty(_), a!flatten(ri!array))\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_175235": {
      "name": "CMGT_NetworkChartField_FixNodeEdgeOrder_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*\n  Since the chart will graph dependent on the actual order of nodes\n  this logic will just reorder the nodes based on what don't have edges, what those point to, etc.\n  */\n  /*since nodes are passed in in a parent-child pattern, this pulls all of the nodes out and flattens*/\n  local!allNodes: rule!CMGT_UTIL_cast(\n    typeOf: { a!map() },\n    value: rule!CMGT_UTIL_RejectBlank(\n      a!flatten(\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!nodes,\n          expression: {\n            remove(fv!item, \"children\"),\n            fv!item.children\n          }\n        )\n      )\n    )\n  ),\n  /*sorting nodes vertically so nodes which are closest to the start node are first in line*/\n  local!nodesOrderedVertically: reduce(\n    rule!CMGT_NCF_orderNodesBasedOnDistanceFromStart(\n      orderedNodes: _,\n      index: _,\n      allNodes: local!allNodes,\n      allEdges: ri!edges\n    ),\n    /*start with \"start\" node*/\n    #\"urn:appian:function:v1:a:update\"(\n      data: rule!CMGT_UTIL_Filter(\n        records: local!allNodes,\n        field: \"id\",\n        value: ri!nodes[1].id\n      ),\n      index: \"verticalOrder\",\n      value: 1\n    ),\n    enumerate(length(local!allNodes))\n  ),\n  /*stray nodes are nodes with no precedents or nodes that are unreachable*/\n  local!strayNodes: rule!CMGT_UTIL_Filter(\n    records: local!allNodes,\n    field: \"id\",\n    value: local!nodesOrderedVertically.id,\n    filterType: \"REJECT\"\n  ),\n  local!nodesSortedVertically: rule!CMGT_UTIL_sortList(\n    records: {\n      local!nodesOrderedVertically,\n      #\"urn:appian:function:v1:a:update\"(\n        local!strayNodes,\n        \"verticalOrder\",\n        repeat(length(local!strayNodes), 2)\n      )\n    },\n    field: \"verticalOrder\",\n    ascending: true\n  ),\n  /*using the \"verticalOrder\" property given to each node, goes through each \"level\" and sorts nodes*/\n  /*horizontally based on the horizontalOrder of their dependents to help prevent edge intersections*/\n  /*sorting from bottom first helps alleviate crossing lines that form from arbitrary sort from top*/\n  local!nodesSortedHorizontallyFromBottom: rule!CMGT_UTIL_sortList(\n    records: rule!CMGT_UTIL_sortList(\n      records: reduce(\n        rule!CMGT_NCF_orderNodesHorizontallyBottomUp(\n          orderedNodes: _,\n          level: _,\n          allNodes: local!nodesSortedVertically,\n          allEdges: ri!edges\n        ),\n        {},\n        rule!CMGT_UTIL_Distinct(\n          local!nodesSortedVertically.verticalOrder\n        )\n      ),\n      field: \"horizontalOrder\",\n      ascending: true\n    ),\n    field: \"verticalOrder\",\n    ascending: true\n  ),\n  /*using the \"verticalOrder\" property given to each node, goes through each \"level\" and sorts nodes*/\n  /*horizontally based on the horizontalOrder of their precedents to help prevent edge intersections*/\n  /*doing this sort last provides the best visual results*/\n  local!nodesSortedHorizontallyFromTop: rule!CMGT_UTIL_sortList(\n    records: rule!CMGT_UTIL_sortList(\n      records: reduce(\n        rule!CMGT_NCF_orderNodesHorizontallyTopDown(\n          orderedNodes: _,\n          level: _,\n          allNodes: local!nodesSortedHorizontallyFromBottom,\n          allEdges: ri!edges\n        ),\n        {},\n        rule!CMGT_UTIL_Distinct(\n          local!nodesSortedHorizontallyFromBottom.verticalOrder\n        )\n      ),\n      field: \"horizontalOrder\",\n      ascending: true\n    ),\n    field: \"verticalOrder\",\n    ascending: true\n  ),\n  local!fixNodesOrder: local!nodesSortedHorizontallyFromTop,\n  local!maxVerticalSort: todecimal(\n    rule!CMGT_UTIL_returnLastIndexOfArray(array: local!fixNodesOrder).verticalOrder\n  ),\n  /*\n  Since the chart will inaccurately graph if edges point back to previous nodes,\n  this logic will update the ordering of edges so that they always point to \"next\" nodes\n\n  If the edge \"from\" points to a \"to\" that is before it, it just swaps the \"from\" and \"to\" of both the object and the arrow\n  */\n  local!fixEdgesOrder: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!edges,\n    expression: a!localVariables(\n      /*to help \"fix\" direction of loopback edges*/\n      local!fromNodeIndex: cast(\n        1,\n        wherecontains(\n          tostring(fv!item.from),\n          touniformstring(local!fixNodesOrder.id)\n        )\n      ),\n      local!toNodeIndex: cast(\n        1,\n        wherecontains(\n          tostring(fv!item.to),\n          touniformstring(local!fixNodesOrder.id)\n        )\n      ),\n      local!switchToAndFromIds: and(\n        a!isNotNullOrEmpty(local!fromNodeIndex),\n        a!isNotNullOrEmpty(local!toNodeIndex),\n        local!toNodeIndex < local!fromNodeIndex\n      ),\n      /*to allow for curved edges between distant nodes*/\n      local!fromNode: local!fixNodesOrder[local!fromNodeIndex],\n      local!toNode: local!fixNodesOrder[local!toNodeIndex],\n      local!horizontalOrderSign: sign(\n        local!fromNode.horizontalOrder - local!toNode.horizontalOrder\n      ),\n      /*to allow for multiple curved edges between two nodes when there are multiple branches*/\n      local!matchingEdgeIndices: rule!CMGT_UTIL_Filter(\n        records: ri!edges,\n        fieldValuePairs: {\n          a!map(field: \"from\", value: fv!item.from),\n          a!map(field: \"to\", value: fv!item.to)\n        },\n        filterType: \"MATCH_INDICES\"\n      ),\n      #\"urn:appian:function:v1:a:update\"(\n        fv!item,\n        { \"from\", \"to\", \"arrows\", \"smooth\", \"font\" },\n        {\n          /*from*/\n          if(\n            local!switchToAndFromIds,\n            fv!item.to,\n            fv!item.from\n          ),\n          /*to*/\n          if(\n            local!switchToAndFromIds,\n            fv!item.from,\n            fv!item.to\n          ),\n          /*arrows*/\n          cast(\n            252,\n            if(\n              and(\n                local!switchToAndFromIds,\n                a!isNotNullOrEmpty(fv!item.arrows)\n              ),\n              #\"urn:appian:function:v1:a:update\"(\n                fv!item.arrows,\n                { \"from\", \"to\" },\n                { fv!item.arrows.to, fv!item.arrows.from }\n              ),\n              fv!item.arrows\n            )\n          ),\n          /*smooth*/\n          a!match(\n            value: true,\n            /*allow for multiple curved edges between two nodes when there are multiple branches*/\n            whenTrue: length(local!matchingEdgeIndices) > 1,\n            then: a!map(\n              enabled: true,\n              type: \"curvedCW\",\n              roundness: a!localVariables(\n                local!normalizedMatchingEdgeIndices: enumerate(count(local!matchingEdgeIndices)),\n                local!normalizedCurrentIndex: cast(\n                  1,\n                  wherecontains(fv!index, local!matchingEdgeIndices)\n                ) - 1,\n                local!unadjustedCurve: (\n                  local!normalizedCurrentIndex - median(local!normalizedMatchingEdgeIndices)\n                ) / count(local!matchingEdgeIndices),\n                /*for some reason, negative curve values need to start at -2*/\n                local!adjustedCurve: if(\n                  local!unadjustedCurve < 0,\n                  local!unadjustedCurve - 2,\n                  local!unadjustedCurve\n                ),\n                local!adjustedCurve\n              )\n            ),\n            /*allow for curved edges between distant nodes*/\n            whenTrue: (\n              local!toNode.verticalOrder - local!fromNode.verticalOrder\n            ) <> 1,\n            then: a!map(\n              enabled: true,\n              type: \"curvedCW\",\n              roundness: (\n                local!toNode.verticalOrder - local!fromNode.verticalOrder\n              ) / (local!maxVerticalSort - 1) * 0.5 * a!match(\n                value: 0,\n                whenTrue: local!horizontalOrderSign <> 0,\n                then: local!horizontalOrderSign,\n                whenTrue: sign(local!fromNode.horizontalOrder - 50.0) <> 0,\n                then: sign(local!fromNode.horizontalOrder - 50.0),\n                default: 1\n              )\n            ),\n            default: a!map(enabled: false)\n          ),\n          /*font*/\n          cast(\n            252,\n            /*if there are multiple branches between two nodes update label alignment to handle crowdedness*/\n            if(\n              length(local!matchingEdgeIndices) > 1,\n              #\"urn:appian:function:v1:a:update\"(fv!item.font, \"align\", \"middle\"),\n              fv!item.font\n            )\n          )\n        }\n      )\n    )\n  ),\n  a!map(\n    nodes: rule!CMGT_UTIL_DistinctRecords(\n      records: rule!CMGT_UTIL_RejectBlank(local!fixNodesOrder),\n      fields: \"id\"\n    ),\n    edges: rule!CMGT_UTIL_DistinctRecords(\n      records: rule!CMGT_UTIL_RejectBlank(local!fixEdgesOrder),\n      fields: { \"from\", \"to\", \"arrows\", \"title\" }\n    )\n  )\n)"
    },
    "_a-0000eb2c-b6af-8000-9c5d-011c48011c48_1476001": {
      "name": "CMGT_UTIL_DisplayBranding",
      "type": "Expression Rule",
      "sail_code": "/*\nNote that because a forEach that loops over a single item is significantly less performant than just calling the thing,\nwe only want to use forEach here if multiple keys are passed, since this rule is used on every text on every interface\n(many calls per page load).\n\nRather than create a separate rule that just adds to rule sprawl, we just commented the common blocks of identical code.\nUpdates to either one should be reflected in the other.\n*/\na!localVariables(\n  /*Using this to avoid re-evaluation on page interaction*/\n  local!output: cast(\n    /*Always ensure the key is returned as the same list-type of the input, especially for null/empty keys*/\n    runtimetypeof(ri!key),\n    if(\n      a!isNullOrEmpty(ri!key),\n      {},\n      if(\n        count(a!flatten(ri!key)) = 1,\n        a!localVariables(\n          local!key: a!flatten(ri!key)[1],\n          /*START OF COMMON CODE*/\n          local!rawLabel:a!defaultValue(ri!brandingMap[local!key], local!key),\n          /*END OF COMMON CODE*/\n          local!rawLabel\n        ),\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!key,\n          expression: a!localVariables(\n            local!key: fv!item,\n            /*START OF COMMON CODE*/\n            local!rawLabel: a!defaultValue(ri!brandingMap[local!key], local!key),\n            \n            /*END OF COMMON CODE*/\n            local!rawLabel\n          )\n        )\n      )\n    )\n  ),\n  local!output\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000eb32-20f6-8000-9c60-011c48011c48_1532719": {
      "name": "CMGT_UTIL_sortList",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!records),\n  if(\n    a!isNullOrEmpty(ri!field),\n    ri!records,\n    with(\n      local!dataSortedByField: todatasubset(\n        ri!records,\n        #\"SYSTEM_SYSRULES_pagingInfo\"(\n          startIndex: 1,\n          batchSize: - 1,\n          sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n            field: ri!field,\n            ascending: a!defaultValue(ri!ascending, true)\n          )\n        )\n      ).data,\n      if(\n        a!isNullOrEmpty(ri!nullsFirst),\n        local!dataSortedByField,\n        with(\n          local!nullsAggregated: rule!CMGT_UTIL_Filter(\n            records: local!dataSortedByField,\n            field: ri!field,\n            value: null,\n            filterType: \"FULL_RESULT\"\n          ),\n          if(\n            ri!nullsFirst,\n            append(\n              local!nullsAggregated.matches,\n              local!nullsAggregated.rejects\n            ),\n            append(\n              local!nullsAggregated.rejects,\n              local!nullsAggregated.matches\n            )\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180598": {
      "name": "CMGT_UTIL_returnSingleTypeObject",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!typeOf: if(\n    isnull(ri!type),\n    ri!typeOf,\n    cast(\n      ri!type,\n      {}\n    )\n  ),\n\n  index(\n    cast(\n      typeof({local!typeOf}), \n      updatearray({local!typeOf}, 1, {})\n    ), \n    1,\n    {}\n  )\n)"
    },
    "8af695e2-f3e1-4fe7-9755-ff66a47ce843": {
      "name": "CMGT_UTIL_MergeMaps",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!value1_keyed: if(\n    isnull(ri!key),\n    ri!map1,\n    index(ri!map1, ri!key, null)\n  ),\n  local!value2_keyed: if(\n    isnull(ri!key),\n    ri!map2,\n    index(ri!map2, ri!key, null)\n  ),\n  local!newValue: if(\n    and(\n      runtimetypeof(local!value1_keyed) = 'type!{http://www.appian.com/ae/types/2009}Map',\n      runtimetypeof(local!value2_keyed) = 'type!{http://www.appian.com/ae/types/2009}Map'\n    ),\n    reduce(\n      rule!CMGT_UTIL_MergeMaps(\n        previous: _,\n        key: _,\n        map1: local!value1_keyed,\n        map2: local!value2_keyed\n      ),\n      a!map(),\n      union(\n        a!keys(local!value1_keyed),\n        a!keys(local!value2_keyed)\n      )\n    ),\n    a!defaultValue(local!value2_keyed, local!value1_keyed)\n  ),\n  if(\n    isnull(ri!key),\n    local!newValue,\n    #\"urn:appian:function:v1:a:update\"(ri!previous, ri!key, local!newValue)\n  )\n)"
    },
    "_a-0000ebaa-19ba-8000-9ca6-011c48011c48_2093172": {
      "name": "CMGT_UTIL_returnLastIndexOfArray",
      "type": "Expression Rule",
      "sail_code": "index(\n  ri!array,\n  count(ri!array),\n  rule!CMGT_UTIL_returnSingleTypeObject(typeOf: ri!array)\n)"
    }
  }
}
{
  "uuid": "_a-0000e36c-7599-8000-9ba2-011c48011c48_64585-tmg-am-am",
  "name": "AS_GSS_TMG_UT_disableTaskActions",
  "type": "Expression Rule",
  "description": "Returns true (implying disabled) if task is not assigned to the logged in user or a group the logged in user belongs to",
  "sail_code": "or(\n  /*Check if all tasks are blank*/\n  rule!AS_CO_UT_isBlank(ri!tasks),\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!tasks,\n    expression: if(\n      /*First check that the task status is assigned*/\n      rule!AS_CO_UT_not(\n        contains(\n          {\n            cons!AS_GSS_TMG_REF_ID_TASK_STATUS_ASSIGNED,\n            cons!AS_GSS_TMG_REF_ID_TASK_STATUS_IN_PROGRESS\n          },\n          fv!item.taskStatus.taskStatusId\n        )\n      ),\n      true,\n      if(\n        /*Then check if there is a default assignee on the task*/\n        rule!AS_CO_UT_isNotBlank(fv!item.groupAssignee),\n        /*Return false (not disabled) if EITHER the user is in the default assignee group OR the user is the individual assignee*/\n        /*Returns true (disabled) when the task behaviour type is \"Complete Evaluation\" and the loggedInUser is not a userAssignee*/\n        and(\n          or(\n            tostring(\n              fv!item.taskBehaviorType.behaviorSubtypeCode\n            ) = cons!AS_GSS_TMG_ENUM_TASK_BEHAVIOR_SUBTYPE_CODE_COMPLETE_EVALUATION,\n            rule!AS_CO_UT_not(\n              rule!AS_CO_UT_isUserMemberOfGroups(\n                groups: fv!item.groupAssignee,\n                user: loggedInUser()\n              )\n              \n            )\n          ),\n          rule!AS_CO_UT_not(fv!item.userAssignee = loggedInUser())\n        ),\n        /*Return false (not disabled) if the user is the individual assignee*/\n        rule!AS_CO_UT_not(fv!item.userAssignee = loggedInUser())\n      )\n    )\n  )\n)",
  "calls": [
    {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_not",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_isNotBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_isUserMemberOfGroups",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_REF_ID_TASK_STATUS_ASSIGNED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_REF_ID_TASK_STATUS_IN_PROGRESS",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_ENUM_TASK_BEHAVIOR_SUBTYPE_CODE_COMPLETE_EVALUATION",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_GSS_TMG_REF_ID_TASK_STATUS_QUEUED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    }
  ],
  "called_by": [
    {
      "name": "AS_GSS_TMG_UI_taskGrid_colTaskName",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    }
  ]
}
{
  "_metadata": {
    "bundle_id": "AS_GSS_WA_POST_Vendor_Proposal_Action"
  },
  "objects": {
    "_a-0000e583-8ce5-8000-9bb7-011c48011c48_734490": {
      "name": "AS_CO_UT_castToMapList",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Map?list',\n  if(\n    rule!AS_CO_UT_isBlank(ri!value),\n    {},\n    ri!value\n  )\n)"
    },
    "_a-0001ed6e-54f1-8000-9df6-011c48011c48_15278699": {
      "name": "AS_GSS_WA_defaultResponseForUnsupportedApiVersion",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_httpResponse_v1\"(\n  statusCode: cons!AS_GSS_HTTP_STATUS_CODE_INVALID_VERSION,\n  headers: rule!AS_GSS_UT_getHttpHeaderForJsonContent(),\n  body: #\"SYSTEM_SYSRULES_toJson_v1\"(\n    {\n      error: \"INVALID_VERSION\",\n      message: \"The requested version is not supported. Please refer to the documentation.\"\n    }\n  )\n)"
    },
    "_a-0001ed6e-54f1-8000-9df6-011c48011c48_15278480": {
      "name": "AS_GSS_UT_extractApiVersionFromHeaders",
      "type": "Expression Rule",
      "sail_code": "cast(\n  1,\n  rule!AS_CO_UT_indexPath(\n    cdt: rule!AS_CO_UT_castToMap(value: ri!request.headers),\n    field: \"Version\"\n  )\n)"
    },
    "_a-0001ed6e-54f1-8000-9df6-011c48011c48_15278654": {
      "name": "AS_GSS_UT_getHttpHeaderForJsonContent",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_httpHeader\"(\n  name: \"Content-Type\",\n  value: \"application/json\"\n)"
    },
    "f12130d6-9046-4cd1-bdb3-ec4ae84bcd64": {
      "name": "AS GSS WA POST Vendor Proposal Action",
      "type": "Web API",
      "sail_code": "a!localVariables(\n  local!version: rule!AS_GSS_UT_extractApiVersionFromHeaders(request: http!request),\n  /* Retrieve evaluation details and summary link */\n  /* Construct an HTTP response that contains the information */\n  a!match(\n    value: local!version,\n    equals: 1,\n    then: rule!AS_GSS_BL_receiveVendorUpdates_v1(request: http!request),\n    default: rule!AS_GSS_WA_defaultResponseForUnsupportedApiVersion()\n  )\n)"
    },
    "_a-0000e3e6-fb42-8000-9ba5-011c48011c48_162769": {
      "name": "AS_CO_UT_typeCompare",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Boolean',\n  typeof(ri!value1) = typeof(ri!value2)\n)"
    },
    "_a-0000eb69-8eb8-8000-9d24-011c48011c48_10389864": {
      "name": "AS_GSS_UT_isBlank",
      "type": "Expression Rule",
      "sail_code": "/*\nThis rule null checks below scenarios, \n\n-- null value\n-- an empty list\n-- an empty string\n-- list of null values\n-- all fields of the CDT are null\n      While passing a CDT, make sure ri!checkIfAllCdtFieldsAreNull is TRUE to handle\n    this scenario\n-- string with only spaces\n*/\na!localVariables(\n  local!checkIfAllCdtFieldsAreNull: a!defaultValue(\n    value: ri!checkIfAllCdtFieldsAreNull, \n    default: false\n  ),\n  local!keys: if(\n    local!checkIfAllCdtFieldsAreNull,\n    a!keys(value: index(ri!value, 1, null)),\n    null\n  ),\n  local!indicesOfCdtsWhereAllFieldsAreNull: if(\n    local!checkIfAllCdtFieldsAreNull,\n    rule!AS_CO_UT_rejectNullValuesFromArray(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        rule!AS_CO_UT_castToMapList(ri!value),\n        a!localVariables(\n          local!currentItem: fv!item,\n          local!currentIndex: fv!index,\n          if(\n            length(\n              a!flatten(\n                #\"SYSTEM_SYSRULES_forEach\"(\n                  local!keys,\n                  rule!AS_CO_UT_whereContains(\n                    values: null,\n                    array: rule!AS_CO_UT_indexPath(\n                      cdt: a!flatten(local!currentItem),\n                      field: fv!item\n                    )\n                  )\n                )\n              )\n            ) = length(local!keys),\n            local!currentIndex,\n            null\n          )\n        )\n      )\n    ),\n    null\n  ),\n  local!filteredCdt: if(\n    local!checkIfAllCdtFieldsAreNull,\n    remove(\n      a!flatten(ri!value),\n      local!indicesOfCdtsWhereAllFieldsAreNull\n    ),\n    null\n  ),\n  cast(\n    'type!{http://www.appian.com/ae/types/2009}Boolean',\n    or(\n      length(a!flatten(ri!value)) = 0,\n      a!isNullOrEmpty(\n        if(\n          local!checkIfAllCdtFieldsAreNull,\n          local!filteredCdt,\n          trim(ri!value)\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ed77-8e71-8000-9df8-011c48011c48_15294040": {
      "name": "AS_GSS_BL_receiveVendorUpdates_v1",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!requestBody: if(\n    rule!AS_GSS_UT_isNotBlank(value: ri!request.body),\n    #\"SYSTEM_SYSRULES_fromJson_v1\"(ri!request.body),\n    {}\n  ),\n  a!match(\n    value: a!map(\n      vendorId: index(local!requestBody, \"vendorId\", null),\n      legalName: index(local!requestBody, \"legalName\", null),\n      noticeId: index(local!requestBody, \"noticeId\", null),\n      proposalId: index(local!requestBody, \"proposalId\", null),\n      proposalVersion: index(\n        local!requestBody,\n        \"proposalVersion\",\n        null\n      ),\n      proposalAction: index(\n        local!requestBody,\n        \"proposalAction\",\n        null\n      ),\n      proposalActionTimestamp: index(\n        local!requestBody,\n        \"proposalActionTimestamp\",\n        null\n      ),\n      \n    ),\n    whenTrue: or(\n      rule!AS_GSS_UT_isBlank(value: index(fv!value, \"vendorId\", null)),\n      rule!AS_GSS_UT_isBlank(value: index(fv!value, \"legalName\", null)),\n      rule!AS_GSS_UT_isBlank(value: index(fv!value, \"noticeId\", null)),\n      rule!AS_GSS_UT_isBlank(\n        value: index(fv!value, \"proposalAction\", null)\n      ),\n      rule!AS_GSS_UT_isBlank(\n        value: index(\n          fv!value,\n          \"proposalActionTimestamp\",\n          null\n        )\n      ),\n      not(\n        contains(\n          {\n            cons!AS_GSS_ENUM_PROPOSAL_ACTION_SUBMIT,\n            cons!AS_GSS_ENUM_PROPOSAL_ACTION_RESUBMIT,\n            cons!AS_GSS_ENUM_PROPOSAL_ACTION_WITHDRAW\n          },\n          index(fv!value, \"proposalAction\", null)\n        )\n      )\n    ),\n    then: #\"SYSTEM_SYSRULES_httpResponse_v1\"(\n      statusCode: cons!AS_GSS_HTTP_STATUS_CODE_BAD_REQUEST,\n      headers: {\n        rule!AS_GSS_UT_getHttpHeaderForJsonContent()\n      },\n      body: #\"SYSTEM_SYSRULES_toJson_v1\"(\n        {\n          error: \"INVALID_REQUEST\",\n          message: \"The request cannot be processed as some of the mandatory inputs are incorrect or missing\"\n        }\n      )\n    ),\n    default: #\"SYSTEM_SYSRULES_startProcess3\"(\n      processModel: cons!AS_GSS_PM_RECEIVE_VENDOR_PROPOSAL_ACTION,\n      /* A dictionary or map of parameters passed to the process model */\n      processParameters: { requestBody: local!requestBody },\n      isSynchronous: true(),\n      /* This expression will run when the process is started (when run asynchronously) or completed (when run synchronously) */\n      onSuccess: #\"SYSTEM_SYSRULES_httpResponse_v1\"(\n        statusCode: cons!AS_GSS_HTTP_STATUS_CODE_SUCCESS,\n        headers: {\n          rule!AS_GSS_UT_getHttpHeaderForJsonContent()\n        },\n        body: if(\n          a!isNotNullOrEmpty(fv!processInfo),\n          #\"SYSTEM_SYSRULES_toJson_v1\"(\n            /*Need to check if we return primary key after saving the request received in DB*/\n            a!map(\n              initiatedProcessInstanceId: fv!processInfo.pp.id,\n              message: \"Request processed successfully\"\n            )\n          ),\n          null()\n        )\n      ),\n      /* This expression will run if the process fails to start */\n      onError: #\"SYSTEM_SYSRULES_httpResponse_v1\"(\n        statusCode: cons!AS_GSS_HTTP_STATUS_CODE_INTERNAL_SERVER_ERROR,\n        headers: {\n          rule!AS_GSS_UT_getHttpHeaderForJsonContent()\n        },\n        body: #\"SYSTEM_SYSRULES_toJson_v1\"(\n          {\n            error: \"INTERNAL_SERVER_ERROR\",\n            message: \"There was an error starting the process\"\n          }\n        )\n      ),\n      /* If the process is started synchronously, this expression will run if the process does not complete in 30 seconds */\n      onIncomplete: #\"SYSTEM_SYSRULES_httpResponse_v1\"(\n        statusCode: cons!AS_GSS_HTTP_STATUS_CODE_TIMEOUT,\n        headers: {\n          rule!AS_GSS_UT_getHttpHeaderForJsonContent()\n        },\n        body: {\n          error: \"REQUEST_TIMED_OUT\",\n          message: \"There was an error completing the process\"\n        }\n      )\n    )\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76433": {
      "name": "AS_CO_UT_indexPath",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldsAndIndices: rule!AS_CO_UT_zINTERNAL_indexPath_nestedFieldArrayHandler(field: ri!field),\n\n  reduce(\n    index(_, _, ri!indexDefault),\n    ri!cdt,\n    local!fieldsAndIndices\n  )\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_73536": {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  length(a!flatten(ri!value)) = 0\n)"
    },
    "_a-0000e2ad-62e7-8000-9ba2-011c48011c48_76367": {
      "name": "AS_CO_UT_rejectNullValuesFromArray",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!array),\n  reject(\n    rule!AS_CO_UT_isBlank(_),\n    a!flatten(ri!array)\n  )\n)"
    },
    "_a-0000eb72-c933-8000-9d28-011c48011c48_10423869": {
      "name": "AS_GSS_UT_isNotBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  not(\n    rule!AS_GSS_UT_isBlank(\n      value: ri!value,\n      checkIfAllCdtFieldsAreNull: ri!checkIfAllCdtFieldsAreNull\n    )\n  )\n)"
    },
    "_a-0000e583-8ce5-8000-9bb7-011c48011c48_734482": {
      "name": "AS_CO_UT_castToMap",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Map',\n  if(\n    rule!AS_CO_UT_isBlank(ri!value),\n    null,\n    ri!value\n  )\n)"
    },
    "_a-0000e40a-de32-8000-9ba8-011c48011c48_272151": {
      "name": "AS_CO_UT_whereContains",
      "type": "Expression Rule",
      "sail_code": "cast(\n   'type!{http://www.appian.com/ae/types/2009}Integer?list',\n  with(\n    local!array: a!flatten(ri!array),\n  \n    if(\n    \n      /*Have to handle separately for document types due to how it casts to string*/\n      rule!AS_CO_UT_typeCompare(\n        value1: local!array,\n        value2: {todocument(null)}\n      ),\n      wherecontains(\n        todocument(ri!values),\n        local!array\n      ),\n    \n      /*Have to handle separately for group types due to how it casts to string*/\n      rule!AS_CO_UT_typeCompare(\n        value1: local!array,\n        value2: {togroup(null)}\n      ),\n      wherecontains(\n        togroup(ri!values),\n        local!array\n      ),\n    \n      /*Casting to string accounts for any primitive type (integer, boolean, ect.)*/\n      wherecontains(\n        if(\n          rule!AS_CO_UT_isBlank(ri!values),\n          touniformstring(ri!values),\n          touniformstring(a!flatten(ri!values))\n        ),\n        touniformstring(local!array)\n      )\n    )\n  )\n)"
    }
  }
}
{
  "_metadata": {
    "bundle_id": "AIA_Classification_Model_-_urnappiantranslation-stringv132d1dbb0-6850-4d83-9be0-"
  },
  "objects": {
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_34388": {
      "name": "AIA_UTIL_displayDateTime",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!dateTime),\n  \"\",\n  cast(\n    'type!{http://www.appian.com/ae/types/2009}Text',\n    if(\n      ri!isDisplayTime,\n      text(ri!dateTime, \"mmm d, yyyy h:mm a\"),\n      text(ri!dateTime, \"mmm d, yyyy\")\n    )\n  )\n)"
    },
    "_a-0000ec44-cb49-8000-9be6-011c48011c48_94099": {
      "name": "AIA_RecordAction_ModelRunInstance",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!selectedValue: 1,\n  local!brandingMap: rule!AIA_UTIL_LoadBrandingMap(),\n\n  #\"SYSTEM_SYSRULES_formLayout_v1\"(\n    label: if(\n      ri!isExtract,\n      #\"urn:appian:translation-string:v1:462f4edf-6112-4749-b16a-b65aa5d37b33\",\n      #\"urn:appian:translation-string:v1:223c21ab-c709-45fe-84d8-09be18dd4cd7\"\n    ),\n    contents: {\n      #\"SYSTEM_SYSRULES_cardChoiceField\"(\n        label: #\"urn:appian:translation-string:v1:68fbf292-0312-430f-a09a-576bf0278417\",\n        data: {\n          a!map(\n            id: 1,\n            icon: \"files-o\",\n            primaryText: #\"urn:appian:translation-string:v1:237b1bae-1428-4544-8ecf-6fa89331222c\"\n          ),\n          a!map(\n            id: 2,\n            icon: \"file-upload\",\n            primaryText: #\"urn:appian:translation-string:v1:30e7aea8-0fc7-4996-ba6d-7adce844780e\"\n          ),\n          a!map(\n            id: 3,\n            icon: \"pencil-square-o\",\n            primaryText: #\"urn:appian:translation-string:v1:a0b565e1-0a3e-4fcd-9db6-0f02c509edc0\"\n          )\n        },\n        cardTemplate: #\"SYSTEM_SYSRULES_cardTemplateBarTextStacked\"(\n          id: fv!data.id,\n          primaryText: fv!data.primaryText,\n          icon: fv!data.icon,\n          iconColor: local!brandingMap.Gray4\n        ),\n        value: local!selectedValue,\n        saveInto: {\n          a!save(\n            local!selectedValue,\n            cast(\n              'type!{http://www.appian.com/ae/types/2009}Integer',\n              save!value\n            )\n          ),\n          a!save(ri!documents, null)\n        },\n        maxSelections: 1,\n        align: \"START\",\n        showShadow: false,\n        required: true(),\n        validations: {}\n      ),\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        columns: {\n          a!match(\n            value: local!selectedValue,\n            equals: 1,\n            then: {\n              #\"SYSTEM_SYSRULES_columnLayout\"(\n                contents: {\n                  #\"SYSTEM_SYSRULES_pickerFieldDocuments\"(\n                    label: #\"urn:appian:translation-string:v1:c66d26a9-dba4-425c-a05f-0d1ce9a13b22\",\n                    placeholder: #\"urn:appian:translation-string:v1:c66d26a9-dba4-425c-a05f-0d1ce9a13b22\",\n                    maxSelections: 10,\n                    folderFilter: cons!AIA_FOLDER_INPUT_DOCS,\n                    value: ri!documents,\n                    saveInto: ri!documents,\n                    required: true,\n                    validations: #\"SYSTEM_SYSRULES_forEach\"(\n                      ri!documents,\n                      rule!AIA_DocumentValidation(document: fv!item)\n                    )\n                  ),\n                  if(\n                    ri!isExtract = true(),\n                    rule!AIA_ExtractionInstance_Sub_RecentlyUploadedDocuments(\n                      showWhen: true(),\n                      brandingMap: local!brandingMap,\n                      modelVersionId: ri!modelVersionId,\n                      selectedDocuments: ri!documents\n                    ),\n                    rule!AIA_ClassificationInstance_Sub_RecentlyUploadedDocuments(\n                      showWhen: true(),\n                      brandingMap: local!brandingMap,\n                      modelVersionId: ri!modelVersionId,\n                      selectedDocuments: ri!documents\n                    )\n                  )\n                },\n                width: \"WIDE_PLUS\"\n              )\n            },\n            equals: 2,\n            then: {\n              #\"SYSTEM_SYSRULES_columnLayout\"(\n                contents: #\"SYSTEM_SYSRULES_fileUploadField_v1\"(\n                  label: #\"urn:appian:translation-string:v1:98615fbb-7de7-4c33-899c-f2c8f63d5e21\",\n                  placeholder: #\"urn:appian:translation-string:v1:98615fbb-7de7-4c33-899c-f2c8f63d5e21\",\n                  target: cons!AIA_FOLDER_INPUT_DOCS,\n                  maxSelections: 10,\n                  value: ri!documents,\n                  saveInto: ri!documents,\n                  required: true,\n                  validations: #\"SYSTEM_SYSRULES_forEach\"(\n                    fv!files,\n                    rule!AIA_DocumentValidation(extension: fv!item.extension)\n                  )\n                )\n              )\n            },\n            equals: 3,\n            then: {\n              #\"SYSTEM_SYSRULES_columnLayout\"(\n                width: \"WIDE_PLUS\",\n                contents: #\"SYSTEM_SYSRULES_paragraphField\"(\n                  label: #\"urn:appian:translation-string:v1:4178454f-5b2a-4327-ad04-ce72fdbd4179\",\n                  value: ri!input,\n                  saveInto: ri!input,\n                  height: \"TALL\",\n                  required: true()\n                )\n              )\n            },\n            default: {}\n          )\n        }\n      ),\n      rule!AIA_RecordAction_ModelRunInstance_Sub_TestCaseSettings(\n        brandingMap: local!brandingMap,\n        isDocumentTestCase: ri!isDocumentTestCase,\n        isExtraction: ri!isExtract,\n        modelId: ri!modelId,\n        modelTestSuiteIds: ri!modelTestSuiteIds\n      )\n\n    },\n    buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n      primaryButtons: #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n        label: if(\n          ri!isExtract,\n          #\"urn:appian:translation-string:v1:9bae1597-88bf-4ae9-a8d3-34be21fdaa11\",\n          #\"urn:appian:translation-string:v1:051ff814-18db-44bd-a332-1ca6054aec66\"\n        ),\n        submit: true,\n        style: \"SOLID\"\n      ),\n      secondaryButtons: #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n        label: #\"urn:appian:translation-string:v1:df61ccad-fe9a-4d7a-ba9a-d89b08f3467a\",\n        saveInto: a!save(ri!cancel, true),\n        submit: true,\n        validate: false\n      )\n    ),\n    skipAutoFocus: true()\n  )\n)"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_98523": {
      "name": "AIA_ExtractionModel_GetRecentlyUploadedDocument",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!instanceDetails: #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n    recordType: recordType!AIA Extraction Instance,\n    filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Extraction Instance.modelVersionId,\n      operator: \"=\",\n      value: ri!modelVersionId\n    ),\n    fields: a!flatten(\n      {\n        /*Only the fields needed on AIA_Extraction_InstanceCard */\n        recordType!AIA Extraction Instance.modelVersionId,\n        recordType!AIA Extraction Instance.documentId,\n        recordType!AIA Extraction Instance.modifiedBy,\n        recordType!AIA Extraction Instance.modifiedOn\n      }\n    ),\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 50,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Extraction Instance.id,\n        ascending: false()\n      )\n    )\n  ).data,\n  local!uniqueDocumentIds: union(\n    tointeger(\n      local!instanceDetails[recordType!AIA Extraction Instance.documentId]\n    ),\n    tointeger({})\n  ),\n  a!flatten(\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: enumerate(10),\n      expression: {\n        if(\n          a!isNullOrEmpty(\n            index(\n              local!uniqueDocumentIds,\n              fv!index,\n              null()\n            )\n          ),\n          {},\n          index(\n            local!instanceDetails,\n            wherecontains(\n              tointeger(\n                index(\n                  local!uniqueDocumentIds,\n                  fv!index,\n                  null()\n                )\n              ),\n              tointeger(\n                local!instanceDetails[recordType!AIA Extraction Instance.documentId]\n              )\n            ),\n            null()\n          )[1]\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000ecd4-7f5c-8000-9c42-011c48011c48_163609": {
      "name": "AIA_Classification_TestReconcilliation",
      "type": "Expression Rule",
      "sail_code": "if(\n  /*Depending on whether the model version being run allows multiple outputs, auto-reconciliation will look a little bit different.*/\n  /*This is to account for the fact that a baseline test case may have used a model version that allowed multiple outputs, but the inputted version doesn't*/\n  ri!newInstance[recordType!AIA Classification Instance.modelVersion.allowMultipleOutputs] = true,\n  \n  /*Multiple Outcome Model Version*/\n  a!localVariables(\n    /*To check whether the baselineInstance and newInstance have the same outcomes:, determine that all of the following are true:*/\n      /*(1) all of the outcomes in the baselineInstance are contained in the newInstance*/\n      /*(2) all of the outcomes in the newInstance are contained in the baselineInstance*/\n      /*(3) the length of the outcomes in the baselineInstance = the length of the outcomes in the newInstance*/\n    /*This ensures that there aren't baseline outcomes that are omitted from the new instance and that the new instance outcomes don't contain any extras*/\n    \n    /*Query for Baseline Outcomes here to avoid sending them into process (use defaultValue PURELY for expression test cases)*/\n    local!baselineOutcomes: a!defaultValue(\n      ri!baselineInstance[recordType!AIA Classification Instance.outcomes],\n      rule!AIA_QR_getClassificationInstanceOutcome(\n        returnType: \"OBJECT_ARRAY\",\n        instanceId: ri!baselineInstance[recordType!AIA Classification Instance.id],\n        returnActiveOutcomesOnly: true\n      )\n    ),\n    \n    /*First, construct outcome maps so that the correct classification/split for baselineInstance is contained in a singular key (instead of one or the other)*/\n    /*This also will weed out any Removed outcomes from the initial reconciliation*/\n    /*These maps will tell us if we need to add or remove any outcomes when we go to auto-reconcile*/\n    local!baselineInstanceOutcomeMaps: #\"SYSTEM_SYSRULES_forEach\"(\n      items: local!baselineOutcomes,\n      expression: a!map(\n        id: fv!item[recordType!AIA Classification Instance Outcome.classificationInstanceOutcomeId],\n        classification: a!defaultValue(\n          fv!item[recordType!AIA Classification Instance Outcome.classificationOverride],\n          fv!item[recordType!AIA Classification Instance Outcome.classification]\n        ),\n        splitPagesJson: a!defaultValue(\n          fv!item[recordType!AIA Classification Instance Outcome.splitPagesJsonOverride],\n          fv!item[recordType!AIA Classification Instance Outcome.splitPagesJson],\n          /*At this point, if splitPagesJson is null, then the baselineInstance did not allow multiple outcomes and thus does not have a value for this field. \n          We should therefore just construct a splitPagesJson that covers the entire document page range.*/\n          #\"SYSTEM_SYSRULES_toJson_v1\"(\n            a!map(\n              splitType: cons!AIA_TXT_CLASSIFICATION_SPLIT_TYPE_PAGE_RANGE,\n              startPageNumber: 1,\n              endPageNumber: ri!newInstance[recordType!AIA Classification Instance.pageCount]\n            )\n          )\n        ),\n        isContained: a!isNotNullOrEmpty(\n          rule!AIA_UTIL_Filter(\n            records: ri!newInstance[recordType!AIA Classification Instance.outcomes],\n            field: {\n              recordType!AIA Classification Instance Outcome.classification,\n              recordType!AIA Classification Instance Outcome.splitPagesJson\n            },\n            value: {\n              a!defaultValue(\n                fv!item[recordType!AIA Classification Instance Outcome.classificationOverride],\n                fv!item[recordType!AIA Classification Instance Outcome.classification]\n              ),\n              a!defaultValue(\n                fv!item[recordType!AIA Classification Instance Outcome.splitPagesJsonOverride],\n                fv!item[recordType!AIA Classification Instance Outcome.splitPagesJson]\n              )\n            }\n          )\n        )\n      )\n    ),\n    local!newInstanceOutcomeMaps: #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!newInstance[recordType!AIA Classification Instance.outcomes],\n      expression: a!map(\n        id: fv!item[recordType!AIA Classification Instance Outcome.classificationInstanceOutcomeId],\n        isContained: a!isNotNullOrEmpty(\n          rule!AIA_UTIL_Filter(\n            records: local!baselineInstanceOutcomeMaps,\n            field: {\n              \"classification\",\n              \"splitPagesJson\"\n            },\n            value: {\n              fv!item[recordType!AIA Classification Instance Outcome.classification],\n              fv!item[recordType!AIA Classification Instance Outcome.splitPagesJson]\n            }\n          )\n        )\n      )\n    ),\n    local!newInstanceWithStatusUpdate: #\"urn:appian:function:v1:a:update\"(\n      ri!newInstance,\n      {\n        recordType!AIA Classification Instance.statusId,\n        recordType!AIA Classification Instance.modifiedBy,\n        recordType!AIA Classification Instance.modifiedOn\n      },\n      {\n        if(\n          contains(\n            {\n              cons!AIA_INSTANCE_STATUS_RECONCILED_AUTOMATICALLY,\n              cons!AIA_INSTANCE_STATUS_RECONCILED_MANUALLY\n            },\n            ri!baselineInstance[recordType!AIA Classification Instance.statusId]\n          ),\n          cons!AIA_INSTANCE_STATUS_RECONCILED_AUTOMATICALLY,\n          cons!AIA_INSTANCE_STATUS_CLASSIFIED\n        ),\n        loggedInUser(),\n        now()\n      }\n    ),\n    \n    if(\n      and(\n        /*(1) All Baseline Outcomes Contained in New Outcomes*/\n        local!baselineInstanceOutcomeMaps.isContained,\n        /*(2) All New Outcomes Contained in Baseline Outcomes*/\n        local!newInstanceOutcomeMaps.isContained,\n        /*(3) Lengths are the same (use local!baselineInstanceOutcomeMaps to ensure Removed outcomes aren't included in the count)*/\n        length(local!baselineInstanceOutcomeMaps) = length(ri!newInstance[recordType!AIA Classification Instance.outcomes])\n      ),\n      /*In this case, no auto-reconciliation is required, so just return the updated-status new instance*/\n      local!newInstanceWithStatusUpdate,\n      /*Otherwise, we need to override the new instance's outcomes with those of the baseline*/\n      a!localVariables(\n        local!baselineOutcomesToAdd: #\"SYSTEM_SYSRULES_forEach\"(\n          items: rule!AIA_UTIL_Filter(\n            records: local!baselineInstanceOutcomeMaps,\n            field: \"isContained\",\n            value: false\n          ),\n          expression: rule!AIA_ClassificationInstanceOutcome_Initialize(\n            classificationInstanceId: ri!newInstance[recordType!AIA Classification Instance.id],\n            modelVersionId: ri!newInstance[recordType!AIA Classification Instance.modelVersionId],\n            documentId: ri!newInstance[recordType!AIA Classification Instance.documentId],\n            pageCount: ri!newInstance[recordType!AIA Classification Instance.pageCount],\n            classificationOverride: fv!item.classification,\n            splitPagesJsonOverride: fv!item.splitPagesJson,\n            outcomeOverride: cons!AIA_TXT_CLASSIFICATION_OUTCOME_OVERRIDE_ADDED,\n            initiator: loggedInUser()\n          )\n        ),\n        local!newInstanceOutcomeMapsToRemove: rule!AIA_UTIL_Filter(\n          records: local!newInstanceOutcomeMaps,\n          field: \"isContained\",\n          value: false\n        ),\n        #\"urn:appian:function:v1:a:update\"(\n          data: local!newInstanceWithStatusUpdate,\n          index: recordType!AIA Classification Instance.outcomes,\n          value: a!flatten(\n            {\n              /*Don't need to change anything to the outcomes that were already contained in the baseline*/\n              rule!AIA_UTIL_Filter(\n                records: ri!newInstance[recordType!AIA Classification Instance.outcomes],\n                field: recordType!AIA Classification Instance Outcome.classificationInstanceOutcomeId,\n                value: local!newInstanceOutcomeMapsToRemove.id,\n                filterType: \"REJECT\"\n              ),\n              /*Update the new instance outcomes that are not contained in the baseline to be Removed*/\n              if(\n                a!isNullOrEmpty(local!newInstanceOutcomeMapsToRemove),\n                {},\n                #\"urn:appian:function:v1:a:update\"(\n                  data: rule!AIA_UTIL_Filter(\n                    records: ri!newInstance[recordType!AIA Classification Instance.outcomes],\n                    field: recordType!AIA Classification Instance Outcome.classificationInstanceOutcomeId,\n                    value: local!newInstanceOutcomeMapsToRemove.id,\n                  ),\n                  index: recordType!AIA Classification Instance Outcome.outcomeOverride,\n                  value: cons!AIA_TXT_CLASSIFICATION_OUTCOME_OVERRIDE_REMOVED\n                )\n              ),\n              /*And lastly add the new outcomes that were in the baseline but not in the new instance*/\n              local!baselineOutcomesToAdd\n            }\n          )\n        )\n      )\n    )\n  ),\n  \n  /*Single Outcome Model Version*/\n  a!localVariables(\n    /*For single outcome, we really just need to make sure that the classification of the baselineInstance = newInstance*/\n    /*Even if the baseline instance allowed multiple outcomes, we only should take the FIRST one that comes up to reconcile against*/\n    /*Query for Baseline Outcome here to avoid sending them into process (use ri!baselineOutcome PURELY for expression test cases)*/\n    local!baselineOutcome: if(\n      a!isNullOrEmpty(ri!baselineInstance[recordType!AIA Classification Instance.outcomes]),\n      rule!AIA_QR_getClassificationInstanceOutcome(\n        returnType: \"SINGLE_OBJECT\",\n        instanceId: ri!baselineInstance[recordType!AIA Classification Instance.id],\n        returnActiveOutcomesOnly: true\n      ),\n      ri!baselineInstance[recordType!AIA Classification Instance.outcomes][1]\n    ),\n    local!newInstanceWithStatusUpdate: #\"urn:appian:function:v1:a:update\"(\n      data: ri!newInstance,\n      index: {\n        recordType!AIA Classification Instance.statusId,\n        recordType!AIA Classification Instance.modifiedBy,\n        recordType!AIA Classification Instance.modifiedOn\n      },\n      value: {\n        if(\n          contains(\n            {\n              cons!AIA_INSTANCE_STATUS_RECONCILED_AUTOMATICALLY,\n              cons!AIA_INSTANCE_STATUS_RECONCILED_MANUALLY\n            },\n            ri!baselineInstance[recordType!AIA Classification Instance.statusId]\n          ),\n          cons!AIA_INSTANCE_STATUS_RECONCILED_AUTOMATICALLY,\n          cons!AIA_INSTANCE_STATUS_CLASSIFIED\n        ),\n        loggedInUser(),\n        now()\n      }\n    ),\n    if(\n      a!defaultValue(\n        local!baselineOutcome[recordType!AIA Classification Instance Outcome.classificationOverride],\n        local!baselineOutcome[recordType!AIA Classification Instance Outcome.classification]\n      ) = ri!newInstance[recordType!AIA Classification Instance.outcomes][1][recordType!AIA Classification Instance Outcome.classification],\n      local!newInstanceWithStatusUpdate,\n      /*If the classifications didn't match, simply overwrite the newInstanceOutcome's classification with that of the baseline*/\n      #\"urn:appian:function:v1:a:update\"(\n        data: local!newInstanceWithStatusUpdate,\n        index: recordType!AIA Classification Instance.outcomes,\n        value: #\"urn:appian:function:v1:a:update\"(\n          data: ri!newInstance[recordType!AIA Classification Instance.outcomes],\n          index: recordType!AIA Classification Instance Outcome.classificationOverride,\n          value: a!defaultValue(\n            local!baselineOutcome[recordType!AIA Classification Instance Outcome.classificationOverride],\n            local!baselineOutcome[recordType!AIA Classification Instance Outcome.classification]\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ec67-5f00-8000-9bf0-011c48011c48_125041": {
      "name": "AIA_ENUM_ValidDocExtensions",
      "type": "Expression Rule",
      "sail_code": "a!flatten({\n  \"pdf\",\n  \"eml\",\n  \"msg\",\n  \"html\",\n  \"docx\",\n  cons!AIA_TEXT_BASED_EXTENSIONS,\n  \"xlsx\",\n  \"xlsm\",\n  cons!AIA_VALID_IMAGE_FORMATS\n})"
    },
    "_a-0000ef51-0941-8000-a02a-011c48011c48_497699": {
      "name": "AIA_QR_getClassificationInstanceOutcome",
      "type": "Expression Rule",
      "sail_code": "rule!SHRD_UTIL_QueryRecord(\n  recordType: recordType!AIA Classification Instance Outcome,\n  fields: {\n    ri!fields\n  },\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  identifier: ri!classificationInstanceOutcomeId,\n  logicalExpressions: {\n    ri!logicalExpressions,\n    if(\n      a!defaultValue(ri!returnActiveOutcomesOnly, false),\n      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n        operator: \"OR\",\n        filters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Classification Instance Outcome.outcomeOverride,\n            operator: \"=\",\n            value: cons!AIA_TXT_CLASSIFICATION_OUTCOME_OVERRIDE_ADDED\n          ),\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Classification Instance Outcome.outcomeOverride,\n            operator: \"is null\"\n          )\n        }\n      ),\n      {}\n    )\n  },\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Classification Instance Outcome.classificationInstanceOutcomeId,\n      operator: \"=\",\n      value: ri!classificationInstanceOutcomeId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Classification Instance Outcome.instanceId,\n      operator: \"=\",\n      value: ri!instanceId\n    ),\n    ri!additionalFilters\n  }\n)"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_26889": {
      "name": "AIA_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: a!flatten(ri!field),\n      expression: a!map(\n        field: fv!item,\n        value: if(\n          fv!itemCount = 1,\n          ri!value,\n          index(a!flatten(ri!value), fv!index, null)\n        )\n      )\n    )\n  ),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!AIA_UTIL_Filter_Reducer(\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _\n      ),\n      enumerate(count(a!flatten(ri!records))) + 1,\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  )\n)"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_73130": {
      "name": "AIA_Template_ToggleField",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!useRecord: and(\n    a!isNotNullOrEmpty(ri!record),\n    a!isNotNullOrEmpty(ri!field)\n  ),\n  local!value: a!defaultValue(\n    ri!value,\n    if(\n      local!useRecord,\n      a!defaultValue(ri!record[ri!field], ri!defaultValue),\n      ri!defaultValue\n    )\n  ),\n  #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n    spacing: \"SPARSE\",\n    items: {\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          labelPosition: \"COLLAPSED\",\n          value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n            icon: if(\n              local!value,\n              \"toggle-on\",\n              \"toggle-off\"\n            ),\n            size: \"MEDIUM_PLUS\",\n            color: if(\n              local!value,\n              \"ACCENT\",\n              ri!brandingMap.gray3\n            ),\n            link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n              saveInto: {\n                if(\n                  local!useRecord,\n                  a!save(\n                    ri!record[ri!field],\n                    not(local!value)\n                  ),\n                  {}\n                ),\n                ri!saveInto\n              }\n            ),\n            linkStyle: \"STANDALONE\",\n            altText: if(\n              local!value,\n              #\"urn:appian:translation-string:v1:2bcaa33e-f7f3-49e1-a731-448d50b81aa5\"(#\"urn:appian:translation-variable:v1:579fd534-6b9b-425f-bc9f-b634242559ae\": ri!label),\n              #\"urn:appian:translation-string:v1:5d5ccfce-4251-4290-af1d-2bca780b08dd\"(#\"urn:appian:translation-variable:v1:aa7f15e8-7ec1-4fe5-bee9-f84f3f6c85ca\": ri!label)\n            )\n          ),\n\n        ),\n        width: \"MINIMIZE\"\n      ),\n      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n          labelPosition: \"COLLAPSED\",\n          value: {\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!label,\n              style: \"STRONG\",\n            ),\n            char(\n              10\n            ),\n            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n              text: ri!description,\n              color: ri!brandingMap.gray3\n            )\n          }\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_97164": {
      "name": "AIA_UTIL_isBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Boolean',\n  length(a!flatten(ri!value)) = 0\n)"
    },
    "_a-0000ec60-a08d-8000-9bee-011c48011c48_122457": {
      "name": "AIA_DocumentValidation",
      "type": "Expression Rule",
      "sail_code": "if(\n  and(\n    or(\n      a!isNotNullOrEmpty(ri!document),\n      a!isNotNullOrEmpty(ri!extension)\n    ),\n    not(rule!AIA_IsValidDocumentExtension(\n      extension: a!defaultValue(\n        ri!extension,\n        document(ri!document, \"extension\")\n      )\n    ))\n  ),\n  \"Document must be one of these types: \" & joinarray(rule!AIA_ENUM_ValidDocExtensions(), \", \"),\n  null\n)"
    },
    "_a-0000ef2c-4192-8000-9e56-011c48011c48_353021": {
      "name": "AIA_ClassificationInstanceOutcome_Initialize",
      "type": "Expression Rule",
      "sail_code": "recordType!AIA Classification Instance Outcome(\n  recordType!AIA Classification Instance Outcome.instanceId: ri!classificationInstanceId,\n  recordType!AIA Classification Instance Outcome.modelVersionId: ri!modelVersionId,\n  recordType!AIA Classification Instance Outcome.documentId: ri!documentId,\n  recordType!AIA Classification Instance Outcome.pageCount: ri!pageCount,\n  recordType!AIA Classification Instance Outcome.classification: ri!classification,\n  recordType!AIA Classification Instance Outcome.classificationOverride: ri!classificationOverride,\n  recordType!AIA Classification Instance Outcome.reasoning: ri!reasoning,\n  recordType!AIA Classification Instance Outcome.isSplit: ri!isSplit,\n  recordType!AIA Classification Instance Outcome.splitPagesJson: ri!splitPagesJson,\n  recordType!AIA Classification Instance Outcome.splitPagesJsonOverride: ri!splitPagesJsonOverride,\n  recordType!AIA Classification Instance Outcome.outcomeOverride: ri!outcomeOverride,\n  recordType!AIA Classification Instance Outcome.createdBy: ri!initiator,\n  recordType!AIA Classification Instance Outcome.createdOn: now(),\n  recordType!AIA Classification Instance Outcome.modifiedBy: ri!initiator,\n  recordType!AIA Classification Instance Outcome.modifiedOn: now()\n)"
    },
    "000cec5f-edfc-8000-014e-7f0000014e7a": {
      "name": "AIA Classification Run Test Instance",
      "type": "Process Model",
      "sail_code": "// Output: ?\nrule!AIA_Classification_TestReconcilliation(\n  baselineInstance: pv!BaselineClassificationInstance,\n  newInstance: pv!ClassificationInstance\n)\n\n// Input: ?\na!defaultValue(\n  index(pv!documents, tp!instanceIndex, null),\n  todocument(pv!BaselineClassificationInstance[recordType!AIA Classification Instance.documentId])\n)\n\n// Input: ?\n=pv!input\n\n// Input: ?\n=pv!isDocumentTestCase\n\n// Input: ?\n=pv!modelVersionId\n\n// Output: ?\nac!ProcessInfo.pv.ClassificationInstance\n\n// Input: ?\n=pv!ClassificationInstance"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_97936": {
      "name": "AIA_ExtractionInstance_Sub_RecentlyUploadedDocuments",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!recentlyUploadedDocuments: rule!AIA_ExtractionModel_GetRecentlyUploadedDocument(modelVersionId: ri!modelVersionId),\n  local!returnedCount: if(\n    a!isNullOrEmpty(local!recentlyUploadedDocuments),\n    0,\n    length(local!recentlyUploadedDocuments)\n  ),\n  {\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n        marginAbove: \"LESS\",\n        label: #\"urn:appian:translation-string:v1:8a471156-5fc9-419d-ad04-fcb0225e0957\",\n        labelSize: \"EXTRA_SMALL\",\n        labelColor: ri!brandingMap.Gray4,\n        contents: {\n          #\"SYSTEM_SYSRULES_cardGroupLayout\"(\n            cardWidth: if(\n              #\"SYSTEM_SYSRULES_isPageWidth\"(\n                {\n                  \"DESKTOP_NARROW\",\n                  \"DESKTOP\",\n                  \"DESKTOP_WIDE\"\n                }\n              ),\n              \"NARROW_PLUS\",\n              \"NARROW\"\n            ),\n            marginBelow: \"NONE\",\n            labelPosition: \"COLLAPSED\",\n            spacing: \"DENSE\",\n            cards: #\"SYSTEM_SYSRULES_forEach\"(\n              items: enumerate(local!returnedCount) + 1,\n              expression: a!localVariables(\n                local!currentInstanceDocument: index(\n                  local!recentlyUploadedDocuments,\n                  fv!item,\n                  null()\n                ),\n                local!isSelected: if(\n                  a!isNullOrEmpty(ri!selectedDocuments),\n                  false(),\n                  contains(\n                    ri!selectedDocuments,\n                    local!currentInstanceDocument[recordType!AIA Extraction Instance.documentId]\n                  )\n                ),\n                #\"SYSTEM_SYSRULES_cardLayout\"(\n                  contents: {\n                    #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                      items: {\n                        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                          item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                            labelPosition: \"COLLAPSED\",\n                            value: {\n                              #\"SYSTEM_SYSRULES_richTextIcon\"(\n                                icon: if(\n                                  local!isSelected,\n                                  \"check-square\",\n                                  \"square-o\"\n                                ),\n                                color: if(\n                                  local!isSelected,\n                                  ri!brandingMap.AccentColor,\n                                  ri!brandingMap.Gray3\n                                )\n                              )\n                            },\n                            marginBelow: \"NONE\"\n                          ),\n                          width: \"MINIMIZE\"\n                        ),\n                        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                          item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                            labelPosition: \"COLLAPSED\",\n                            value: {\n                              #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                                text: rule!AIA_FormatDocument(\n                                  documentId: local!currentInstanceDocument[recordType!AIA Extraction Instance.documentId],\n                                ),\n                                color: ri!brandingMap.Gray4,\n                                style: { \"STRONG\" }\n                              )\n                            },\n                            preventWrapping: true,\n                            marginBelow: \"NONE\"\n                          ),\n                          width: \"AUTO\"\n                        )\n                      },\n                      alignVertical: \"MIDDLE\",\n                      /*spacing: \"SPARSE\",*/\n                      marginBelow: \"NONE\"\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                      items: {\n                        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                          item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                            labelPosition: \"COLLAPSED\",\n                            value: {\n                              #\"SYSTEM_SYSRULES_richTextIcon\"(\n                                icon: \"check-square\",\n                                color: if(\n                                  local!isSelected,\n                                  ri!brandingMap.Blue0,\n                                  ri!brandingMap.White\n                                )\n                              )\n                            },\n                            marginBelow: \"NONE\"\n                          ),\n                          width: \"MINIMIZE\"\n                        ),\n                        #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                          item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                            labelPosition: \"COLLAPSED\",\n                            value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                              color: ri!brandingMap.Gray3,\n                              size: \"SMALL\",\n                              text: #\"urn:appian:translation-string:v1:89391e44-bfe2-407c-9423-65975c155a06\"(\n                                #\"urn:appian:translation-variable:v1:8624fe55-f7c2-4b34-bbfd-e39c36fe9516\": rule!AIA_UTIL_displayDateTime(\n                                  isDisplayTime: true(),\n                                  dateTime: local!currentInstanceDocument[recordType!AIA Extraction Instance.modifiedOn]\n                                ),\n                                #\"urn:appian:translation-variable:v1:d9a32067-1d56-498f-a207-9f1093f29068\": rule!AIA_UTIL_displayUserFullName(\n                                  userName: local!currentInstanceDocument[recordType!AIA Extraction Instance.modifiedBy]\n                                )\n                              )\n                            ),\n                            marginBelow: \"NONE\"\n                          ),\n                          width: \"MINIMIZE\"\n                        )\n                      },\n                      alignVertical: \"MIDDLE\",\n                      /*spacing: \"SPARSE\"*/\n                      marginBelow: \"NONE\"\n                    )\n                  },\n                  link: if(\n                    local!isSelected,\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: a!save(\n                        ri!selectedDocuments,\n                        remove(\n                          ri!selectedDocuments,\n                          wherecontains(\n                            local!currentInstanceDocument[recordType!AIA Extraction Instance.documentId],\n                            ri!selectedDocuments\n                          )\n                        )\n                      )\n                    ),\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                      saveInto: a!save(\n                        ri!selectedDocuments,\n                        append(\n                          ri!selectedDocuments,\n                          local!currentInstanceDocument[recordType!AIA Extraction Instance.documentId]\n                        )\n                      )\n                    )\n                  ),\n                  shape: \"SEMI_ROUNDED\",\n                  padding: \"LESS\",\n                  borderColor: if(\n                    local!isSelected,\n                    ri!brandingMap.AccentColor,\n                    ri!brandingMap.Gray1\n                  ),\n                  style: if(\n                    local!isSelected,\n                    ri!brandingMap.Blue0,\n                    \"NONE\"\n                  )\n                )\n              )\n            ),\n            showWhen: a!defaultValue(ri!showWhen, false()),\n            fillContainer :if(\n              local!returnedCount<4,\n              false(),\n              true()\n            )\n\n          )\n        }\n      ),\n      showBorder: false,\n      style: ri!brandingMap.AppianBackground,\n      showWhen: and(\n        a!isNotNullOrEmpty(local!recentlyUploadedDocuments),\n        ri!showWhen\n      )\n    ),\n  }\n)"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_98542": {
      "name": "AIA_ClassificationModel_GetRecentlyUploadedDocument",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!instanceDetails: #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n    recordType: recordType!AIA Classification Instance,\n    filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Classification Instance.modelVersionId,\n      operator: \"=\",\n      value: ri!modelVersionId\n    ),\n    fields: a!flatten(\n      {\n        /* Only the fields needed on AIA_Extraction_InstanceCard */\n        recordType!AIA Classification Instance.modelVersionId,\n        recordType!AIA Classification Instance.documentId,\n        recordType!AIA Classification Instance.modifiedBy,\n        recordType!AIA Classification Instance.modifiedOn\n      }\n    ),\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 10,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Classification Instance.id,\n        ascending: false()\n      )\n    )\n  ).data,\n  local!uniqueDocumentIds: union(\n    tointeger(\n      local!instanceDetails[recordType!AIA Classification Instance.documentId]\n    ),\n    tointeger({})\n  ),\n  a!flatten(\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: enumerate(10),\n      expression: {\n        if(\n          or(\n            a!isNullOrEmpty(\n              index(\n                local!uniqueDocumentIds,\n                fv!index,\n                null()\n              )\n            ),\n            a!isNullOrEmpty(\n              try(\n                document(local!uniqueDocumentIds[fv!index], \"id\"),\n                null\n              )\n            )\n          ),\n          {},\n          index(\n            local!instanceDetails,\n            wherecontains(\n              tointeger(\n                index(\n                  local!uniqueDocumentIds,\n                  fv!index,\n                  null()\n                )\n              ),\n              tointeger(\n                local!instanceDetails[recordType!AIA Classification Instance.documentId]\n              )\n            ),\n            null()\n          )[1]\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_12129": {
      "name": "AIA_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!brandingDefault: getbrandingconfig(\n    cons!AIA_DOC_DEFAULT_BRANDING_CONFIG,\n    true()\n  ),\n  local!output: reduce(\n    #\"urn:appian:function:v1:a:update\"(_, _, _),\n    a!map(),\n    merge(\n      {\n        local!brandingDefault.defaultBranding.key,\n        local!brandingDefault.customBranding.key\n      },\n      {\n        local!brandingDefault.defaultBranding.value,\n        local!brandingDefault.customBranding.value\n      }\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ec67-5f00-8000-9bf0-011c48011c48_125328": {
      "name": "AIA_FormatDocument",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNotNullOrEmpty(ri!documentId),\n  try(document(ri!documentId, \"name\"), \"[\" & #\"urn:appian:translation-string:v1:955ba2b6-66dc-4f51-96ff-bc7facbc8d66\" & \"]\"),\n  if(\n    a!isNotNullOrEmpty(ri!instance),\n    a!localVariables(\n      local!isExtraction: runtimetypeof(ri!instance) = typeof(recordType!AIA Extraction Instance()),\n      if(\n        local!isExtraction,\n        rule!AIA_FormatDocument(\n          documentId: a!defaultValue(\n            ri!instance[recordType!AIA Extraction Instance.documentId],\n            ri!instance[recordType!AIA Extraction Instance.sourceDocumentId]\n          )\n        ),\n        rule!AIA_FormatDocument(\n          documentId: a!defaultValue(\n            ri!instance[recordType!AIA Classification Instance.documentId],\n            ri!instance[recordType!AIA Classification Instance.sourceDocumentId]\n          )\n        )\n      )\n    ),\n    \"[\" & #\"urn:appian:translation-string:v1:955ba2b6-66dc-4f51-96ff-bc7facbc8d66\" & \"]\"\n  )\n)"
    },
    "_a-0000ec2d-5396-8000-9bdc-011c48011c48_40839": {
      "name": "AIA_Test_GetLatestExtractionInstance",
      "type": "Expression Rule",
      "sail_code": "rule!AIA_Extraction_GetInstanceById(\n  identifier: #\"SYSTEM_SYSRULES_queryRecordType_v3\"(\n    recordType: recordType!AIA Extraction Instance,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 1,\n      sort: {\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AIA Extraction Instance.id\n        )\n      }\n    )\n  ).data[recordType!AIA Extraction Instance.id],\n  additionalFields: {\n    recordType!AIA Extraction Instance.instanceUuid,\n    recordType!AIA Extraction Instance.modelVersion.versionId,\n    recordType!AIA Extraction Instance.modelVersion.modelId,\n    recordType!AIA Extraction Instance.modelVersion.uuid,\n    recordType!AIA Extraction Instance.modelVersion.extractionModel.key,\n    recordType!AIA Extraction Instance.documentFolderId,\n    recordType!AIA Extraction Instance.fieldCount,\n    recordType!AIA Extraction Instance.sections,\n    recordType!AIA Extraction Instance.boundingBoxes,\n    recordType!AIA Extraction Instance.responseDocumentId,\n    recordType!AIA Extraction Instance.sourceDocumentId\n  }\n)"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_36163": {
      "name": "SHRD_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!maxBatchSize: 5000,\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      queryRecordByIdentifier: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          local!maxBatchSize\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      queryRecordByIdentifier: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"RECORD_BY_ID\",\n    then: a!map(\n      castToType: ri!recordType,\n      fetchTotalCount: false,\n      isArray: false,\n      queryRecordByIdentifier: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      queryRecordByIdentifier: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          local!maxBatchSize\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      queryRecordByIdentifier: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, RECORD_BY_ID, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: if(\n          local!queryParams.queryRecordByIdentifier,\n          #\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n            recordType: ri!recordType,\n            identifier: index({ri!identifier},1,null),\n            /*If fields is sent in using a!selectionFields(), then adding the fields contained in ri!relatedRecordData will break the query*/\n            fields: reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  if(\n                    or(\n                      typeof(ri!fields) = typeof(#\"SYSTEM_SYSRULES_selectionFields\"()),\n                      typeof(ri!fields) = typeof({#\"SYSTEM_SYSRULES_selectionFields\"()})\n                    ),\n                    {},\n                    index(ri!relatedRecordData, \"relationship\", {})\n                  )\n                }\n              )\n            ),\n            relatedRecordData: ri!relatedRecordData\n          ),\n          #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n            recordType: ri!recordType,\n            fields: if(\n              a!isNullOrEmpty(ri!groupByFields),\n              reject(\n                a!isNullOrEmpty,\n                a!flatten(\n                  {\n                    ri!fields,\n                    index(ri!relatedRecordData, \"relationship\", {})\n                  }\n                )\n              ),\n              #\"SYSTEM_SYSRULES_aggregationFields\"(\n                groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                  items: ri!groupByFields,\n                  expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n                ),\n                measures: #\"SYSTEM_SYSRULES_measure\"(\n                  field: ri!groupByFields[1],\n                  function: \"COUNT\",\n                  alias: \"count\"\n                )\n              )\n            ),\n            filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n              operator: \"AND\",\n              ignoreFiltersWithEmptyValues: true,\n              logicalExpressions: {\n                ri!logicalExpressions,\n                if(\n                  and(\n                    a!isNotNullOrEmpty(ri!searchFields),\n                    a!isNotNullOrEmpty(ri!searchTerm)\n                  ),\n                  #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                    operator: \"AND\",\n                    logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                      items: split(trim(ri!searchTerm), \" \"),\n                      expression: a!localVariables(\n                        local!splitSearchTerm: fv!item,\n                        /*   Initiate filter for each field by the value provided in searchTerm   */\n                        #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                          operator: \"OR\",\n                          filters: #\"SYSTEM_SYSRULES_forEach\"(\n                            items: ri!searchFields,\n                            expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                              field: fv!item,\n                              operator: \"includes\",\n                              value: local!splitSearchTerm\n                            )\n                          )\n                        )\n                      )\n                    )\n                  ),\n                  {}\n                )\n              },\n              filters: ri!filters\n            ),\n            pagingInfo: if(\n              a!isNullOrEmpty(ri!groupByFields),\n              local!queryParams.pagingInfo,\n              #\"urn:appian:function:v1:a:update\"(\n                local!queryParams.pagingInfo,\n                \"sort\",\n                null\n              )\n            ),\n            fetchTotalCount: local!queryParams.fetchTotalCount,\n            relatedRecordData: if(\n              a!isNullOrEmpty(ri!groupByFields),\n              ri!relatedRecordData,\n              {}\n            )\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          index(local!queryResult,\"data\",{})\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          index(local!queryResult,\"data\",{})\n        ),\n        equals: \"RECORD_BY_ID\",\n        /*do not need to cast for queryRecordByIdentifier*/\n        then: local!queryResult,\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: cast(\n          local!queryParams.castToType,\n          index(local!queryResult,\"totalCount\",{})\n        ),\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000ec60-a08d-8000-9bee-011c48011c48_122463": {
      "name": "AIA_IsValidDocumentExtension",
      "type": "Expression Rule",
      "sail_code": "contains(\n  rule!AIA_ENUM_ValidDocExtensions(),\n  ri!extension\n)"
    },
    "_a-0000ef43-16ec-8000-9fda-011c48011c48_478809": {
      "name": "AIA_ModelTestSuite_getSuitesWithMaxTestSuiteCases",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*get all suites that are selected that have 100 cases already*/\n  local!suitesWithMaxTestCases: rule!SHRD_UTIL_QueryRecord(\n    recordType: recordType!AIA Model Test Suite,\n    returnType: \"OBJECT_ARRAY\",\n    executeWhen: a!isNotNullOrEmpty(ri!modelTestSuiteIds),\n    fields: {\n      recordType!AIA Model Test Suite.testSuiteId,\n      recordType!AIA Model Test Suite.name\n    },\n    /*get the row that has this instance already saved if exists, will be used to ignore in validation below*/\n    relatedRecordData: if(\n      a!isNotNullOrEmpty(ri!instanceUuidToIgnore),\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!AIA Model Test Suite.modelTestSuiteCases,\n        limit: 1,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AIA Model Test Suite Case.baselineInstanceUuid,\n          operator: \"=\",\n          value: ri!instanceUuidToIgnore\n        )\n      ),\n      {}\n    ),\n    filters: {\n      #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AIA Model Test Suite.testSuiteId,\n        operator: \"in\",\n        value: ri!modelTestSuiteIds\n      ),\n      #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AIA Model Test Suite.testCaseCount,\n        operator: \">=\",\n        value: 100\n      )\n    }\n  ),\n  /*filter out by uuid to ignore if provided, else return query directly*/\n  if(\n    a!isNotNullOrEmpty(ri!instanceUuidToIgnore),\n    rule!AIA_UTIL_rejectNullValuesFromArray(\n      array: #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!suitesWithMaxTestCases,\n        /*iterate over each and reject if the related record filter returned the current instance already saved in the DB*/\n        /*this means the current isntance already contriubtes to caseCount so not truely \"adding\"*/\n        expression: if(\n          a!isNotNullOrEmpty(fv!item[recordType!AIA Model Test Suite.modelTestSuiteCases.baselineInstanceUuid]),\n          null,\n          fv!item\n        )\n      )\n    ),\n    local!suitesWithMaxTestCases\n  )\n)"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_34420": {
      "name": "AIA_UTIL_displayUserFullName",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!userName),\n  ri!defaultValue,\n  try(\n    tostring(\n      concat(\n        user(ri!userName, \"firstName\"),\n        \" \",\n        user(ri!userName, \"lastName\")\n      )\n    ),\n    a!defaultValue(ri!defaultValue, \"System\")\n  )\n)"
    },
    "_a-0000ec36-59aa-8000-9be0-011c48011c48_52454": {
      "name": "AIA_Test_GetLatestClassificationInstance",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n  recordType: recordType!AIA Classification Instance,\n  identifier: index(\n    #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n      recordType: recordType!AIA Classification Instance,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: {\n          #\"SYSTEM_SYSRULES_sortInfo\"(\n            field: recordType!AIA Classification Instance.id\n          )\n        }\n      )\n    ).data[recordType!AIA Classification Instance.id],\n    1,\n    null\n  ),\n  fields: {\n    recordType!AIA Classification Instance.modelVersion,\n    recordType!AIA Classification Instance.modelVersion,\n    recordType!AIA Classification Instance.outcomes,\n    recordType!AIA Classification Instance.refInstanceStatus\n  },\n)"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_98603": {
      "name": "AIA_ClassificationInstance_Sub_RecentlyUploadedDocuments",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!recentlyUploadedDocuments: rule!AIA_ClassificationModel_GetRecentlyUploadedDocument(modelVersionId: ri!modelVersionId),\n  local!returnedCount: if(\n    a!isNullOrEmpty(local!recentlyUploadedDocuments),\n    0,\n    length(local!recentlyUploadedDocuments)\n  ),\n  #\"SYSTEM_SYSRULES_cardLayout\"(\n    contents: #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n      marginAbove: \"LESS\",\n      label: #\"urn:appian:translation-string:v1:8a471156-5fc9-419d-ad04-fcb0225e0957\",\n      labelSize: \"EXTRA_SMALL\",\n      labelColor: ri!brandingMap.Gray4,\n      contents: {\n        #\"SYSTEM_SYSRULES_cardGroupLayout\"(\n          labelPosition: \"COLLAPSED\",\n          cardWidth: if(\n            #\"SYSTEM_SYSRULES_isPageWidth\"(\n              {\n                \"DESKTOP_NARROW\",\n                \"DESKTOP\",\n                \"DESKTOP_WIDE\"\n              }\n            ),\n            \"NARROW_PLUS\",\n            \"NARROW\"\n          ),\n          marginBelow: \"NONE\",\n          spacing: \"DENSE\",\n          cards: #\"SYSTEM_SYSRULES_forEach\"(\n            items: enumerate(local!returnedCount) + 1,\n            expression: a!localVariables(\n              local!currentInstanceDocument: index(\n                local!recentlyUploadedDocuments,\n                fv!item,\n                null()\n              ),\n              local!isSelected: if(\n                a!isNullOrEmpty(ri!selectedDocuments),\n                false(),\n                contains(\n                  tointeger(ri!selectedDocuments),\n                  local!currentInstanceDocument[recordType!AIA Classification Instance.documentId]\n                )\n              ),\n              #\"SYSTEM_SYSRULES_cardLayout\"(\n                contents: {\n                  #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                    items: {\n                      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                          labelPosition: \"COLLAPSED\",\n                          value: {\n                            #\"SYSTEM_SYSRULES_richTextIcon\"(\n                              icon: if(\n                                local!isSelected,\n                                \"check-square\",\n                                \"square-o\"\n                              ),\n                              color: if(\n                                local!isSelected,\n                                ri!brandingMap.AccentColor,\n                                ri!brandingMap.Gray3\n                              )\n                            )\n                          },\n                          marginBelow: \"NONE\"\n                        ),\n                        width: \"MINIMIZE\"\n                      ),\n                      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                          labelPosition: \"COLLAPSED\",\n                          value: {\n                            #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                              text: document(\n                                local!currentInstanceDocument[recordType!AIA Classification Instance.documentId],\n                                \"name\"\n                              ),\n                              color: ri!brandingMap.Gray4,\n                              style: { \"STRONG\" }\n                            )\n                          },\n                          preventWrapping: true,\n                          marginBelow: \"NONE\"\n                        ),\n                        width: \"AUTO\"\n                      )\n                    },\n                    alignVertical: \"MIDDLE\",\n                    /*spacing: \"SPARSE\",*/\n                    marginBelow: \"NONE\"\n                  ),\n                  #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                    items: {\n                      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                          labelPosition: \"COLLAPSED\",\n                          value: {\n                            #\"SYSTEM_SYSRULES_richTextIcon\"(\n                              icon: \"check-square\",\n                              color: if(\n                                local!isSelected,\n                                ri!brandingMap.Blue0,\n                                ri!brandingMap.White\n                              )\n                            )\n                          },\n                          marginBelow: \"NONE\"\n                        ),\n                        width: \"MINIMIZE\"\n                      ),\n                      #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                        item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                          labelPosition: \"COLLAPSED\",\n                          value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            color: ri!brandingMap.Gray3,\n                            size: \"SMALL\",\n                            text: #\"urn:appian:translation-string:v1:89391e44-bfe2-407c-9423-65975c155a06\"(\n                              #\"urn:appian:translation-variable:v1:8624fe55-f7c2-4b34-bbfd-e39c36fe9516\": rule!AIA_UTIL_displayDateTime(\n                                isDisplayTime: true(),\n                                dateTime: local!currentInstanceDocument[recordType!AIA Classification Instance.modifiedOn]\n                              ),\n                              #\"urn:appian:translation-variable:v1:d9a32067-1d56-498f-a207-9f1093f29068\": rule!AIA_UTIL_displayUserFullName(\n                                userName: local!currentInstanceDocument[recordType!AIA Classification Instance.modifiedBy]\n                              )\n                            )\n                          ),\n                          marginBelow: \"NONE\"\n                        ),\n                        width: \"MINIMIZE\"\n                      )\n                    },\n                    alignVertical: \"MIDDLE\",\n                    /*spacing: \"SPARSE\"*/\n                    marginBelow: \"NONE\"\n                  )\n                },\n                link: if(\n                  local!isSelected,\n                  #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    saveInto: a!save(\n                      ri!selectedDocuments,\n                      remove(\n                        ri!selectedDocuments,\n                        wherecontains(\n                          local!currentInstanceDocument[recordType!AIA Classification Instance.documentId],\n                          ri!selectedDocuments\n                        )\n                      )\n                    )\n                  ),\n                  #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    saveInto: a!save(\n                      ri!selectedDocuments,\n                      append(\n                        ri!selectedDocuments,\n                        local!currentInstanceDocument[recordType!AIA Classification Instance.documentId]\n                      )\n                    )\n                  )\n                ),\n                shape: \"SEMI_ROUNDED\",\n                padding: \"LESS\",\n                borderColor: if(\n                  local!isSelected,\n                  ri!brandingMap.AccentColor,\n                  ri!brandingMap.Gray1\n                ),\n                style: if(\n                  local!isSelected,\n                  ri!brandingMap.Blue0,\n                  \"NONE\"\n                )\n              )\n            )\n          ),\n          showWhen: a!defaultValue(ri!showWhen, false()),\n          fillContainer :if(\n            local!returnedCount<4,\n            false(),\n            true()\n          )\n\n        )\n      }\n    ),\n    showBorder: false,\n    style: ri!brandingMap.AppianBackground,\n    showWhen: and(\n      a!isNotNullOrEmpty(local!recentlyUploadedDocuments),\n      ri!showWhen\n    )\n  )\n)"
    },
    "_a-0000eead-6b09-8000-9bee-011c48011c48_148667": {
      "name": "AIA_QR_getModelTestSuite",
      "type": "Expression Rule",
      "sail_code": "rule!SHRD_UTIL_QueryRecord(\n  recordType: recordType!AIA Model Test Suite,\n  returnType: ri!returnType,\n  fields: ri!fields,\n  executeWhen: ri!executeWhen,\n  pagingInfo: ri!pagingInfo,\n  identifier: ri!ids,\n  filters: {\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Model Test Suite.modelUuid,\n      operator: \"=\",\n      value: ri!uuid,\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Model Test Suite.testSuiteId,\n      operator: \"in\",\n      value: ri!ids\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!AIA Model Test Suite.testSuiteId,\n      operator: \"not in\",\n      value: ri!idsToExclude\n    ),\n  },\n  sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n    field: recordType!AIA Model Test Suite.testSuiteId,\n    ascending: true\n  )\n)"
    },
    "_a-0000edb4-d4ac-8000-9bae-011c48011c48_107488": {
      "name": "AIA_RecordAction_ModelRunInstance_Sub_TestCaseSettings",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!modelTestSuites: rule!AIA_QR_getModelTestSuite(\n    uuid: if(\n      ri!isExtraction,\n      concat(cons!AIA_MODEL_TYPE_VALUES[1], \"-\", ri!modelId),\n      concat(cons!AIA_MODEL_TYPE_VALUES[2], \"-\", ri!modelId)\n    )\n  ),\n  local!suitesWithMaxTestCases: rule!AIA_ModelTestSuite_getSuitesWithMaxTestSuiteCases(\n    modelTestSuiteIds: ri!modelTestSuiteIds,\n    /*intentionaly null because this is a new instance*/\n    instanceUuidToIgnore: null\n  ),\n  {\n    #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        rule!AIA_Template_ToggleField(\n          value: ri!isDocumentTestCase,\n          saveInto: a!save(\n            ri!isDocumentTestCase,\n            not(a!defaultValue(ri!isDocumentTestCase, false))\n          ),\n          brandingMap: ri!brandingMap,\n          label: #\"urn:appian:translation-string:v1:c43ce91b-bcb2-40f7-b945-b009f5b48b26\",\n          description: #\"urn:appian:translation-string:v1:6822d8fb-6b9f-4045-ba44-a3253c8da1b1\",\n          defaultValue: false\n        ),\n        /*test suite selection*/\n        #\"SYSTEM_SYSRULES_multipleDropdownField_v1\"(\n          label: #\"urn:appian:translation-string:v1:b1dcc961-d661-4c36-b9d4-391ca5995eb7\",\n          choiceLabels: local!modelTestSuites[recordType!AIA Model Test Suite.name],\n          choiceValues: local!modelTestSuites[recordType!AIA Model Test Suite.testSuiteId],\n          showWhen: and(\n            a!defaultValue(ri!isDocumentTestCase, false),\n            a!isNotNullOrEmpty(local!modelTestSuites)\n          ),\n          placeholder: #\"urn:appian:translation-string:v1:f744141b-3e47-4992-827f-1758bb3ff64f\"(\n            #\"urn:appian:translation-variable:v1:ad0716ea-de59-4fd9-bed1-e6102d6dc170\": #\"urn:appian:translation-string:v1:572d331a-7e5e-4c1c-a6d1-3f08b96a0aed\"\n          ),\n          validations: if(\n            a!isNotNullOrEmpty(local!suitesWithMaxTestCases),\n            #\"urn:appian:translation-string:v1:622db5b6-eb03-45db-a33e-180f6c840c16\"(\n              #\"urn:appian:translation-variable:v1:f7144572-32f1-4235-97cc-5e10c7448832\": joinarray(\n                local!suitesWithMaxTestCases[recordType!AIA Model Test Suite.name],\n                \", \"\n              )\n            ),\n            null\n          ),\n          value: ri!modelTestSuiteIds,\n          saveInto: ri!modelTestSuiteIds\n        )\n      },\n      padding: \"NONE\",\n      marginAbove: \"LESS\",\n      marginBelow: \"NONE\",\n      showBorder: false\n    )\n  }\n)"
    },
    "_a-0000edb0-f009-8000-9ba8-011c48011c48_97176": {
      "name": "AIA_UTIL_rejectNullValuesFromArray",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(ri!array),\n  reject(\n    rule!AIA_UTIL_isBlank(_),\n    a!flatten(ri!array)\n  )\n)"
    },
    "_a-0000ef3e-b586-8000-9f8a-011c48011c48_451285": {
      "name": "AIA_Test_GetLatestExtractionModelWithTestSuite",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n  recordType: recordType!AIA Extraction Model,\n  identifier: index(\n    #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n      recordType: recordType!AIA Extraction Model,\n      filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AIA Extraction Model.modelTestSuites,\n        operator: \"not null\"\n      ),\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: {\n          #\"SYSTEM_SYSRULES_sortInfo\"(\n            field: recordType!AIA Extraction Model.modelId\n          )\n        }\n      )\n    ).data[recordType!AIA Extraction Model.modelId],\n    1,\n    null\n  ),\n  fields: {\n    recordType!AIA Extraction Model.modelTestSuites,\n    recordType!AIA Extraction Model.modelTestSuites,\n    recordType!AIA Extraction Model.modelTestSuites\n  },\n)"
    }
  }
}
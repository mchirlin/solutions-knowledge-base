{
  "_metadata": {
    "bundle_id": "AIA_Extraction_Instance_-_urnappiantranslation-stringv125c2d38b-ee59-4ab8-bbfe-0"
  },
  "objects": {
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92467": {
      "name": "AIA_MTR_ClassificationInstanceClassifiedWithErrors",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eeac-580c-8000-9be9-011c48011c48_148239": {
      "name": "AIA_filterValidationRulesForProcessExecution",
      "type": "Expression Rule",
      "sail_code": "reject(\n  fn!isnull,\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!validationRules,\n    expression: if(\n      a!isNullOrEmpty(\n        rule!AIA_returnRuleOperationForValidationRule(validationRule: fv!item).executionProcess\n      ),\n      null,\n      fv!item\n    )\n  )\n)"
    },
    "_a-0000eec9-5676-8000-9c92-011c48011c48_179359": {
      "name": "AIA_MTR_ConfidenceThresholdDisabled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_268553": {
      "name": "AIA_RULE_RunValidationRule",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!rule),\n  null,\n  a!localVariables(\n    local!rule: ri!rule,\n    /*Query available Rule Operations*/\n    local!ruleOperations: a!defaultValue(\n      value: ri!ruleOperations,\n      default: rule!AIA_RULE_ENUM_RuleOperations()\n    ),\n    /* Query model version fields */\n    local!modelVersionFields: a!defaultValue(\n      value: ri!ModelVersionFields,\n      default: rule!AIA_Extraction_GetFieldsForModelVersionId(\n        modelVersionId: ri!Instance[recordType!AIA Extraction Instance.modelVersionId]\n      )\n    ),\n    /* Convert Rule Expression to Dictionary */\n    local!ruleLogicalExpression: rule!AIA_ExtractJson(\n      json: local!rule[recordType!AIA Extraction Model Version Validation Rule.validations]\n    ),\n    /*Execute deficiency rule logic*/\n    local!ruleLogicOutcome: rule!AIA_RULE_ExecuteRuleLogic(\n      logicalExpression: local!ruleLogicalExpression,\n      ruleOperations: local!ruleOperations,\n      parameters: a!map(\n        instanceMap: ri!instanceMap,\n        Instance: ri!Instance,\n        modelVersionFields: local!modelVersionFields\n      )\n    ),\n    /*Return a deficiency if the rule logic evaluates to false*/\n    if(\n      a!defaultValue(\n        index(local!ruleLogicOutcome, \"result\", null),\n        local!ruleLogicOutcome\n      ),\n      {},\n      #\"SYSTEM_SYSRULES_forEach\"(\n        index(local!ruleLogicOutcome, \"results\", {local!ruleLogicOutcome}),\n        recordType!AIA Instance Validation Error(\n          recordType!AIA Instance Validation Error.instanceId: ri!Instance[recordType!AIA Extraction Instance.id],\n          recordType!AIA Instance Validation Error.instanceType: cons!AIA_MODEL_TYPE_VALUES[1],\n          recordType!AIA Instance Validation Error.modelValidationRuleId: ri!rule[recordType!AIA Extraction Model Version Validation Rule.id],\n          recordType!AIA Instance Validation Error.typeId: if(\n            a!isNotNullOrEmpty(ri!rule[recordType!AIA Extraction Model Version Validation Rule.id]),\n            cons!AIA_VALIDATION_TYPE_ID_MODEL,\n            a!defaultValue(fv!item.typeId, cons!AIA_VALIDATION_TYPE_ID_FIELD)\n          ),\n          recordType!AIA Instance Validation Error.instanceFieldId: index(\n            index(\n              fv!item,\n              \"field\",\n            ),\n            recordType!AIA Extraction Instance Field.id,\n            null\n          ),\n          recordType!AIA Instance Validation Error.message: a!defaultValue(\n            rule!AIA_MergeJsonTemplate(\n              map: ri!instanceMap,\n              template: ri!rule[recordType!AIA Extraction Model Version Validation Rule.message]\n            ),\n            index(fv!item, \"message\", null),\n          ),\n          recordType!AIA Instance Validation Error.severity: a!defaultValue(\n            index(fv!item, \"severity\", null),\n            ri!rule[recordType!AIA Extraction Model Version Validation Rule.severity],\n          )\n        )\n      ) \n    )\n  )\n)"
    },
    "_a-0000eeca-c121-8000-9cab-011c48011c48_182002": {
      "name": "AIA_MTR_ClassificationModelVersionRestore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180853": {
      "name": "AIA_MTR_ExtractionInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483991": {
      "name": "AIA_MTR_ModelTestSuiteUpdated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ec67-5f00-8000-9bf0-011c48011c48_126403": {
      "name": "AIA_UTIL_UpdateByKeyValue",
      "type": "Expression Rule",
      "sail_code": "#\"urn:appian:function:v1:a:update\"(\n  ri!baseMap,\n  ri!updateMap.key,\n  ri!updateMap.value\n)"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_268583": {
      "name": "AIA_RULE_ExecuteRuleLogic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!logicalExpression: ri!logicalExpression,\n  /*Query Rule Operations if not provided*/\n  local!ruleOperations: a!defaultValue(\n    value: ri!ruleOperations,\n    default: rule!AIA_RULE_ENUM_RuleOperations()\n  ),\n  /*Obtain the operation rule when a rule operation identifier is available*/\n  local!operationRule: a!refreshVariable(\n    value: displayvalue(\n      local!logicalExpression.ruleOperationId,\n      local!ruleOperations.id,\n      local!ruleOperations.rule,\n      null\n    ),\n    refreshAlways: true\n  ),\n  if(\n    a!isNullOrEmpty(local!operationRule),\n    null,\n    a!localVariables(\n      local!parameters: #\"urn:appian:function:v1:a:update\"(\n        data: ri!parameters,\n        index: \"context\",\n        value: local!logicalExpression\n      ),\n      local!nestedExpresions: reject(\n        a!isNullOrEmpty,\n        append(\n          local!logicalExpression.conditions,\n          local!logicalExpression.expressions\n        )\n      ),\n      /*Determine the output based on expression operator*/\n      a!match(\n        value: upper(\n          local!logicalExpression.expressionOperator\n        ),\n        /*Run the nested expression if operator is AND*/\n        /*Returns false as soon as a rule operation yields false*/\n        equals: \"AND\",\n        then: and(\n          #\"SYSTEM_SYSRULES_forEach\"(\n            local!nestedExpresions,\n            rule!AIA_RULE_ExecuteRuleLogic(\n              logicalExpression: fv!item,\n              ruleOperations: local!ruleOperations,\n              parameters: ri!parameters\n            )\n          )\n        ),\n        /*Run the nested expression if operator is OR*/\n        /*Returns true as soon as a rule operation yields true*/\n        equals: \"OR\",\n        then: or(\n          #\"SYSTEM_SYSRULES_forEach\"(\n            local!nestedExpresions,\n            rule!AIA_RULE_ExecuteRuleLogic(\n              logicalExpression: fv!item,\n              ruleOperations: local!ruleOperations,\n              parameters: ri!parameters\n            )\n          )\n        ),\n        /*When no nested expressions are available, execute the rule operation*/\n        whenTrue: a!isNotNullOrEmpty(value: local!operationRule),\n        then: local!operationRule(\n          /*Include the rule operation context in the parameters (Obtained from the logical expression)*/\n          local!parameters\n        ),\n        /*Return null if the evaluation fails (Should not happen)*/\n        default: a!localVariables(\n          local!error: a!match(\n            value: local!operationRule,\n            whenTrue: a!isNullOrEmpty(value: local!logicalExpression),\n            then: \"A Logical Expression was not provided.\",\n            whenTrue: a!isNullOrEmpty(value: local!operationRule),\n            then: \"The rule is null.\",\n            default: \"Dude, I don't know.\"\n          ),\n          error(\"An expression evaluation failed to execute. \" & local!error)\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92592": {
      "name": "AIA_MTR_ExtractionInstanceValidationIgnore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483964": {
      "name": "AIA_MTR_ModelTestRunInitiated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92585": {
      "name": "AIA_MTR_ExtractionInstanceValidationAccept",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ec2d-5396-8000-9bdc-011c48011c48_43077": {
      "name": "AIA_Extraction_GetInstanceById",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n  recordType: recordType!AIA Extraction Instance,\n  identifier: ri!identifier,\n  fields: a!flatten(\n    {\n      /* Extraction Instance */\n      recordType!AIA Extraction Instance.modelVersionId,\n      recordType!AIA Extraction Instance.documentId,\n      recordType!AIA Extraction Instance.statusId,\n      recordType!AIA Extraction Instance.hasBoundingBoxes,\n      recordType!AIA Extraction Instance.boundingBoxesDocumentId,\n      recordType!AIA Extraction Instance.validationErrors,\n      recordType!AIA Extraction Instance.accuracy,\n      recordType!AIA Extraction Instance.precision,\n      recordType!AIA Extraction Instance.f1,\n      recordType!AIA Extraction Instance.recall,\n      recordType!AIA Extraction Instance.createdOn,\n      /* Extraction Fields */\n      recordType!AIA Extraction Instance.fields.modelVersionFieldId,\n      recordType!AIA Extraction Instance.fields.extractedValue,\n      recordType!AIA Extraction Instance.fields.overrideValue,\n      recordType!AIA Extraction Instance.fields.overrideNull,\n      recordType!AIA Extraction Instance.fields.boundingBox,\n      recordType!AIA Extraction Instance.fields.confidence,\n      /* Extraction Fields > Rows */\n      recordType!AIA Extraction Instance.fields.rows.overrideValue,\n      recordType!AIA Extraction Instance.fields.rows.boundingBox,\n      /* Extraction Fields > Rows > Cells */\n      recordType!AIA Extraction Instance.fields.rows.cells.modelVersionFieldId,\n      recordType!AIA Extraction Instance.fields.rows.cells.extractedValue,\n      recordType!AIA Extraction Instance.fields.rows.cells.overrideValue,\n      recordType!AIA Extraction Instance.fields.rows.cells.overrideNull,\n      recordType!AIA Extraction Instance.fields.rows.cells.confidence,\n      /* Extraction Fields > Model Field */\n      recordType!AIA Extraction Instance.fields.modelVersionField.key,\n      recordType!AIA Extraction Instance.fields.modelVersionField.columns.key,\n      /* Extraction Fields > Rows > Cells > Column */\n      recordType!AIA Extraction Instance.fields.rows.cells.column.key,\n      a!defaultValue(ri!additionalFields, {})\n    },\n    \n  )\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92578": {
      "name": "AIA_MTR_ExtractionModelVersionAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92488": {
      "name": "AIA_MTR_ExtractionInstanceError",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee35-0ca2-8000-9ba6-011c48011c48_13646": {
      "name": "AIA_LogMetric",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!name,\n  /* Classification Model Created */\n  equals: cons!AIA_MTR_CLASSIFICATION_MODEL_CREATED,\n  then: rule!AIA_MTR_ClassificationModelCreated(),\n  /* Classification Instance Created */\n  equals: cons!AIA_MTR_CLASSIFICATION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_ClassificationInstanceCreated(),\n  /* Classification Instance Reconciled */\n  equals: cons!AIA_MTR_CLASSIFICATION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_ClassificationInstanceReconciled(),\n  /* Classification Instance with Validation Errors */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFIED_WITH_ERRORS,\n  then: rule!AIA_MTR_ClassificationInstanceClassifiedWithErrors(),\n  /* Classification Instance with Critical Error */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFICATION_CRITICAL_ERROR,\n  then: rule!AIA_MTR_ClassificationInstanceError(),\n  \n  /* Extraction Model Created */\n  equals: cons!AIA_MTR_EXTRACTION_MODEL_CREATED,\n  then: rule!AIA_MTR_ExtractionModelCreated(),\n  /* Extraction Instance Created */\n  equals: cons!AIA_MTR_EXTRACTION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_ExtractionInstanceCreated(),\n  /* Extraction Instance Reconciled */\n  equals: cons!AIA_MTR_EXTRACTION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_ExtractionInstanceReconciled(),\n  /* Extraction Instance with Validation Errors */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTED_WITH_ERRORS,\n  then: rule!AIA_MTR_ExtractionInstanceExtractedWithErrors(),\n  /* Extraction Instance with Critical Error */\n  equals: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTION_CRITICAL_ERROR,\n  then: rule!AIA_MTR_ExtractionInstanceError(),\n  \n  /* Triggered when AI review raises an error (field level) */\n  equals: cons!AIA_MTR_AI_REVIEW_FIELD,\n  then: rule!AIA_MTR_ExtractionInstanceFieldAiReview(),\n  /* Triggered when AI review raises an error (instance level, this instance has 1 or more errors raised by AI review) */\n  equals: cons!AIA_MTR_AI_REVIEW_INSTANCE,\n  then: rule!AIA_MTR_ExtractionInstanceAiReview(),\n  /* Triggered when model is created with AI review turned on OR AI review is turned on for a model */\n  equals: cons!AIA_MTR_AI_REVIEW_MODEL_VERSION,\n  then: rule!AIA_MTR_ExtractionModelVersionAiReview(),\n  /* Triggered when user clicks accept */\n  equals: cons!AIA_MTR_AI_REVIEW_ACCEPT,\n  then: rule!AIA_MTR_ExtractionInstanceValidationAccept(),\n  /* Triggered when user clicks ignored */\n  equals: cons!AIA_MTR_AI_REVIEW_IGNORE,\n  then: rule!AIA_MTR_ExtractionInstanceValidationIgnore(),\n  /*triggered when spot check ocnfigured*/\n  equals: cons!AIA_MTR_SPOT_CHECK_MODEL_VERSION,\n  then: rule!AIA_MTR_ModelVersionConfigureSampling(),\n  /* Triggered when a model validation rule of type AI validation creates a validation instance */\n  equals: cons!AIA_MTR_AI_VALIDATION_RULE_OCCURANCE,\n  then: rule!AIA_MTR_InstanceValidationAiRuleOccurance(),\n  /*Confidence Threshold Enabled*/\n  equals: cons!AIA_MTR_CONFIDENCE_THRESHOLD_ENABLED,\n  then: rule!AIA_MTR_ConfidenceThresholdEnabled(),\n  /*Confidence Threshold Disabled*/\n  equals: cons!AIA_MTR_CONFIDENCE_THRESHOLD_DISABLED,\n  then: rule!AIA_MTR_ConfidenceThresholdDisabled(),\n  /*Extraction Model Version Restored*/\n  equals: cons!AIA_MTR_EXTRACTION_MODEL_VERSION_RESTORE,\n  then: rule!AIA_MTR_ExtractionModelVersionRestore(),\n  /*Classification Model Version Restored*/\n  equals: cons!AIA_MTR_CLASSIFICATION_MODEL_VERSION_RESTORE,\n  then: rule!AIA_MTR_ClassificationModelVersionRestore(),\n  /*Model Test Suite Created*/\n  equals: cons!AIA_MTR_MODEL_TEST_SUITE_CREATED,\n  then: rule!AIA_MTR_ModelTestSuiteCreated(),\n  /*Model Test Suite Updated*/\n  equals: cons!AIA_MTR_MODEL_TEST_SUITE_UPDATED,\n  then: rule!AIA_MTR_ModelTestSuiteUpdated(),\n  /*Model Test Run Initiated*/\n  equals: cons!AIA_MTR_MODEL_TEST_RUN_INITIATED,\n  then: rule!AIA_MTR_ModelTestRunInitiated(),\n  /*Classification Model Version Created with Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_MODEL_VERSION_CREATED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationModelVersionCreated(),\n  /*Classification Instance Created for a Model Version that Allows Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_INSTANCE_CREATED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationInstanceCreated(),\n  /*Classification Instance Reconciled for a Model Version that Allows Multiple Outputs*/\n  equals: cons!AIA_MTR_MULTIPLE_OUTPUTS_CLASSIFICATION_INSTANCE_RECONCILED,\n  then: rule!AIA_MTR_MultipleOutputsClassificationInstanceReconciled(),\n  default: null\n)"
    },
    "_a-0000eeb2-df20-8000-9bfe-011c48011c48_154565": {
      "name": "AIA_MTR_InstanceValidationAiRuleOccurance",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180846": {
      "name": "AIA_MTR_ClassificationModelCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee5d-151c-8000-9ba8-011c48011c48_33514": {
      "name": "AIA_Extraction_GetInstanceByIdForValidations",
      "type": "Expression Rule",
      "sail_code": "rule!AIA_Extraction_GetInstanceById(\n  identifier: ri!instanceId,\n  additionalFields: {\n    recordType!AIA Extraction Instance.inputTokens,\n    recordType!AIA Extraction Instance.outputTokens,\n    recordType!AIA Extraction Instance.pageCount,\n    recordType!AIA Extraction Instance.responseDocumentId,\n    recordType!AIA Extraction Instance.documentFolderId,\n    recordType!AIA Extraction Instance.modelVersion.useConfidence,\n    recordType!AIA Extraction Instance.modelVersion.confidenceThreshold,\n    recordType!AIA Extraction Instance.modelVersion.fields.useAiReview,\n    recordType!AIA Extraction Instance.modelVersion.fields.useAiReview,\n    recordType!AIA Extraction Instance.modelVersion.aiReviewLlm,\n    recordType!AIA Extraction Instance.modelVersion.aiReviewInstructions,\n    recordType!AIA Extraction Instance.modelVersion.aiReviewRole,\n    recordType!AIA Extraction Instance.modelVersion.useSampling,\n    recordType!AIA Extraction Instance.modelVersion.samplingRate,\n    /*Used for Confidence Validations on Tables*/\n    recordType!AIA Extraction Instance.fields.addedCells,\n    recordType!AIA Extraction Instance.fields.removedCells,\n    recordType!AIA Extraction Instance.fields.overriddenCells\n  }\n)"
    },
    "_a-0000ec67-5f00-8000-9bf0-011c48011c48_126391": {
      "name": "AIA_API_Extraction_ConvertInstanceToMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!fields: rule!AIA_Extraction_GetFieldsForModelVersionId(\n    modelVersionId: ri!ExtractionInstance[recordType!AIA Extraction Instance.modelVersionId]\n  ),\n  local!updates: #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!fields,\n    expression: a!map(\n      key: fv!item[recordType!AIA Extraction Model Version Field.key],\n      value: a!localVariables(\n        local!modelField: fv!item,\n        local!instanceField: displayvalue(\n          fv!item[recordType!AIA Extraction Model Version Field.key],\n          ri!ExtractionInstance[recordType!AIA Extraction Instance.fields][recordType!AIA Extraction Instance Field.modelVersionField.key],\n          ri!ExtractionInstance[recordType!AIA Extraction Instance.fields],\n          null\n        ),\n        if(\n          fv!item[recordType!AIA Extraction Model Version Field.type] = cons!AIA_EXTRACTION_FIELD_TYPE_TABLE,\n          /* Get table field */\n          a!localVariables(\n            local!extractedRows: local!instanceField[recordType!AIA Extraction Instance Field.rows],\n            local!extractedRowsRemoved:index(\n              local!extractedRows,\n              where(#\"SYSTEM_SYSRULES_forEach\"(local!extractedRows, fv!item[recordType!AIA Extraction Instance Field Row.overrideValue] <> \"Removed\")),\n              {}\n            ),\n            #\"SYSTEM_SYSRULES_forEach\"(\n              local!extractedRowsRemoved,\n              a!localVariables(\n                local!row: fv!item,\n                reduce(\n                  #\"urn:appian:function:v1:a:update\"(_, _, _),\n                  a!map(),\n                  merge(\n                    #\"SYSTEM_SYSRULES_forEach\"(\n                      items: local!modelField[recordType!AIA Extraction Model Version Field.columns],\n                      expression: fv!item[recordType!AIA Extraction Model Version Field.key]\n                    ),\n                    #\"SYSTEM_SYSRULES_forEach\"(\n                      items: local!modelField[recordType!AIA Extraction Model Version Field.columns],\n                      expression: a!localVariables(\n                        local!cellField: displayvalue(\n                          fv!item[recordType!AIA Extraction Model Version Field.key],\n                          local!row[recordType!AIA Extraction Instance Field Row.cells.column.key],\n                          local!row[recordType!AIA Extraction Instance Field Row.cells],\n                          null\n                        ),\n                        if(\n                          a!defaultValue(\n                            local!cellField[recordType!AIA Extraction Instance Field Row Cell.overrideNull],\n                            false\n                          ) = true,\n                          null,\n                          rule!AIA_FormatValueForMap(\n                            value: a!defaultValue(\n                              local!cellField[recordType!AIA Extraction Instance Field Row Cell.overrideValue],\n                              local!cellField[recordType!AIA Extraction Instance Field Row Cell.extractedValue]\n                            ),\n                            field: fv!item\n                          )\n                        )\n                      )\n                    )\n                  )\n                ) \n              )\n            )\n          ),\n          /* Get scalar field */\n          if(\n            and(\n              a!isNotNullOrEmpty(local!instanceField[recordType!AIA Extraction Instance Field.overrideNull]),\n              a!defaultValue(\n                local!instanceField[recordType!AIA Extraction Instance Field.overrideNull],\n                false\n              ) = true\n            ),\n            null,\n            rule!AIA_FormatValueForMap(\n              value: a!defaultValue(\n                local!instanceField[recordType!AIA Extraction Instance Field.overrideValue],\n                local!instanceField[recordType!AIA Extraction Instance Field.extractedValue]\n              ),\n              field: fv!item\n            )\n          )\n        )\n      )\n    )\n  ),\n  reduce(\n    rule!AIA_UTIL_UpdateByKeyValue(baseMap: _, updateMap: _),\n    a!map(),\n    local!updates\n  )\n)"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180860": {
      "name": "AIA_MTR_ClassificationInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_85019": {
      "name": "AIA_IsExtractionInstance",
      "type": "Expression Rule",
      "sail_code": "runtimetypeof(\n  ri!Instance\n) = typeof(\n  recordType!AIA Extraction Instance()\n)"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_83881": {
      "name": "AIA_HasCriticalErrors",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!relationship: if(\n    rule!AIA_IsExtractionInstance(Instance: ri!Instance),\n    recordType!AIA Extraction Instance.validations,\n    recordType!AIA Classification Instance.validations\n  ),\n  local!criticalErrors: rule!AIA_UTIL_Filter(\n    records: a!defaultValue(ri!Validations, ri!Instance[local!relationship]),\n    field: recordType!AIA Instance Validation Error.severity,\n    value: cons!AIA_SEVERITY_CRITICAL,\n    filterType: \"FILTER\"\n  ),\n  and(\n    a!isNotNullOrEmpty(\n      local!criticalErrors\n    ),\n    length(\n      local!criticalErrors\n    ) > 0\n  )\n)"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180834": {
      "name": "AIA_MTR_ExtractionModelCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_76945": {
      "name": "AIA_Execution_filterValidationsForClearOnReconciliation",
      "type": "Expression Rule",
      "sail_code": "/*Instance VAlidation Error does not consistently track the source ruleOperationId so filtering by ENUM is not correct*/\n/*Currently all validations clear on reconciliation, so no need for filter*/\n/*a!localVariables(*/\n  /*local!clearOnReconciliationValidations: rule!AIA_UTIL_Filter(*/\n    /*records: rule!AIA_RULE_ENUM_RuleOperations(),*/\n    /*field: \"clearOnReconciliation\",*/\n    /*value: true*/\n  /*),*/\n  /*rule!AIA_UTIL_Filter(*/\n    /*records: ri!Validations,*/\n    /*field: 'recordType!{ad69df9e-7be7-4d3e-bd73-0061082eec6e}AIA Instance Validation Error.fields.{e1dd5a94-3ee6-45e2-b95d-b81774e711f9}typeId',*/\n    /*value: cast(typeof({1,2}),local!clearOnReconciliationValidations.id)*/\n  /*)*/\n/*)*/\n\n\nif(\n  ri!isReconciliation,\n  /*return all validations to be cleared once reconcilied*/\n  ri!Validations,\n  /*on inital validation, do not delete process errors that were created previously*/\n  rule!AIA_UTIL_Filter(\n    records: ri!Validations,\n    field: recordType!AIA Instance Validation Error.typeId,\n    value: cons!AIA_VALIDATION_TYPE_ID_EXECUTION,\n    filterType: \"REJECT\"\n  )\n)"
    },
    "_a-0000ed1d-549f-8000-9c66-011c48011c48_277294": {
      "name": "AIA_MergeJsonTemplate",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!template),\n  null,\n  jsonexpression(\n    json: rule!AIA_ToJson(ri!map),\n    expression: ri!template\n  )\n)"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505631": {
      "name": "AIA_MTR_MultipleOutputsClassificationInstanceCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_267337": {
      "name": "AIA_RULE_ENUM_RuleOperations",
      "type": "Expression Rule",
      "sail_code": "/* Data dictionary \n * id (number) - stored as ruleOperationId in validations column in MODEL_VERSION_VALIDATIONS. Negative numbers indicate rules that are system created, positive numbers for rules types that are added to models through ADD MODEL VALIDATION\n * category (text) - segretates rules for use in different ways. field_config, model_feature, or validation_rule\n * isEnabled (boolean) - if true, this rule is always run for all instances\n * rule (rule reference) - this is the expression to run to evaluate this rule - the input is a single map \n *    - parameters (map)\n *      - instance (record type)\n *      - modelVersionFields (list of Model Version Fields)\n *      - instanceMap (map)\n * displayRule (rule reference) - this is the rule to display this rule at a per validation rule level on the instance errors view\n * summaryRule (rule reference) - this is the rule to display the summary of the aggregations of multiples of these errors\n * postReconciliation (boolean) - if true, this will rerun the rule after reconciliation\n * clearOnReconciliation (booean) \n *    - DEPRECATED: all validations clear once reconcilied so this boolean is not used\n *    - if true, this will delete instances of this error after reconciliation\n * icon (map) - this is the icon to display for the toggle for this rule\n *    - icon (text) - icon to use\n *    - color (text) - color of icon\n *    - label (text) - label for toggle\n * \n*/\n \n\n{\n  a!map(\n    id: -1,\n    category: \"field_config\",\n    isEnabled: true,\n    rule: rule!AIA_RULE_Operation_RequiredFields,\n    displayRule: null,\n    postReconciliation: true,\n    clearOnReconciliation: true\n  ),\n  a!map(\n    id: -2,\n    category: \"field_config\",\n    isEnabled: true,\n    rule: rule!AIA_RULE_Operation_ValidateField,\n    displayRule: null,\n    postReconciliation: true,\n    clearOnReconciliation: true\n  ),\n  a!map(\n    id: -cons!AIA_VALIDATION_TYPE_ID_LOW_CONFIDENCE,\n    category: \"model_feature\",\n    typeId: cons!AIA_VALIDATION_TYPE_ID_LOW_CONFIDENCE,\n    rule: rule!AIA_RULE_Operation_LowConfidence,\n    displayRule: rule!AIA_LowConfidenceDisplayMessage,\n    summaryRule: rule!AIA_LowConfidenceDisplaySummary,\n    isEnabledField: recordType!AIA Extraction Instance.modelVersion.useConfidence,\n    postReconciliation: false,\n    clearOnReconciliation: true,\n    icon:  a!map(\n      icon: \"exclamation-triangle\",\n      label: #\"urn:appian:translation-string:v1:e1babdf7-c62c-4f32-94ac-af5babe6695a\",\n      color: \"Orange3\"\n    )\n  ),\n  a!map(\n    id: -cons!AIA_VALIDATION_TYPE_ID_AI_REVIEW,\n    category: \"model_feature\",\n    isEnabled: false,\n    typeId: cons!AIA_VALIDATION_TYPE_ID_AI_REVIEW,\n    displayRule: rule!AIA_AiReviewDisplayMessage,\n    summaryRule: rule!AIA_AiReviewDisplaySummary,\n    isEnabledField: recordType!AIA Extraction Instance.modelVersion.useAiReview,\n    executionProcess: cons!AIA_PM_EXTRACTION_INSTANCE_AI_REVIEW,\n    postReconciliation: false,\n    clearOnReconciliation: true,\n    icon: a!map(\n      icon: \"magic\",\n      label: #\"urn:appian:translation-string:v1:a67c9f85-f682-4191-bed6-c4912e7d88b4\",\n      color: \"Blue3\"\n    )\n  ),\n  a!map(\n    id: -cons!AIA_VALIDATION_TYPE_ID_EXECUTION,\n    category: \"model_feature\",\n    isEnabled: false,\n    typeId: cons!AIA_VALIDATION_TYPE_ID_EXECUTION,\n    summaryRule: rule!AIA_ExecutionDisplaySummary,\n    displayRule: rule!AIA_ExecutionDisplayMessage,\n    postReconciliation: false,\n    clearOnReconciliation: true\n  ),\n  a!map(\n    id: -cons!AIA_VALIDATION_TYPE_ID_AI_VALIDATION,\n    category: \"validation_rule\",\n    isEnabled: false,\n    typeId: cons!AIA_VALIDATION_TYPE_ID_AI_VALIDATION,\n    parameters: {\n      if(\n        cons!AIA_FLAG_AI_VALIDATION_RULE_SHOW_FLAG_WHEN,\n        /*only show flagWhen radiobutton if feature flag is on*/\n        {\n          id: \"flagWhen\",\n          label: #\"urn:appian:translation-string:v1:de846dfd-706a-492e-a1c9-d1a348ce039f\",\n          instructions: #\"urn:appian:translation-string:v1:7e770d69-fe55-4875-a18c-cd10ee7a0ab8\",\n          type: \"boolean\",\n          required: true\n        },\n        {}\n      ),\n      {\n        id: \"prompt\",\n        label: if(\n          cons!AIA_FLAG_AI_VALIDATION_RULE_SHOW_FLAG_WHEN,\n          #\"urn:appian:translation-string:v1:a31d0f67-35fe-40b0-b9ed-7d660f37d5e6\",\n          #\"urn:appian:translation-string:v1:018010cf-d13e-40d9-b451-fcf9725436f7\"\n        ),\n        type: \"paragraph\",\n        required: true,\n        characterLimit: 4000\n      }\n    },\n    configDisplayRule: rule!AIA_AiValidationRuleConfigDisplay,\n    displayRule: rule!AIA_AiValidationRuleDisplayMessage,\n    summaryRule: rule!AIA_AiValidationRuleDisplaySummary,\n    executionProcess: cons!AIA_PM_EXTRACTION_INSTANCE_AI_VALIDATION_RULE,\n    testExecutionProcess: cons!AIA_PM_AI_VALIDATION_TEST_EXECUTION,\n    testCasePromptGenerationRule: rule!AIA_AiValidationRulePromptInputForTestCaseGeneration,\n    postReconciliation: false,\n    clearOnReconciliation: true,\n    cardChoiceConfig: a!map(\n      icon: \"magic\",\n      primaryText: #\"urn:appian:translation-string:v1:83c0f531-6606-4898-a02d-ceac9946ddaa\",\n      secondaryText: #\"urn:appian:translation-string:v1:992f3303-0dd3-4e32-a943-713f18cfe257\"\n    )\n  ),\n  a!map(\n    id: cons!AIA_VALIDATION_TYPE_ID_EXPRESSION_RULE,\n    category: \"validation_rule\",\n    name: \"Expression Rule\",\n    parameters: {\n      {\n        type: \"columns\",\n        alignVertical: \"MIDDLE\",\n        columns: {\n          {\n            contents: {\n              id: \"rule\",\n              label: \"\",\n              type: \"rulepicker\",\n              required: true\n              \n            },\n            width: \"MEDIUM\"\n          }\n        }\n      }\n    },\n    rule: rule!AIA_RULE_Operation_ExpressionRule,\n    configDisplayRule: rule!AIA_RULE_Operation_ExpressionRuleConfigDisplay,\n    displayRule: rule!AIA_ExpressionRuleDisplayMessage,\n    testCasePromptGenerationRule: rule!AIA_ExpressionRulePromptInputForTestCaseGeneration,\n    postReconciliation: true,\n    clearOnReconciliation: true,\n    cardChoiceConfig: a!map(\n      icon: \"code\",\n      primaryText: #\"urn:appian:translation-string:v1:a807a92f-3079-48ca-929a-d899a8dafee2\",\n      secondaryText: #\"urn:appian:translation-string:v1:2cc88913-646e-4a92-896b-fa2ba61a38f2\"\n    )\n  )\n}/*a!map(*/\n/*id: 3,*/\n/*name: \"Field Comparison\",*/\n/*parameters: {*/\n/*{*/\n/*type: \"columns\",*/\n/*alignVertical: \"MIDDLE\",*/\n/*columns: {*/\n/* LHS Type Selection */\n/*{*/\n/*contents: {*/\n/*id: \"lhsType\",*/\n/*label: \"\",*/\n/*type: \"fieldtype\",*/\n/*hideTypes: {cons!AIA_RULE_INPUT_TYPES[2],cons!AIA_RULE_INPUT_TYPES[3]},*/\n/*required: true,*/\n/*nullifyFieldIdsOnChange: \"lhs\"*/\n/*},*/\n/*width: \"EXTRA_NARROW\"*/\n/*},*/\n/* LHS Field Selection */\n/*{*/\n/*contents: {*/\n/*{*/\n/*id: \"lhs\",*/\n/*label: \"Field\",*/\n/*type: \"modelversionfielddropdown\",*/\n/*returnDataTypeId: true,*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"lhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[1]*/\n/*}*/\n/*},*/\n/*{*/\n/*id: \"lhs\",*/\n/*label: \"Rule\",*/\n/*type: \"rulepicker\",*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"lhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[3]*/\n/*}*/\n/*},*/\n/*{*/\n/*id: \"lhs\",*/\n/*label: \"Expression\",*/\n/*type: \"paragraph\",*/\n/*returnDataTypeId: false,*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"lhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[4]*/\n/*}*/\n/*}*/\n/*},*/\n/*width: \"MEDIUM\"*/\n/*},*/\n/* Operator Selection */\n/*{*/\n/*contents: {*/\n/*id: \"ruleOperator\",*/\n/*label: \"Operator\",*/\n/*type: \"operatordropdown\",*/\n/*required: true*/\n/*},*/\n/*width: \"NARROW\"*/\n/*},*/\n/* RHS Type Selection */\n/*{*/\n/*contents: {*/\n/*id: \"rhsType\",*/\n/*label: \"\",*/\n/*type: \"fieldtype\",*/\n/*required: true,*/\n/*nullifyFieldIdsOnChange: \"rhs\",*/\n/*showWhen: {*/\n/*field: \"ruleOperator\",*/\n/*operator: \"not in\",*/\n/*value: { \"is null\", \"not null\" }*/\n/*},*/\n/*hideTypes: {cons!AIA_RULE_INPUT_TYPES[3]},*/\n/*},*/\n/*width: \"EXTRA_NARROW\"*/\n/*},*/\n/* RHS Field Selection */\n/*{*/\n/*contents: {*/\n/*{*/\n/*id: \"rhs\",*/\n/*label: \"Field\",*/\n/*type: \"modelversionfielddropdown\",*/\n/*returnDataTypeId: false,*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"rhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[1]*/\n/*}*/\n/*},*/\n/*{*/\n/*id: \"rhs\",*/\n/*label: \"Value\",*/\n/*type: \"dynamicdatatype\",*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"rhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[2]*/\n/*}*/\n/*},*/\n/*{*/\n/*id: \"rhs\",*/\n/*label: \"Rule\",*/\n/*type: \"rulepicker\",*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"rhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[3]*/\n/*}*/\n/*},*/\n/*{*/\n/*id: \"rhs\",*/\n/*label: \"Expression\",*/\n/*type: \"paragraph\",*/\n/*returnDataTypeId: false,*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"rhsType\",*/\n/*operator: \"=\",*/\n/*value: cons!AIA_RULE_INPUT_TYPES[4]*/\n/*}*/\n/*}*/\n/*},*/\n/*width: \"MEDIUM\"*/\n/*},*/\n/*}*/\n/*}*/\n/*},*/\n/*rule: rule!AIA_RULE_Operation_CompareTwoValues,*/\n/*displayRule: rule!AIA_RULE_Operation_CompareTwoValuesDisplay*/\n/*),*/\n/*a!map(*/\n/*id: 1,*/\n/*name: \"Examine Fields\",*/\n/*parameters: {*/\n/*{*/\n/*type: \"columns\",*/\n/*alignVertical: \"MIDDLE\",*/\n/*columns: {*/\n/*{*/\n/*contents: {*/\n/*{*/\n/*id: \"fieldKey\",*/\n/*label: \"Field\",*/\n/*type: \"modelversionfielddropdown\",*/\n/*returnDataTypeId: true,*/\n/*required: true,*/\n/*nullifyFieldIdsOnChange: \"value\"*/\n/*},*/\n/*},*/\n/*width: \"MEDIUM\"*/\n/*},*/\n/*{*/\n/*contents: {*/\n/*id: \"ruleOperator\",*/\n/*label: \"Operator\",*/\n/*type: \"operatordropdown\",*/\n/*required: true*/\n/*},*/\n/*width: \"NARROW\"*/\n/*},*/\n/*{*/\n/*contents: {*/\n/*id: \"value\",*/\n/*label: \"Value\",*/\n/*type: \"dynamicdatatype\",*/\n/*required: true,*/\n/*showWhen: {*/\n/*field: \"ruleOperator\",*/\n/*operator: \"not in\",*/\n/*value: { \"is null\", \"not null\" }*/\n/*}*/\n/*},*/\n/*width: \"NARROW\"*/\n/*}*/\n/*}*/\n/*}*/\n/*},*/\n/*rule: rule!AIA_RULE_Operation_ExamineField,*/\n/*displayRule: rule!AIA_RULE_Operation_ExamineFieldDisplay*/\n/*),*/\n/*a!map(*/\n/*id: 2,*/\n/*name: \"Compare Expressions\",*/\n/*parameters: {*/\n/*{*/\n/*type: \"columns\",*/\n/*alignVertical: \"MIDDLE\",*/\n/*columns: {*/\n/*{*/\n/*contents: {*/\n/*id: \"lhs\",*/\n/*label: \"LHS\",*/\n/*type: \"paragraph\",*/\n/*returnDataTypeId: false,*/\n/*required: true*/\n/*},*/\n/*width: \"MEDIUM\",*/\n/*},*/\n/*{*/\n/*contents: {*/\n/*id: \"ruleOperator\",*/\n/*label: \"Operator\",*/\n/*type: \"operatordropdown\",*/\n/*required: true*/\n/*},*/\n/*},*/\n/*{*/\n/*contents: {*/\n/*id: \"rhs\",*/\n/*label: \"RHS\",*/\n/*type: \"paragraph\",*/\n/*returnDataTypeId: false,*/\n/*required: true*/\n/*},*/\n/*width: \"MEDIUM\"*/\n/*}*/\n/*}*/\n/*}*/\n/*},*/\n/*rule: rule!AIA_RULE_Operation_CompareExpressions,*/\n/*displayRule: rule!AIA_RULE_Operation_CompareExpressionsDisplay*/\n/*),*/"
    },
    "_a-0000eec9-5676-8000-9c92-011c48011c48_179352": {
      "name": "AIA_MTR_ConfidenceThresholdEnabled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eea3-15ee-8000-9bd4-011c48011c48_137447": {
      "name": "AIA_MTR_ModelVersionConfigureSampling",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_272710": {
      "name": "AIA_RULE_ENUM_Severity",
      "type": "Expression Rule",
      "sail_code": "{\n  a!map(\n    value: cons!AIA_SEVERITY_CRITICAL,\n    label: #\"urn:appian:translation-string:v1:0fdbc5bf-53b5-4561-bfbd-b271cac50c35\",\n    icon: \"fire-alt\",\n    color: \"Red4\"\n  ),\n  a!map(\n    value: cons!AIA_SEVERITY_HIGH,\n    label: #\"urn:appian:translation-string:v1:e0e17633-3db4-46cb-ad07-96b5d97b3e8c\",\n    icon: \"angle-double-up-bold\",\n    color: \"Orange4\"\n  ),\n  a!map(\n    value: cons!AIA_SEVERITY_MEDIUM,\n    label: #\"urn:appian:translation-string:v1:1c3e003d-2666-41cd-844f-3278b6e69a82\",\n    icon: \"circle-o\",\n    color: \"Yellow4\"\n  ),\n  a!map(\n    value: cons!AIA_SEVERITY_LOW,\n    label: #\"urn:appian:translation-string:v1:2b0d9f01-f232-478f-bd9c-89f7158ed854\",\n    icon: \"angle-double-down\",\n    color: \"Green4\"\n  )\n}"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_85540": {
      "name": "AIA_SetValidationErrorSummary",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!fields: if(\n    rule!AIA_IsExtractionInstance(Instance: ri!Instance),\n    a!map(\n      statusId: recordType!AIA Extraction Instance.statusId,\n      validationErrors: recordType!AIA Extraction Instance.validationErrors,\n      isSpotCheckRequired: recordType!AIA Extraction Instance.isSamplingRequired,\n      wasStp: recordType!AIA Extraction Instance.wasStp,\n      completeStatus: cons!AIA_INSTANCE_STATUS_EXTRACTED,\n      warnStatus: cons!AIA_INSTANCE_STATUS_EXTRACTED_WITH_ERRORS,\n      warnMetric: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTED_WITH_ERRORS,\n      errorStatus: cons!AIA_INSTANCE_STATUS_INSTANCE_ERROR,\n      errorMetric: cons!AIA_MTR_INSTANCE_STATUS_EXTRACTION_CRITICAL_ERROR,\n      useSampling: recordType!AIA Extraction Instance.modelVersion.useSampling,\n      samplingRate: recordType!AIA Extraction Instance.modelVersion.samplingRate\n    ),\n    a!map(\n      statusId: recordType!AIA Classification Instance.statusId,\n      validationErrors: recordType!AIA Classification Instance.validationErrors,\n      isSpotCheckRequired: recordType!AIA Classification Instance.isSamplingRequired,\n      wasStp: recordType!AIA Classification Instance.wasStp,\n      completeStatus: cons!AIA_INSTANCE_STATUS_CLASSIFIED,\n      warnStatus: cons!AIA_INSTANCE_STATUS_CLASSIFIED_WITH_ERRORS,\n      warnMetric: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFIED_WITH_ERRORS,\n      errorStatus: cons!AIA_INSTANCE_STATUS_INSTANCE_ERROR,\n      errorMetric: cons!AIA_MTR_INSTANCE_STATUS_CLASSIFICATION_CRITICAL_ERROR,\n      useSampling: recordType!AIA Classification Instance.modelVersion.useSampling,\n      samplingRate: recordType!AIA Classification Instance.modelVersion.samplingRate\n    )\n  ),\n  local!statusUpdated: if(\n    ri!isReconciliation,\n    ri!Instance[local!fields.statusId],\n    a!match(\n      value: ri!Instance[local!fields.statusId],\n      /* If critical errors, set to 'Instance Error' */\n      whenTrue: rule!AIA_HasCriticalErrors(Instance: ri!Instance, Validations: ri!Validations),\n      then: a!localVariables(\n        local!metric: rule!AIA_LogMetric(\n          name: local!fields.errorMetric\n        ),\n        local!fields.errorStatus\n      ),\n      /* If not reconciled and has errors set to 'Extracted/Classified with Errors' */\n      whenTrue: and(\n        not(contains(\n          cons!AIA_INSTANCE_STATUS_RECONCILED_ALL,\n          tointeger(ri!Instance[local!fields.statusId])\n        )),\n        length(ri!Validations) > 0\n      ),\n      then:  a!localVariables(\n        local!metric: rule!AIA_LogMetric(\n          name: local!fields.warnMetric\n        ),\n        local!fields.warnStatus\n      ),\n      /* Leave as is */\n      default: ri!Instance[local!fields.statusId]\n    )\n  ),\n  #\"urn:appian:function:v1:a:update\"(\n    ri!Instance,\n    {\n      local!fields.statusId,\n      local!fields.validationErrors,\n      local!fields.isSpotCheckRequired,\n      local!fields.wasStp\n    },\n    {\n      /*statusId*/\n      local!statusUpdated,\n      /*validationErrors*/\n      rule!AIA_ToJson(\n        reduce(\n          #\"urn:appian:function:v1:a:update\",\n          a!map(),\n          merge(\n            a!flatten(\n              {\n                touniformstring(\n                  rule!AIA_RULE_ENUM_Severity().value\n                ),\n                \"total\"\n              }\n            ),\n            a!flatten(\n              {\n                #\"SYSTEM_SYSRULES_forEach\"(\n                  rule!AIA_RULE_ENUM_Severity().value,\n                  length(\n                    wherecontains(\n                      tointeger(\n                        fv!item\n                      ),\n                      tointeger(\n                        ri!Validations[recordType!AIA Instance Validation Error.severity]\n                      )\n                    )\n                  )\n                ),\n                length(\n                  ri!Validations\n                )\n              }\n            )\n          )\n        )\n      ),\n      /*isSpotCheckRequired*/\n      a!match(\n        value: local!statusUpdated,\n        /*manually reconcilid status is shared between both model types so just use constant here*/\n        equals: cons!AIA_INSTANCE_STATUS_RECONCILED_MANUALLY,\n        then: false(),\n        /*alwasy remove flag on reconciliation*/\n        whenTrue: ri!isReconciliation,\n        then: false(),\n        /*if completed with no errors and sampling configured, flag based on rate percentage*/\n        whenTrue: and(\n          fv!value = local!fields.completeStatus,\n          toboolean(ri!Instance[local!fields.useSampling]) = true,\n          a!isNotNullOrEmpty(ri!Instance[local!fields.samplingRate])\n        ),\n        then: rule!AIA_RandomBoolean(percentTrue: ri!Instance[local!fields.samplingRate]),\n        default: ri!Instance[local!fields.isSpotCheckRequired]\n      ),\n      /*wasStp - must set post validations to see if any errors arose after inital extraction*/\n      a!match(\n        value: local!statusUpdated,\n        /*if instance is in pure complete status, set wasSTP to true for future tracking*/\n        equals: local!fields.completeStatus,\n        then: true(),\n        /*else leave alone, never want to flip this back to false*/\n        default: ri!Instance[local!fields.wasStp]\n      )\n    }\n  )\n)"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_84705": {
      "name": "AIA_Extraction_InstanceUuid",
      "type": "Expression Rule",
      "sail_code": "a!defaultValue(\n  ri!ExtractionInstance[recordType!AIA Extraction Instance.instanceUuid],\n  cons!AIA_MODEL_TYPE_VALUES[1] & \"-\" & ri!ExtractionInstance[recordType!AIA Extraction Instance.id]\n)"
    },
    "_a-0000ec5c-9eda-8000-9bec-011c48011c48_117023": {
      "name": "AIA_Extraction_GetModelVersionById",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n  recordType: recordType!AIA Extraction Model Version,\n  fields: {\n    rule!AIA_EXTRACTION_MODEL_VERSION_FIELDS()\n  },\n  relatedRecordData: {\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AIA Extraction Model Version.fields,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Extraction Model Version Field.order,\n        ascending: true\n      )\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AIA Extraction Model Version.fields,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Extraction Model Version Field.order,\n        ascending: true\n      )\n    )\n  },\n  identifier: ri!identifier\n)"
    },
    "_a-0000eeca-c121-8000-9cab-011c48011c48_181995": {
      "name": "AIA_MTR_ExtractionModelVersionRestore",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee3d-1f5c-8000-9ba4-011c48011c48_14346": {
      "name": "AIA_FormatValueForMap",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!field[recordType!AIA Extraction Model Version Field.type],\n  whenTrue: contains(\n    index(cons!AIA_EXTRACTION_FIELD_TYPES, {4,5}),\n    fv!value\n  ),\n  then: rule!AIA_ConvertIsoToDate(\n    value: ri!value\n  ),\n  default: ri!value\n)"
    },
    "_a-0000ecf1-11b9-8000-9c4e-011c48011c48_203145": {
      "name": "AIA_EXTRACTION_MODEL_VERSION_FIELDS",
      "type": "Expression Rule",
      "sail_code": "{\n  /* Base */\n  recordType!AIA Extraction Model Version.status,\n  recordType!AIA Extraction Model Version.updates,\n  recordType!AIA Extraction Model Version.role,\n  recordType!AIA Extraction Model Version.instructions,\n  recordType!AIA Extraction Model Version.modelId,\n  recordType!AIA Extraction Model Version.versionId,\n  recordType!AIA Extraction Model Version.llm,\n  recordType!AIA Extraction Model Version.useAiReview,\n  recordType!AIA Extraction Model Version.aiReviewLlm,\n  recordType!AIA Extraction Model Version.aiReviewRole,\n  recordType!AIA Extraction Model Version.aiReviewInstructions,\n  recordType!AIA Extraction Model Version.useConfidence,\n  recordType!AIA Extraction Model Version.confidenceThreshold,\n  recordType!AIA Extraction Model Version.useSampling,\n  recordType!AIA Extraction Model Version.samplingRate,\n  recordType!AIA Extraction Model Version.instanceCount,\n  /* Fields */\n  recordType!AIA Extraction Model Version.fields.sectionId,\n  recordType!AIA Extraction Model Version.fields.section,\n  recordType!AIA Extraction Model Version.fields.order,\n  recordType!AIA Extraction Model Version.fields.key,\n  recordType!AIA Extraction Model Version.fields.label,\n  recordType!AIA Extraction Model Version.fields.type,\n  recordType!AIA Extraction Model Version.fields.isMultiple,\n  recordType!AIA Extraction Model Version.fields.description,\n  recordType!AIA Extraction Model Version.fields.instructions,\n  recordType!AIA Extraction Model Version.fields.extractionType,\n  recordType!AIA Extraction Model Version.fields.optionRule,\n  recordType!AIA Extraction Model Version.fields.validationRule,\n  recordType!AIA Extraction Model Version.fields.extractionRule,\n  recordType!AIA Extraction Model Version.fields.postProcessRule,\n  recordType!AIA Extraction Model Version.fields.required,\n  recordType!AIA Extraction Model Version.fields.useVision,\n  recordType!AIA Extraction Model Version.fields.isHidden,\n  recordType!AIA Extraction Model Version.fields.isNotTracked,\n  recordType!AIA Extraction Model Version.fields.useAiReview,\n  /* Columns */\n  recordType!AIA Extraction Model Version.fields.columns.order,\n  recordType!AIA Extraction Model Version.fields.columns.key,\n  recordType!AIA Extraction Model Version.fields.columns.label,\n  recordType!AIA Extraction Model Version.fields.columns.type,\n  recordType!AIA Extraction Model Version.fields.columns.isMultiple,\n  recordType!AIA Extraction Model Version.fields.columns.isHidden,\n  recordType!AIA Extraction Model Version.fields.columns.isNotTracked,\n  recordType!AIA Extraction Model Version.fields.columns.description,\n  recordType!AIA Extraction Model Version.fields.columns.instructions,\n  recordType!AIA Extraction Model Version.fields.columns.extractionType,\n  recordType!AIA Extraction Model Version.fields.columns.optionRule,\n  recordType!AIA Extraction Model Version.fields.columns.validationRule,\n  recordType!AIA Extraction Model Version.fields.columns.extractionRule,\n  recordType!AIA Extraction Model Version.fields.columns.postProcessRule,\n  recordType!AIA Extraction Model Version.fields.columns.required,\n  /* Examples */\n  recordType!AIA Extraction Model Version.examples,\n  /* Sections */\n  recordType!AIA Extraction Model Version.sections.name,\n  recordType!AIA Extraction Model Version.sections.description,\n  recordType!AIA Extraction Model Version.sections.rule,\n  /* Validation Rules */\n  recordType!AIA Extraction Model Version.validationRules.name,\n  recordType!AIA Extraction Model Version.validationRules.message,\n  recordType!AIA Extraction Model Version.validationRules.severity,\n  recordType!AIA Extraction Model Version.validationRules.validations,\n  /* Extraction Model */\n  recordType!AIA Extraction Model Version.extractionModel,\n}"
    },
    "_a-0000eea3-15ee-8000-9bd4-011c48011c48_138569": {
      "name": "AIA_RandomBoolean",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!probability: ri!percentTrue / 100,\n  rand() < local!probability\n)"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180874": {
      "name": "AIA_MTR_ClassificationInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ecf1-11b9-8000-9c4e-011c48011c48_199422": {
      "name": "AIA_Test_GetLatestExtractionInstanceWithFields",
      "type": "Expression Rule",
      "sail_code": "rule!AIA_Extraction_GetInstanceById(\n  identifier: #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n    recordType: recordType!AIA Extraction Instance,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 1,\n      sort: {\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AIA Extraction Instance.id\n        )\n      }\n    )\n  ).data[recordType!AIA Extraction Instance.id],\n  additionalFields: {\n    recordType!AIA Extraction Instance.inputDocumentId,\n    recordType!AIA Extraction Instance.documentFolderId,\n    recordType!AIA Extraction Instance.modelVersion,\n    recordType!AIA Extraction Instance.modelVersion.confidenceThreshold,\n    recordType!AIA Extraction Instance.modelVersion,\n    recordType!AIA Extraction Instance.modelVersion,\n  }\n)"
    },
    "0002ed18-12f4-8000-0b79-7f0000014e7a": {
      "name": "AIA Extraction Instance Run Validations",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=pv!Validations\n\n// Input: ?\n=recordType!AIA Instance Validation Error\n\n// Output: ?\nAC!RecordsUpdated\n\n// Output: ?\na!defaultValue(\n  pv!ExtractionInstance,\n  rule!AIA_Extraction_GetInstanceByIdForValidations(\n    instanceId: pv!instanceId\n  )\n)\n\n// Output: ?\nrule!AIA_GetValidationsForInstance(\n  Instance: pv!ExtractionInstance\n)\n\n// Output: ?\nrule!AIA_RULE_ExecuteRules(\n  Instance: pv!ExtractionInstance,\n  isReconciliation: pv!isReconciliation\n)\n\n// Input: ?\n={\n  rule!AIA_SetValidationErrorSummary(\n    Instance: pv!ExtractionInstance,\n    Validations: pv!Validations,\n    isReconciliation: pv!isReconciliation\n  )\n}\n\n// Input: ?\n={recordType!AIA Extraction Instance}\n\n// Input: ?\nif(\n  length(pv!Validations) > 0,\n  cons!AIA_INSTANCE_EVENT_TYPE_NEEDS_REVIEW,\n  cons!AIA_INSTANCE_EVENT_TYPE_AUTOMATED\n)\n\n// Input: ?\npp!initiator\n\n// Input: ?\nnow()\n\n// Input: ?\na!automationId(\"AI\")\n\n// Output: ?\nAC!RecordsUpdated\n\n// Input: ?\n=rule!AIA_Extraction_GetValidationsForModelVersion( instance: pv!ExtractionInstance, isReconciliation: pv!isReconciliation)\n\n// Output: ?\nrule!AIA_filterValidationRulesForProcessExecution(validationRules: ac!validationRules)\n\n// Output: ?\nrule!AIA_Extraction_GetModelVersionById(\n  identifier: pv!ExtractionInstance[recordType!AIA Extraction Instance.modelVersionId]\n)\n\n// Output: ?\na!defaultValue(\n  value: pv!executionProcessIndex,\n  default: 0\n) + 1\n\n// Input: ?\nrule!AIA_returnRuleOperationForValidationRule(\n  validationRule: pv!validationRulesWithExecutionProcess[pv!executionProcessIndex]\n).executionProcess\n\n// Input: ?\n=pv!ExtractionInstance\n\n// Input: ?\n=pv!modelVersion\n\n// Input: ?\n=pv!validationRulesWithExecutionProcess[pv!executionProcessIndex]\n\n// Output: ?\nac!ProcessInfo.pv.ExtractionInstance\n\n// Output: ?\n{\n  pv!Validations,\n  ac!ProcessInfo.pv.validations\n}\n\n// Input: ?\n= rule!AIA_Execution_filterValidationsForClearOnReconciliation( Validations: pv!Validations, isReconciliation: pv!isReconciliation)\n\n// Output: ?\nnull"
    },
    "_a-0000ee21-294f-8000-9bb6-011c48011c48_180867": {
      "name": "AIA_MTR_ExtractionInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92474": {
      "name": "AIA_MTR_ClassificationInstanceError",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ec2d-5396-8000-9bdc-011c48011c48_40839": {
      "name": "AIA_Test_GetLatestExtractionInstance",
      "type": "Expression Rule",
      "sail_code": "rule!AIA_Extraction_GetInstanceById(\n  identifier: #\"SYSTEM_SYSRULES_queryRecordType_v3\"(\n    recordType: recordType!AIA Extraction Instance,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 1,\n      sort: {\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AIA Extraction Instance.id\n        )\n      }\n    )\n  ).data[recordType!AIA Extraction Instance.id],\n  additionalFields: {\n    recordType!AIA Extraction Instance.instanceUuid,\n    recordType!AIA Extraction Instance.modelVersion.versionId,\n    recordType!AIA Extraction Instance.modelVersion.modelId,\n    recordType!AIA Extraction Instance.modelVersion.uuid,\n    recordType!AIA Extraction Instance.modelVersion.extractionModel.key,\n    recordType!AIA Extraction Instance.documentFolderId,\n    recordType!AIA Extraction Instance.fieldCount,\n    recordType!AIA Extraction Instance.sections,\n    recordType!AIA Extraction Instance.boundingBoxes,\n    recordType!AIA Extraction Instance.responseDocumentId,\n    recordType!AIA Extraction Instance.sourceDocumentId\n  }\n)"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_269084": {
      "name": "AIA_GetValidationsForInstance",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordType_v3\"(\n  recordType: recordType!AIA Instance Validation Error,\n  fields: {\n    recordType!AIA Instance Validation Error.typeId,\n    recordType!AIA Instance Validation Error.errorType.name,\n    recordType!AIA Instance Validation Error.modelVersionValidation.validations,\n    recordType!AIA Instance Validation Error.instanceField.modelVersionField.label,\n    recordType!AIA Instance Validation Error.instanceField.modelVersionField.key,\n    recordType!AIA Instance Validation Error.severity,\n    recordType!AIA Instance Validation Error.message,\n    recordType!AIA Instance Validation Error.messageDocId,\n    recordType!AIA Instance Validation Error.isAccepted,\n    recordType!AIA Instance Validation Error.isIgnored\n  },\n  filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n    operator: \"AND\",\n    filters: {\n      #\"SYSTEM_SYSRULES_queryFilter\"(\n        field: recordType!AIA Instance Validation Error.instanceUuid,\n        operator: \"=\",\n        value: if(\n          rule!AIA_IsExtractionInstance(instance: ri!Instance),\n          rule!AIA_Extraction_InstanceUuid(\n            ExtractionInstance: ri!Instance\n          ),\n          rule!AIA_Classification_InstanceUuid(\n            ClassificationInstance: ri!Instance\n          )\n        )\n      )\n    }\n  ),\n  pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n    startIndex: 1,\n    batchSize: 1000,\n    sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!AIA Instance Validation Error.severity,\n      ascending: false\n    )\n  )\n).data"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92481": {
      "name": "AIA_MTR_ExtractionInstanceExtractedWithErrors",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000eeac-580c-8000-9be9-011c48011c48_148282": {
      "name": "AIA_returnRuleOperationForValidationRule",
      "type": "Expression Rule",
      "sail_code": "cast(\n  typeof(a!map()),\n  if(\n    a!isNullOrEmpty(ri!validationRule[recordType!AIA Extraction Model Version Validation Rule.validations]),\n    null,\n    displayvalue(\n      #\"SYSTEM_SYSRULES_fromJson_v1\"(ri!validationRule[recordType!AIA Extraction Model Version Validation Rule.validations]).ruleOperationId,\n      rule!AIA_RULE_ENUM_RuleOperations().id,\n      rule!AIA_RULE_ENUM_RuleOperations(),\n      null\n    )\n  )\n)"
    },
    "_a-0000ee3d-1f5c-8000-9ba4-011c48011c48_14361": {
      "name": "AIA_ConvertIsoToDate",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_fromJson_v1\"(\n  \"{\"\"a\"\":\"\"\" & ri!value & \"\"\"}\"\n).a"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_274759": {
      "name": "AIA_ToJson",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!data),\n  \"null\",\n  #\"SYSTEM_SYSRULES_toJson_v1\"(ri!data)\n)"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_26889": {
      "name": "AIA_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: a!flatten(ri!field),\n      expression: a!map(\n        field: fv!item,\n        value: if(\n          fv!itemCount = 1,\n          ri!value,\n          index(a!flatten(ri!value), fv!index, null)\n        )\n      )\n    )\n  ),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!AIA_UTIL_Filter_Reducer(\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _\n      ),\n      enumerate(count(a!flatten(ri!records))) + 1,\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  )\n)"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505670": {
      "name": "AIA_MTR_MultipleOutputsClassificationInstanceReconciled",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ef55-14e0-8000-a041-011c48011c48_505575": {
      "name": "AIA_MTR_MultipleOutputsClassificationModelVersionCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee6e-3b90-8000-9bac-011c48011c48_85064": {
      "name": "AIA_Classification_InstanceUuid",
      "type": "Expression Rule",
      "sail_code": "a!defaultValue(\n  ri!ClassificationInstance[recordType!AIA Classification Instance.instanceUuid],\n  cons!AIA_MODEL_TYPE_VALUES[2] & \"-\" & ri!ClassificationInstance[recordType!AIA Classification Instance.id]\n)"
    },
    "_a-0000ef46-744c-8000-9fed-011c48011c48_483943": {
      "name": "AIA_MTR_ModelTestSuiteCreated",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92571": {
      "name": "AIA_MTR_ExtractionInstanceAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ec1e-9975-8000-9bd6-011c48011c48_1381838": {
      "name": "AIA_Extraction_GetFieldsForModelVersionId",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_queryRecordByIdentifier\"(\n  recordType: recordType!AIA Extraction Model Version,\n  identifier: ri!modelVersionId,\n  fields: a!flatten(\n    {\n      recordType!AIA Extraction Model Version.modelVersionId,\n  \n      /* Fields */\n      recordType!AIA Extraction Model Version.fields.sectionId,\n      recordType!AIA Extraction Model Version.fields.section,\n      recordType!AIA Extraction Model Version.fields.order,\n      recordType!AIA Extraction Model Version.fields.key,\n      recordType!AIA Extraction Model Version.fields.label,\n      recordType!AIA Extraction Model Version.fields.type,\n      recordType!AIA Extraction Model Version.fields.isMultiple,\n      recordType!AIA Extraction Model Version.fields.description,\n      recordType!AIA Extraction Model Version.fields.instructions,\n      recordType!AIA Extraction Model Version.fields.extractionType,\n      recordType!AIA Extraction Model Version.fields.optionRule,\n      recordType!AIA Extraction Model Version.fields.validationRule,\n      recordType!AIA Extraction Model Version.fields.extractionRule,\n      recordType!AIA Extraction Model Version.fields.postProcessRule,\n      recordType!AIA Extraction Model Version.fields.required,\n      recordType!AIA Extraction Model Version.fields.useVision,\n      recordType!AIA Extraction Model Version.fields.isHidden,\n      recordType!AIA Extraction Model Version.fields.isNotTracked,\n      recordType!AIA Extraction Model Version.fields.useAiReview,\n  \n      /* Fields > Column */\n      recordType!AIA Extraction Model Version.fields.columns.fieldId,\n      recordType!AIA Extraction Model Version.fields.columns.label,\n      recordType!AIA Extraction Model Version.fields.columns.key,\n      recordType!AIA Extraction Model Version.fields.columns.optionRule,\n      recordType!AIA Extraction Model Version.fields.columns.validationRule,\n      recordType!AIA Extraction Model Version.fields.columns.postProcessRule,\n      recordType!AIA Extraction Model Version.fields.columns.isHidden,\n      recordType!AIA Extraction Model Version.fields.columns.isNotTracked,\n      recordType!AIA Extraction Model Version.fields.columns.type,\n      recordType!AIA Extraction Model Version.fields.columns.extractionType,\n      recordType!AIA Extraction Model Version.fields.columns.required,\n      recordType!AIA Extraction Model Version.fields.columns.description,\n      recordType!AIA Extraction Model Version.fields.columns.instructions,\n      recordType!AIA Extraction Model Version.fields.columns.accuracy,\n      a!defaultValue(ri!additionalFields, {})\n    },\n  ),\n  relatedRecordData: {\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AIA Extraction Model Version.fields,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Extraction Model Version Field.order,\n        ascending: true\n      )\n    ),\n    #\"SYSTEM_SYSRULES_relatedRecordData\"(\n      relationship: recordType!AIA Extraction Model Version.fields,\n      sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n        field: recordType!AIA Extraction Model Version Field.order,\n        ascending: true\n      )\n    )\n  }\n)[recordType!AIA Extraction Model Version.fields]"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_268545": {
      "name": "AIA_RULE_ExecuteRules",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!instance: if(\n    and(\n      a!isNullOrEmpty(ri!Instance),\n      a!isNotNullOrEmpty(ri!instanceId)\n    ),\n    rule!AIA_Extraction_GetInstanceById(identifier: ri!instanceId),\n    ri!Instance\n  ),\n  local!instanceMap: rule!AIA_API_Extraction_ConvertInstanceToMap(\n    ExtractionInstance: local!instance\n  ),\n  local!modelVersionFields: rule!AIA_Extraction_GetFieldsForModelVersionId(\n    modelVersionId: local!instance[recordType!AIA Extraction Instance.modelVersionId]\n  ),\n  /*Obtain relevant Validation Rules*/\n  local!rules: rule!AIA_Extraction_GetValidationsForModelVersion(\n    instance: local!instance,\n    isReconciliation: ri!isReconciliation\n  ),\n  /*Query available Rule Operations*/\n  local!ruleOperations: rule!AIA_RULE_ENUM_RuleOperations(),\n  reject(\n    fn!isnull,\n    a!flatten(\n      {\n        /* Validation Rule Framework rules */\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: local!rules,\n          expression: rule!AIA_RULE_RunValidationRule(\n            rule: fv!item,\n            Instance: local!instance,\n            instanceMap: local!instanceMap,\n            modelVersionFields: local!modelVersionFields,\n            ruleOperations: local!ruleOperations\n          )\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000ec2d-5396-8000-9bdc-011c48011c48_40909": {
      "name": "AIA_ExtractJson",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!firstTry: rule!AIA_ExtractJsonInner(\n    json: ri!json\n  ),\n  local!result: if(\n    a!isNotNullOrEmpty(local!firstTry),\n    local!firstTry,\n    a!localVariables(\n      local!secondTry: rule!AIA_ExtractJsonInner(\n        json: index(split(ri!json, \"Appian's private AI\"), 1, null),\n      ),\n      if(\n        a!isNotNullOrEmpty(local!secondTry),\n        local!secondTry,\n        a!localVariables(\n          local!thirdTry: rule!AIA_ExtractJsonInner(\n            json: index(split(ri!json, \"Appian's private AI\"), 2, null),\n          ),\n          if(\n            a!isNotNullOrEmpty(local!thirdTry),\n            local!thirdTry,\n            a!localVariables(\n              local!forthTry: rule!AIA_ExtractJsonInner(\n                json: index(split(ri!json, \"<output>\"), 1, null),\n              ),\n              if(\n                a!isNotNullOrEmpty(local!forthTry),\n                local!forthTry,\n                a!localVariables(\n                  local!fifthTry: rule!AIA_ExtractJsonInner(\n                    json: index(split(ri!json, \"</entities>\"), 1, null),\n                  ),\n                  local!fifthTry\n                )\n              )\n            )\n          )\n        )\n      )\n    )\n  ),\n  local!finalResult: if(\n    a!isNullOrEmpty(local!result),\n    null,\n    if(\n      a!defaultValue(ri!returnList, true),\n      local!result,\n      if(\n        rule!SHRD_IsList(local!result),\n        null,\n        local!result\n      )\n    )\n  ),\n  /* Handle scenario where the result comes back as properties of a $schema */\n  if(\n    or(\n      a!defaultValue(ri!returnList, true),\n      a!isNullOrEmpty(local!finalResult),\n      not(contains(\n        a!keys(local!finalResult),\n        \"$schema\"\n      ))\n    ),\n    local!finalResult,\n    local!finalResult.properties\n  )\n)"
    },
    "_a-0000ed16-a792-8000-9c64-011c48011c48_268731": {
      "name": "AIA_Extraction_GetValidationsForModelVersion",
      "type": "Expression Rule",
      "sail_code": "a!flatten(\n  {\n    #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n      recordType: recordType!AIA Extraction Model Version Validation Rule,\n      filters: {\n        #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!AIA Extraction Model Version Validation Rule.modelVersionId,\n          operator: \"=\",\n          value: ri!instance[recordType!AIA Extraction Instance.modelVersionId]\n        )\n      },\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(1, 100)\n    ).data,\n    a!localVariables(\n      local!rules: reject(\n        fn!isnull,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          rule!AIA_RULE_ENUM_RuleOperations(),\n          if(\n            and(\n              /* Rule defaults to true, or defaultField is true */\n              or(\n                a!defaultValue(fv!item.isEnabled, false),\n                and(\n                  a!isNotNullOrEmpty(fv!item.isEnabledField),\n                  a!defaultValue(\n                    value: index(ri!instance, fv!item.isEnabledField, false),\n                    default: false\n                  )\n                )\n              ),\n              /* Either not a reconciliation or if reconciliation, rule is configured to run post reconciliation */\n              or(\n                not(a!defaultValue(ri!isReconciliation, false)),\n                a!defaultValue(fv!item.postReconciliation, false)\n              )\n            ),\n            fv!item,\n            null\n          )\n        )\n      ),\n      #\"SYSTEM_SYSRULES_forEach\"(\n        local!rules,\n        recordType!AIA Extraction Model Version Validation Rule(\n          recordType!AIA Extraction Model Version Validation Rule.validations: rule!AIA_ToJson(data: a!map(ruleOperationId: fv!item.id))\n        )\n      )\n    )\n  }\n)"
    },
    "_a-0000ee78-c4db-8000-9bae-011c48011c48_92564": {
      "name": "AIA_MTR_ExtractionInstanceFieldAiReview",
      "type": "Expression Rule",
      "sail_code": "now()"
    }
  }
}
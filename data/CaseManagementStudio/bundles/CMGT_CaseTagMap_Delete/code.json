{
  "_metadata": {
    "bundle_id": "CMGT_CaseTagMap_Delete"
  },
  "objects": {
    "_a-0000ea2f-ac11-8000-9bf4-011c48011c48_592097": {
      "name": "CMGT_Case_SetEvents",
      "type": "Expression Rule",
      "sail_code": "/*Only one not listed is tasks because they have separate sub processes that include audit capture*/\n#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!cases,\n  expression: #\"urn:appian:function:v1:a:update\"(\n    fv!item,\n    recordType!CMGT_Case.eventHistory,\n    a!flatten(\n      {\n        /*EVENTS THAT ARE PROCESS-SPECIFIC (based on \"eventType\" input)*/\n        a!match(\n          value: ri!eventType,\n          equals: \"CREATE\",\n          equals: \"UPDATE\",\n          then: rule!CMGT_CaseEventHistory_Constructor(\n            caseId: fv!item[recordType!CMGT_Case.caseId],\n            initiator: ri!initiator,\n            eventTypeId: if(\n              fv!value = \"CREATE\",\n              cons!CMGT_REFID_EVENT_TYPE_CASE_CREATE,\n              cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE\n            )\n          ),\n          equals: \"UPDATE_PROPERTY\",\n          then: rule!CMGT_Case_UpdateProperty_SetEvents(cases: fv!item, initiator: ri!initiator),\n          equals: \"MODIFY_WORKFLOW\",\n          then: rule!CMGT_CaseEventHistory_Constructor(\n            caseId: fv!item[recordType!CMGT_Case.caseId],\n            initiator: ri!initiator,\n            eventTypeId: cons!CMGT_REFID_EVENT_TYPE_MODIFY_WORKFLOW\n          ),\n          default: {}\n        ),\n        /*EVENTS THAT ARE NON-PROCESS-SPECIFIC (based on \"what children are populated\")*/\n        /* - Roles*/\n        rule!CMGT_Role_SetEvents(\n          roles: fv!item[recordType!CMGT_Case.roles],\n          initiator: ri!initiator,\n          context: \"CASE\"\n        ),\n        /* - Comments*/\n        rule!CMGT_Comment_SetEvents(\n          comments: fv!item[recordType!CMGT_Case.comments],\n          initiator: ri!initiator,\n          context: \"CASE\"\n        ),\n        /* - Documents*/\n        if(\n          rule!CMGT_UTIL_IsBlank(\n            fv!item[recordType!CMGT_Case.documents]\n          ),\n          {},\n          rule!CMGT_Document_SetEvents(\n            documents: fv!item[recordType!CMGT_Case.documents],\n            initiator: ri!initiator\n          )\n        ),\n        /* - Tags*/\n        if(\n          rule!CMGT_UTIL_IsBlank(\n            fv!item[recordType!CMGT_Case.tagMap]\n          ),\n          {},\n          #\"SYSTEM_SYSRULES_forEach\"(\n            items: fv!item[recordType!CMGT_Case.tagMap],\n            expression: rule!CMGT_CaseEventHistory_Constructor(\n              caseId: fv!item[recordType!CMGT_CaseTagMap.caseId],\n              initiator: ri!initiator,\n              eventTypeId: if(\n                fv!item[recordType!CMGT_CaseTagMap.isActive],\n                cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_TAG,\n                cons!CMGT_REFID_EVENT_TYPE_CASE_REMOVE_TAG\n              ),\n              details: a!map(\n                tagId: fv!item[recordType!CMGT_CaseTagMap.tagId]\n              )\n            )\n          )\n        ),\n      /* - Related Cases*/\n        if(\n          rule!CMGT_UTIL_IsBlank(\n            fv!item[recordType!CMGT_Case.relatedCaseMap]\n          ),\n          {},\n          rule!CMGT_RelatedCaseMap_SetEvents(\n            relatedCaseMaps: fv!item[recordType!CMGT_Case.relatedCaseMap],\n            initiator: rule!CMGT_formatEventInitiator(\n              initiator: ri!initiator\n            )\n          )\n          ),\n          /* - Case Entity Map*/\n          if(\n            rule!CMGT_UTIL_IsBlank(\n              fv!item[recordType!CMGT_Case.caseEntityMap]\n            ),\n            {},\n            rule!CMGT_CaseEntityMap_SetEvents(\n              caseEntityMaps: fv!item[recordType!CMGT_Case.caseEntityMap],\n              initiator: rule!CMGT_formatEventInitiator(\n                initiator: ri!initiator\n              ),\n              context: \"CASE\"\n            )\n          )\n      }\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_24593": {
      "name": "CMGT_Role_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!roles,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_Role.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Role.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_Role.isActive,\n        value: true\n      ),\n      a!map(\n        field: recordType!CMGT_Role.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Role.createdBy,\n        value: ri!initiator\n      )\n    }\n  )\n)"
    },
    "_a-0000eaab-5303-8000-9c24-011c48011c48_994738": {
      "name": "CMGT_formatEventInitiator",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!user: rule!CMGT_QR_GetUser(\n    username: ri!initiator,\n    returnType: \"SINGLE_OBJECT\"\n  ),\n  if(\n    rule!CMGT_UTIL_IsBlank(local!user),\n    ri!initiator,\n    if(\n      or(\n        local!user[#\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_isServiceAccount\"] = true,\n        #\"urn:appian:function:v1:a:isusermemberofgroup?okey=a!isUserMemberOfGroup\"(\n          username: ri!initiator,\n          groups: cons!CMGT_GRP_SERVICE_ACCOUNTS\n        )\n      ),\n      cons!CMGT_TXT_AUTOMATED_SYSTEM,\n      ri!initiator\n    )\n  )\n)"
    },
    "_a-0000ebe1-6999-8000-9cbe-011c48011c48_2275955": {
      "name": "CMGT_Role_CreateCase_CreateRoles_Wrapper",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_RejectBlank(\n  {\n    rule!CMGT_Role_CreateCase_CreateAssigneeAndAssignedGroup(\n      case: ri!case\n    ),\n    rule!CMGT_LA_Role_CreateCase_Submitter(\n      case: ri!case,\n      initiator: ri!initiator\n    ),\n    \n  }\n)"
    },
    "_a-0000edbd-1f9f-8000-9d6d-011c48011c48_4081813": {
      "name": "CMGT_setPrefixDefault",
      "type": "Expression Rule",
      "sail_code": "left(\n  initials(\n    proper(\n      ri!caseType[recordType!CMGT_CFG_CaseType.name]\n    )\n  ),\n  3\n)"
    },
    "_a-0000eaba-1e20-8000-9c2a-011c48011c48_1044277": {
      "name": "CMGT_Comment_SetEvents",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!context,\n  whenTrue: rule!CMGT_UTIL_IsBlank(ri!comments),\n  then: {},\n  equals: \"CASE\",\n  then: a!flatten(\n    {\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: ri!comments,\n        expression: rule!CMGT_CaseEventHistory_Constructor(\n          caseId: fv!item[recordType!CMGT_Comment.caseId],\n          initiator: ri!initiator,\n          eventTypeId:           \n          /*comment event history*/\n          if(\n            fv!item[recordType!CMGT_Comment.isActive] = false,\n            cons!CMGT_REFID_EVENT_TYPE_CASE_DELETE_COMMENT,\n            if(\n              a!isNotNullOrEmpty(\n                fv!item[recordType!CMGT_Comment.commentId]\n              ),\n              cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_COMMENT,\n              if(\n                a!isNotNullOrEmpty(\n                  fv!item[recordType!CMGT_Comment.parentCommentId]\n                ),\n                cons!CMGT_REFID_EVENT_TYPE_CASE_REPLY_TO_COMMENT,\n                cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_COMMENT\n              )\n            )\n          ),\n          details: a!localVariables(\n            local!detailsMap: a!map(\n              commentText: fv!item[recordType!CMGT_Comment.commentText],\n              taggedUsers: if(\n                rule!CMGT_UTIL_IsBlank(\n                  ri!comments[recordType!CMGT_Comment.userTags]\n                ),\n                {},\n                rule!CMGT_UTIL_RejectBlank(\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    items: a!flatten(\n                      ri!comments[recordType!CMGT_Comment.userTags]\n                    ),\n                    expression: if(\n                      fv!item[recordType!CMGT_CommentUserTag.isActive],\n                      tostring(\n                        fv!item[recordType!CMGT_CommentUserTag.username]\n                      ),\n                      null\n                    )\n                  )\n                )\n              ),\n              documents: if(\n                rule!CMGT_UTIL_IsBlank(\n                  ri!comments[recordType!CMGT_Comment.commentDocumentMap]\n                ),\n                null,\n                rule!CMGT_UTIL_RejectBlank(\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    items: a!flatten(\n                      ri!comments[recordType!CMGT_Comment.commentDocumentMap]\n                    ),\n                    expression: if(\n                      fv!item[recordType!CMGT_CommentDocumentMap.isActive],\n                      a!localVariables(\n                        local!originalDocument: rule!CMGT_QR_GetDocument(\n                          documentId: fv!item[recordType!CMGT_CommentDocumentMap.documentId],\n                          returnType: \"SINGLE_OBJECT\"\n                        ),\n                        concat(\n                          document(\n                            documentId: local!originalDocument[recordType!CMGT_Document.appianDocId],\n                            property: \"name\"\n                          ),\n                          \".\",\n                          lower(\n                            document(\n                              documentId: local!originalDocument[recordType!CMGT_Document.appianDocId],\n                              property: \"extension\"\n                            )\n                          )\n                        )\n                      ),\n                      null\n                    )\n                  )\n                )\n              )\n            ),\n            local!detailsMap\n          )\n        )\n      )\n    }\n  ),\n  equals: \"TASK\",\n  then: a!flatten(\n    {\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: ri!comments,\n        expression: rule!CMGT_TaskEventHistory_Constructor(\n          taskId: fv!item[recordType!CMGT_Comment.taskId],\n          initiator: ri!initiator,\n          eventTypeId: if(\n            /*Defaulting to true here since this is a metadata field with a comment that has not been written as it happened within a task*/\n            a!defaultValue(fv!item[recordType!CMGT_Comment.isActive], true) = false,\n            cons!CMGT_REFID_EVENT_TYPE_TASK_DELETE_COMMENT,\n            if(\n              a!isNotNullOrEmpty(\n                fv!item[recordType!CMGT_Comment.commentId]\n              ),\n              cons!CMGT_REFID_EVENT_TYPE_TASK_UPDATE_COMMENT,\n              if(\n                a!isNotNullOrEmpty(\n                  fv!item[recordType!CMGT_Comment.parentCommentId]\n                ),\n                cons!CMGT_REFID_EVENT_TYPE_TASK_REPLY_TO_COMMENT,\n                cons!CMGT_REFID_EVENT_TYPE_TASK_ADD_COMMENT\n              )\n            )\n          ),\n          details: a!localVariables(\n            local!detailsMap: a!map(\n              commentText: fv!item[recordType!CMGT_Comment.commentText],\n              taggedUsers: if(\n                rule!CMGT_UTIL_IsBlank(\n                  ri!comments[recordType!CMGT_Comment.userTags]\n                ),\n                {},\n                rule!CMGT_UTIL_RejectBlank(\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    items: a!flatten(\n                      ri!comments[recordType!CMGT_Comment.userTags]\n                    ),\n                    expression: if(\n                      fv!item[recordType!CMGT_CommentUserTag.isActive],\n                      tostring(\n                        fv!item[recordType!CMGT_CommentUserTag.username]\n                      ),\n                      null\n                    )\n                  )\n                )\n              ),\n              documents: if(\n                rule!CMGT_UTIL_IsBlank(\n                  ri!comments[recordType!CMGT_Comment.commentDocumentMap]\n                ),\n                null,\n                rule!CMGT_UTIL_RejectBlank(\n                  #\"SYSTEM_SYSRULES_forEach\"(\n                    items: a!flatten(\n                      ri!comments[recordType!CMGT_Comment.commentDocumentMap]\n                    ),\n                    expression: if(\n                      fv!item[recordType!CMGT_CommentDocumentMap.isActive],\n                      a!localVariables(\n                        local!originalDocument: rule!CMGT_QR_GetDocument(\n                          documentId: fv!item[recordType!CMGT_CommentDocumentMap.documentId],\n                          returnType: \"SINGLE_OBJECT\"\n                        ),\n                        concat(\n                          document(\n                            documentId: local!originalDocument[recordType!CMGT_Document.appianDocId],\n                            property: \"name\"\n                          ),\n                          \".\",\n                          lower(\n                            document(\n                              documentId: local!originalDocument[recordType!CMGT_Document.appianDocId],\n                              property: \"extension\"\n                            )\n                          )\n                        )\n                      ),\n                      null\n                    )\n                  )\n                )\n              )\n            ),\n            local!detailsMap\n          )\n        )\n      )\n    }\n  ),\n  default: {}\n)"
    },
    "_a-0000eaba-1e20-8000-9c2a-011c48011c48_1041687": {
      "name": "CMGT_RelatedCaseMap_SetEvents",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!relatedCaseMaps,\n  expression: /*EVENTS THAT ARE PROCESS-SPECIFIC (based on \"eventType\" input)*/\n  rule!CMGT_CaseEventHistory_Constructor(\n    caseId: fv!item[recordType!CMGT_RelatedCaseMap.caseId],\n    initiator: ri!initiator,\n    eventTypeId: if(\n      fv!item[recordType!CMGT_RelatedCaseMap.isActive],\n      cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_RELATED_CASE,\n      cons!CMGT_REFID_EVENT_TYPE_CASE_REMOVE_RELATED_CASE\n    ),\n    details: a!map(\n      relatedCaseId: fv!item[recordType!CMGT_RelatedCaseMap.relatedCaseId],\n      relationshipMapTypeId: fv!item[recordType!CMGT_RelatedCaseMap.relationshipMapTypeId]\n    )\n  )\n)"
    },
    "_a-0000eccd-140e-8000-9d02-011c48011c48_3330621": {
      "name": "CMGT_MTR_UserCreatesAutomationRule",
      "type": "Expression Rule",
      "sail_code": "now()"
    },
    "_a-0000ebe1-6999-8000-9cbe-011c48011c48_2312376": {
      "name": "CMGT_Portal_CaseContact_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!portalCaseContacts,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_Portal_CaseContact.modifiedBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Portal_CaseContact.modifiedOn,\n        value: now()\n      )\n    },\n    /*Only modify these fields if they are currently null*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_Portal_CaseContact.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Portal_CaseContact.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Portal_CaseContact.isActive,\n        value: true\n      )\n    }\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25890": {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "sail_code": "length(a!flatten(ri!value)) = 0"
    },
    "_a-0000e9fd-9441-8000-9bdc-011c48011c48_312992": {
      "name": "CMGT_EntityEventHistory_Constructor",
      "type": "Expression Rule",
      "sail_code": "recordType!CMGT_EventHistory_Entity(\n  recordType!CMGT_EventHistory_Entity.entityId: ri!entityId,\n  recordType!CMGT_EventHistory_Entity.timestamp: a!defaultValue(value: ri!timestamp, default: now()),\n  recordType!CMGT_EventHistory_Entity.username: rule!CMGT_formatEventInitiator(initiator: ri!initiator),\n  recordType!CMGT_EventHistory_Entity.entityEventTypeId: ri!eventTypeId,\n  recordType!CMGT_EventHistory_Entity.details: if(\n    a!isNotNullOrEmpty(ri!details),\n    #\"SYSTEM_SYSRULES_toJson_v1\"(value: ri!details),\n    null\n  )\n)"
    },
    "_a-0000e9ae-873e-8000-9baf-011c48011c48_97439": {
      "name": "CMGT_QR_GetUser",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: #\"urn:appian:record-type:v1:SYSTEM_RECORD_TYPE_USER\",\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: #\"urn:appian:record-field:v1:SYSTEM_RECORD_TYPE_USER/SYSTEM_RECORD_TYPE_USER_FIELD_username\",\n      operator: \"in\",\n      value: ri!username\n    )\n  },\n  fields: ri!fields,\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  triggerRefresh: ri!triggerRefresh,\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ece2-0128-8000-9bb8-011c48011c48_37290": {
      "name": "CMGT_UTIL_CalculateDueDateBasedOnSLA",
      "type": "Expression Rule",
      "sail_code": "if(\n  any(a!isNullOrEmpty, { ri!dateTime, ri!SLA }),\n  null(),\n  a!localVariables(\n    local!details: cast(\n      'type!{http://www.appian.com/ae/types/2009}Map',\n      if(\n        a!isNotNullOrEmpty(ri!SLA),\n        #\"SYSTEM_SYSRULES_fromJson_v1\"(ri!SLA),\n        null\n      )\n    ),\n    local!days: a!defaultValue(\n      value: index(local!details, \"days\", null()),\n      default: 0\n    ),\n    local!hours: a!defaultValue(\n      value: index(local!details, \"hours\", null()),\n      default: 0\n    ),\n    local!minutes: a!defaultValue(\n      value: index(local!details, \"minutes\", null()),\n      default: 0\n    ),\n    local!isBusinessDays: a!defaultValue(\n      value: index(local!details, \"isBusinessDays\", false()),\n      default: false()\n    ),\n    a!addDateTime(\n      startDateTime: ri!dateTime,\n      days: local!days,\n      hours: local!hours,\n      minutes: local!minutes,\n      useProcessCalendar: local!isBusinessDays\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_29477-cmgt": {
      "name": "CMGT_Comment_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!comments,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_Comment.modifiedBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.modifiedOn,\n        value: now()\n      ),\n      /*Set hasBeenEdited if changed and not previously set*/\n      a!map(\n        field: recordType!CMGT_Comment.hasBeenEdited,\n        value: if(\n          fv!item[recordType!CMGT_Comment.hasBeenEdited],\n          true,\n          a!isNullOrEmpty(\n            fv!item[recordType!CMGT_Comment.commentId]\n          ),\n          false,\n          fv!item[recordType!CMGT_Comment.commentText] <> rule!CMGT_QR_GetComment(\n            commentId: fv!item[recordType!CMGT_Comment.commentId],\n            fields: recordType!CMGT_Comment.commentText,\n            returnType: \"SINGLE_OBJECT\"\n          )[recordType!CMGT_Comment.commentText]\n        )\n      )\n    },\n    /*Only modify these fields if they are currently null (default value)*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_Comment.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.isActive,\n        value: true\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.isPrivate,\n        value: #\"urn:appian:function:v1:a:isusermemberofgroup?okey=a!isUserMemberOfGroup\"(\n          ri!initiator,\n          cons!CMGT_GRP_INTERNAL_USERS\n        )\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.isBookmarked,\n        value: false\n      ),\n      /*Set caseId/taskId in case it's on the object and not the FK field*/\n      a!map(\n        field: recordType!CMGT_Comment.caseId,\n        value: fv!item[recordType!CMGT_Comment.case.caseId]\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.taskId,\n        value: fv!item[recordType!CMGT_Comment.task.taskId]\n      )\n    },\n    /*Set metadata for all child relationships*/\n    childRelationships: {\n      a!map(\n        field: recordType!CMGT_Comment.userTags,\n        value: rule!CMGT_CommentUserTag_SetMetaData(\n          commentUserTags: fv!item[recordType!CMGT_Comment.userTags]\n        )\n      ),\n      a!map(\n        field: recordType!CMGT_Comment.commentDocumentMap,\n        value: rule!CMGT_CommentDocumentMap_SetMetaData(\n          commentDocumentMaps: fv!item[recordType!CMGT_Comment.commentDocumentMap]\n        )\n      )\n    }\n  )\n)"
    },
    "_a-0000eac3-5839-8000-9c2d-011c48011c48_1070771": {
      "name": "CMGT_CaseEntityMap_SetEvents",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!context,\n  equals: \"CASE\",\n  then: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!caseEntityMaps,\n    expression: /*EVENTS THAT ARE PROCESS-SPECIFIC (based on \"eventType\" input)*/\n    rule!CMGT_CaseEventHistory_Constructor(\n      caseId: fv!item[recordType!CMGT_CaseEntityMap.caseId],\n      initiator: ri!initiator,\n      eventTypeId: a!match(\n        value: fv!item[recordType!CMGT_CaseEntityMap.isActive],\n        equals: true,\n        then: cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_RELATED_ENTITY,\n        default: cons!CMGT_REFID_EVENT_TYPE_CASE_REMOVE_RELATED_ENTITY\n      ),\n      details: a!map(\n        entityId: fv!item[recordType!CMGT_CaseEntityMap.entityId],\n        entityTypeId: fv!item[recordType!CMGT_CaseEntityMap.entity.entityTypeId]\n      )\n    )\n  ),\n  equals: \"ENTITY\",\n  then: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!caseEntityMaps,\n    expression: /*EVENTS THAT ARE PROCESS-SPECIFIC (based on \"eventType\" input)*/\n    rule!CMGT_EntityEventHistory_Constructor(\n      entityId: fv!item[recordType!CMGT_CaseEntityMap.entityId],\n      initiator: ri!initiator,\n      eventTypeId: a!match(\n        value: fv!item[recordType!CMGT_CaseEntityMap.isActive],\n        equals: true,\n        then: cons!CMGT_REFID_EVENT_TYPE_ENTITY_ADD_RELATED_CASE,\n        default: cons!CMGT_REFID_EVENT_TYPE_ENTITY_REMOVE_RELATED_CASE\n      ),\n      details: a!map(\n        caseId: fv!item[recordType!CMGT_CaseEntityMap.caseId]\n      )\n    )\n  ),\n  default: {}\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_38959": {
      "name": "CMGT_RelatedCaseMap_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!relatedCaseMaps,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.isActive,\n        value: true\n      ),\n      /*In case the ID of parent/child is on the object instead of the direct field itself, tie it to the direct field itself*/\n      /*e.g. `.parentCase.caseId` is populated, so then we populate `.caseId`*/\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.caseId,\n        value: fv!item[recordType!CMGT_RelatedCaseMap.parentCase.caseId]\n      ),\n      a!map(\n        field: recordType!CMGT_RelatedCaseMap.relatedCaseId,\n        value: fv!item[recordType!CMGT_RelatedCaseMap.childCase.caseId]\n      )\n    }\n  )\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_20014": {
      "name": "CMGT_Case_GenerateFriendlyIdentifier_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!dateHex: dec2hex(text(today(), \"mmddyy\")),\n  local!asciiCodes: append(\n    /* ASCII codes for A-Z (65 - 90) */\n    enumerate(26) + 65,\n    /* ASCII codes for 0-9 (48 - 57) */\n    enumerate(10) + 48\n  ),\n  /* Generating 6 random alphanumeric characters */\n  local!randomAlphaNumericChars: concat(\n    char(\n      index(\n        local!asciiCodes,\n        1 + round(rand(6) * (count(local!asciiCodes) - 1), 0),\n        null\n      )\n    )\n  ),\n  joinarray(\n    {\n      a!defaultValue(\n        value: ri!case[recordType!CMGT_Case.caseType.caseTypeMetadata.prefix],\n        default: rule!CMGT_setPrefixDefault(\n          caseType: ri!case[recordType!CMGT_Case.caseType]\n        )\n      ),\n      \"-\",\n      local!randomAlphaNumericChars,\n      local!dateHex\n    }\n  )\n)"
    },
    "_a-0000eab0-e049-8000-9c27-011c48011c48_1006075": {
      "name": "CMGT_WFL_Case_GenerateCaseCreationMilestones_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!referenceMilestones: rule!CMGT_WFL_QR_GetReferenceMilestone(\n    executeWhen: a!isNotNullOrEmpty(\n      ri!case[recordType!CMGT_Case.caseTypeUuid]\n    ),\n    caseTypeUuid: ri!case[recordType!CMGT_Case.caseTypeUuid]\n  ),\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!referenceMilestones,\n    expression: recordType!CMGT_Milestone(\n      recordType!CMGT_Milestone.caseId: ri!case[recordType!CMGT_Case.caseId],\n      recordType!CMGT_Milestone.referenceMilestoneUuid: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.milestoneUuid],\n      recordType!CMGT_Milestone.label: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.label],\n      recordType!CMGT_Milestone.milestoneColor: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.milestoneColor],\n      recordType!CMGT_Milestone.sortOrder: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.sortOrder]\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_36486": {
      "name": "CMGT_Case_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!metric: #\"SYSTEM_SYSRULES_forEach\"(\n    items: rule!CMGT_UTIL_Filter(\n      records: rule!CMGT_UTIL_RejectBlank(\n        a!flatten(\n          ri!cases[#\"urn:appian:record-relationship:v1:d81cdd0e-c54d-4b8e-beec-b7ae37fefe7f/5a26c421-0dd4-402c-bc21-d650ed60924e/5189c3ac-98e2-4a82-8598-2e9561baec9d/64b891e4-359b-48b4-9f47-2a3af4695c34\"]\n        )\n      ),\n      field: recordType!CMGT_ConditionSet.conditionSetId,\n      value: null\n    ),\n    expression: rule!CMGT_MTR_UserCreatesAutomationRule()\n  ),\n  rule!CMGT_Case_SetEvents(\n    cases: #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!cases,\n      expression: rule!CMGT_UTIL_SetRecordFields(\n        record: fv!item,\n        alwaysOverwrite: {\n          a!map(\n            field: recordType!CMGT_Case.modifiedOn,\n            value: now()\n          ),\n          a!map(\n            field: recordType!CMGT_Case.modifiedBy,\n            value: ri!initiator\n          ),\n          /* If the status is closed and the completedOn is empty then update to current time stamp, otherwise use the existing completedOn value     */\n          if(\n            ri!eventType = cons!CMGT_TXT_EVENT_TYPE_CASE_MODIFY_CHILD_RECORD,\n            null,\n            a!map(\n              field: recordType!CMGT_Case.completedOn,\n              value: a!match(\n                value: tointeger(\n                  fv!item[recordType!CMGT_Case.statusId]\n                ),\n                whenTrue: and(\n                  fv!value = cons!CMGT_REFID_STATUS_CASE_CLOSED,\n                  a!isNullOrEmpty(\n                    fv!item[recordType!CMGT_Case.completedOn]\n                  )\n                ),\n                then: now(),\n                whenTrue: and(\n                  fv!value <> cons!CMGT_REFID_STATUS_CASE_CLOSED,\n                  a!isNotNullOrEmpty(\n                    fv!item[recordType!CMGT_Case.completedOn]\n                  )\n                ),\n                then: null,\n                default: fv!item[recordType!CMGT_Case.completedOn]\n              )\n            ),\n            \n          )\n        },\n        neverOverwrite: if(\n          ri!eventType = cons!CMGT_TXT_EVENT_TYPE_CASE_MODIFY_CHILD_RECORD,\n          null,\n          {\n            a!map(\n              field: recordType!CMGT_Case.isActive,\n              value: true\n            ),\n            a!map(\n              field: recordType!CMGT_Case.createdOn,\n              value: now()\n            ),\n            a!map(\n              field: recordType!CMGT_Case.createdBy,\n              value: ri!initiator\n            ),\n            a!map(\n              field: recordType!CMGT_Case.friendlyId,\n              value: rule!CMGT_Case_GenerateFriendlyIdentifier_Logic(\n                case: fv!item\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Case.dueOn,\n              value: rule!CMGT_UTIL_CalculateDueDateBasedOnSLA(\n                SLA: fv!item[recordType!CMGT_Case.caseType.caseTypeMetadata.sla],\n                dateTime: now()\n              ),\n              applyWhen: ri!eventType = \"CREATE\"\n            ),\n            a!map(\n              field: recordType!CMGT_Case.priorityId,\n              value: a!defaultValue(\n                value: fv!item[recordType!CMGT_Case.caseType.caseTypeMetadata.priorityId],\n                default: cons!CMGT_REFID_PRIORITY_NONE\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Case.statusId,\n              value: cons!CMGT_REFID_STATUS_CASE_OPEN\n            ),\n            a!map(\n              field: recordType!CMGT_Case.processId,\n              value: ri!processId\n            )\n          }\n        ),\n        /*Set metadata for all child relationships*/\n        childRelationships: {\n          a!map(\n            field: recordType!CMGT_Case.comments,\n            value: rule!CMGT_Comment_SetMetaData(\n              comments: fv!item[recordType!CMGT_Case.comments],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.documents,\n            value: rule!CMGT_Document_SetMetaData(\n              documents: fv!item[recordType!CMGT_Case.documents],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.tagMap,\n            value: rule!CMGT_CaseTagMap_SetMetaData(\n              caseTagMaps: fv!item[recordType!CMGT_Case.tagMap],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.relatedCaseMap,\n            value: rule!CMGT_RelatedCaseMap_SetMetaData(\n              relatedCaseMaps: fv!item[recordType!CMGT_Case.relatedCaseMap],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.caseEntityMap,\n            value: rule!CMGT_CaseEntityMap_SetMetaData(\n              caseEntityMaps: fv!item[recordType!CMGT_Case.caseEntityMap],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.milestones,\n            value: rule!CMGT_Milestone_SetMetaData(\n              milestones: a!defaultValue(\n                fv!item[recordType!CMGT_Case.milestones],\n                if(\n                  or(\n                    a!isNullOrEmpty(\n                      fv!item[recordType!CMGT_Case.caseId]\n                    ),\n                    a!isNullOrEmpty(\n                      fv!item[recordType!CMGT_Case.folderId]\n                    )\n                  ),\n                  rule!CMGT_WFL_Case_GenerateCaseCreationMilestones_Logic(\n                    case: fv!item\n                  ),\n                  {}\n                )\n              ),\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.tasks,\n            value: rule!CMGT_Task_SetMetaData(\n              tasks: fv!item[recordType!CMGT_Case.tasks],\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.roles,\n            value: rule!CMGT_Role_SetMetaData(\n              roles: if(\n                ri!eventType = cons!CMGT_TXT_EVENT_TYPE_CASE_MODIFY_CHILD_RECORD,\n                fv!item[recordType!CMGT_Case.roles],\n                if(\n                  a!isNotNullOrEmpty(\n                    fv!item[recordType!CMGT_Case.caseId]\n                  ),\n                  if(\n                    a!isNullOrEmpty(\n                      fv!item[recordType!CMGT_Case.folderId]\n                    ),\n                    rule!CMGT_Role_CreateCase_CreateRoles_Wrapper(\n                      initiator: ri!initiator,\n                      case: ri!cases\n                    ),\n                    fv!item[recordType!CMGT_Case.roles]\n                  ),\n                  rule!CMGT_Role_CreateCase_CreateRoles_Wrapper(\n                    initiator: ri!initiator,\n                    case: ri!cases\n                  )\n                )\n              ),\n              initiator: ri!initiator\n            )\n          ),\n          a!map(\n            field: recordType!CMGT_Case.portalCaseContact,\n            value: rule!CMGT_Portal_CaseContact_SetMetaData(\n              portalCaseContacts: fv!item[recordType!CMGT_Case.portalCaseContact],\n              initiator: ri!initiator\n            )\n          )\n        }\n      )\n    ),\n    initiator: ri!initiator,\n    eventType: ri!eventType\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_29424-cmgt": {
      "name": "CMGT_QR_GetComment",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Comment,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Comment.caseId,\n      operator: \"=\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Comment.taskId,\n      operator: \"=\",\n      value: ri!taskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Comment.commentId,\n      operator: \"in\",\n      value: ri!commentId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Comment.parentCommentId,\n      operator: \"is null\",\n      applyWhen: ri!onlyParentComments = true\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpressions,\n  fields: {\n    ri!fields,\n    if(\n      ri!includeCase,\n      recordType!CMGT_Comment.case,\n      {}\n    ),\n    if(\n      ri!includeTask,\n      recordType!CMGT_Comment.task,\n      {}\n    ),\n    if(\n      ri!includeUserTagsAndDocumentMaps,\n      {\n        recordType!CMGT_Comment.userTags,\n        recordType!CMGT_Comment.userTags,\n        recordType!CMGT_Comment.commentDocumentMap,\n        recordType!CMGT_Comment.commentDocumentMap\n      },\n      {}\n    ),\n    if(\n      ri!includeChildComments,\n      {\n        recordType!CMGT_Comment.childComments,\n        if(\n          ri!includeUserTagsAndDocumentMaps,\n          {\n            recordType!CMGT_Comment.childComments,\n            #\"urn:appian:record-relationship:v1:e57250b0-f216-4a23-afd9-39e7d532d302-cmgt/3fbb8e70-35d5-460e-aee9-d05940b75a05/18e4567c-a0ea-4ba1-bcff-220a1ef13668-cmgt/e7ba3b0b-ab6f-4600-9551-ea4a0d70d530-cmgt\",\n            recordType!CMGT_Comment.childComments,\n            #\"urn:appian:record-relationship:v1:e57250b0-f216-4a23-afd9-39e7d532d302-cmgt/3fbb8e70-35d5-460e-aee9-d05940b75a05/4482fa71-8c71-40a5-98f2-773715556151/71840277-2340-479f-be2c-7d05e30ba12f\"\n          },\n          {}\n        )\n      },\n      {}\n    ),\n    recordType!CMGT_Comment.createdByUser\n  },\n  pagingInfo: ri!pagingInfo,\n  relatedRecordData: {\n    ri!relatedRecordData,\n    if(\n      ri!includeChildComments,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Comment.childComments,\n        limit: 10,\n        sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!CMGT_Comment.createdOn,\n          ascending: true\n        )\n      ),\n      {}\n    )\n  },\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: {\n    recordType!CMGT_Comment.commentText,\n    #\"urn:appian:record-field:v1:e57250b0-f216-4a23-afd9-39e7d532d302-cmgt/18e4567c-a0ea-4ba1-bcff-220a1ef13668-cmgt/e7ba3b0b-ab6f-4600-9551-ea4a0d70d530-cmgt/SYSTEM_RECORD_TYPE_USER_FIELD_firstAndLastName\",\n    if(\n      ri!includeChildComments,\n      {\n        recordType!CMGT_Comment.childComments.commentText,\n        #\"urn:appian:record-field:v1:e57250b0-f216-4a23-afd9-39e7d532d302-cmgt/3fbb8e70-35d5-460e-aee9-d05940b75a05/18e4567c-a0ea-4ba1-bcff-220a1ef13668-cmgt/e7ba3b0b-ab6f-4600-9551-ea4a0d70d530-cmgt/SYSTEM_RECORD_TYPE_USER_FIELD_firstAndLastName\"\n      },\n      {}\n    )\n  },\n  sort: ri!sort\n)"
    },
    "_a-0000e9c0-fc38-8000-9bb5-011c48011c48_118180": {
      "name": "CMGT_CommentUserTag_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!commentUserTags,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {},\n    /*Only modify these fields if they are currently null (default value)*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_CommentUserTag.isActive,\n        value: true\n      )\n    }\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_33778": {
      "name": "CMGT_UTIL_SetRecordFields",
      "type": "Expression Rule",
      "sail_code": "/*\nFuture enhancement ideas:\n1 Parameter to skip update if the field isn't present in the object\n--- This would also apply to nested fields, as in, don't set a relationship field if the entire relationship object isn't there because it will instantiate it\n2 Parameter to overwrite based on more enhanced logic\n3 Allow list types for the `value`\n4 Allow reuse to apply setting metadata for nested relationships, but using their own set metadata rule\n--- e.g. CMGT_Entity_SetMetaData can be used in both the Case process and the individual Entity process\n*/\nif(\n  a!isNullOrEmpty(ri!record),\n  ri!record,\n  a!localVariables(\n    local!allUpdates: rule!CMGT_UTIL_RejectBlank(a!flatten(\n      {\n        ri!alwaysOverwrite,\n        ri!childRelationships,\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!neverOverwrite,\n          expression: #\"urn:appian:function:v1:a:update\"(\n            fv!item,\n            \"value\",\n            /*Specifically using this instead of a!defaultValue() to account for the `{null}` value*/\n            if(\n              rule!CMGT_UTIL_IsBlank(ri!record[fv!item.field]),\n              fv!item.value,\n              ri!record[fv!item.field]\n            )\n          )\n        )\n      }\n    )),\n    local!onlyChangedUpdates: a!flatten(\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!allUpdates,\n        expression: if(\n          or(\n            tostring(ri!record[fv!item.field]) = tostring(fv!item.value),\n            toboolean(fv!item.applyWhen) = false\n          ),\n          {},\n          fv!item\n        )\n      )\n    ),\n    if(\n      a!isNullOrEmpty(local!onlyChangedUpdates),\n      ri!record,\n      #\"urn:appian:function:v1:a:update\"(\n        data: ri!record,\n        index: local!onlyChangedUpdates.field,\n        value: local!onlyChangedUpdates.value\n      )\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_44574": {
      "name": "CMGT_CaseTagMap_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!caseTagMaps,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_CaseTagMap.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_CaseTagMap.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_CaseTagMap.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_CaseTagMap.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_CaseTagMap.isActive,\n        value: true\n      ),\n      /*Prime the caseId with the assigned case, if it's not already populated*/\n      a!map(\n        field: recordType!CMGT_CaseTagMap.caseId,\n        value: fv!item[recordType!CMGT_CaseTagMap.case.caseId]\n      )\n    }\n  )\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000ea2f-ac11-8000-9bf4-011c48011c48_608417": {
      "name": "CMGT_Milestone_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!milestones,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_Milestone.modifiedBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Milestone.modifiedOn,\n        value: now()\n      )\n    },\n    /*Only modify these fields if they are currently null*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_Milestone.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Milestone.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Milestone.isActive,\n        value: true\n      ),\n      a!map(\n        field: recordType!CMGT_Milestone.sortOrder,\n        value: fv!index\n      )\n    }\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_36462": {
      "name": "CMGT_CaseEntityMap_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!caseEntityMaps,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    alwaysOverwrite: {\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.isActive,\n        value: true\n      ),\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.createdBy,\n        value: ri!initiator\n      ),\n      /*Prime the caseId with the assigned case, if it's not already populated*/\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.caseId,\n        value: fv!item[recordType!CMGT_CaseEntityMap.case.caseId]\n      ),\n      /*Prime the entityId with the assigned entity, if it's not already populated*/\n      a!map(\n        field: recordType!CMGT_CaseEntityMap.entityId,\n        value: fv!item[recordType!CMGT_CaseEntityMap.entity.entityId]\n      )\n    }\n  )\n)"
    },
    "_a-0000eaba-1e20-8000-9c2a-011c48011c48_1043926": {
      "name": "CMGT_Document_SetEvents",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!documents,\n  expression: /*EVENTS THAT ARE PROCESS-SPECIFIC (based on \"eventType\" input)*/\n  if(\n    isnull(\n      fv!item[recordType!CMGT_Document.taskId]\n    ),\n    /*Case documents*/\n    rule!CMGT_CaseEventHistory_Constructor(\n      caseId: fv!item[recordType!CMGT_Document.caseId],\n      initiator: rule!CMGT_formatEventInitiator(\n        initiator: ri!initiator\n      ),\n      eventTypeId: if(\n        fv!item[recordType!CMGT_Document.isActive],\n        cons!CMGT_REFID_EVENT_TYPE_CASE_UPLOAD_DOCUMENT,\n        cons!CMGT_REFID_EVENT_TYPE_CASE_DELETE_DOCUMENT\n      ),\n      details: a!map(\n        value: concat(\n          document(\n            documentId: fv!item[recordType!CMGT_Document.appianDocId],\n            property: \"name\"\n          ),\n          \".\",\n          lower(\n            document(\n              documentId: fv!item[recordType!CMGT_Document.appianDocId],\n              property: \"extension\"\n            )\n          )\n        )\n      )\n    ),\n    /*Task documents*/\n    rule!CMGT_TaskEventHistory_Constructor(\n      taskId: fv!item[recordType!CMGT_Document.taskId],\n      initiator: rule!CMGT_formatEventInitiator(\n        initiator: ri!initiator\n      ),\n      eventTypeId: if(\n        fv!item[recordType!CMGT_Document.isActive],\n        cons!CMGT_REFID_EVENT_TYPE_TASK_UPLOAD_DOCUMENT,\n        cons!CMGT_REFID_EVENT_TYPE_TASK_DELETE_DOCUMENT\n      ),\n      details: a!map(\n        value: concat(\n          document(\n            documentId: fv!item[recordType!CMGT_Document.appianDocId],\n            property: \"name\"\n          ),\n          \".\",\n          lower(\n            document(\n              documentId: fv!item[recordType!CMGT_Document.appianDocId],\n              property: \"extension\"\n            )\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_25461": {
      "name": "CMGT_Task_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!originalTasks: if(\n    or(\n      rule!CMGT_UTIL_IsBlank(ri!tasks),\n      ri!eventType = \"TRIGGERED_AUTOMATION_ACTION\",\n      \n    ),\n    null,\n    rule!CMGT_QR_GetTask(\n      taskId: ri!tasks[recordType!CMGT_Task.taskId],\n      includeInactive: true,\n      executeWhen: rule!CMGT_UTIL_IsNotBlank(\n        a!flatten(\n          ri!tasks[recordType!CMGT_Task.taskId]\n        )\n      ),\n      fields: {\n        recordType!CMGT_Task.roles,\n        recordType!CMGT_Task.conditionSet\n      }\n    )\n  ),\n  rule!CMGT_Task_SetEvents(\n    tasks: #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!tasks,\n      expression: a!localVariables(\n        /*The current value of this record in the database*/\n        local!orgItem: rule!CMGT_UTIL_Filter(\n          records: local!originalTasks,\n          field: recordType!CMGT_Task.taskId,\n          value: fv!item[recordType!CMGT_Task.taskId]\n        ),\n        rule!CMGT_UTIL_SetRecordFields(\n          record: fv!item,\n          /*Always set these fields with each update*/\n          alwaysOverwrite: {\n            a!map(\n              field: recordType!CMGT_Task.modifiedBy,\n              value: if(\n                /*we want the modified by to be process automation only when the new instance is created*/\n                and(\n                  rule!CMGT_UTIL_IsBlank(\n                    fv!item[recordType!CMGT_Task.taskId]\n                  ),\n                  tointeger(\n                    fv!item[recordType!CMGT_Task.instanceCount]\n                  ) > 1\n                ),\n                cons!CMGT_TXT_PROCESS_AUTOMATION,\n                ri!initiator\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.modifiedOn,\n              value: now()\n            ),\n            if(\n              ri!eventType = cons!CMGT_TXT_EVENT_TYPE_TASK_MODIFY_CHILD_RECORD,\n              null,\n              {\n                a!map(\n                  field: recordType!CMGT_Task.statusId,\n                  value: fv!item[recordType!CMGT_Task.statusId],\n                  applyWhen: contains(\n                    {\n                      cons!CMGT_REFID_STATUS_TASK_READY,\n                      cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS\n                    },\n                    tointeger(\n                      fv!item[recordType!CMGT_Task.statusId]\n                    )\n                  )\n                ),\n                /* Calculate dueOn based on SLA*/\n                a!map(\n                  field: recordType!CMGT_Task.dueOn,\n                  value: if(\n                    or(\n                      tointeger(\n                        fv!item[recordType!CMGT_Task.statusId]\n                      ) = cons!CMGT_REFID_STATUS_TASK_READY,\n                      tointeger(\n                        fv!item[recordType!CMGT_Task.statusId]\n                      ) = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS\n                    ),\n                    if(\n                      and(\n                        or(\n                          rule!CMGT_UTIL_IsBlank(\n                            value: local!orgItem[recordType!CMGT_Task.dueOn]\n                          ),\n                          tointeger(\n                            local!orgItem[recordType!CMGT_Task.statusId]\n                          ) = cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n                          tointeger(\n                            local!orgItem[recordType!CMGT_Task.statusId]\n                          ) = cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n                        ),\n                        /*  For open and reopen , dueOn is updated as null in the recordAction context*/\n                        rule!CMGT_UTIL_IsBlank(\n                          value: fv!item[recordType!CMGT_Task.dueOn]\n                        ),\n                        /* we should not update due on if the status is being swithced between ready and inprogress*/\n                        tointeger(\n                          fv!item[recordType!CMGT_Task.statusId]\n                        ) <> tointeger(\n                          local!orgItem[recordType!CMGT_Task.statusId]\n                        ),\n                        if(\n                          tointeger(\n                            fv!item[recordType!CMGT_Task.statusId]\n                          ) = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                          tointeger(\n                            local!orgItem[recordType!CMGT_Task.statusId]\n                          ) <> cons!CMGT_REFID_STATUS_TASK_READY,\n                          not(\n                            and(\n                              tointeger(\n                                local!orgItem[recordType!CMGT_Task.statusId]\n                              ) = cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                              tointeger(\n                                fv!item[recordType!CMGT_Task.statusId]\n                              ) = cons!CMGT_REFID_STATUS_TASK_READY\n                            )\n                          )\n                        )\n                      ),\n                      rule!CMGT_UTIL_CalculateDueDateBasedOnSLA(\n                        SLA: fv!item[recordType!CMGT_Task.sla],\n                        dateTime: now()\n                      ),\n                      fv!item[recordType!CMGT_Task.dueOn]\n                    ),\n                    fv!item[recordType!CMGT_Task.dueOn]\n                  )\n                ),\n                /*Clear completedBy/On whenever the statusId goes back to Queued/Ready/Inprogress status*/\n                a!map(\n                  field: recordType!CMGT_Task.completedBy,\n                  value: null,\n                  applyWhen: contains(\n                    {\n                      cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                      cons!CMGT_REFID_STATUS_TASK_READY,\n                      cons!CMGT_REFID_STATUS_TASK_QUEUED,\n                      \n                    },\n                    tointeger(\n                      fv!item[recordType!CMGT_Task.statusId]\n                    )\n                  )\n                ),\n                /*Task has not been completed so no date should be available*/\n                a!map(\n                  field: recordType!CMGT_Task.completedOn,\n                  value: null,\n                  applyWhen: contains(\n                    {\n                      cons!CMGT_REFID_STATUS_TASK_IN_PROGRESS,\n                      cons!CMGT_REFID_STATUS_TASK_READY,\n                      cons!CMGT_REFID_STATUS_TASK_QUEUED,\n                      \n                    },\n                    tointeger(\n                      fv!item[recordType!CMGT_Task.statusId]\n                    )\n                  )\n                ),\n                a!map(\n                  field: recordType!CMGT_Task.isCurrent,\n                  value: a!defaultValue(\n                    fv!item[recordType!CMGT_Task.isCurrent],\n                    true\n                  ),\n                  \n                ),\n                a!map(\n                  field: recordType!CMGT_Task.instanceCount,\n                  value: a!defaultValue(\n                    fv!item[recordType!CMGT_Task.instanceCount],\n                    1\n                  ),\n                  \n                ),\n                \n              }\n            )\n          },\n          /*Only modify these fields if they are currently null*/\n          neverOverwrite: if(\n            ri!eventType = cons!CMGT_TXT_EVENT_TYPE_TASK_MODIFY_CHILD_RECORD,\n            {},\n            {\n              a!map(\n                field: recordType!CMGT_Task.createdBy,\n                value: ri!initiator\n              ),\n              a!map(\n                field: recordType!CMGT_Task.createdOn,\n                value: now()\n              ),\n              a!map(\n                field: recordType!CMGT_Task.isActive,\n                value: true\n              ),\n              a!map(\n                field: recordType!CMGT_Task.taskUuid,\n                value: rule!CMGT_UTIL_GenerateUuid_NonPlugin()\n              ),\n              a!map(\n                field: recordType!CMGT_Task.taskInstanceUuid,\n                value: rule!CMGT_UTIL_GenerateUuid_NonPlugin()\n              ),\n              a!map(\n                field: recordType!CMGT_Task.isAdHoc,\n                value: false,\n                \n              ),\n              /*Default status to \"Queued\"*/\n              a!map(\n                field: recordType!CMGT_Task.statusId,\n                value: cons!CMGT_REFID_STATUS_TASK_QUEUED\n              ),\n              /*Automatically calculate availableOn whenever the statusId is Ready*/\n              a!map(\n                field: recordType!CMGT_Task.availableOn,\n                value: now(),\n                applyWhen: tointeger(\n                  fv!item[recordType!CMGT_Task.statusId]\n                ) = cons!CMGT_REFID_STATUS_TASK_READY\n              ),\n              /*Set completedBy/On whenever the statusId matches a Completion status*/\n              a!map(\n                field: recordType!CMGT_Task.completedBy,\n                value: ri!initiator,\n                applyWhen: contains(\n                  {\n                    cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n                    cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n                  },\n                  tointeger(\n                    fv!item[recordType!CMGT_Task.statusId]\n                  )\n                )\n              ),\n              a!map(\n                field: recordType!CMGT_Task.completedOn,\n                value: now(),\n                applyWhen: contains(\n                  {\n                    cons!CMGT_REFID_STATUS_TASK_COMPLETED,\n                    cons!CMGT_REFID_STATUS_TASK_NOT_NEEDED\n                  },\n                  tointeger(\n                    fv!item[recordType!CMGT_Task.statusId]\n                  )\n                )\n              ),\n              a!map(\n                field: recordType!CMGT_Task.taskIntentionCode,\n                value: cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_WORKFLOW\n              )\n            }\n          ),\n          /*Set metadata for all child relationships*/\n          childRelationships: {\n            a!map(\n              field: recordType!CMGT_Task.roles,\n              value: rule!CMGT_Role_SetMetaData(\n                roles: fv!item[recordType!CMGT_Task.roles],\n                initiator: ri!initiator\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.comments,\n              value: rule!CMGT_Comment_SetMetaData(\n                /*Note that the caseId context is on task, therefore we need to set it on comment here*/\n                comments: rule!CMGT_UTIL_SetForeignKey(\n                  records: fv!item,\n                  relationship: recordType!CMGT_Task.comments,\n                  parentPkField: recordType!CMGT_Task.caseId,\n                  childFkField: recordType!CMGT_Comment.caseId\n                ),\n                initiator: ri!initiator\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.documents,\n              value: rule!CMGT_Document_SetMetaData(\n                /*Note that the caseId context is on task, therefore we need to set it on document here*/\n                documents: rule!CMGT_UTIL_SetForeignKey(\n                  records: fv!item,\n                  relationship: recordType!CMGT_Task.documents,\n                  parentPkField: recordType!CMGT_Task.caseId,\n                  childFkField: recordType!CMGT_Document.caseId\n                ),\n                initiator: ri!initiator\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.beforeTaskInstanceBranches,\n              value: rule!CMGT_TaskBranch_SetMetaData(\n                taskBranches: fv!item[recordType!CMGT_Task.beforeTaskInstanceBranches]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.taskResponseOptions,\n              value: rule!CMGT_TaskResponseOption_SetMetaData(\n                taskResponseOptions: fv!item[recordType!CMGT_Task.taskResponseOptions]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.conditionSet,\n              value: rule!CMGT_ConditionSet_SetMetaData(\n                conditionSets: fv!item[recordType!CMGT_Task.conditionSet],\n                initiator: ri!initiator\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.createCaseTask,\n              value: rule!CMGT_CreateCaseTask_SetMetaData(\n                createCaseTask: fv!item[recordType!CMGT_Task.createCaseTask],\n                initiator: ri!initiator\n              ),\n              applyWhen: rule!CMGT_UTIL_IsNotBlank(\n                fv!item[recordType!CMGT_Task.createCaseTask]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.taskCaseMap,\n              value: rule!CMGT_TaskCaseMap_SetMetaData(\n                taskCaseMap: fv!item[recordType!CMGT_Task.taskCaseMap],\n                initiator: ri!initiator\n              ),\n              applyWhen: rule!CMGT_UTIL_IsNotBlank(\n                fv!item[recordType!CMGT_Task.taskCaseMap]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.sendEmailTask,\n              value: rule!CMGT_SendEmailTask_SetMetaData(\n                sendEmailTask: fv!item[recordType!CMGT_Task.sendEmailTask],\n                initiator: ri!initiator\n              ),\n              applyWhen: rule!CMGT_UTIL_IsNotBlank(\n                fv!item[recordType!CMGT_Task.sendEmailTask]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.automationWorkflowTasks,\n              value: rule!CMGT_Task_SetMetaData(\n                tasks: fv!item[recordType!CMGT_Task.automationWorkflowTasks],\n                initiator: cons!CMGT_TXT_PROCESS_AUTOMATION,\n                eventType: \"TRIGGERED_AUTOMATION_ACTION\"\n              ),\n              applyWhen: rule!CMGT_UTIL_IsNotBlank(\n                fv!item[recordType!CMGT_Task.automationWorkflowTasks]\n              )\n            ),\n            a!map(\n              field: recordType!CMGT_Task.automationTaskAction,\n              value: rule!CMGT_TaskAction_SetMetaData(\n                taskAction: fv!item[recordType!CMGT_Task.automationTaskAction],\n                initiator: ri!initiator\n              ),\n              applyWhen: rule!CMGT_UTIL_IsNotBlank(\n                fv!item[recordType!CMGT_Task.automationTaskAction]\n              )\n            )\n          }\n        )\n      )\n    ),\n    originalTasks: local!originalTasks,\n    initiator: ri!initiator,\n    eventType: ri!eventType,\n    taskBranches: ri!taskBranches\n  )\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_20741": {
      "name": "CMGT_QR_GetDocument",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Document,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.caseId,\n      operator: \"=\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.taskId,\n      operator: \"=\",\n      value: ri!taskId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.documentId,\n      operator: \"in\",\n      value: ri!documentId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.commentDocumentMap.commentId,\n      operator: \"=\",\n      value: ri!commentId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.documentName,\n      operator: \"in\",\n      value: ri!documentFileNames\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.modifiedOn,\n      operator: \"=\",\n      value: ri!includeModifiedOn\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Document.modifiedOn,\n      operator: \"<>\",\n      value: ri!excludeModifiedOn\n    )\n  },\n  fields: {\n    ri!fields,\n    recordType!CMGT_Document.case,\n    recordType!CMGT_Document.task,\n    recordType!CMGT_Document.createdByUser,\n    recordType!CMGT_Document.modifiedByUser\n  },\n  pagingInfo: ri!pagingInfo,\n  sort: a!defaultValue(\n    value: ri!sort,\n    default: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!CMGT_Document.createdOn,\n      ascending: false\n    )\n  ),\n  relatedRecordData: ri!relatedRecordData,\n  groupByFields: ri!groupByFields,\n  logicalExpressions: ri!additionalLogicalExpression,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000e9fa-aa45-8000-9bda-011c48011c48_293777": {
      "name": "CMGT_CaseEventHistory_Constructor",
      "type": "Expression Rule",
      "sail_code": "recordType!CMGT_EventHistory_Case(\n  recordType!CMGT_EventHistory_Case.caseId: ri!caseId,\n  recordType!CMGT_EventHistory_Case.timestamp: a!defaultValue(value: ri!timestamp, default: now()),\n  recordType!CMGT_EventHistory_Case.username: rule!CMGT_formatEventInitiator(initiator: ri!initiator),\n  recordType!CMGT_EventHistory_Case.caseEventTypeId: ri!eventTypeId,\n  recordType!CMGT_EventHistory_Case.details: if(\n    a!isNotNullOrEmpty(ri!details),\n    #\"SYSTEM_SYSRULES_toJson_v1\"(\n      value: ri!details,\n      removeNullOrEmptyFields: false\n    ),\n    null\n  )\n)"
    },
    "_a-0000ea26-2ced-8000-9bf1-011c48011c48_568215": {
      "name": "CMGT_WFL_QR_GetReferenceMilestone",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_WFL_CFG_ReferenceMilestone,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.caseTypeUuid,\n      operator: \"=\",\n      value: ri!caseTypeUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.referenceMilestoneId,\n      operator: \"in\",\n      value: ri!referenceMilestoneId\n    )\n  },\n  fields: {\n    ri!fields,\n    recordType!CMGT_WFL_CFG_ReferenceMilestone.caseType\n  },\n  relatedRecordData: { ri!relatedRecordData },\n  pagingInfo: ri!pagingInfo,\n  sort: a!defaultValue(\n    ri!sort,\n    #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.sortOrder,\n      ascending: true\n    )\n  ),\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ebe1-6999-8000-9cbe-011c48011c48_2275976": {
      "name": "CMGT_LA_Role_CreateCase_Submitter",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!submitter: rule!CMGT_UTIL_Filter(\n    records: ri!case[recordType!CMGT_Case.roles],\n    field: recordType!CMGT_Role.roleTypeId,\n    value: cons!CMGT_LA_REFID_ROLE_TYPE_SUBMITTER\n  ),\n  a!defaultValue(\n    value: local!submitter,\n    default: recordType!CMGT_Role(\n      recordType!CMGT_Role.username: ri!initiator,\n      recordType!CMGT_Role.roleTypeId: cons!CMGT_LA_REFID_ROLE_TYPE_SUBMITTER,\n      recordType!CMGT_Role.caseId: ri!case[recordType!CMGT_Case.caseId]\n    ),\n    \n  )\n)"
    },
    "_a-0000ebe1-6999-8000-9cbe-011c48011c48_2275969": {
      "name": "CMGT_Role_CreateCase_CreateAssigneeAndAssignedGroup",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!assignees: rule!CMGT_UTIL_Filter(\n    records: ri!case[recordType!CMGT_Case.roles],\n    field: recordType!CMGT_Role.roleTypeId,\n    value: {\n      cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n      cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE\n    }\n  ),\n  a!defaultValue(\n    local!assignees,\n    {}/*rule!CMGT_ACR_EVAL_RouteCaseToUserOrGroup(*/\n    /*case: ri!case*/\n    /*)*/\n    \n  )\n)"
    },
    "_a-0000ea0e-71db-8000-9be6-011c48011c48_470477": {
      "name": "CMGT_TaskEventHistory_Constructor",
      "type": "Expression Rule",
      "sail_code": "recordType!CMGT_EventHistory_Task(\n  recordType!CMGT_EventHistory_Task.taskId: ri!taskId,\n  recordType!CMGT_EventHistory_Task.timestamp: a!defaultValue(value: ri!timestamp, default: now()),\n  recordType!CMGT_EventHistory_Task.username: rule!CMGT_formatEventInitiator(initiator: ri!initiator),\n  recordType!CMGT_EventHistory_Task.taskEventTypeId: ri!eventTypeId,\n  recordType!CMGT_EventHistory_Task.details: if(\n    a!isNotNullOrEmpty(ri!details),\n    #\"SYSTEM_SYSRULES_toJson_v1\"(value: ri!details),\n    null\n  )\n)"
    },
    "_a-0000e9fa-aa45-8000-9bda-011c48011c48_293282": {
      "name": "CMGT_Case_UpdateProperty_SetEvents",
      "type": "Expression Rule",
      "sail_code": "a!flatten(\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!cases,\n    expression: a!localVariables(\n      local!oldCase: rule!CMGT_QR_GetCase(\n        returnType: \"SINGLE_OBJECT\",\n        caseId: fv!item[recordType!CMGT_Case.caseId],\n        fields: {\n          recordType!CMGT_Case.status,\n          recordType!CMGT_Case.priority\n        }\n      ),\n      local!newCase: fv!item,\n      local!events: rule!CMGT_UTIL_RejectBlank(\n        array: {\n          if(\n            fv!item[recordType!CMGT_Case.priorityId] = local!oldCase[recordType!CMGT_Case.priorityId],\n            null,\n            cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_PRIORITY\n          ),\n          if(\n            fv!item[recordType!CMGT_Case.statusId] = local!oldCase[recordType!CMGT_Case.statusId],\n            null,\n            if(\n              fv!item[recordType!CMGT_Case.statusId] = cons!CMGT_REFID_STATUS_CASE_CLOSED,\n              cons!CMGT_REFID_EVENT_TYPE_CASE_CLOSED,\n              cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_STATUS\n            )\n          ),\n          if(\n            fv!item[recordType!CMGT_Case.dueOn] = local!oldCase[recordType!CMGT_Case.dueOn],\n            null,\n            cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_DUE_DATE\n          ),\n          if(\n            fv!item[recordType!CMGT_Case.title] = local!oldCase[recordType!CMGT_Case.title],\n            null,\n            cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_CASE_TITLE\n          )\n        }\n      ),\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: local!events,\n        expression: rule!CMGT_CaseEventHistory_Constructor(\n          caseId: local!newCase[recordType!CMGT_Case.caseId],\n          initiator: ri!initiator,\n          eventTypeId: fv!item,\n          timestamp: now(),\n          details: a!match(\n            value: fv!item,\n            equals: cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_STATUS,\n            then: a!map(\n              statusId: tointeger(\n                local!newCase[recordType!CMGT_Case.statusId]\n              )\n            ),\n            equals: cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_PRIORITY,\n            then: a!map(\n              priorityId: tointeger(\n                local!newCase[recordType!CMGT_Case.priorityId]\n              )\n            ),\n            equals: cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_CASE_TITLE,\n            then: a!map(\n              title: tostring(\n                local!newCase[recordType!CMGT_Case.title]\n              )\n            ),\n            equals: cons!CMGT_REFID_EVENT_TYPE_CASE_UPDATE_DUE_DATE,\n            then: a!map(\n              dueOn: local!newCase[recordType!CMGT_Case.dueOn]\n            ),\n            default: null\n          )\n        )\n      )\n    )\n  )\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145917": {
      "name": "CMGT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000e9d3-70bf-8000-9bbd-011c48011c48_180481": {
      "name": "CMGT_UTIL_RejectBlank",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(a!flatten(ri!array)),\n  reject(a!isNullOrEmpty(_), a!flatten(ri!array))\n)"
    },
    "_a-0000ea03-1fde-8000-9be1-011c48011c48_390450": {
      "name": "CMGT_CommentDocumentMap_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!commentDocumentMaps,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    /*Always set these fields with each update*/\n    alwaysOverwrite: {},\n    /*Only modify these fields if they are currently null (default value)*/\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_CommentDocumentMap.isActive,\n        value: true\n      )\n    }\n  )\n)"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_39879": {
      "name": "CMGT_Document_SetMetaData",
      "type": "Expression Rule",
      "sail_code": "#\"SYSTEM_SYSRULES_forEach\"(\n  items: ri!documents,\n  expression: rule!CMGT_UTIL_SetRecordFields(\n    record: fv!item,\n    alwaysOverwrite: {\n      /*ri!taskCompletedOn will be removed once related record tree updation feature is released which will automatically update these metadata with parent's data*/\n      /*ri!taskCompletedOn is added, so that in the frontend we can display documents based on task completed timestamp in task summary*/\n      a!map(\n        field: recordType!CMGT_Document.modifiedOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Document.modifiedBy,\n        value: ri!initiator\n      )\n    },\n    neverOverwrite: {\n      a!map(\n        field: recordType!CMGT_Document.createdOn,\n        value: now()\n      ),\n      a!map(\n        field: recordType!CMGT_Document.createdBy,\n        value: ri!initiator\n      ),\n      a!map(\n        field: recordType!CMGT_Document.isActive,\n        value: true\n      ),\n      a!map(\n        field: recordType!CMGT_Document.isPrivate,\n        value: #\"urn:appian:function:v1:a:isusermemberofgroup?okey=a!isUserMemberOfGroup\"(\n          ri!initiator,\n          cons!CMGT_GRP_INTERNAL_USERS\n        )\n      ),\n      a!map(\n        field: recordType!CMGT_Document.documentName,\n        value: document(\n          fv!item[recordType!CMGT_Document.appianDocId],\n          \"name\"\n        )\n      ),\n      a!map(\n        field: recordType!CMGT_Document.extension,\n        value: document(\n          fv!item[recordType!CMGT_Document.appianDocId],\n          \"extension\"\n        )\n      ),\n      a!map(\n        field: recordType!CMGT_Document.size,\n        value: document(\n          fv!item[recordType!CMGT_Document.appianDocId],\n          \"size\"\n        )\n      ),\n      /*Set caseId/taskId in case it's on the object and not the FK field*/\n      a!map(\n        field: recordType!CMGT_Document.caseId,\n        value: fv!item[recordType!CMGT_Document.case.caseId]\n      ),\n      a!map(\n        field: recordType!CMGT_Document.taskId,\n        value: fv!item[recordType!CMGT_Document.task.taskId]\n      )\n    }\n  )\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ea13-fced-8000-9be9-011c48011c48_481668": {
      "name": "CMGT_Role_SetEvents",
      "type": "Expression Rule",
      "sail_code": "a!match(\n  value: ri!context,\n  whenTrue: rule!CMGT_UTIL_IsBlank(\n    ri!roles\n  ),\n  then: {},\n  equals: \"CASE\",\n  then: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!roles,\n    expression: rule!CMGT_CaseEventHistory_Constructor(\n      caseId: fv!item[recordType!CMGT_Role.caseId],\n      initiator: ri!initiator,\n      eventTypeId: a!match(\n        value: fv!item[recordType!CMGT_Role.roleTypeId],\n        equals: cons!CMGT_SELF_REFID_ROLE_TYPE_CLAIMANT,\n        then: cons!CMGT_SELF_REFID_EVENT_TYPE_CASE_ADD_CLAIMANT,\n        equals: cons!CMGT_REFID_ROLE_TYPE_WATCHER,\n        then: if(\n          fv!item[recordType!CMGT_Role.isActive],\n          cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_WATCHER,\n          cons!CMGT_REFID_EVENT_TYPE_CASE_REMOVED_WATCHER\n        ),\n        equals: cons!CMGT_LA_REFID_ROLE_TYPE_SUBMITTER,\n        then: cons!CMGT_LA_REFID_EVENT_TYPE_CASE_ADD_SUBMITTER,\n        whenTrue: or(\n          fv!value = cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n          fv!value = cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE\n        ),\n        then: if(\n          fv!item[recordType!CMGT_Role.isActive],\n          cons!CMGT_REFID_EVENT_TYPE_CASE_ADD_ASSIGNEE,\n          cons!CMGT_REFID_EVENT_TYPE_CASE_REMOVED_ASSIGNEE\n        ),\n        default: {}\n      ),\n      details: a!map(\n        user: tostring(\n          fv!item[recordType!CMGT_Role.username]\n        ),\n        groupId: tointeger(\n          fv!item[recordType!CMGT_Role.groupId]\n        )\n      )\n    )\n  ),\n  equals: \"TASK\",\n  then: a!flatten(\n    #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!roles,\n      expression: a!localVariables(\n        local!originalRole: rule!CMGT_UTIL_Filter(\n          records: ri!originalRoles,\n          field: recordType!CMGT_Role.roleId,\n          value: fv!item[recordType!CMGT_Role.roleId]\n        ),\n        if(\n          /*new role or change in active flag, create event*/\n          or(\n            a!isNullOrEmpty(\n              local!originalRole\n            ),\n            and(\n              a!isNotNullOrEmpty(\n                local!originalRole\n              ),\n              local!originalRole[recordType!CMGT_Role.isActive] <> fv!item[recordType!CMGT_Role.isActive]\n            )\n          ),\n          rule!CMGT_TaskEventHistory_Constructor(\n            taskId: fv!item[recordType!CMGT_Role.taskId],\n            initiator: ri!initiator,\n            eventTypeId: if(\n              fv!item[recordType!CMGT_Role.isActive],\n              cons!CMGT_REFID_EVENT_TYPE_TASK_ADD_ASSIGNEE,\n              cons!CMGT_REFID_EVENT_TYPE_TASK_REMOVED_ASSIGNEE\n            ),\n            details: a!map(\n              user: tostring(\n                fv!item[recordType!CMGT_Role.username]\n              ),\n              groupId: tointeger(\n                fv!item[recordType!CMGT_Role.groupId]\n              )\n            )\n          ),\n          {}\n        )\n      )\n    )\n  ),\n  default: {}\n)"
    },
    "0005e99a-e08b-8000-fcf0-7f0000014e7a": {
      "name": "CMGT_CaseTagMap_Delete",
      "type": "Process Model",
      "sail_code": "// Input: ?\n=#\"urn:appian:function:v1:a:update\"( data:pv!caseTagMaps, index: recordType!CMGT_CaseTagMap.isActive, value: false )\n\n// Output: ?\nrule!CMGT_Case_SetMetaData(\n  cases: #\"SYSTEM_SYSRULES_forEach\"(\n    items: rule!CMGT_UTIL_Distinct(\n      ac!caseTagMap[recordType!CMGT_CaseTagMap.caseId]\n    ),\n    expression: recordType!CMGT_Case(\n      recordType!CMGT_Case.caseId: fv!item,\n      recordType!CMGT_Case.tagMap: rule!CMGT_UTIL_Filter(\n        records: ac!caseTagMap,\n        field: recordType!CMGT_CaseTagMap.caseId,\n        value: fv!item\n      )\n    )\n  ),\n  initiator: pp!initiator,\n  eventType: cons!CMGT_TXT_EVENT_TYPE_CASE_MODIFY_CHILD_RECORD\n)\n\n// Input: ?\npv!case\n\n// Input: ?\n=recordType!CMGT_Case"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_19509": {
      "name": "CMGT_QR_GetCase",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Case,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.caseId,\n      operator: \"in\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \">\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate - 1,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Case.dueOn,\n      operator: \"<=\",\n      value: rule!CMGT_UTIL_ConvertDatetoDatetime(\n        date: ri!dueOnDate,\n        useSystemTimeZone: a!defaultValue(ri!useSystemTimeZoneForDueOn,true)\n      )\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpression,\n  fields: {\n    ri!fields,\n    if(\n      ri!excludeRelatedRecords,\n      {},\n      {\n        recordType!CMGT_Case.status,\n        recordType!CMGT_Case.priority,\n        recordType!CMGT_Case.caseType\n      }\n    ),\n    if(\n      ri!includeAssignees,\n      {\n        recordType!CMGT_Case.roles,\n        recordType!CMGT_Case.roles\n      },\n      {}\n    ),\n    if(\n      ri!includePrimaryContact,\n      {\n        recordType!CMGT_Case.caseEntityMap,\n        #\"urn:appian:record-relationship:v1:d81cdd0e-c54d-4b8e-beec-b7ae37fefe7f/9455b8a8-142d-4976-8b8d-83403eedad6a/043457e2-ee0b-4c7a-8210-8671bbe73128/2a2b64c2-0530-4e0a-a173-d26a396e3cc9\"\n      },\n      {}\n    )\n  },\n  relatedRecordData: {\n    ri!relatedRecordData,\n    if(\n      ri!includePrimaryContact,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.caseEntityMap,\n        limit: 1,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_CaseEntityMap.entity.entityTypeId,\n          operator: \"=\",\n          value: cons!CMGT_REFID_ENTITY_TYPE_CONTACT\n        )\n      ),\n      {}\n    ),\n    if(\n      ri!includeAssignees,\n      #\"SYSTEM_SYSRULES_relatedRecordData\"(\n        relationship: recordType!CMGT_Case.roles,\n        filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n          field: recordType!CMGT_Role.roleTypeId,\n          operator: \"in\",\n          value: {\n            cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n            cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE\n          }\n        )\n      ),\n      {}\n    )\n  },\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    }
  }
}
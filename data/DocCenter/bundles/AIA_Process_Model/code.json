{
  "_metadata": {
    "bundle_id": "AIA_Process_Model"
  },
  "objects": {
    "_a-0000ec2d-5396-8000-9bdc-011c48011c48_40839": {
      "name": "AIA_Test_GetLatestExtractionInstance",
      "type": "Expression Rule",
      "sail_code": "rule!AIA_Extraction_GetInstanceById(\n  identifier: #\"SYSTEM_SYSRULES_queryRecordType_v3\"(\n    recordType: recordType!AIA Extraction Instance,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n      startIndex: 1,\n      batchSize: 1,\n      sort: {\n        #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: recordType!AIA Extraction Instance.id\n        )\n      }\n    )\n  ).data[recordType!AIA Extraction Instance.id],\n  additionalFields: {\n    recordType!AIA Extraction Instance.instanceUuid,\n    recordType!AIA Extraction Instance.modelVersion.versionId,\n    recordType!AIA Extraction Instance.modelVersion.modelId,\n    recordType!AIA Extraction Instance.modelVersion.uuid,\n    recordType!AIA Extraction Instance.modelVersion.extractionModel.key,\n    recordType!AIA Extraction Instance.documentFolderId,\n    recordType!AIA Extraction Instance.fieldCount,\n    recordType!AIA Extraction Instance.sections,\n    recordType!AIA Extraction Instance.boundingBoxes,\n    recordType!AIA Extraction Instance.responseDocumentId,\n    recordType!AIA Extraction Instance.sourceDocumentId\n  }\n)"
    },
    "063137b5-587a-44c8-8099-d20489ca5df5": {
      "name": "AIA_ProcessModelSummary",
      "type": "Interface",
      "sail_code": "{\n  #\"SYSTEM_SYSRULES_sectionLayout_v1\"(\n    label: \"Process Model\",\n    contents: {\n      #\"SYSTEM_SYSRULES_columnsLayout\"(\n        columns: {\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_textField\"(\n                label: \"Name\",\n                labelPosition: \"JUSTIFIED\",\n                value: a!defaultValue(\n                  ri!record[recordType!AIA Process Model.name],\n                  \"–\"\n                ),\n                readOnly: true\n              ),\n              #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                alignVertical: \"MIDDLE\",\n                items: if(\n                  or(\n                    isnull(\n                      ri!record[recordType!AIA Process Model.createdBy]\n                    ),\n                    not(\n                      isusernametaken(\n                        ri!record[recordType!AIA Process Model.createdBy]\n                      )\n                    )\n                  ),\n                  #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                    item: #\"SYSTEM_SYSRULES_textField\"(\n                      label: \"Created By\",\n                      labelPosition: \"JUSTIFIED\",\n                      value: \"–\",\n                      readOnly: true\n                    )\n                  ),\n                  {\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      item: #\"SYSTEM_SYSRULES_imageField_v1\"(\n                        label: \"Created By\",\n                        labelPosition: \"JUSTIFIED\",\n                        images: #\"SYSTEM_SYSRULES_userImage\"(\n                          user: ri!record[recordType!AIA Process Model.createdBy]\n                        ),\n                        size: \"TINY\",\n                        style: \"AVATAR\"\n                      ),\n                      width: \"MINIMIZE\"\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                          text: {\n                            rule!AIA_UTIL_displayUserFullName(\n                              userName: ri!record[recordType!AIA Process Model.createdBy]\n                            )\n                          },\n                          link: #\"SYSTEM_SYSRULES_userRecordLink\"(\n                            user: ri!record[recordType!AIA Process Model.createdBy]\n                          )\n                        )\n                      )\n                    )\n                  }\n                )\n              ),\n              #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                alignVertical: \"MIDDLE\",\n                items: if(\n                  or(\n                    isnull(\n                      ri!record[recordType!AIA Process Model.modifiedBy]\n                    ),\n                    not(\n                      isusernametaken(\n                        ri!record[recordType!AIA Process Model.modifiedBy]\n                      )\n                    )\n                  ),\n                  #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                    item: #\"SYSTEM_SYSRULES_textField\"(\n                      label: \"Modified By\",\n                      labelPosition: \"JUSTIFIED\",\n                      value: \"–\",\n                      readOnly: true\n                    )\n                  ),\n                  {\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      item: #\"SYSTEM_SYSRULES_imageField_v1\"(\n                        label: \"Modified By\",\n                        labelPosition: \"JUSTIFIED\",\n                        images: #\"SYSTEM_SYSRULES_userImage\"(\n                          user: ri!record[recordType!AIA Process Model.modifiedBy]\n                        ),\n                        size: \"TINY\",\n                        style: \"AVATAR\"\n                      ),\n                      width: \"MINIMIZE\"\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                          text: {\n                            rule!AIA_UTIL_displayUserFullName(\n                              userName: ri!record[recordType!AIA Process Model.modifiedBy]\n                            )\n                          },\n                          link: #\"SYSTEM_SYSRULES_userRecordLink\"(\n                            user: ri!record[recordType!AIA Process Model.modifiedBy]\n                          )\n                        )\n                      )\n                    )\n                  }\n                )\n              )\n            }\n          ),\n          #\"SYSTEM_SYSRULES_columnLayout\"(\n            contents: {\n              #\"SYSTEM_SYSRULES_textField\"(\n                label: \"Description\",\n                labelPosition: \"JUSTIFIED\",\n                value: a!defaultValue(\n                  ri!record[recordType!AIA Process Model.description],\n                  \"–\"\n                ),\n                readOnly: true\n              ),\n              #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                label: \"Created On\",\n                labelPosition: \"JUSTIFIED\",\n                value: if(\n                  isnull(\n                    ri!record[recordType!AIA Process Model.createdOn]\n                  ),\n                  \"–\",\n                  {\n                    #\"SYSTEM_SYSRULES_richTextIcon\"(icon: \"calendar-o\", color: \"SECONDARY\"),\n                    \" \",\n                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: text(\n                        ri!record[recordType!AIA Process Model.createdOn],\n                        \"mmmm d, yyyy h:mm AM/PM\"\n                      )\n                    )\n                  }\n                )\n              ),\n              #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                label: \"Modified On\",\n                labelPosition: \"JUSTIFIED\",\n                value: if(\n                  isnull(\n                    ri!record[recordType!AIA Process Model.modifiedOn]\n                  ),\n                  \"–\",\n                  {\n                    #\"SYSTEM_SYSRULES_richTextIcon\"(icon: \"calendar-o\", color: \"SECONDARY\"),\n                    \" \",\n                    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                      text: text(\n                        ri!record[recordType!AIA Process Model.modifiedOn],\n                        \"mmmm d, yyyy h:mm AM/PM\"\n                      )\n                    )\n                  }\n                )\n              )\n            }\n          )\n        }\n      ),\n      rule!AIA_ProcessModelStepCards(record: ri!record)\n    },\n    labelSize: \"MEDIUM\",\n    labelColor: \"STANDARD\",\n    labelHeadingTag: \"H2\",\n    divider: \"ABOVE\",\n    marginAbove: \"STANDARD\",\n    marginBelow: \"MORE\",\n    accessibilityText: #\"urn:appian:translation-string:v1:97426cb9-3c71-4f38-a2c0-a1bba89570ca\"\n  )\n}"
    },
    "_a-0000ec1e-9975-8000-9bd6-011c48011c48_1376722": {
      "name": "AIA_PercentageColor",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!valueAsDecimal: if(\n    ri!isPercentage = false,\n    ri!value / 100,\n    ri!value\n  ),\n  local!comparisonValue: if(\n    ri!isInverted = true,\n    1 - local!valueAsDecimal,\n    local!valueAsDecimal\n  ),\n  a!match(\n    value: local!comparisonValue,\n    whenTrue: fv!value > 1000,\n    then: null,\n    whenTrue: a!isNullOrEmpty(fv!value),\n    then: if(\n      ri!isBackground,\n      \"NONE\",\n      null\n    ),\n    whenTrue: fv!value < .25,\n    then: if(\n      ri!isBackground,\n      \"ERROR\",\n      \"#DE0037\"\n    ),\n    whenTrue: fv!value < .5,\n    then: if(\n      ri!isBackground,\n      \"WARN\",\n      cons!AIA_WARN_COLOR\n    ),\n    whenTrue: fv!value < .8,\n    then: if(\n      ri!isBackground,\n      \"INFO\",\n      \"#1d659c\"\n    ),\n    whenTrue: fv!value = 1,\n    then: if(\n      ri!isBackground,\n      \"SUCCESS\",\n      \"#169602\"\n    ),\n    whenTrue: fv!value >= .8,\n    then: if(\n      ri!isBackground,\n      \"SUCCESS\",\n      \"#1CC101\"\n    ),\n    default: \"NONE\"\n  )\n)"
    },
    "_a-0000ec36-59aa-8000-9be0-011c48011c48_53588": {
      "name": "AIA_ModelAccuracyKpi",
      "type": "Interface",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!record),\n  {},\n  a!localVariables(\n    local!record: ri!record,\n    local!fields: a!match(\n      value: runtimetypeof(local!record),\n      equals: typeof(\n        recordType!AIA Extraction Model()\n      ),\n      then: a!map(\n        type: \"extractionModel\",\n        accuracyField: recordType!AIA Extraction Model.publishedVersionAccuracy,\n        primaryFilters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Model.modelId,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Model.modelId]\n          )\n        },\n        primaryText: \"Model Accuracy\",\n        tooltip: \"Average of percentage of fields accurately extracted compared to total fields\",\n        showSecondary: false\n      ),\n      equals: typeof(\n        recordType!AIA Extraction Model Version()\n      ),\n      then: a!map(\n        type: \"extractionModelVersion\",\n        accuracyField: recordType!AIA Extraction Model Version.accuracy,\n        modelVersionIdField: recordType!AIA Extraction Model Version.modelVersionId,\n        modelIdField: recordType!AIA Extraction Model Version.modelId,\n        versionIdField: recordType!AIA Extraction Model Version.versionId,\n        primaryText: \"Model Version Accuracy\",\n        tooltip: \"Average of percentage of fields accurately extracted compared to total fields\",\n        showSecondary: true\n      ),\n      equals: typeof(\n        recordType!AIA Extraction Model Version Field()\n      ),\n      then: a!map(\n        type: \"extractionField\",\n        accuracyField: recordType!AIA Extraction Model Version Field.correctPercentage,\n        primaryFilters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Model Version Field.fieldId,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Model Version Field.fieldId]\n          )\n        },\n        secondaryFilters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Model Version Field.key,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Model Version Field.key]\n          ),\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Model Version Field.version.modelId,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Model Version Field.version.modelId]\n          ),\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Model Version Field.version.versionId,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Model Version Field.version.versionId] - 1,\n            applyWhen: ri!record[recordType!AIA Extraction Model Version Field.version.versionId] > 1\n          )\n        },\n        primaryText: \"Field Accuracy\",\n        tooltip: \"Percentage of fields accurately extracted compared to total fields\",\n        showSecondary: true\n      ),\n      equals: typeof(\n        recordType!AIA Extraction Instance()\n      ),\n      then: a!map(\n        type: \"extractionInstance\",\n        accuracyField: recordType!AIA Extraction Instance.accuracy,\n        primaryFilters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Extraction Instance.id,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Extraction Instance.id]\n          )\n        },\n        primaryText: \"Instance Accuracy\",\n        tooltip: \"Percentage of fields (including table cells) accurately extracted compared to total fields\",\n        showSecondary: false\n      ),\n      equals: typeof(\n        recordType!AIA Classification Model()\n      ),\n      then: a!map(\n        type: \"classificationModel\",\n        accuracyField: recordType!AIA Classification Model.publishedAccuracy,\n        primaryFilters: {\n          #\"SYSTEM_SYSRULES_queryFilter\"(\n            field: recordType!AIA Classification Model.modelId,\n            operator: \"=\",\n            value: ri!record[recordType!AIA Classification Model.modelId]\n          )\n        },\n        primaryText: \"Model Accuracy\",\n        tooltip: \"Classification accuracy\",\n        showSecondary: false\n      ),\n      equals: typeof(\n        recordType!AIA Classification Model Version()\n      ),\n      then: a!map(\n        type: \"classificationModelVersion\",\n        accuracyField: recordType!AIA Classification Model Version.accuracyAvg,\n        modelVersionIdField: recordType!AIA Classification Model Version.modelVersionId,\n        modelIdField: recordType!AIA Classification Model Version.modelId,\n        versionIdField: recordType!AIA Classification Model Version.versionId,\n        primaryText: \"Model Version Accuracy\",\n        tooltip: \"Percentage of times classification was not overridden\",\n        showSecondary: true\n      ),\n      default: null\n    ),\n    if(\n      a!isNullOrEmpty(ri!record[local!fields.accuracyField]),\n      #\"SYSTEM_SYSRULES_kpiField\"(\n        icon: \"line-chart\",\n        iconStyle: \"STAMP\",\n        primaryText: \"Awaiting Accuracy Results\",\n        trend: \"DIFFERENCE\",\n        template: \"ADJACENT\",\n        align: \"CENTER\",\n        size: \"STANDARD\",\n        refreshAlways: false,\n        refreshAfter: \"RECORD_ACTION\"\n      ),\n      #\"SYSTEM_SYSRULES_kpiField\"(\n        data: #\"SYSTEM_SYSRULES_recordData\"(\n          recordType: a!match(\n            value: local!fields.type,\n            equals: \"extractionModel\",\n            then: recordType!AIA Extraction Model,\n            equals: \"extractionModelVersion\",\n            then: recordType!AIA Extraction Model Version,\n            equals: \"classificationModel\",\n            then: recordType!AIA Classification Model,\n            equals: \"classificationModelVersion\",\n            then: recordType!AIA Classification Model Version,\n            equals: \"extractionField\",\n            then: recordType!AIA Extraction Model Version Field,\n            equals: \"extractionInstance\",\n            then: recordType!AIA Extraction Instance,\n            default: null\n          ),\n          filters: local!fields.dataFilters\n        ),\n        primaryMeasure: #\"SYSTEM_SYSRULES_measure\"(\n          function: \"MAX\",\n          field: local!fields.accuracyField,\n          filters: a!defaultValue(\n            local!fields.primaryFilters,\n            {\n              #\"SYSTEM_SYSRULES_queryFilter\"(\n                field: local!fields.modelVersionIdField,\n                operator: \"=\",\n                value: ri!record[local!fields.modelVersionIdField]\n              )\n            }\n          ),\n          formatValue: rule!AIA_DisplayPercentage(value: fv!value)\n        ),\n        primaryMeasureColor: rule!AIA_PercentageColor(\n          value: ri!record[local!fields.accuracyField]\n        ),\n        secondaryMeasure: if(\n          local!fields.showSecondary,\n          #\"SYSTEM_SYSRULES_measure\"(\n            function: \"AVG\",\n            field: local!fields.accuracyField,\n            filters: a!defaultValue(\n              local!fields.secondaryFilters,\n              #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                operator: \"AND\",\n                filters: {\n                  #\"SYSTEM_SYSRULES_queryFilter\"(\n                    field: local!fields.modelIdField,\n                    operator: \"=\",\n                    value: ri!record[local!fields.modelIdField]\n                  ),\n                  #\"SYSTEM_SYSRULES_queryFilter\"(\n                    field: local!fields.versionIdField,\n                    operator: \"=\",\n                    value: ri!record[local!fields.versionIdField] - 1,\n                    applyWhen: ri!record[local!fields.versionIdField] > 1\n                  )\n                }\n              )\n            ),\n            formatValue: rule!AIA_DisplayPercentage(value: fv!value)\n          ),\n          null\n        ),\n        primaryText: local!fields.primaryText,\n        icon: \"bullseye-alt\",\n        iconColor: rule!AIA_PercentageColor(\n          value: ri!record[local!fields.accuracyField]\n        ),\n        trend: \"DIFFERENCE\",\n        trendFormat: rule!AIA_DisplayPercentage(value: fv!value),\n        template: \"ADJACENT\",\n        align: \"CENTER\",\n        size: \"STANDARD\",\n        tooltip: local!fields.tooltip,\n        refreshAlways: false,\n        refreshAfter: \"RECORD_ACTION\"\n      )\n    )\n  )\n)"
    },
    "_a-0000ec1e-9975-8000-9bd6-011c48011c48_1375434": {
      "name": "AIA_DisplayPercentage",
      "type": "Expression Rule",
      "sail_code": "if(\n  or(\n    a!isNullOrEmpty(ri!value),\n    ri!value > 100000\n  ),\n  \"\",\n  fixed(\n    round(ri!value * if(a!defaultValue(ri!isPercentage, true), 100, 1), a!defaultValue(ri!precision, 0)),\n    a!defaultValue(ri!precision, 0),\n    true\n  ) & \"%\"\n)"
    },
    "_a-0000ec40-0355-8000-9be4-011c48011c48_70598": {
      "name": "AIA_ProcessModelStepCards",
      "type": "Interface",
      "sail_code": "{\n  #\"SYSTEM_SYSRULES_columnsLayout\"(\n    alignVertical: \"MIDDLE\",\n    columns: #\"SYSTEM_SYSRULES_forEach\"(\n      items: ri!record[recordType!AIA Process Model.steps],\n      expression: {\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          width: \"10X\",\n          contents: {\n            #\"SYSTEM_SYSRULES_cardLayout\"(\n              /*style: \"TRANSPARENT\",*/\n              contents: {\n                #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n                  alignVertical: \"MIDDLE\",\n                  items: {\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      width: \"MINIMIZE\",\n                      item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        align: \"CENTER\",\n                        value: {\n                          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                            text: a!defaultValue(\n                              fv!item[recordType!AIA Process Model Step.classificationModel.name],\n                              fv!item[recordType!AIA Process Model Step.extractionModel.name]\n                            ),\n                            size: \"MEDIUM_PLUS\"\n                          )\n                        }\n                      )\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                      width: \"MINIMIZE\",\n                      item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n                        labelPosition: \"COLLAPSED\",\n                        align: \"LEFT\",\n                        value: {\n                          #\"SYSTEM_SYSRULES_richTextIcon\"(\n                            icon: a!match(\n                              value: fv!item[recordType!AIA Process Model Step.modelType],\n                              equals: cons!AIA_MODEL_TYPE_VALUES[1],\n                              then: \"atom\",\n                              equals: cons!AIA_MODEL_TYPE_VALUES[2],\n                              then: \"search\",\n                              default: null\n                            ),\n                            size: \"MEDIUM\",\n                            caption: proper(fv!item[recordType!AIA Process Model Step.modelType])\n                          )\n                        }\n                      )\n                    ),\n                    #\"SYSTEM_SYSRULES_sideBySideItem\"(),\n                  }\n                ),\n                rule!AIA_ModelAccuracyKpi(\n                  record: a!defaultValue(\n                    fv!item[recordType!AIA Process Model Step.classificationModel],\n                    fv!item[recordType!AIA Process Model Step.extractionModel]\n                  )\n                )\n              },\n              marginBelow: \"NONE\",\n              shape: \"SEMI_ROUNDED\"\n            )\n          }\n        ),\n        #\"SYSTEM_SYSRULES_columnLayout\"(\n          width: \"1X\",\n          contents: {\n            #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              labelPosition: \"COLLAPSED\",\n              value: #\"SYSTEM_SYSRULES_richTextIcon\"(\n                icon: \"angle-right\",\n                size: \"LARGE_PLUS\",\n                color: \"#CCC\"\n              ),\n              align: \"CENTER\"\n            )\n          },\n          showWhen: not(fv!isLast)\n        )\n      }\n    ),\n    marginBelow: \"MORE\",\n    spacing: \"DENSE\"\n  )\n}"
    },
    "_a-0000ed46-3c8c-8000-9bac-011c48011c48_34420": {
      "name": "AIA_UTIL_displayUserFullName",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!userName),\n  ri!defaultValue,\n  try(\n    tostring(\n      concat(\n        user(ri!userName, \"firstName\"),\n        \" \",\n        user(ri!userName, \"lastName\")\n      )\n    ),\n    a!defaultValue(ri!defaultValue, \"System\")\n  )\n)"
    }
  }
}
{
  "uuid": "_a-0000ed7d-5e46-8000-9d4b-011c48011c48_3826501",
  "name": "CMGT_Rules_FormatAssignAction",
  "type": "Expression Rule",
  "description": "General rule to format Assign Action, used for both Case and Task",
  "sail_code": "a!localVariables(\n  local!assignmentParams: if(\n    rule!CMGT_UTIL_IsBlank(\n      ri!assignmentJson\n    ),\n    {},\n    #\"SYSTEM_SYSRULES_fromJson_v1\"(\n      ri!assignmentJson\n    )\n  ),\n  local!action: rule!CMGT_UTIL_Filter(\n    records: rule!CMGT_CFG_ENUM_ACTIONS(),\n    field:\"actionCode\",\n    value: ri!actionCode\n  ),\n  {\n    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n      text: lower(\n        local!action.name\n      ) & \" \",\n      style: \"STRONG\",\n      size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n      color: a!defaultValue(\n        ri!textColor,\n        \"STANDARD\"\n      )\n    ),\n    #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n      text: #\"urn:appian:translation-string:v1:b10266ed-ce12-41dd-80ee-94e0fcf812ea\" & \" \",\n      size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n      color: a!defaultValue(\n        ri!textColor,\n        \"STANDARD\"\n      )\n    ),\n    /*displays the correct formatting based off of whether the user selects, group, role, or user in the configuration screen\n    NOTE: this will need to be updated once https://appian-eng.atlassian.net/browse/CM-4910 has been worked on*/\n    a!match(\n      value: ri!assigneeType,\n      equals: \"GROUP\",\n      then: {\n        a!localVariables(\n          local!group: tointeger(\n            index(\n              local!assignmentParams,\n              \"groups\",\n              \"id\",\n              null\n            )[1]\n          ),\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: group(\n              local!group,\n              \"groupName\"\n            ),\n            style: \"STRONG\",\n            size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n            color: a!defaultValue(\n              ri!textColor,\n              \"STANDARD\"\n            ),\n            showWhen: rule!CMGT_UTIL_IsNotBlank(\n              local!group\n            )\n          )\n        ),\n        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: \" \" & #\"urn:appian:translation-string:v1:0cbc9214-f878-47ff-9c51-572be3971030\" & \" \",\n          size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n          color: a!defaultValue(\n            ri!textColor,\n            \"STANDARD\"\n          )\n        ),\n        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: a!match(\n            value: ri!routingType,\n            equals: cons!CMGT_WFL_TXT_ROUTING_ROUND_ROBIN,\n            then: #\"urn:appian:translation-string:v1:6adab87e-7d06-4086-805b-38ef932f83f9\",\n            equals: cons!CMGT_WFL_TXT_ROUTING_WORKLOAD_BALANCE,\n            then: #\"urn:appian:translation-string:v1:1d9871b5-eb62-41cb-a04e-a4bb7ea9c39c\",\n            equals: cons!CMGT_WFL_TXT_ROUTING_SHARED_QUEUE,\n            then: #\"urn:appian:translation-string:v1:4795438e-d468-4e7e-afd2-7be48845b849\",\n            default: \"\"\n          ),\n          style: \"STRONG\",\n          size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n          color: a!defaultValue(\n            ri!textColor,\n            \"STANDARD\"\n          )\n        ),\n        #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: \" \" & #\"urn:appian:translation-string:v1:9434beff-5ecd-40aa-a99d-6547dda0f35e\",\n          size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n          color: a!defaultValue(\n            ri!textColor,\n            \"STANDARD\"\n          )\n        )\n      },\n      equals: \"ROLE\",\n      then: a!localVariables(\n        local!rolesList: rule!CMGT_QR_GetRoleType(\n          returnType: \"OBJECT_ARRAY\",\n          roleTypeId: {\n            cons!CMGT_WFL_REFID_ROLE_TYPE_SUBMITTER,\n            cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE\n          }\n        ),\n        local!extractedRoleIds: tointeger(\n          a!flatten(\n            index(\n              local!assignmentParams,\n              \"roles\",\n              null\n            )\n          )\n        ),\n        {\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: joinarray(\n              if(\n                contains(\n                  {\n                    cons!CMGT_CFG_TXT_ACT_ASSIGN_TASK,\n                    cons!CMGT_CFG_TXT_ACT_REASSIGN_TASK\n                  },\n                  ri!actionCode\n                ),\n                #\"SYSTEM_SYSRULES_forEach\"(\n                  items: local!rolesList[wherecontains(\n                    local!extractedRoleIds, local!rolesList[recordType!CMGT_CFG_RoleType.roleTypeId]\n                  )][recordType!CMGT_CFG_RoleType.label],\n                  expression: concat(\"Case \", fv!item)\n                ),\n                local!rolesList[wherecontains(\n                  local!extractedRoleIds, local!rolesList[recordType!CMGT_CFG_RoleType.roleTypeId]\n                )][recordType!CMGT_CFG_RoleType.label]\n              ),\n              \", \"\n            ),\n            style: \"STRONG\",\n            size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n            color: a!defaultValue(\n              ri!textColor,\n              \"STANDARD\"\n            )\n          )\n        }\n      ),\n      equals: \"USER\",\n      then: a!localVariables(\n        local!extractedUsernames: a!flatten(\n          index(\n            local!assignmentParams,\n            \"users\",\n            \"id\",\n            null\n          )\n        ),\n        {\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: #\"urn:appian:translation-string:v1:20734616-ee15-454c-ab98-797a0023e1d8\" & \" \",\n            size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n            color: a!defaultValue(\n              ri!textColor,\n              \"STANDARD\"\n            )\n          ),\n          #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n            text: joinarray(\n              #\"SYSTEM_SYSRULES_forEach\"(\n                items: local!extractedUsernames,\n                expression: rule!CMGT_UTIL_DisplayUserFullName(\n                  username: fv!item\n                )\n              ),\n              \", \"\n            ),\n            style: \"STRONG\",\n            size: a!defaultValue(ri!textSize, \"MEDIUM\"),\n            color: a!defaultValue(\n              ri!textColor,\n              \"STANDARD\"\n            )\n          )\n        }\n      ),\n      default: \"DEFAULT\"\n    )\n  }\n)",
  "calls": [
    {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_CFG_ENUM_ACTIONS",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_QR_GetRoleType",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_DisplayUserFullName",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_WFL_TXT_ROUTING_ROUND_ROBIN",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_WFL_TXT_ROUTING_WORKLOAD_BALANCE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_WFL_TXT_ROUTING_SHARED_QUEUE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_WFL_REFID_ROLE_TYPE_SUBMITTER",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_CFG_TXT_ACT_ASSIGN_TASK",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_CFG_TXT_ACT_REASSIGN_TASK",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_CFG_RoleType",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    }
  ],
  "called_by": [
    {
      "name": "CMGT_Case_Rules_FormatAssignAction",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_WFL_CaseType_Rules_FormatAssignAction",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    }
  ]
}
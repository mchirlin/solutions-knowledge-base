{
  "_metadata": {
    "bundle_id": "AS_GCM_Export_Clause_Usage_Report"
  },
  "objects": {
    "_a-0000e61a-f20f-8000-9ba5-011c48011c48_53662": {
      "name": "AS_GAM_CO_I18N_UT_displayLabel",
      "type": "Expression Rule",
      "sail_code": "cast(\n  'type!{http://www.appian.com/ae/types/2009}Text',\n  a!localVariables(\n    local!result: a!refreshVariable(\n      value: if(\n        rule!AS_CO_UT_isBlank(ri!bundleKey),\n        null,\n        if(\n          rule!AS_CO_UT_isBlank(ri!arguments),\n          rule!AS_CO_UT_replaceNull(\n            nullableValue: ri!bundle[ri!bundleKey],\n            replacementValue: ri!bundleKey\n          ),\n          rule!AS_GAM_CO_I18N_UT_replaceArguments(\n            bundleKey: ri!bundle[ri!bundleKey],\n            arguments: ri!arguments\n          )\n        )\n      ),\n      refreshAlways: true\n    ),\n    local!result\n  )\n)"
    },
    "_a-0000e61a-f20f-8000-9ba5-011c48011c48_53654": {
      "name": "AS_GCM_CO_UT_loadBundleFromFolder",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!lang: \"en_US\",\n/* below is deprecated for now, uncomment to support multi-language display */\n  /*if(*/\n    /*isnull(ri!langISOCode),*/\n    /*userlocale(loggedInUser()),*/\n    /*ri!langISOCode*/\n  /*),*/\n  local!bundleName: rule!AS_GCM_determineValueBySolutionFlavor(\n    options: cons!AS_GCM_TXT_VALID_SOLUTION_FLAVORS\n  ),\n  /*local!bundleName*/\n  local!output: loadbundlepropertiesfile(\n    cons!AS_GCM_FLD_PROPERTIES_FILES,\n    local!lang,\n    local!bundleName\n  )[local!bundleName],\n  local!output\n)"
    },
    "0009edd6-cab3-8000-d185-7f0000014e7a": {
      "name": "AS GCM Export Clause Usage Report",
      "type": "Process Model",
      "sail_code": "// Input: ?\n={pv!clauseUsageReportClauses}\n\n// Input: ?\n={recordType!AS GCM Clause Usage Report Clauses}\n\n// Output: ?\nrule!AS_GCM_updateClauseUsageReportClauses(\n  clauseUsageReportClauses: pv!clauseUsageReportClauses\n)\n\n// Input: ?\n=cons!AS_GCM_ENT_CLAUSE_USAGE_REPORT_CLAUSES\n\n// Input: ?\n= #\"SYSTEM_SYSRULES_querySelection\"( columns: { #\"SYSTEM_SYSRULES_queryColumn\"( field: \"refClause.clauseNumber\", alias: \"Clause_Number\" ), #\"SYSTEM_SYSRULES_queryColumn\"( field: \"refClause.clauseTitle\", alias: \"Clause_Title\" ), #\"SYSTEM_SYSRULES_queryColumn\"( field: \"refClause.alternateValue\", alias: \"Alternate_Value\" ), #\"SYSTEM_SYSRULES_queryColumn\"( field: \"deviation\", alias: \"Deviation\" ), #\"SYSTEM_SYSRULES_forEach\"( items: pv!selectedColumns, expression: #\"SYSTEM_SYSRULES_queryColumn\"( field: fv!item.cdtField, alias: fv!item.cdtField ) ) })\n\n// Input: ?\n= #\"SYSTEM_SYSRULES_queryFilter\"( field: \"reportId\", operator: \"=\", value: pv!clauseUsageReport[recordType!AS GCM Clause Usage Report.reportId])\n\n// Input: ?\n=pv!clauseUsageReport[recordType!AS GCM Clause Usage Report.reportName]\n\n// Input: ?\n=cons!AS_GCM_FLD_TEMPORARY_DOCUMENT_FOLDER\n\n// Input: ?\n=\"A2\"\n\n// Input: ?\n=rule!AS_GCM_ClauseUsageReport_CustomCellPositionAndValues( selectedColumns: pv!selectedColumns, isReturnPositions: true)\n\n// Input: ?\n=rule!AS_GCM_ClauseUsageReport_CustomCellPositionAndValues( selectedColumns: pv!selectedColumns, isReturnPositions: false)\n\n// Output: ?\nappian:record-field:v1:29dc9f28-ea45-4c45-be53-c031dd2ca92d/2609fc99-7c0d-4963-9070-ab46068549d6\"]:ac!NewDocument"
    },
    "_a-0000edd3-c8fc-8000-9e0d-011c48011c48_15948010": {
      "name": "AS_GCM_ClauseUsageReport_CustomCellPositionAndValues",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!bundle: rule!AS_GCM_CO_UT_loadBundleFromFolder(langISOCode: null()),\n  if(\n    ri!isReturnPositions = true,\n    {\n      \"A1\",\n      \"B1\",\n      \"C1\",\n      \"D1\",\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: ri!selectedColumns,\n        expression: char(68 + fv!index) & \"1\"\n      )\n    },\n    {\n      \"\",\n      \"\",\n      \"Alternate Value\",\n      \"Deviation\",\n      #\"SYSTEM_SYSRULES_forEach\"(\n        items: ri!selectedColumns,\n        expression: fv!item.label\n      )\n    }\n  )\n)"
    },
    "_a-0000edd3-c8fc-8000-9e0d-011c48011c48_15931733": {
      "name": "AS_GCM_ClauseUsageReport_ColumnConfig",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!bundle: rule!AS_GCM_CO_UT_loadBundleFromFolder(langISOCode: null()),\n  {\n    a!map(\n      cdtField: \"clauseType\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"lbl_ClauseType\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.refType.refKey,\n      width: \"NARROW_PLUS\",\n      helpToolTip: null\n    ),\n    a!map(\n      cdtField: \"clauseSource\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"lbl_ClauseSource\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.refSource.refKey,\n      width: \"NARROW_PLUS\",\n      helpToolTip: null\n    ),\n    a!map(\n      cdtField: \"clauseSetCount\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"lbl_ClauseSets\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.clauseSetCount,\n      width: \"NARROW_PLUS\",\n      helpToolTip: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"hlp_ClauseSetsCount\",\n        bundle: local!bundle\n      )\n    ),\n    a!map(\n      cdtField: \"manuallyAddedCountInClauseSet\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"txt_TimesAddedManually\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.manuallyAddedCountInClauseSet,\n      width: \"NARROW_PLUS\",\n      helpToolTip: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"hlp_TimesAddedManually\",\n        bundle: local!bundle\n      )\n    ),\n    a!map(\n      cdtField: \"manuallyRemovedCountFromClauseSet\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"txt_TimesRemovedManually\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.manuallyRemovedCountFromClauseSet,\n      width: \"NARROW_PLUS\",\n      helpToolTip: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"hlp_TimesRemovedManually\",\n        bundle: local!bundle\n      )\n    ),\n    a!map(\n      cdtField: \"ruleCount\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"lbl_Rules\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.ruleCount,\n      width: \"NARROW_PLUS\",\n      helpToolTip: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"hlp_RuleCount\",\n        bundle: local!bundle\n      )\n    ),\n    a!map(\n      cdtField: \"templateCount\",\n      label: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"lbl_Templates\",\n        bundle: local!bundle\n      ),\n      recordField: recordType!AS GCM R Clause.templateCount,\n      width: \"NARROW_PLUS\",\n      helpToolTip: rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundleKey: \"hlp_TemplateCount\",\n        bundle: local!bundle\n      )\n    )\n  }\n)"
    },
    "_a-0000edd3-c8fc-8000-9e0d-011c48011c48_15947294": {
      "name": "AS_GCM_updateClauseUsageReportClauses",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!bundle: rule!AS_GCM_CO_UT_loadBundleFromFolder(langISOCode: null()),\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!clauseUsageReportClauses,\n    expression: #\"urn:appian:function:v1:a:update\"(\n      data: fv!item,\n      index: {\n        recordType!AS GCM Clause Usage Report Clauses.deviation,\n        recordType!AS GCM Clause Usage Report Clauses.clauseType,\n        recordType!AS GCM Clause Usage Report Clauses.clauseSource,\n        recordType!AS GCM Clause Usage Report Clauses.clauseSetCount,\n        recordType!AS GCM Clause Usage Report Clauses.manuallyAddedCountInClauseSet,\n        recordType!AS GCM Clause Usage Report Clauses.manuallyRemovedCountFromClauseSet,\n        recordType!AS GCM Clause Usage Report Clauses.templateCount,\n        recordType!AS GCM Clause Usage Report Clauses.ruleCount\n      },\n      value: {\n        rule!AS_GAM_CO_I18N_UT_displayLabel(\n          bundle: local!bundle,\n          bundleKey: if(\n            fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.deviation],\n            \"txt_Yes\",\n            \"txt_No\"\n          )\n        ),\n        rule!AS_GAM_CO_I18N_UT_displayLabel(\n          bundle: local!bundle,\n          bundleKey: fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.refType.refKey]\n        ),\n        rule!AS_GAM_CO_I18N_UT_displayLabel(\n          bundle: local!bundle,\n          bundleKey: fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.refSource.refKey]\n        ),\n        fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.clauseSetCount],\n        fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.manuallyAddedCountInClauseSet],\n        fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.manuallyRemovedCountFromClauseSet],\n        fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.templateCount],\n        fv!item[recordType!AS GCM Clause Usage Report Clauses.refClause.ruleCount]\n      }\n    )\n  )\n)"
    }
  }
}
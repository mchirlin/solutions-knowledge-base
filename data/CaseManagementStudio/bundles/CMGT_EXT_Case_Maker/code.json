{
  "_metadata": {
    "bundle_id": "CMGT_EXT_Case_Maker"
  },
  "objects": {
    "_a-0000ec0f-47ad-8000-9ba8-011c48011c48_16329": {
      "name": "CMGT_EXT_AdjustDateTimeForDayLightSaving",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!isDayLightSavingStartDate: and(\n    isindaylightsavingtime(ri!dateTime, \"EST5EDT\") = false(),\n    isindaylightsavingtime(ri!dateTime + 1, \"EST5EDT\")\n  ),\n  if(\n    and(\n      local!isDayLightSavingStartDate,\n      totime(ri!dateTime) >= time(2, 0, 0, 0),\n      totime(ri!dateTime) < time(3, 0, 0, 0)\n    ),\n    a!addDateTime(startDateTime: ri!dateTime, hours: 1),\n    ri!dateTime\n  )\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514373": {
      "name": "CMGT_EXT_UTIL_RandomXObjectsFromArray",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!array),\n  null,\n  a!match(\n    value: a!defaultValue(value: ri!noOfObjects, default: 1),\n    equals: 1,\n    then: index(\n      rule!CMGT_EXT_UTIL_ShuffleArray(array: ri!array),\n      1,\n      {}\n    ),\n    whenTrue: and(fv!value > 1, fv!value < length(ri!array)),\n    then: index(\n      rule!CMGT_EXT_UTIL_ShuffleArray(array: ri!array),\n      enumerate(fv!value) + 1,\n      {}\n    ),\n    /* Returning all the objects when the noOfObjects is greater than the array length    */\n    whenTrue: fv!value >= length(ri!array),\n    then: rule!CMGT_EXT_UTIL_ShuffleArray(array: ri!array),\n    default: {}\n  )\n)"
    },
    "_a-0000ece2-0128-8000-9bb8-011c48011c48_37290": {
      "name": "CMGT_UTIL_CalculateDueDateBasedOnSLA",
      "type": "Expression Rule",
      "sail_code": "if(\n  any(a!isNullOrEmpty, { ri!dateTime, ri!SLA }),\n  null(),\n  a!localVariables(\n    local!details: cast(\n      'type!{http://www.appian.com/ae/types/2009}Map',\n      if(\n        a!isNotNullOrEmpty(ri!SLA),\n        #\"SYSTEM_SYSRULES_fromJson_v1\"(ri!SLA),\n        null\n      )\n    ),\n    local!days: a!defaultValue(\n      value: index(local!details, \"days\", null()),\n      default: 0\n    ),\n    local!hours: a!defaultValue(\n      value: index(local!details, \"hours\", null()),\n      default: 0\n    ),\n    local!minutes: a!defaultValue(\n      value: index(local!details, \"minutes\", null()),\n      default: 0\n    ),\n    local!isBusinessDays: a!defaultValue(\n      value: index(local!details, \"isBusinessDays\", false()),\n      default: false()\n    ),\n    a!addDateTime(\n      startDateTime: ri!dateTime,\n      days: local!days,\n      hours: local!hours,\n      minutes: local!minutes,\n      useProcessCalendar: local!isBusinessDays\n    )\n  )\n)"
    },
    "_a-0000e9ca-3659-8000-9bb8-011c48011c48_145917": {
      "name": "CMGT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000ec0f-47ad-8000-9ba8-011c48011c48_17202": {
      "name": "CMGT_EXT_Case_CreatedOnTimeStamps",
      "type": "Expression Rule",
      "sail_code": "{\n  /*4 Cases will be generated in last 1 months so that we can get current months in due date*/\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: enumerate(4),\n    expression: rule!CMGT_EXT_AdjustDateTimeForDayLightSaving(\n      dateTime: rule!CMGT_EXT_UTIL_RandomDateTime(\n        fromDate: a!subtractDateTime(startDateTime: now(),days: 30),\n        toDate:a!subtractDateTime(startDateTime: now(), days: 20)\n      )\n    )\n  )\n  \n}"
    },
    "_a-0000ec3d-b406-8000-9bb2-011c48011c48_415813": {
      "name": "CMGT_EXT_UTIL_Distinct",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!value),\n  union(\n    a!flatten(ri!value),\n    a!flatten(ri!value)\n  )\n)"
    },
    "_a-0000ec0f-47ad-8000-9ba8-011c48011c48_18973": {
      "name": "CMGT_EXT_WFL_Case_GenerateCaseCreationMilestones_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!referenceMilestones: rule!CMGT_WFL_QR_GetReferenceMilestone(caseTypeUuid: ri!caseTypeUuid),\n  #\"SYSTEM_SYSRULES_forEach\"(\n    items: local!referenceMilestones,\n    expression: recordType!CMGT_Milestone(\n      recordType!CMGT_Milestone.referenceMilestoneUuid: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.milestoneUuid],\n      recordType!CMGT_Milestone.label: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.label],\n      recordType!CMGT_Milestone.milestoneColor: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.milestoneColor],\n      recordType!CMGT_Milestone.sortOrder: fv!item[recordType!CMGT_WFL_CFG_ReferenceMilestone.sortOrder],\n      recordType!CMGT_Milestone.isActive: true(),\n      recordType!CMGT_Milestone.createdBy: ri!createdBy,\n      recordType!CMGT_Milestone.createdOn: ri!timestamp,\n      recordType!CMGT_Milestone.modifiedBy: ri!modifiedBy,\n      recordType!CMGT_Milestone.modifiedOn: ri!timestamp\n    )\n  )\n)"
    },
    "0009ec12-eae5-8000-fa5d-7f0000014e7a": {
      "name": "CMGT_EXT_Case_Maker",
      "type": "Process Model",
      "sail_code": "// Output: ?\na!defaultValue(\n  pv!index,\n  0\n) + 1\n\n// Input: ?\n= { case: rule!CMGT_EXT_Case_GenerateCaseDetails( caseData: index(pv!caseDetails, pv!index, null()), documentMaps: pv!documentMaps, timestamp: index( rule!CMGT_EXT_Case_CreatedOnTimeStamps(), pv!index, null ) ), parentProcessId: pv!parentProcessId, datasetUuids: pv!datasetUuids}"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_20014": {
      "name": "CMGT_Case_GenerateFriendlyIdentifier_Logic",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!dateHex: dec2hex(text(today(), \"mmddyy\")),\n  local!asciiCodes: append(\n    /* ASCII codes for A-Z (65 - 90) */\n    enumerate(26) + 65,\n    /* ASCII codes for 0-9 (48 - 57) */\n    enumerate(10) + 48\n  ),\n  /* Generating 6 random alphanumeric characters */\n  local!randomAlphaNumericChars: concat(\n    char(\n      index(\n        local!asciiCodes,\n        1 + round(rand(6) * (count(local!asciiCodes) - 1), 0),\n        null\n      )\n    )\n  ),\n  joinarray(\n    {\n      a!defaultValue(\n        value: ri!case[recordType!CMGT_Case.caseType.caseTypeMetadata.prefix],\n        default: rule!CMGT_setPrefixDefault(\n          caseType: ri!case[recordType!CMGT_Case.caseType]\n        )\n      ),\n      \"-\",\n      local!randomAlphaNumericChars,\n      local!dateHex\n    }\n  )\n)"
    },
    "_a-0000ec3d-b406-8000-9bb2-011c48011c48_217959": {
      "name": "CMGT_EXT_DATA_FraudulentTransactions_Case",
      "type": "Expression Rule",
      "sail_code": "/*Execute all the testcases before saving*/\n/*The below is the structure definition of the map used in this rule*/\n/*a!map(\ntitle:<Defines title of the case>,\ndescription:<Defines description of the case>,\ncaseType:<Defines the casetype of the case and the value can be either \"Credit Card Disputes\" or \"Automated Clearing House\">,\nstatus:<The value can be either cons!CMGT_REFID_STATUS_CASE_OPEN or cons!CMGT_REFID_STATUS_CASE_IN_PROGRESS>\nrelatedCases:<Related Case title>\n\nmapping the other values here so that the case looks same everytime it is created\n */\n{\n  /*Fraudulent Transactions*/\n  /*Credit Card Disputes*/\n  a!map(\n    title: \"Incorrect Amount Charged\",\n    description: \"Customer reported an incorrect charge on their credit card statement for a restaurant bill. Submitted bill and transaction details. Investigation confirmed error. Account adjusted.\",\n    caseType: \"Credit Card Disputes (DEMO)\",\n    status: cons!CMGT_REFID_STATUS_CASE_OPEN,\n    relatedCases: { \"Duplicate Transaction\" }\n  ),\n  a!map(\n    title: \"Duplicate Transaction\",\n    description: \"Customer reported a duplicate charge for a single purchase on their credit card. Provided receipt and statement. Investigation confirmed error with the store. Account credited.\",\n    caseType: \"Credit Card Disputes (DEMO)\",\n    status: cons!CMGT_REFID_STATUS_CASE_IN_PROGRESS,\n    relatedCases: { \"Incorrect Amount Charged\" }\n  ),\n  /* Automated Clearing House*/\n  a!map(\n    title: \"ACH Payment Not Received\",\n    description: \"Customer reported a missing ACH payment that was not credited to the recipient's account. Provided payment details and confirmation. Investigation traced and confirmed payment failure. Issue resolved.\",\n    caseType: \"Automated Clearing House (DEMO)\",\n    status: cons!CMGT_REFID_STATUS_CASE_OPEN,\n    relatedCases: { \"ACH Transaction Error\" }\n  ),\n  a!map(\n    title: \"ACH Transaction Error\",\n    description: \"Customer reported an error in an ACH transaction. Provided transaction details and error description. Investigation confirmed the error. Transaction corrected and funds adjusted.\",\n    caseType: \"Automated Clearing House (DEMO)\",\n    status: cons!CMGT_REFID_STATUS_CASE_IN_PROGRESS,\n    relatedCases: { \"ACH Payment Not Received\" }\n  ),\n  \n}"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514276": {
      "name": "CMGT_EXT_UTIL_RandomInt",
      "type": "Expression Rule",
      "sail_code": "if(\n  a!isNullOrEmpty(ri!between),\n  null,\n  length(ri!between) < 2,\n  null,\n  a!localVariables(\n    local!lowerBound: if(\n      a!isNullOrEmpty(ri!between[1]),\n      1,\n      ri!between[1]\n    ),\n    local!numOfDigits: a!defaultValue(value: ri!numOfDigits, default: 0),\n    local!result: round(\n      rand() * (ri!between[2] - local!lowerBound),\n      local!numOfDigits\n    ) + local!lowerBound,\n    if(\n      local!numOfDigits = 0,\n      tointeger(local!result),\n      local!result\n    )\n  )\n)"
    },
    "_a-0000ec46-ed50-8000-9bb4-011c48011c48_683170": {
      "name": "CMGT_EXT_UTIL_SortArray",
      "type": "Expression Rule",
      "sail_code": "cast(\n  runtimetypeof(ri!array),\n  if(\n    a!isNullOrEmpty(ri!array),\n    ri!array,\n    todatasubset(\n      apply(\n        a!map(item: _),\n        a!flatten(ri!array),\n      ),\n      #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: - 1,\n        sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n          field: \"item\",\n          ascending: a!defaultValue(value: ri!ascending, default: true)\n        )\n      )\n    ).data.item\n  )\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514381": {
      "name": "CMGT_EXT_UTIL_ShuffleArray",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!arrayLength: count(ri!array),\n  local!shuffledIndicies: tointeger(\n    rule!CMGT_UTIL_Distinct(\n      value: floor(\n        rand(local!arrayLength * 10) * local!arrayLength\n      ) + 1\n    )\n  ),\n  index(ri!array, local!shuffledIndicies, {})\n)"
    },
    "_a-0000edbd-1f9f-8000-9d6d-011c48011c48_4081813": {
      "name": "CMGT_setPrefixDefault",
      "type": "Expression Rule",
      "sail_code": "left(\n  initials(\n    proper(\n      ri!caseType[recordType!CMGT_CFG_CaseType.name]\n    )\n  ),\n  3\n)"
    },
    "af326a29-a1c8-4399-a28d-996f85819d9e": {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "sail_code": "with(\n  local!fieldValuePairs: a!defaultValue(\n    ri!fieldValuePairs,\n    apply(\n      rule!CMGT_UTIL_Filter_CreateFieldValuePair(\n        field: _,\n        value: ri!value,\n        allFields: a!flatten(ri!field)\n      ),\n      a!flatten(ri!field)\n    )\n  ),\n  local!matchingCriteria: a!defaultValue(\n    value: ri!matchingCriteria,\n    default: \"ALL\"\n  ),\n  local!matchType: a!defaultValue(value: ri!matchType, default: \"EXACT\"),\n  local!matchIndices: if(\n    a!isNullOrEmpty(a!flatten(ri!records)),\n    tointeger({}),\n    reduce(\n      rule!CMGT_UTIL_Filter_Reducer(\n        matchingCriteria: local!matchingCriteria,\n        previousIndices: _,\n        records: a!flatten(ri!records),\n        fieldValuePair: _,\n        matchType: local!matchType\n      ),\n      a!match(\n        value: local!matchingCriteria,\n        equals: \"ALL\",\n        then: enumerate(count(a!flatten(ri!records))) + 1,\n        equals: \"ANY\",\n        then: {},\n        default: fn!error(\n          \"Invalid matchingCriteria, must be one of: ALL, ANY\"\n        )\n      ),\n      local!fieldValuePairs\n    )\n  ),\n  local!rejectIndices: difference(\n    if(\n      a!isNullOrEmpty(ri!records),\n      tointeger({}),\n      enumerate(count(a!flatten(ri!records))) + 1\n    ),\n    local!matchIndices\n  ),\n  local!matches: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!matchIndices, {})\n  ),\n  local!rejects: cast(\n    runtimetypeof(ri!records),\n    index(ri!records, local!rejectIndices, {})\n  ),\n  local!output: a!match(\n    value: a!defaultValue(ri!filterType, \"FILTER\"),\n    equals: \"FILTER\",\n    then: local!matches,\n    equals: \"REJECT\",\n    then: local!rejects,\n    equals: \"FIRST_MATCH\",\n    then: index(local!matches, 1, null),\n    equals: \"FIRST_REJECT\",\n    then: index(local!rejects, 1, null),\n    equals: \"MATCH_COUNT\",\n    then: count(local!matchIndices),\n    equals: \"REJECT_COUNT\",\n    then: count(local!rejectIndices),\n    equals: \"MATCH_INDICES\",\n    then: local!matchIndices,\n    equals: \"REJECT_INDICES\",\n    then: local!rejectIndices,\n    equals: \"FULL_RESULT\",\n    then: a!map(\n      matches: local!matches,\n      rejects: local!rejects,\n      firstMatch: index(local!matches, 1, null),\n      firstReject: index(local!rejects, 1, null),\n      matchCount: count(local!matchIndices),\n      rejectCount: count(local!rejectIndices),\n      matchIndices: local!matchIndices,\n      rejectIndices: local!rejectIndices\n    ),\n    default: fn!error(\n      \"Invalid filterType, must be one of: FILTER, REJECT, FIRST_MATCH, FIRST_REJECT, MATCH_COUNT, REJECT_COUNT, MATCH_INDICES, REJECT_INDICES, FULL_RESULT\"\n    )\n  ),\n  local!output\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514336": {
      "name": "CMGT_EXT_UTIL_AdjustDateTimeForDayLightSaving",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!isDayLightSavingStartDate: and(\n    isindaylightsavingtime(ri!dateTime, \"EST5EDT\") = false(),\n    isindaylightsavingtime(ri!dateTime + 1, \"EST5EDT\")\n  ),\n  if(\n    and(\n      local!isDayLightSavingStartDate,\n      totime(ri!dateTime) >= time(2, 0, 0, 0),\n      totime(ri!dateTime) < time(3, 0, 0, 0)\n    ),\n    a!addDateTime(startDateTime: ri!dateTime, hours: 1),\n    ri!dateTime\n  )\n)"
    },
    "_a-0000ec0f-47ad-8000-9ba8-011c48011c48_17215": {
      "name": "CMGT_EXT_UTIL_RandomForeignKey",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!totalCount: #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n    recordType: ri!recordType,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0),\n    fetchTotalCount: true\n  ).totalCount,\n  if(\n    local!totalCount=0,\n    null,\n    a!localVariables(\n      local!query:#\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n        recordType: ri!recordType,\n        pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n          startIndex: max({ceiling(rand() * local!totalCount),1}),\n          batchSize: 1\n        )\n      ),\n      if(\n        ri!fullObject,\n        local!query.data[1],\n        local!query.identifiers[1]\n      )\n    )\n  )\n\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514329": {
      "name": "CMGT_EXT_UTIL_RandomDateTime",
      "type": "Expression Rule",
      "sail_code": "/*By default ignoring the day light saving time (2.00 AM to 3.00 AM of day light saving start date) \nas attempting to write this date might error out */\na!localVariables(\n  local!returnCount: a!defaultValue(value: ri!returnCount, default: 1),\n  local!dateTimes: #\"SYSTEM_SYSRULES_forEach\"(\n    items: enumerate(local!returnCount),\n    expression: rule!CMGT_EXT_UTIL_AdjustDateTimeForDayLightSaving(\n      dateTime: ri!toDate - rule!CMGT_EXT_UTIL_RandomInt(\n        between: { 0, tointeger(ri!toDate - ri!fromDate) },\n        numOfDigits: 2\n      )\n    )\n  ),\n  if(\n    ri!sortAscending,\n    rule!CMGT_EXT_UTIL_SortArray(array: local!dateTimes, ascending: true()),\n    local!dateTimes\n  )\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514427": {
      "name": "CMGT_EXT_UTIL_RandomBoolean",
      "type": "Expression Rule",
      "sail_code": "rand() < .5"
    },
    "_a-0000e990-c462-8000-9ba7-011c48011c48_26020": {
      "name": "CMGT_QR_GetTag",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_Tag,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Tag.tagId,\n      operator: \"in\",\n      value: ri!tagId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Tag.tagName,\n      operator: \"=\",\n      value: ri!tagName\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Tag.caseTagMap.caseId,\n      operator: \"=\",\n      value: ri!caseId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_Tag.isActive,\n      operator: \"=\",\n      value: ri!isActive\n    )\n  },\n  fields: ri!fields,\n  pagingInfo: ri!pagingInfo,\n  sort: a!defaultValue(\n    value: ri!sort,\n    default: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!CMGT_Tag.tagName,\n      ascending: true\n    )\n  ),\n  relatedRecordData: ri!relatedRecordData,\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ea26-2ced-8000-9bf1-011c48011c48_568215": {
      "name": "CMGT_WFL_QR_GetReferenceMilestone",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_WFL_CFG_ReferenceMilestone,\n  returnType: ri!returnType,\n  executeWhen: ri!executeWhen,\n  triggerRefresh: ri!triggerRefresh,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.caseTypeUuid,\n      operator: \"=\",\n      value: ri!caseTypeUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.referenceMilestoneId,\n      operator: \"in\",\n      value: ri!referenceMilestoneId\n    )\n  },\n  fields: {\n    ri!fields,\n    recordType!CMGT_WFL_CFG_ReferenceMilestone.caseType\n  },\n  relatedRecordData: { ri!relatedRecordData },\n  pagingInfo: ri!pagingInfo,\n  sort: a!defaultValue(\n    ri!sort,\n    #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: recordType!CMGT_WFL_CFG_ReferenceMilestone.sortOrder,\n      ascending: true\n    )\n  ),\n  logicalExpressions: ri!additionalLogicalExpression,\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_19651": {
      "name": "CMGT_QR_GetCaseType",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_CFG_CaseType,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_CFG_CaseType.uuid,\n      operator: \"in\",\n      value: ri!caseTypeUuid\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_CFG_CaseType.isCategory,\n      operator: \"=\",\n      value: ri!isCaseCategory\n    )\n  },\n  fields: {\n    ri!fields,\n    if(\n      ri!excludeRelatedRecords,\n      {},\n      recordType!CMGT_CFG_CaseType.parentCaseType\n    )\n  },\n  relatedRecordData: ri!relatedRecordData,\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort,\n  logicalExpressions: {\n    ri!additionalLogicalExpression,\n    rule!CMGT_CaseTypeActiveLogicalExpression(includeInactive: ri!includeInactive)\n  },\n  groupByFields: ri!groupByFields,\n  searchTerm: ri!searchTerm,\n  searchFields: ri!searchFields\n)"
    },
    "_a-0000ec06-54a3-8000-9cca-011c48011c48_2514351": {
      "name": "CMGT_EXT_UTIL_RandomXMembersFromGroup",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!memberType: a!defaultValue(value: ri!memberType, default: \"USER\"),\n  local!includeServiceAccounts: a!defaultValue(\n    value: ri!includeServiceAccounts,\n    default: false()\n  ),\n  local!includeAllMembers: a!defaultValue(\n    value: ri!includeAllMembers,\n    default: false()\n  ),\n  /* Getting all service accounts */\n  local!serviceAccounts: if(\n    and(\n      local!includeServiceAccounts,\n      local!memberType = \"USER\"\n    ),\n    a!groupMembers(group: cons!CMGT_GRP_SERVICE_ACCOUNTS).data,\n    {}\n  ),\n  local!allGroupMembers: a!groupMembers(\n    group: ri!group,\n    direct: false,\n    memberType: local!memberType,\n    pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 10000)\n  ).data,\n  rule!CMGT_EXT_UTIL_RandomXObjectsFromArray(\n    array: if(\n      or(\n        local!includeAllMembers,\n        local!memberType = \"GROUP\"\n      ),\n      difference(\n        touser(local!allGroupMembers),\n        ri!excludeUsers\n      ),\n      /* By default returns only demo specific users from the given group */\n      difference(\n        intersection(\n          touser(local!allGroupMembers),\n          touser(\n            {\n              cons!CMGT_EXT_MALE_USERNAMES,\n              cons!CMGT_EXT_FEMALE_USERNAMES,\n              local!serviceAccounts\n            }\n          )\n        ),\n        ri!excludeUsers\n      )\n    ),\n    noOfObjects: ri!noOfMembers\n  )\n)"
    },
    "_a-0000ec0f-47ad-8000-9ba8-011c48011c48_16220": {
      "name": "CMGT_EXT_Case_GenerateCaseDetails",
      "type": "Expression Rule",
      "sail_code": "/*\nPerformancemetrics(howmanythingspercase)outlinedinthisdocument:\nhttps://docs.google.com/document/d/1jo8Co1mLFSjERZhzajke_6ZkjnyXRY_kdb-CYNWC71o/edit#heading=h.m76hr38jg2dj\n*/\n/* For case and it is related records to get most recent events we are picking a dateTime till now for the modifiedOn timestamp   */\n/*Need to add james baker as assignee after the user creation is done*/\na!localVariables(\n  local!caseTypes: rule!CMGT_QR_GetCaseType(\n    excludeRelatedRecords: true(),\n    additionalFilters: #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_CFG_CaseType.parentUuid,\n      operator: \"not null\",\n      \n    ),\n    fields: {\n      recordType!CMGT_CFG_CaseType.uuid,\n      recordType!CMGT_CFG_CaseType.name,\n      recordType!CMGT_CFG_CaseType.caseTypeMetadata\n    }\n  ),\n  local!currentCaseType: #\"SYSTEM_SYSRULES_forEach\"(\n    items: ri!caseData,\n    expression: rule!CMGT_UTIL_Filter(\n      records: local!caseTypes,\n      field: recordType!CMGT_CFG_CaseType.name,\n      value: fv!item.caseType\n    )\n  ),\n  local!tagIds: rule!CMGT_QR_GetTag(\n    fields: recordType!CMGT_Tag.tagId\n  )[recordType!CMGT_Tag.tagId],\n  local!watchersPerCase: rule!CMGT_EXT_UTIL_RandomInt(between: { 1, 3 }),\n  local!tagsPerCase: rule!CMGT_EXT_UTIL_RandomInt(between: { 1, 3 }),\n  local!createdBy: rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n    group: cons!CMGT_GRP_INTERNAL_USERS,\n    includeServiceAccounts: false()\n  ),\n  local!modifiedBy: rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n    group: cons!CMGT_GRP_INTERNAL_USERS,\n    includeServiceAccounts: false()\n  ),\n  /*Case should be created in past 2 months*/\n  local!timestamp: a!defaultValue(\n    value: ri!timestamp,\n    default: rule!CMGT_EXT_AdjustDateTimeForDayLightSaving(\n      dateTime: rule!CMGT_EXT_UTIL_RandomDateTime(\n        fromDate: a!subtractDateTime(startDateTime: now(), months: 2),\n        toDate: a!subtractDateTime(startDateTime: now(), days: 15)\n      )\n    )\n  ),\n  /*If the case has default assignee it will be assigned to the maximum data user of that group\n  else it will be assigned to random user from case manager and case worker group*/\n  local!userAssignee: rule!CMGT_EXT_UTIL_Distinct(\n    value: touniformstring(\n      {\n        rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n          group: cons!CMGT_GRP_CASE_WORKERS,\n          includeServiceAccounts: false,\n          noOfMembers: 1\n        ),\n        rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n          group: cons!CMGT_GRP_CASE_MANAGERS,\n          includeServiceAccounts: false,\n          noOfMembers: 1\n        )\n      }\n    )\n  ),\n  /*  Adding the current casetype's case due days to the case createdOn dateTime to determine caseDueOn   */\n  local!caseDueOn: rule!CMGT_UTIL_CalculateDueDateBasedOnSLA(\n    SLA: local!currentCaseType[recordType!CMGT_CFG_CaseType.caseTypeMetadata.sla],\n    dateTime: local!timestamp\n  ),\n  local!caseCompletedOn: if(\n    ri!caseData.status = cons!CMGT_REFID_STATUS_CASE_CLOSED,\n    rule!CMGT_EXT_AdjustDateTimeForDayLightSaving(\n      dateTime: if(\n        local!caseDueOn > now(),\n        rule!CMGT_EXT_UTIL_RandomDateTime(\n          fromDate: local!timestamp,\n          toDate: a!subtractDateTime(startDateTime: now(), days: 10)\n        ),\n        rule!CMGT_EXT_UTIL_RandomDateTime(\n          fromDate: local!timestamp,\n          toDate: a!subtractDateTime(startDateTime: local!caseDueOn, days: 10)\n        )\n      )\n    ),\n    null()\n  ),\n  recordType!CMGT_Case(\n    recordType!CMGT_Case.caseId: null,\n    recordType!CMGT_Case.friendlyId: rule!CMGT_Case_GenerateFriendlyIdentifier_Logic(\n      case: recordType!CMGT_Case(\n        recordType!CMGT_Case.caseType: local!currentCaseType,\n        recordType!CMGT_Case.caseTypeUuid: local!currentCaseType[recordType!CMGT_CFG_CaseType.uuid]\n      )\n    ),\n    recordType!CMGT_Case.caseTypeUuid: local!currentCaseType[recordType!CMGT_CFG_CaseType.uuid],\n    recordType!CMGT_Case.title: ri!caseData.title,\n    recordType!CMGT_Case.description: ri!caseData.description,\n    recordType!CMGT_Case.statusId: ri!caseData.status,\n    recordType!CMGT_Case.priorityId: rule!CMGT_EXT_UTIL_RandomForeignKey(\n      recordType: recordType!CMGT_CFG_Priority\n    ),\n    recordType!CMGT_Case.dueOn: local!caseDueOn,\n    recordType!CMGT_Case.source: cons!CMGT_TXT_SOURCE_APPIAN,\n    recordType!CMGT_Case.completedOn: local!caseCompletedOn,\n    recordType!CMGT_Case.isActive: true(),\n    recordType!CMGT_Case.isCreateProcessDone: true,\n    recordType!CMGT_Case.createdBy: local!createdBy,\n    recordType!CMGT_Case.createdOn: local!timestamp,\n    recordType!CMGT_Case.modifiedBy: local!modifiedBy,\n    recordType!CMGT_Case.modifiedOn: /*  To get most recent events we are picking a dateTime till now    */\n    rule!CMGT_EXT_UTIL_RandomDateTime(fromDate: local!timestamp, toDate: now()),\n    recordType!CMGT_Case.roles: a!flatten(\n      {\n        /*    User Assignee    */\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: local!userAssignee,\n          expression: recordType!CMGT_Role(\n            recordType!CMGT_Role.roleTypeId: cons!CMGT_REFID_ROLE_TYPE_USER_ASSIGNEE,\n            recordType!CMGT_Role.username: fv!item,\n            recordType!CMGT_Role.isActive: true(),\n            recordType!CMGT_Role.createdBy: local!createdBy,\n            recordType!CMGT_Role.createdOn: local!timestamp,\n            recordType!CMGT_Role.modifiedBy: local!modifiedBy,\n            recordType!CMGT_Role.modifiedOn: rule!CMGT_EXT_UTIL_RandomDateTime(fromDate: local!timestamp, toDate: now())\n          )\n        ),\n        /*  Watchers      */\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n            group: cons!CMGT_GRP_INTERNAL_USERS,\n            includeServiceAccounts: false(),\n            noOfMembers: local!watchersPerCase\n          ),\n          expression: recordType!CMGT_Role(\n            recordType!CMGT_Role.roleTypeId: cons!CMGT_REFID_ROLE_TYPE_WATCHER,\n            recordType!CMGT_Role.username: fv!item,\n            recordType!CMGT_Role.isActive: true(),\n            recordType!CMGT_Role.createdBy: local!createdBy,\n            recordType!CMGT_Role.createdOn: local!timestamp,\n            recordType!CMGT_Role.modifiedBy: local!modifiedBy,\n            recordType!CMGT_Role.modifiedOn: rule!CMGT_EXT_UTIL_RandomDateTime(fromDate: local!timestamp, toDate: now())\n          )\n        ),\n        /*Group Assignee*/\n        recordType!CMGT_Role(\n          recordType!CMGT_Role.roleTypeId: cons!CMGT_REFID_ROLE_TYPE_GROUP_ASSIGNEE,\n          recordType!CMGT_Role.groupId: group(\n            a!match(\n              value: index(\n                local!currentCaseType[recordType!CMGT_CFG_CaseType.uuid],\n                1,\n                null\n              ),\n              /*solar permit*/\n              equals: cons!CMGT_EXT_TXT_GENERATED_CASE_TYPE_UUIDS[1],\n              then: cons!CMGT_EXT_GRP_ANALYSTS,\n              /*addition permit*/\n              equals: cons!CMGT_EXT_TXT_GENERATED_CASE_TYPE_UUIDS[2],\n              then: cons!CMGT_EXT_GRP_ANALYSTS,\n              /*CCD*/\n              equals: cons!CMGT_EXT_TXT_GENERATED_CASE_TYPE_UUIDS[3],\n              then: cons!CMGT_EXT_GRP_CUSTOMER_SERVICE,\n              /*ACH*/\n              equals: cons!CMGT_EXT_TXT_GENERATED_CASE_TYPE_UUIDS[4],\n              then: cons!CMGT_EXT_GRP_DISPUTE_OPERATORS,\n              default: cons!CMGT_GRP_CASE_WORKERS\n            ),\n            \"id\"\n          ),\n          recordType!CMGT_Role.isActive: true(),\n          recordType!CMGT_Role.createdBy: local!createdBy,\n          recordType!CMGT_Role.createdOn: local!timestamp,\n          recordType!CMGT_Role.modifiedBy: local!modifiedBy,\n          recordType!CMGT_Role.modifiedOn: rule!CMGT_EXT_UTIL_RandomDateTime(fromDate: local!timestamp, toDate: now())\n        )\n      }\n    ),\n    recordType!CMGT_Case.documents: #\"SYSTEM_SYSRULES_forEach\"(\n      items: rule!CMGT_UTIL_Filter(\n        records: ri!documentMaps,\n        field: \"caseTitle\",\n        value: ri!caseData.title\n      ),\n      expression: a!localVariables(\n        local!documentTimestamp: rule!CMGT_EXT_UTIL_RandomDateTime(fromDate: local!timestamp, toDate: now()),\n        recordType!CMGT_Document(\n          recordType!CMGT_Document.appianDocId: fv!item.document,\n          recordType!CMGT_Document.documentName: fv!item.name,\n          recordType!CMGT_Document.description: fv!item.description,\n          recordType!CMGT_Document.isPrivate: rule!CMGT_EXT_UTIL_RandomBoolean(),\n          recordType!CMGT_Document.extension: document(fv!item.document, \"extension\"),\n          recordType!CMGT_Document.size: document(fv!item.document, \"size\"),\n          recordType!CMGT_Document.isActive: true(),\n          recordType!CMGT_Document.createdBy: local!createdBy,\n          recordType!CMGT_Document.createdOn: local!timestamp,\n          recordType!CMGT_Document.modifiedBy: local!modifiedBy,\n          recordType!CMGT_Document.modifiedOn: local!documentTimestamp\n        )\n      )\n    ),\n    recordType!CMGT_Case.tagMap: #\"SYSTEM_SYSRULES_forEach\"(\n      items: rule!CMGT_EXT_UTIL_RandomXObjectsFromArray(\n        array: local!tagIds,\n        noOfObjects: local!tagsPerCase\n      ),\n      expression: a!localVariables(\n        local!tagTimestamp: rule!CMGT_EXT_UTIL_RandomDateTime(\n          fromDate: local!timestamp,\n          toDate: a!addDateTime(startDateTime: local!timestamp, days: 10)\n        ),\n        local!createdByModifiedByForTag: rule!CMGT_EXT_UTIL_RandomXMembersFromGroup(\n          group: cons!CMGT_GRP_INTERNAL_USERS,\n          includeServiceAccounts: false()\n        ),\n        recordType!CMGT_CaseTagMap(\n          recordType!CMGT_CaseTagMap.tagId: fv!item,\n          recordType!CMGT_CaseTagMap.createdBy: local!createdByModifiedByForTag,\n          recordType!CMGT_CaseTagMap.createdOn: local!tagTimestamp,\n          recordType!CMGT_CaseTagMap.modifiedBy: local!createdByModifiedByForTag,\n          recordType!CMGT_CaseTagMap.modifiedOn: local!tagTimestamp,\n          recordType!CMGT_CaseTagMap.isActive: true()\n        )\n      )\n    ),\n    recordType!CMGT_Case.milestones: rule!CMGT_EXT_WFL_Case_GenerateCaseCreationMilestones_Logic(\n      caseTypeUuid: local!currentCaseType[recordType!CMGT_CFG_CaseType.uuid],\n      createdBy: local!createdBy,\n      modifiedBy: local!modifiedBy,\n      timestamp: local!timestamp\n    )\n  )\n)"
    }
  }
}
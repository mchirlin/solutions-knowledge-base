{
  "uuid": "_a-0000ed7d-5e46-8000-9d4b-011c48011c48_3825952",
  "name": "CMGT_Case_ConfigureTask_Task_SingleRuleConfig",
  "type": "Interface",
  "description": null,
  "sail_code": "a!localVariables(\n  local!fieldPathJson: if(\n    rule!CMGT_UTIL_IsNotBlank(\n     ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerContext]\n    ),\n    #\"SYSTEM_SYSRULES_fromJson_v1\"(\n      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerContext]\n    ),\n    null\n  ),\n  local!selectedField: if(\n    a!isNotNullOrEmpty(local!fieldPathJson),\n    /*for update we will need the selectedField to hold the choosen value instead of null*/\n    rule!CMGT_UTIL_Filter(\n      records: ri!availableTriggerFields,\n      filterType: \"FIRST_MATCH\",\n      fieldValuePairs: {\n        a!map(\n          field: \"uuid\",\n          value: touniformstring(local!fieldPathJson.uuid)\n        ),\n        a!map(\n          field: \"displayName\",\n          value: touniformString(local!fieldPathJson.displayName)\n        )\n      }\n    ),\n    null\n  ),\n  local!selectedAction: rule!CMGT_UTIL_Filter(\n    records: ri!actions,\n    field: \"actionCode\",\n    value: a!flatten(\n      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.actionCode]\n    )\n  ),\n  if(\n    ri!ruleState.isReadOnly,\n    {\n      #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n        alignVertical: \"MIDDLE\",\n        spacing: \"SPARSE\",\n        marginBelow: \"EVEN_LESS\",\n        items: {\n          /*execution order number*/\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            width: \"MINIMIZE\",\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                size: \"MEDIUM\",\n                text: ri!orderIndex & \".\",\n                color: \"STANDARD\"\n              ),\n              align: \"LEFT\"\n            )\n          ),\n          /*Execution Order Update arrows*/\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            width: \"MINIMIZE\",\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: {\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"caret-up\",\n                  altText: #\"urn:appian:translation-string:v1:bcea71b0-3503-4a3a-a8d1-ffae49d318f7\"(\n                    #\"urn:appian:translation-variable:v1:40abe15b-5511-42d1-9262-31254e0d572c\": ri!orderIndex\n                  ),\n                  color: if(\n                    ri!orderIndex = 1,\n                    ri!brandingMap.CategoryCaseTypeBackgroundColor,\n                    ri!brandingMap.AccentColor\n                  ),\n                  link: a!localVariables(\n                    local!indexToUpdate: rule!CMGT_UTIL_Filter(\n                      records: ri!allAutomationTasks,\n                      field: recordType!CMGT_Task.sortOrder,\n                      value: tointeger(ri!automationTask[recordType!CMGT_Task.sortOrder])-1,\n                      filterType: \"MATCH_INDICES\"\n                    ),\n                    #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    value: tointeger(ri!automationTask[recordType!CMGT_Task.sortOrder]) - 1,\n                    saveInto: #\"SYSTEM_SYSRULES_writeRecords_v2\"(\n                      records: {\n                        /*update sort order for the rule above the current rule*/\n                        #\"urn:appian:function:v1:a:update\"(\n                          ri!allAutomationTasks[local!indexToUpdate],\n                          {\n                            recordType!CMGT_Task.modifiedBy,\n                            recordType!CMGT_Task.modifiedOn,\n                            recordType!CMGT_Task.sortOrder\n                          },\n                          {\n                            loggedInUser(),\n                            now(),\n                            ri!automationTask[recordType!CMGT_Task.sortOrder]\n                          }\n                        ),\n                        /*update sort order for the current rule*/\n                        #\"urn:appian:function:v1:a:update\"(\n                          ri!automationTask,\n                          {\n                            recordType!CMGT_Task.modifiedBy,\n                            recordType!CMGT_Task.modifiedOn,\n                            recordType!CMGT_Task.sortOrder\n                          },\n                          {\n                            loggedInUser(),\n                            now(),\n                            ri!automationTask[recordType!CMGT_Task.sortOrder] - 1\n                          }\n                        )\n                      },\n                      onSuccess: {\n                        rule!CMGT_SetTrackAutomationRuleChanges(\n                          isAddNew: ri!isAddNew,\n                          trackAutomationRuleChanges: ri!trackAutomationRuleChanges,\n                          recordsUpdated: fv!recordsUpdated,\n                          allAutomationTasks: ri!allAutomationTasks\n                        ),\n                        a!save(\n                          ri!allAutomationTasks,\n                          #\"urn:appian:function:v1:a:update\"(\n                            ri!allAutomationTasks,\n                            { local!indexToUpdate, ri!automationIndex },\n                            fv!recordsUpdated\n                          )\n                        )\n                      }\n                    ),\n                    showWhen: and(\n                      not(ri!orderIndex = 1),\n                      ri!automationTask[recordType!CMGT_Task.isActive]\n                    )\n                  )),\n                  linkStyle: \"STANDALONE\",\n                  size: \"MEDIUM\"\n                ),\n                char(10),\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"caret-down\",\n                  altText: #\"urn:appian:translation-string:v1:7a15e656-bc87-4811-b953-8521481a11f8\"(\n                    #\"urn:appian:translation-variable:v1:f43d7e08-821e-4f5e-80ac-091183e02989\": ri!orderIndex\n                  ),\n                  color: if(\n                    and(\n                    /* If in the process of adding a new rule,\n                        we don't want to be able to adjust sorting until that rule is saved */\n                    if(ri!isNewRuleAdded,\n                    not(ri!orderIndex = length(ri!allAutomationTasks) - 1),\n                    not(\n                      ri!orderIndex = length(ri!allAutomationTasks)\n                    )),\n                    ri!automationTask[recordType!CMGT_Task.isActive]\n                  ),\n                  ri!brandingMap.AccentColor,\n                  ri!brandingMap.CategoryCaseTypeBackgroundColor\n                ),\n                link: a!localVariables(\n                  local!indexToUpdate: rule!CMGT_UTIL_Filter(\n                    records: ri!allAutomationTasks,\n                    field: recordType!CMGT_Task.sortOrder,\n                    value: ri!automationTask[recordType!CMGT_Task.sortOrder]+1,\n                    filterType: \"MATCH_INDICES\"\n                  ),\n                  #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    value: ri!automationTask[recordType!CMGT_Task.sortOrder] + 1,\n                    saveInto: #\"SYSTEM_SYSRULES_writeRecords_v2\"(\n                      records: {\n                        /*update the sort order for the rule below the current rue*/\n                        #\"urn:appian:function:v1:a:update\"(\n                          ri!allAutomationTasks[local!indexToUpdate],\n                          {\n                            recordType!CMGT_Task.modifiedBy,\n                            recordType!CMGT_Task.modifiedOn,\n                            recordType!CMGT_Task.sortOrder\n                          },\n                          {\n                            loggedInUser(),\n                            now(),\n                            ri!automationTask[recordType!CMGT_Task.sortOrder]\n                          }\n                        ),\n                        /*update sort order for the current rule*/\n                        #\"urn:appian:function:v1:a:update\"(\n                          ri!automationTask,\n                          {\n                            recordType!CMGT_Task.modifiedBy,\n                            recordType!CMGT_Task.modifiedOn,\n                            recordType!CMGT_Task.sortOrder\n                          },\n                          {\n                            loggedInUser(),\n                            now(),\n                            ri!automationTask[recordType!CMGT_Task.sortOrder] + 1\n                          }\n                        )\n                      },\n                      onSuccess: {\n                        rule!CMGT_SetTrackAutomationRuleChanges(\n                          isAddNew: ri!isAddNew,\n                          trackAutomationRuleChanges: ri!trackAutomationRuleChanges,\n                          recordsUpdated: fv!recordsUpdated,\n                          allAutomationTasks: ri!allAutomationTasks\n                        ),\n                        a!save(\n                          ri!allAutomationTasks,\n                          #\"urn:appian:function:v1:a:update\"(\n                            ri!allAutomationTasks,\n                            {\n                              local!indexToUpdate,\n                              ri!automationIndex\n                            },\n                            fv!recordsUpdated\n                          )\n                        )\n                      }\n                    ),\n                    showWhen: and(\n                      /* If in the process of adding a new rule,\n                        we don't want to be able to adjust sorting until that rule is saved */\n                      if(ri!isNewRuleAdded,\n                      not(ri!orderIndex = length(ri!allAutomationTasks) - 1),\n                      not(\n                        ri!orderIndex = length(ri!allAutomationTasks)\n                      )),\n                      ri!automationTask[recordType!CMGT_Task.isActive]\n\n                    )\n                  )),\n                  linkStyle: \"STANDALONE\",\n                  size: \"MEDIUM\"\n                )\n              },\n              align: \"LEFT\"\n            )\n          ),\n          /*read only automation rule*/\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            width: \"10X\",\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: {\n                rule!CMGT_AutomationRules_FormatTrigger(\n                  triggerContext: ri!automationTask[recordType!CMGT_Task.triggerContext],\n                  automationTrigger: ri!automationTask[recordType!CMGT_Task.automationTrigger],\n                  availableFields: ri!availableTriggerFields,\n                  textSize: \"STANDARD\"\n                ),\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: \", \" & #\"urn:appian:translation-string:v1:75521026-d916-4284-8fb1-204247072b4b\" & \" \",\n                  size: \"STANDARD\",\n                  showWhen: rule!CMGT_UTIL_IsNotBlank(\n                    ri!automationTask[recordType!CMGT_Task.conditionSet]\n                  ),\n\n                ),\n                /*condtion formatting*/\n                rule!CMGT_Case_Rules_FormatRuleConditionSet(\n                  task: ri!automationTask,\n                  availableFields: ri!availableTaskFields,\n                  textSize: \"STANDARD\"\n                ),\n                #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n                  text: \", \",\n                  size: \"STANDARD\",\n                  /*textColor: local!deactivatedTextColor*/\n\n                ),\n                /*action formatting*/\n                rule!CMGT_AutomationRules_FormatRuleAction(\n                  action: ri!automationTask[recordType!CMGT_Task.automationTaskAction],\n                  actionCode: ri!automationTask[recordType!CMGT_Task.automationTaskAction.actionCode],\n                  context: \"RUN_TIME\",\n                  isStandalone: false,\n                  textSize: \"STANDARD\"/*textColor: local!deactivatedTextColor*/\n\n                ),\n                \" \",\n                /*Invalid Flag Icon*/\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"exclamation-triangle\",\n                  size: \"STANDARD\",\n                  caption: #\"urn:appian:translation-string:v1:314cd298-a1f1-4044-9cbb-8bff564af1ff\",\n                  color: ri!brandingMap.WarningAccentColor,\n                  showWhen: if(\n                    a!isNullOrEmpty(\n                      ri!automationTask[recordType!CMGT_Task.conditionSet]\n                    ),\n                    false,\n                    not(\n                      and(\n                        a!defaultValue(\n                          ri!automationTask[recordType!CMGT_Task.conditionSet.childConditionSet.isValid],\n                          true\n                        )\n                      )\n                    )\n                  )\n                )\n\n              }\n            )\n          ),\n          /* edit and delete buttons*/\n          #\"SYSTEM_SYSRULES_sideBySideItem\"(\n            item: #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n              value: {\n                /*Edit Action*/\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"pencil\",\n                  altText: #\"urn:appian:translation-string:v1:b24c9c8c-518f-41e7-984a-d589b83726fd\"(\n                    #\"urn:appian:translation-variable:v1:394131a4-9d98-401a-b4bc-4e5cf580a891\": ri!orderIndex\n                  ),\n                  linkStyle: \"STANDALONE\",\n                  size: \"MEDIUM\",\n                  color: ri!brandingMap.AccentColor,\n                  link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    value: false,\n                    saveInto: { ri!ruleState.isReadOnly, a!save(ri!ruleState.isEdit, true),\n                    a!save(\n                      ri!allWorkingWorkflowTasks,\n                      append(\n                        ri!allWorkingWorkflowTasks,\n                        ri!automationTask\n                      )\n                    )\n                    }\n                  )\n                ),\n                \" \",\n                #\"SYSTEM_SYSRULES_richTextIcon\"(\n                  icon: \"times\",\n                  altText:#\"urn:appian:translation-string:v1:c6d4370e-8514-4548-b163-633839a37863\"(#\"urn:appian:translation-variable:v1:66cd04d6-ce5f-46c5-a6e9-36166d65fb85\": ri!orderIndex),\n                  color: ri!brandingMap.NegativeAccentColor,\n                  linkStyle: \"STANDALONE\",\n                  size: \"MEDIUM\",\n                  link: #\"SYSTEM_SYSRULES_dynamicLink\"(\n                    value: false,\n                    saveInto: a!localVariables(\n                      local!inProgressTask: rule!CMGT_UTIL_Filter(\n                        records: ri!allAutomationTasks,\n                        field: recordType!CMGT_Task.taskId,\n                        value: null\n                      ),\n                      local!indicesToRemove: if(\n                        ri!isNewRuleAdded,\n                        {\n                          ri!automationIndex,\n                          length(ri!allAutomationTasks)\n                        },\n                        ri!automationIndex\n                      ),\n                      #\"SYSTEM_SYSRULES_writeRecords_v2\"(\n                        records: {\n                          /* Update to delete current record */\n                          #\"urn:appian:function:v1:a:update\"(\n                            data: ri!allAutomationTasks[ri!automationIndex],\n                            index: recordType!CMGT_Task.isActive,\n                            value: false\n                          ),\n                          #\"SYSTEM_SYSRULES_forEach\"(\n                            rule!CMGT_UTIL_sortList(\n                              records: remove(ri!allAutomationTasks, local!indicesToRemove),\n                              field: recordType!CMGT_Task.sortOrder\n                            ),\n                            #\"urn:appian:function:v1:a:update\"(\n                              fv!item,\n                              recordType!CMGT_Task.sortOrder,\n                              fv!index\n                            )\n                          )\n\n                        },\n                      onSuccess: {\n                        a!localVariables(\n                          local!finalRecordSet: rule!CMGT_UTIL_Filter(\n                            records: fv!recordsUpdated,\n                            field: recordType!CMGT_Task.isActive,\n                            value: false,\n                            filterType: \"REJECT\"\n                          ),\n                          {\n                            rule!CMGT_SetTrackAutomationRuleChanges(\n                              isAddNew: ri!isAddNew,\n                              trackAutomationRuleChanges: ri!trackAutomationRuleChanges,\n                              recordsUpdated: fv!recordsUpdated,\n                              allAutomationTasks: ri!allAutomationTasks\n                            ),\n                            a!save(\n                              ri!allAutomationTasks,\n                              if(\n                                ri!isNewRuleAdded,\n                                append(\n                                  local!finalRecordSet,\n                                  #\"urn:appian:function:v1:a:update\"(\n                                    data: local!inProgressTask,\n                                    index: recordType!CMGT_Task.sortOrder,\n                                    value: length(local!finalRecordSet) + 1\n                                  )\n                                ),\n                                local!finalRecordSet\n                              )\n                            )\n                          }\n                        ),\n                        a!save(\n                          ri!triggerRefresh,\n                          now()\n                        )\n\n                      }\n                    )\n                    )\n                  )\n                ),\n\n              }\n            ),\n            width: \"MINIMIZE\"\n          ),\n\n        }\n      )\n    },\n    {\n      /* Trigger selection fields */\n      #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n        value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: #\"urn:appian:translation-string:v1:b767a631-0a07-423f-9bf1-fa6b6bd96ddc\",\n          size: \"MEDIUM\",\n          color: ri!brandingMap.PrimaryTextColor,\n\n        )\n      ),\n      #\"SYSTEM_SYSRULES_cardLayout\"(\n        contents: #\"SYSTEM_SYSRULES_columnsLayout\"(\n          columns: {\n            #\"SYSTEM_SYSRULES_columnLayout\"(\n              width: \"NARROW_PLUS\",\n              contents: {\n                #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                  label: #\"urn:appian:translation-string:v1:614d3229-d99a-49d2-9150-a6413dc8348f\",\n                  data: #\"SYSTEM_SYSRULES_recordData\"(\n                    recordType: recordType!CMGT_CFG_Triggers,\n                    filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n                      field: recordType!CMGT_CFG_Triggers.group,\n                      operator: \"=\",\n                      value: ri!triggerGroup,\n                      applyWhen: a!isNotNullOrEmpty(ri!triggerGroup)\n                    )\n                  ),\n                  choiceLabels: recordType!CMGT_CFG_Triggers.triggerName,\n                  choiceValues: recordType!CMGT_CFG_Triggers.triggerId,\n                  value: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerId],\n                  saveInto: {\n                    ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerId],\n                    a!save(\n                      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTrigger],\n                      rule!CMGT_UTIL_Filter(\n                        records: ri!triggers,\n                        field: recordType!CMGT_CFG_Triggers.triggerId,\n                        value: save!value\n                      )\n                    )\n                  },\n                  placeholder: #\"urn:appian:translation-string:v1:89c6ca94-1299-4a79-af56-141fb9095827\",\n                  required: true,\n                  requiredMessage: #\"urn:appian:translation-string:v1:4fab94dc-fcb1-427a-af9f-1239079b2897\"(\n                    #\"urn:appian:translation-variable:v1:3e31b6d5-df20-4d17-80a7-81f3c83ff370\": #\"urn:appian:translation-string:v1:614d3229-d99a-49d2-9150-a6413dc8348f\"\n                  ),\n                  validationGroup: ri!validationGroup\n                )\n              }\n            ),\n            #\"SYSTEM_SYSRULES_columnLayout\"(\n              contents: {\n                #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                  choiceLabels: ri!availableTriggerFields.displayName,\n                  choiceValues: ri!availableTriggerFields,\n                  label: displayvalue(\n                    tointeger(\n                      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerId]\n                    ),\n                    {\n                      cons!CMGT_REFID_TRIGGER_CASE_FIELD_UPDATED,\n                      cons!CMGT_REFID_TRIGGER_TASK_FIELD_IS_UPDATED\n                    },\n                    {\n                      #\"urn:appian:translation-string:v1:7206eb72-b422-4352-8fd1-b5f5e00b1683\",\n                      #\"urn:appian:translation-string:v1:197b1760-d5d6-45f9-85bb-04b2418cea90\"\n                    },\n                    \"\"\n                  ),\n                  labelPosition: \"ABOVE\",\n                  placeholder: #\"urn:appian:translation-string:v1:1a75baba-50a5-4ba3-9372-1af063da50e9\",\n                  value: local!selectedField,\n                  saveInto: {\n                    local!selectedField,\n                    a!save(\n                      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerContext],\n                      #\"SYSTEM_SYSRULES_toJson_v1\"(\n                        value: rule!CMGT_Automation_constructSavedFieldMapping(\n                          selectedField: local!selectedField\n                        )\n                      )\n                    )\n                  },\n                  searchDisplay: \"AUTO\",\n                  validations: {},\n                  required: true,\n                  requiredMessage: #\"urn:appian:translation-string:v1:4fab94dc-fcb1-427a-af9f-1239079b2897\"(\n                    #\"urn:appian:translation-variable:v1:3e31b6d5-df20-4d17-80a7-81f3c83ff370\": displayvalue(\n                      tointeger(\n                        ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerId]\n                      ),\n                      {\n                        cons!CMGT_REFID_TRIGGER_CASE_FIELD_UPDATED,\n                        cons!CMGT_REFID_TRIGGER_TASK_FIELD_IS_UPDATED\n                      },\n                      {\n                        #\"urn:appian:translation-string:v1:7206eb72-b422-4352-8fd1-b5f5e00b1683\",\n                        #\"urn:appian:translation-string:v1:197b1760-d5d6-45f9-85bb-04b2418cea90\"\n                      },\n                      \"\"\n                    )\n                  ),\n                  showWhen: contains(\n                    {\n                      cons!CMGT_REFID_TRIGGER_CASE_FIELD_UPDATED,\n                      cons!CMGT_REFID_TRIGGER_TASK_FIELD_IS_UPDATED\n                    },\n                    tointeger(\n                      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.triggerId]\n                    )\n                  ),\n                  validationGroup: ri!validationGroup\n                )\n              },\n              width: \"NARROW_PLUS\",\n\n            )\n          }\n        ),\n        showBorder: false,\n        marginAbove: \"NONE\",\n        marginBelow: \"STANDARD\",\n        shape: \"SEMI_ROUNDED\"\n      ),\n      /* conditions fields */\n      #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n        value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: #\"urn:appian:translation-string:v1:e08741f8-b4c6-4948-a1c5-40e3f592cfeb\",\n          size: \"MEDIUM\",\n          color: ri!brandingMap.PrimaryTextColor,\n\n        )\n      ),\n      {\n        #\"SYSTEM_SYSRULES_forEach\"(\n          items: ri!allWorkingWorkflowTasks[ri!thisWorkingTaskIndex][recordType!CMGT_Task.conditionSet],\n          expression: if(\n            not(fv!item[recordType!CMGT_ConditionSet.isActive]),\n            {},{\n            #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n              items: {\n                #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                  item: #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                    label:#\"urn:appian:translation-string:v1:e9d8c34b-a1a6-471c-97ce-ce5de1d6bbe0\",\n                    labelPosition: \"COLLAPSED\",\n                    choiceLabels: {\n                      #\"urn:appian:translation-string:v1:fa2de152-629a-4edd-be76-7dcda74e0032\",\n                      #\"urn:appian:translation-string:v1:b5d8cfdc-55e9-486c-83be-0db19fe5b647\"\n                    },\n                    choiceValues: {\n                      cons!CMGT_TXT_SET_OPERATOR_AND,\n                      cons!CMGT_TXT_SET_OPERATOR_OR\n                    },\n                    value: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet.operatorCode],\n                    saveInto: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet.operatorCode],\n                    disabled: fv!index > 2,\n                    showWhen: fv!index > 1\n                  ),\n                  width: \"MINIMIZE\"\n                ),\n\n              },\n              alignVertical: \"MIDDLE\",\n              showWhen: fv!index > 1\n            ),\n            rule!CMGT_Automation_FieldLevelConditionsConfiguration(\n              conditionSet: fv!item,\n              availableFieldsInfo: ri!availableTaskFields,\n              brandingMap: ri!brandingMap,\n              totalConditionsDisplayed: count(\n                rule!CMGT_UTIL_Filter(\n                  records: fv!item[recordType!CMGT_ConditionSet.condition],\n                  field: recordType!CMGT_Condition.isActive,\n                  value: true\n                )\n              ),\n              conditionSetIndex: fv!index,\n              topLevelRuleConditionSet: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet],\n              showHeader: false,\n              validationGroup: ri!validationGroup\n            ),\n\n          }\n          )\n        ),\n        #\"SYSTEM_SYSRULES_ButtonArrayLayout\"(\n          buttons: #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n            label: #\"urn:appian:translation-string:v1:833f1933-c2d7-4478-b82b-d42b524cfbfc\",\n            icon: \"plus-circle\",\n            saveInto: a!save(\n              ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet],\n              append(\n                ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet],\n                rule!CMGT_Automation_initializeChildConditionSet(\n                  parentConditionSetUUid:ri!thisWorkingWorkflowTask[recordType!CMGT_Task.conditionSet.conditionSetUuid]\n                )\n              )\n            ),\n            style: \"LINK\",\n            color: \"ACCENT\"\n          ),\n          align: \"START\"\n        )\n      },\n      /* action selection fields */\n      #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n        value: #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n          text: #\"urn:appian:translation-string:v1:bee323bd-daba-4df1-bb07-3dd244aa6a52\",\n          size: \"MEDIUM\",\n          color: ri!brandingMap.PrimaryTextColor,\n\n        )\n      ),\n      #\"SYSTEM_SYSRULES_cardLayout\"(\n        contents: {\n          #\"SYSTEM_SYSRULES_sideBySideLayout\"(\n            items: {\n              #\"SYSTEM_SYSRULES_sideBySideItem\"(\n                item: #\"SYSTEM_SYSRULES_dropdownField_v1\"(\n                  label: #\"urn:appian:translation-string:v1:ab4f437b-4aa7-4e2c-a59f-d726a9fac1e5\",\n                  choiceLabels: ri!actions.name,\n                  choiceValues: ri!actions.actionCode,\n                  value: a!defaultValue(\n                    rule!CMGT_UTIL_RejectBlank(\n                      a!flatten(\n                        ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.actionCode]\n                      )\n                    ),\n                    null\n                  ),\n                  saveInto: {\n                    a!save(\n                      ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction],\n                      {\n                        if(\n                          rule!CMGT_UTIL_IsBlank(\n                            ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction]\n                          ),\n                          recordType!CMGT_TaskActions(\n                            recordType!CMGT_TaskActions.taskInstanceUuid: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.taskInstanceUuid],\n                            recordType!CMGT_TaskActions.taskActionUuid: rule!CMGT_UTIL_GenerateUuid_NonPlugin(),\n                            recordType!CMGT_TaskActions.actionCode: save!value,\n                            recordType!CMGT_TaskActions.isActive: true\n                          ),\n                          #\"urn:appian:function:v1:a:update\"(\n                            ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction],\n                            {\n                              recordType!CMGT_TaskActions.actionCode,\n                              recordType!CMGT_TaskActions.modifedBy,\n                              recordType!CMGT_TaskActions.modifiedOn\n                            },\n                            { save!value, loggedInUser(), now() }\n                          )\n                        )\n                      }\n                    ),\n                    a!save(\n                      local!selectedAction,\n                      rule!CMGT_UTIL_Filter(\n                        records: ri!actions,\n                        field: \"actionCode\",\n                        value: save!value\n                      )\n                    ),\n                    if(\n                      or(\n                        local!selectedAction.actionCode = \"ASSIGN_CASE\",\n                        local!selectedAction.actionCode = \"REASSIGN_CASE\"\n                      ),\n                      a!save(\n                        ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction],\n                        if(\n                          rule!CMGT_UTIL_IsBlank(\n                            ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction]\n                          ),\n                          recordType!CMGT_AssignmentRule(\n                            recordType!CMGT_AssignmentRule.taskActionUuid: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.taskActionUuid]\n                          ),\n                          recordType!CMGT_AssignmentRule(\n                            recordType!CMGT_AssignmentRule.assignmentRuleId: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.associatedAssignmentRule.assignmentRuleId],\n                            recordType!CMGT_AssignmentRule.taskActionUuid: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.taskActionUuid],\n                            recordType!CMGT_AssignmentRule.taskActionId: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.automationTaskAction.taskActionId]\n                          )\n                        )\n                      ),\n                      {}\n                    )\n                  },\n                  placeholder: #\"urn:appian:translation-string:v1:94dee9b4-fc55-4b1b-af21-a3f5656802be\",\n                  required: true,\n                  requiredMessage: #\"urn:appian:translation-string:v1:4fab94dc-fcb1-427a-af9f-1239079b2897\"(\n                    #\"urn:appian:translation-variable:v1:3e31b6d5-df20-4d17-80a7-81f3c83ff370\": #\"urn:appian:translation-string:v1:ab4f437b-4aa7-4e2c-a59f-d726a9fac1e5\"\n                  ),\n                  validationGroup: ri!validationGroup\n                )\n              ),\n              #\"SYSTEM_SYSRULES_sideBySideItem\"()\n            }\n          ),\n          /*Using ri!allWorkingWorkflowTasks errors when passing into the configuration rule, so using array index instead */\n          if(\n            a!isNotNullOrEmpty(local!selectedAction),\n            local!selectedAction[1].runtimeConfigurationRule(\n              automationRuleTaskAction: ri!allWorkingWorkflowTasks[ri!thisWorkingTaskIndex][recordType!CMGT_Task.automationTaskAction],\n              brandingMap: ri!brandingMap,\n              validationGroup: ri!validationGroup\n            ),\n            {}\n          ),\n\n        },\n        showBorder: false,\n        marginAbove: \"NONE\",\n        marginBelow: \"STANDARD\",\n        shape: \"SEMI_ROUNDED\"\n      ),\n      /* Cancel/Save Buttons */\n      #\"SYSTEM_SYSRULES_ButtonArrayLayout\"(\n        buttons: {\n          #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n            label: #\"urn:appian:translation-string:v1:3e56c457-a27a-49de-aa7d-e865696bf791\",\n            style: \"SOLID\",\n            value: ri!thisWorkingWorkflowTask,\n            saveInto: #\"SYSTEM_SYSRULES_writeRecords_v2\"(\n              records: rule!CMGT_Task_SetMetaData(\n                tasks: ri!thisWorkingWorkflowTask,\n                initiator: loggedInUser()\n              ),\n              onSuccess: {\n                rule!CMGT_SetTrackAutomationRuleChanges(\n                  isAddNew: ri!isAddNew,\n                  trackAutomationRuleChanges: ri!trackAutomationRuleChanges,\n                  recordsUpdated: fv!recordsUpdated,\n                  allAutomationTasks: ri!allAutomationTasks\n                ),\n                a!save(\n                  ri!automationTask,\n                  /*requerying for data instead of save fv!recordsUpdated to account for roles, if roles are not requeried it will mark old ones that were not removed as deleted*/\n                  rule!CMGT_QR_GetTask(\n                    taskIntentionCodes: {\n                      cons!CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_RUNTIME_CONFIG_TRIGGER\n                    },\n                    includeInactive: false,\n                    fields: {\n                      recordType!CMGT_Task.automationTaskAction,\n                      recordType!CMGT_Task.automationTrigger,\n                      /*to show the assignment rule selected*/\n                      recordType!CMGT_Task.automationTaskAction,\n                      #\"urn:appian:record-relationship:v1:ee5aa46d-0228-430f-a794-1134a11fbcc0/45ed19eb-2545-4c96-9e19-72127f9d27a3/dc83b26a-0034-46f4-8085-5887ad59bc08/86c11a87-1ab5-4e62-93f2-b7d24e412b3a\"\n                    },\n                    additionalFilters: {\n                      #\"SYSTEM_SYSRULES_queryFilter\"(\n                        field: recordType!CMGT_Task.taskInstanceUuid,\n                        operator: \"=\",\n                        value: fv!recordsUpdated[recordType!CMGT_Task.taskInstanceUuid][1]\n                      )\n                    }\n                  )\n                ),\n                a!save(ri!ruleState.isReadOnly, true),\n                a!save(ri!isAddNew, false),\n                a!save(\n                  ri!allWorkingWorkflowTasks,\n                  rule!CMGT_UTIL_Filter(\n                    records: ri!allWorkingWorkflowTasks,\n                    field: recordType!CMGT_Task.taskInstanceUuid,\n                    value: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.taskInstanceUuid],\n                    filterType: \"REJECT\"\n                  )\n                ),\n                a!save(\n                  ri!triggerRefresh,\n                  now()\n                )\n\n              },\n              onError: a!save(ri!error, fv!error),\n\n            ),\n            showWhen: not(ri!ruleState.isReadOnly),\n            validate: true,\n            validationGroup: ri!validationGroup\n          ),\n          #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n            label: #\"urn:appian:translation-string:v1:edd4df67-d878-46d6-ab67-732a3700a588\",\n            value: ri!automationTask,\n            saveInto: {\n              ri!thisWorkingWorkflowTask,\n              a!save(ri!ruleState.isReadOnly, true),\n              a!save(ri!isAddNew, false),\n              a!save(\n                ri!allWorkingWorkflowTasks,\n                rule!CMGT_UTIL_Filter(\n                  records: ri!allWorkingWorkflowTasks,\n                  field: recordType!CMGT_Task.taskInstanceUuid,\n                  value: ri!thisWorkingWorkflowTask[recordType!CMGT_Task.taskInstanceUuid],\n                  filterType: \"REJECT\"\n                )\n              ),\n              if(\n                ri!ruleState.isEdit,\n                {},\n                a!save(\n                  ri!allAutomationTasks,\n                  remove(\n                    ri!allAutomationTasks,\n                    ri!automationIndex\n                  )\n                )\n              ),\n              a!save(\n                ri!triggerRefresh,\n                now()\n              )\n            },\n            showWhen: not(ri!ruleState.isReadOnly)\n          ),\n\n        }\n      )\n    }\n  )\n)",
  "calls": [
    {
      "name": "CMGT_UTIL_IsNotBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_Filter",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_SetTrackAutomationRuleChanges",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_AutomationRules_FormatTrigger",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Case_Rules_FormatRuleConditionSet",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_AutomationRules_FormatRuleAction",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_sortList",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Automation_constructSavedFieldMapping",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Automation_FieldLevelConditionsConfiguration",
      "type": "Interface",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Automation_initializeChildConditionSet",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_RejectBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_IsBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_UTIL_GenerateUuid_NonPlugin",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_Task_SetMetaData",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_QR_GetTask",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_REFID_TRIGGER_CASE_FIELD_UPDATED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_REFID_TRIGGER_TASK_FIELD_IS_UPDATED",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_TXT_SET_OPERATOR_AND",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_TXT_SET_OPERATOR_OR",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_WFL_CASE_TYPE_TASK_INTENTION_CODE_RUNTIME_CONFIG_TRIGGER",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_Task",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_CFG_Triggers",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_ConditionSet",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_Condition",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_TaskActions",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "CMGT_AssignmentRule",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "Unknown",
      "type": "Translation String",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_WFL_QR_GetTriggers",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_ENUM_QE_RETURN_TYPE_OBJECT_ARRAY",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_CFG_ENUM_ACTIONS",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "CMGT_CFG_TXT_ACT_CONTEXT_TASK",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "CMGT_CFG_Status",
      "type": "Record Type",
      "dep_type": "USES_RECORD_TYPE"
    }
  ],
  "called_by": [
    {
      "name": "CMGT_Case_ConfigureTask_Task_RulesSection",
      "type": "Interface",
      "dep_type": "CALLS"
    }
  ]
}
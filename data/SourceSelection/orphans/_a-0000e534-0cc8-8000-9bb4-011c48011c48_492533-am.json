{
  "uuid": "_a-0000e534-0cc8-8000-9bb4-011c48011c48_492533-am",
  "name": "AS_GSS_TMG_DSP_displayAuditModificationForReviews",
  "type": "Expression Rule",
  "description": "Returns formatting for modification field on audit grid for document reviews",
  "sail_code": "a!localVariables(\n  /*Task name for Review groups*/\n  local!templateTaskAudit: rule!AS_GSS_TMG_QE_getTemplateTaskAudits(\n    sort: #\"SYSTEM_SYSRULES_sortInfo\"(\n      field: \"templateTaskAuditId\",\n      ascending: false\n    ),\n    templateTaskId: ri!itemId,\n    returnType: cons!AS_CO_ENUM_QE_RETURN_TYPE_SINGLE_OBJECT\n  ).simpleFieldChanges,\n  local!reviewGroupName: if(\n    rule!AS_CO_UT_isBlank(\n      if(\n        rule!AS_CO_UT_isBlank(ri!templateTaskRef.groupAssignee),\n        togroup(\n          tostring(\n            rule!AS_CO_UT_filterCdtByField(\n              cdt: local!templateTaskAudit,\n              field: \"fieldName\",\n              value: \"groupAssignee\"\n            ).oldValue\n          )\n        ),\n        togroup(ri!templateTaskRef.groupAssignee)\n      )\n    ),\n    null,\n    group(\n      if(\n        rule!AS_CO_UT_isBlank(ri!templateTaskRef.groupAssignee),\n        togroup(\n          tostring(\n            rule!AS_CO_UT_filterCdtByField(\n              cdt: local!templateTaskAudit,\n              field: \"fieldName\",\n              value: \"groupAssignee\"\n            ).oldValue\n          )\n        ),\n        togroup(ri!templateTaskRef.groupAssignee)\n      ),\n      \"groupName\"\n    )\n  ),\n  local!reviewGroupSuffix: {\n    \" \",\n    rule!AS_GAM_CO_I18N_UT_displayLabel(\n      bundle: ri!i18nData,\n      bundleKey: if(\n        ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_ADD,\n        \"txt_ToReviewGrp\",\n        \"txt_OfReviewGrp\"\n      )\n    ),\n    \" \"\n  },\n  local!reviewSuffix: {\n    \" \",\n    rule!AS_GAM_CO_I18N_UT_displayLabel(\n      bundle: ri!i18nData,\n      bundleKey: if(\n        ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_ADD,\n        \"txt_ToReview\",\n        \"txt_OfReview\"\n      )\n    ),\n    \" \"\n  },\n  choose(\n    rule!AS_CO_UT_chooseWherecontainsHelper(\n      value: ri!fieldName,\n      inArray: rule!AS_GSS_TMG_CONS_templateAuditFields()\n    ),\n    /*Default*/\n    {},\n    /*Note: the order should be similar to AS_GSS_TMG_CONS_templateAuditFields*/\n    /*Review Name*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"the review\"\n      ),\n      \" \",\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!template.templateName,\n        style: \"STRONG\"\n      )\n    },\n    /*Review Description*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"the review description\"\n      ),\n      \" \",\n      rule!AS_GAM_CO_I18N_UT_displayLabel(\n        bundle: ri!i18nData,\n        bundleKey: if(\n          ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_ADD,\n          \"txt_ToReview\",\n          \"txt_OfReview\"\n        )\n      ),\n      \" \",\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!template.templateName,\n        style: \"STRONG\"\n      )\n    },\n    /*Group Assignee*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"group assignee\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Task Description*/\n    {},\n    /*Task*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: rule!AS_GAM_CO_I18N_UT_displayLabel(\n          bundle: ri!i18nData,\n          bundleKey: if(\n            rule!AS_CO_UT_isBlank(value: local!reviewGroupName),\n            \"txt_AReviewGrp\",\n            \"txt_ReviewGrp\"\n          )\n        )\n      ),\n      \" \",\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Task ref id Precedent - for checklists*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"precedent\"\n      ),\n      \" \",\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: rule!AS_CO_UT_filterCdtByField(\n          cdt: ri!taskRefData,\n          field: \"taskRefId\",\n          value: if(\n            ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_DELETE,\n            ri!oldValue,\n            ri!newValue\n          )\n        ).taskName,\n        style: \"STRONG\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Group id  Precedent - for Reviews*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"precedent\" & \" \"\n      ),\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: if(\n          rule!AS_CO_UT_isBlank(\n            togroup(\n              if(\n                ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_DELETE,\n                ri!oldValue,\n                ri!newValue\n              )\n            )\n          ),\n          null,\n          group(\n            togroup(\n              if(\n                ri!templateAuditEntry.actionCode = cons!AS_ADT_ENUM_AUDIT_ACTION_CODE_DELETE,\n                ri!oldValue,\n                ri!newValue\n              )\n            ),\n            \"groupName\"\n          )\n        ),\n        style: \"STRONG\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Duration*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"duration\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Duration unit*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"duration unit\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*No of days*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"days from start\"\n      ),\n      local!reviewGroupSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: local!reviewGroupName,\n        style: \"STRONG\"\n      )\n    },\n    /*Operation*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"operation\"\n      ),\n      local!reviewSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!template.templateName,\n        style: \"STRONG\"\n      )\n    },\n    /*Threshold Amount*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"threshold amount\"\n      ),\n      local!reviewSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!template.templateName,\n        style: \"STRONG\"\n      )\n    },\n    /*Document Template*/\n    {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: \"document template\"\n      ),\n      local!reviewSuffix,\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!template.templateName,\n        style: \"STRONG\"\n      )\n    }\n  )\n)",
  "calls": [
    {
      "name": "AS_GSS_TMG_QE_getTemplateTaskAudits",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_isBlank",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_filterCdtByField",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GAM_CO_I18N_UT_displayLabel",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_UT_chooseWherecontainsHelper",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_GSS_TMG_CONS_templateAuditFields",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AS_CO_ENUM_QE_RETURN_TYPE_SINGLE_OBJECT",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_ADT_ENUM_AUDIT_ACTION_CODE_ADD",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    },
    {
      "name": "AS_ADT_ENUM_AUDIT_ACTION_CODE_DELETE",
      "type": "Constant",
      "dep_type": "USES_CONSTANT"
    }
  ],
  "called_by": [
    {
      "name": "AS_GSS_TMG_DSP_modificationCommentForTemplateAudit",
      "type": "Interface",
      "dep_type": "CALLS"
    }
  ]
}
{
  "_metadata": {
    "bundle_id": "CMGT_SMS_AI_SearchHistory_-_urnappiantranslation-stringv12e20ffd5-5f6f-4435-88fd"
  },
  "objects": {
    "_a-0000e9ae-873e-8000-9baf-011c48011c48_97626": {
      "name": "CMGT_UTIL_DeleteConfirmation",
      "type": "Interface",
      "sail_code": "{\n  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n    labelPosition: \"COLLAPSED\",\n    marginAbove: a!defaultValue(ri!marginAboveConfirmation,\"MORE\")\n  ),\n  #\"SYSTEM_SYSRULES_stampField\"(\n    labelPosition: \"COLLAPSED\",\n    icon: a!defaultValue(\n      value: ri!stampIcon,\n      default: \"warning\"\n    ),\n    backgroundColor: a!defaultValue(ri!stampColor,ri!brandingMap.WarningAccentColor),\n    contentColor: ri!brandingMap.WhiteColor,\n    size: a!defaultValue(value: ri!stampSize, default: \"TINY\"),\n    align: \"CENTER\"\n  ),\n  #\"SYSTEM_SYSRULES_richTextDisplayField\"(\n    labelPosition: \"COLLAPSED\",\n    value: {\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: ri!primaryMessage,\n        size: \"MEDIUM\",\n        style: \"STRONG\"\n      ),\n      char(10),\n      #\"SYSTEM_SYSRULES_richTextItem_v1\"(\n        text: {\n          ri!secondaryMessage\n        },\n        color: ri!brandingMap.SecondaryTextColor,\n        size: \"STANDARD\"\n      )\n    },\n    align: \"CENTER\"\n  )\n}"
    },
    "_a-0000e98b-cfe0-8000-9ba5-011c48011c48_22352": {
      "name": "CMGT_UTIL_QueryRecord",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  /*Chosen return type*/\n  local!returnType: a!defaultValue(ri!returnType, \"OBJECT_ARRAY\"),\n  /*Determine the query parameters to use by the return type*/\n  local!queryParams: a!match(\n    value: local!returnType,\n    equals: \"OBJECT_ARRAY\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        #\"urn:appian:function:v1:a:listtype?okey=a!listType\"(ri!recordType),\n        'type!{http://www.appian.com/ae/types/2009}Map?list'\n      ),\n      fetchTotalCount: false,\n      isArray: true,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"SINGLE_OBJECT\",\n    then: a!map(\n      castToType: if(\n        a!isNullOrEmpty(ri!groupByFields),\n        ri!recordType,\n        'type!{http://www.appian.com/ae/types/2009}Map'\n      ),\n      fetchTotalCount: false,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: 1,\n        batchSize: 1,\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"DATA_SUBSET\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}DataSubset',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(\n        startIndex: a!defaultValue(ri!pagingInfo.startIndex, 1),\n        batchSize: a!defaultValue(\n          ri!pagingInfo.batchSize,\n          cons!CMGT_INT_BATCH_SIZE_MAX\n        ),\n        sort: { ri!pagingInfo.sort, ri!sort }\n      )\n    ),\n    equals: \"TOTAL_COUNT\",\n    then: a!map(\n      castToType: 'type!{http://www.appian.com/ae/types/2009}Integer',\n      fetchTotalCount: true,\n      isArray: false,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(startIndex: 1, batchSize: 0)\n    ),\n    default: fn!error(\n      \"Invalid returnType, must be one of: OBJECT_ARRAY, SINGLE_OBJECT, DATA_SUBSET, TOTAL_COUNT\"\n    )\n  ),\n  if(\n    /*Early exit for skip execution*/\n    ri!executeWhen = false,\n    cast(\n      local!queryParams.castToType,\n      if(local!queryParams.isArray, {}, null)\n    ),\n    a!localVariables(\n      /*Run the query*/\n      local!queryResult: a!refreshVariable(\n        value: #\"SYSTEM_SYSRULES_queryRecordType_v2\"(\n          recordType: ri!recordType,\n          fields: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            reject(\n              a!isNullOrEmpty,\n              a!flatten(\n                {\n                  ri!fields,\n                  index(ri!relatedRecordData, \"relationship\", {})\n                }\n              )\n            ),\n            #\"SYSTEM_SYSRULES_aggregationFields\"(\n              groupings: #\"SYSTEM_SYSRULES_forEach\"(\n                items: ri!groupByFields,\n                expression: #\"SYSTEM_SYSRULES_grouping\"(field: fv!item, alias: tostring(fv!item))\n              ),\n              measures: #\"SYSTEM_SYSRULES_measure\"(\n                field: ri!groupByFields[1],\n                function: \"COUNT\",\n                alias: \"count\"\n              )\n            )\n          ),\n          filters: #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n            operator: \"AND\",\n            ignoreFiltersWithEmptyValues: true,\n            logicalExpressions: {\n              ri!logicalExpressions,\n              if(\n                and(\n                  a!isNotNullOrEmpty(ri!searchFields),\n                  a!isNotNullOrEmpty(ri!searchTerm)\n                ),\n                #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                  operator: \"AND\",\n                  logicalExpressions: #\"SYSTEM_SYSRULES_forEach\"(\n                    items: split(trim(ri!searchTerm), \" \"),\n                    expression: a!localVariables(\n                      local!splitSearchTerm: fv!item,\n                      #\"SYSTEM_SYSRULES_queryLogicalExpression\"(\n                        operator: \"OR\",\n                        filters: #\"SYSTEM_SYSRULES_forEach\"(\n                          items: ri!searchFields,\n                          expression: #\"SYSTEM_SYSRULES_queryFilter\"(\n                            field: fv!item,\n                            operator: \"includes\",\n                            value: local!splitSearchTerm\n                          )\n                        )\n                      )\n                    )\n                  )\n                ),\n                {}\n              )\n            },\n            filters: ri!filters\n          ),\n          pagingInfo: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            local!queryParams.pagingInfo,\n            #\"urn:appian:function:v1:a:update\"(\n              local!queryParams.pagingInfo,\n              \"sort\",\n              null\n            )\n          ),\n          fetchTotalCount: local!queryParams.fetchTotalCount,\n          relatedRecordData: if(\n            a!isNullOrEmpty(ri!groupByFields),\n            ri!relatedRecordData,\n            {}\n          )\n        ),\n        refreshOnVarChange: ri!triggerRefresh,\n        refreshAfter: { \"RECORD_ACTION\" }\n      ),\n      /*Format the output*/\n      local!output: a!match(\n        value: local!returnType,\n        equals: \"OBJECT_ARRAY\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"SINGLE_OBJECT\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult.data\n        ),\n        equals: \"DATA_SUBSET\",\n        then: cast(\n          local!queryParams.castToType,\n          local!queryResult\n        ),\n        equals: \"TOTAL_COUNT\",\n        then: local!queryResult.totalCount,\n        default: null\n      ),\n      local!output\n    )\n  )\n)"
    },
    "_a-0000eea8-05c2-8000-9db5-011c48011c48_4806083": {
      "name": "CMGT_SMS_AI_SearchHistory_Delete",
      "type": "Interface",
      "sail_code": "a!localVariables(\n  local!brandingMap: rule!CMGT_UTIL_LoadBrandingMap(),\n  #\"SYSTEM_SYSRULES_formLayout_v2\"(\n    titleBar: #\"SYSTEM_SYSRULES_cardLayout\"(\n      contents: {\n        #\"SYSTEM_SYSRULES_headingField\"(\n          text: #\"urn:appian:translation-string:v1:d7422f2a-6001-4cea-b7bf-1dafacbe34b6\",\n          size: local!brandingMap.H1Size,\n          headingTag: \"H1\",\n          fontWeight: \"SEMI_BOLD\",\n          marginAbove: \"STANDARD\"\n        )\n      },\n      padding: \"STANDARD\",\n      showBorder: false()\n    ),\n    showTitleBarDivider: true(),\n    contents: rule!CMGT_UTIL_DeleteConfirmation(\n      primaryMessage: #\"urn:appian:translation-string:v1:fe4e6b73-4730-43c0-b69a-a0ad24fe2547\",\n      secondaryMessage: #\"urn:appian:translation-string:v1:4546a288-a8d9-4dcc-a7c4-9723690b4533\",\n      stampIcon: \"warning\",\n      stampSize: \"TINY\",\n      marginAboveConfirmation: \"EVEN_MORE\",\n      brandingMap: local!brandingMap,\n      stampColor: local!brandingMap.WarningAccentColor\n    ),\n    isButtonFooterFixed: true,\n    showButtonDivider: true,\n    buttons: #\"SYSTEM_SYSRULES_ButtonLayout\"(\n      primaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:98d6193b-3f35-4ce6-86a0-86db512c18fc\",\n          style: \"SOLID\",\n          submit: true\n        )\n      },\n      secondaryButtons: {\n        #\"SYSTEM_SYSRULES_buttonWidget_v1\"(\n          label: #\"urn:appian:translation-string:v1:86261323-8a67-4042-8912-0955a1bd1e33\",\n          style: \"OUTLINE\",\n          submit: true,\n          validate: false,\n          saveInto: a!save(ri!isCancel, true())\n        )\n      }\n    )\n  )\n)"
    },
    "_a-0000e9f4-1323-8000-9bd3-011c48011c48_267840": {
      "name": "CMGT_UTIL_LoadBrandingMap",
      "type": "Expression Rule",
      "sail_code": "a!localVariables(\n  local!branding: getbrandingconfig(\n    cons!CMGT_DOC_DEFAULT_BRANDING_CONFIG,\n    true\n  ),\n  local!output: reduce(\n    #\"urn:appian:function:v1:a:update\"(_, _, _),\n    a!map(),\n    merge(\n      {\n        local!branding.defaultBranding.key,\n        local!branding.customBranding.key\n      },\n      {\n        local!branding.defaultBranding.value,\n        local!branding.customBranding.value\n      }\n    )\n  ),\n  local!output\n)"
    },
    "0007eeac-bbc7-8000-29f6-7f0000014e7a": {
      "name": "CMGT_SMS_AI_SearchHistoryDelete",
      "type": "Process Model",
      "sail_code": "// Input: ?\n= rule!CMGT_SMS_AI_QR_GetSearchHistory( returnType: \"OBJECT_ARRAY\", fields: recordType!CMGT_SMS_AI_SearchHistory.searchHistoryCategoryMap, createdBy:pp!initiator)"
    },
    "_a-0000eea8-05c2-8000-9db5-011c48011c48_4799702": {
      "name": "CMGT_SMS_AI_QR_GetSearchHistory",
      "type": "Expression Rule",
      "sail_code": "rule!CMGT_UTIL_QueryRecord(\n  recordType: recordType!CMGT_SMS_AI_SearchHistory,\n  returnType: ri!returnType,\n  triggerRefresh: ri!triggerRefresh,\n  executeWhen: ri!executeWhen,\n  filters: {\n    ri!additionalFilters,\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_SMS_AI_SearchHistory.searchId,\n      operator: \"in\",\n      value: ri!searchId\n    ),\n    #\"SYSTEM_SYSRULES_queryFilter\"(\n      field: recordType!CMGT_SMS_AI_SearchHistory.createdBy,\n      operator: \"=\",\n      value: ri!createdBy\n    )\n  },\n  logicalExpressions: ri!additionalLogicalExpression,\n  fields: { ri!fields },\n  pagingInfo: ri!pagingInfo,\n  sort: ri!sort\n)"
    }
  }
}
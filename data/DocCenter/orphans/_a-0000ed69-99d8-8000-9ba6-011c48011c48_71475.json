{
  "uuid": "_a-0000ed69-99d8-8000-9ba6-011c48011c48_71475",
  "name": "AIA_ClassificationModel_GetDataForHomePage",
  "type": "Expression Rule",
  "description": "Expression rule to get Data for Home Page",
  "sail_code": "a!localVariables(\n  /*Classification Model Data*/\n  local!classificationModelData: index(\n    #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n      recordType: recordType!AIA Classification Model,\n      fields: #\"SYSTEM_SYSRULES_aggregationFields\"(\n        measures: {\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Model.modelId,\n            function: \"COUNT\",\n            alias: \"activeModelCount\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Model.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Model.publishedAccuracy,\n            function: \"AVG\",\n            alias: \"accuracyAvg\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Model.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            alias: \"lastMonthOrYearAccuracyAvg\",\n            field: recordType!AIA Classification Model.publishedAccuracy,\n            function: \"AVG\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Model.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.previousStartDate,\n                ri!selectedInterval.previousEndDate\n              }\n            )\n          )\n        }\n      ),\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(1, 1)\n    ).data,\n    1,\n    null()\n  ),\n  /*Classification Instance Data*/\n  local!classificationInstanceData: index(\n    #\"SYSTEM_SYSRULES_queryRecordType_v1\"(\n      recordType: recordType!AIA Classification Instance,\n      pagingInfo: #\"SYSTEM_SYSRULES_pagingInfo\"(1, 1),\n      fields: #\"SYSTEM_SYSRULES_aggregationFields\"(\n        measures: {\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Instance.id,\n            function: \"COUNT\",\n            alias: \"instanceCount\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Instance.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Instance.id,\n            function: \"COUNT\",\n            alias: \"LastMonthOrYearInstanceCount\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Instance.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.previousStartDate,\n                ri!selectedInterval.previousEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Instance.inputTokens,\n            function: \"SUM\",\n            alias: \"inputTokens\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Instance.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Instance.outputTokens,\n            function: \"SUM\",\n            alias: \"outputTokens\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Instance.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          ),\n          #\"SYSTEM_SYSRULES_measure\"(\n            field: recordType!AIA Classification Instance.pageCount,\n            function: \"SUM\",\n            alias: \"pageCount\",\n            filters: #\"SYSTEM_SYSRULES_queryFilter\"(\n              field: recordType!AIA Classification Instance.createdOn,\n              operator: \"between\",\n              value: {\n                ri!selectedInterval.currrentStartDate,\n                ri!selectedInterval.currentEndDate\n              }\n            )\n          )\n        }\n      )\n    ).data,\n    1,\n    null\n  ),\n  {\n    a!map(\n      kpiLabel:\"Active Model\",\n      kpiValue: local!classificationModelData.activeModelCount,\n      isDisplay: false()\n    ),\n    a!map(\n      kpiValue: sum(\n        a!defaultValue(\n          local!classificationInstanceData.inputTokens,\n          0\n        ),\n        a!defaultValue(\n          local!classificationInstanceData.outputTokens,\n          0\n        )\n      ),\n      kpiSecondaryValue: 0,\n      kpiForthValue: a!defaultValue(\n        local!classificationInstanceData.pageCount,\n        0\n      ),\n      KpiFithValue: local!classificationInstanceData.inputTokens,\n      KpiSixthValue: local!classificationInstanceData.outputTokens,\n      actualValue: sum(\n        a!defaultValue(\n          local!classificationInstanceData.inputTokens,\n          0\n        ),\n        a!defaultValue(\n          local!classificationInstanceData.outputTokens,\n          0\n        )\n      )\n    ),\n    a!map(\n      kpiValue: local!classificationInstanceData.instanceCount,\n      kpiSecondaryValue: a!defaultValue(\n        rule!AIA_UTIL_findAverageRaiseGivenInputNumbers(\n          lastMonthYear: a!defaultValue(\n            local!classificationInstanceData.LastMonthOrYearInstanceCount,\n            0\n          ),\n          thisMonthYear: a!defaultValue(\n            local!classificationInstanceData.instanceCount,\n            0\n          )\n        ),\n        0\n      ),\n      actualValue: local!classificationInstanceData.instanceCount\n    ),\n    a!map(\n      kpiValue: rule!AIA_DisplayPercentage(\n        value: if(\n          a!isNotNullOrEmpty(\n            local!classificationModelData.accuracyAvg\n          ),\n          round(\n            local!classificationModelData.accuracyAvg,\n            2\n          ),\n          0\n        )\n      ),\n      kpiSecondaryValue: a!defaultValue(\n        rule!AIA_UTIL_findAverageRaiseGivenInputNumbers(\n          lastMonthYear: a!defaultValue(\n            local!classificationModelData.lastMonthOrYearAccuracyAvg,\n            0\n          ),\n          thisMonthYear: a!defaultValue(\n            local!classificationModelData.accuracyAvg,\n            0\n          )\n        ),\n        0\n      ),\n      KpiThirdValue: local!classificationModelData.activeModelCount,\n      actualValue: local!classificationModelData.accuracyAvg\n    )\n  }\n)",
  "calls": [
    {
      "name": "AIA_UTIL_findAverageRaiseGivenInputNumbers",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    },
    {
      "name": "AIA_DisplayPercentage",
      "type": "Expression Rule",
      "dep_type": "CALLS"
    }
  ],
  "called_by": []
}